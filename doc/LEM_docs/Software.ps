%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: Software.dvi
%%Pages: 116
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentPaperSizes: a4
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -o file.ps Software.dvi
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2001.11.15:1457
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (Software.dvi)
@start
%DVIPSBitmapFont: Fa cmsy10 10.95 1
/Fa 1 3 df<0060166000F816F06C1501007E15036CED07E06C6CEC0FC06C6CEC1F806C
6CEC3F006C6C147E6C6C5C6C6C495A017E495A6D495A6D6C485A6D6C485A6D6C48C7FC90
3803F07E6D6C5A903800FDF8EC7FF06E5A6E5AA24A7E4A7EECFDF8903801F8FC903803F0
7E49487E49486C7E49486C7E49486C7E017E6D7E496D7E48486D7E4848147E4848804848
EC1F804848EC0FC048C8EA07E0007EED03F0481501481500006016602C2C73AC47>2
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fb cmmi10 10.95 8
/Fb 8 123 df<ED1FC0EDFFF0913803E07C91380F803E4A487E023E14804AEB0FC05C49
4814E01303495A5C130F494814F0A2133F91C7FCEE1FE05B137EA201FE143F17C05BA200
01ED7F80A24915005E00035D4B5AA24B5A486C495A4B5A6D5C01EEEB3F80D80FE7017EC7
FC9038E3C1F89038C1FFE0D9C07FC8FC001F90C9FCA25BA2123FA290CAFCA25AA2127EA2
12FEA25AA35A12702C3C7EA72F>26 D<ED0180ED03C01507A21680150FA216005DA2151E
153EA2153C157CA2157815F8A25D1401A25D1403A25D1407A25D140FA24AC7FCA2141E14
3EA2143C147CA2147814F8A25C1301A25C1303A25C1307A25C130FA291C8FC5BA2131E13
3EA25BA2137813F8A25B1201A25B1203A25B1207A25B120FA290C9FC5AA2121E123EA212
3C127CA2127812F8A25A1260225B7BC32D>61 D<EC07F0EC7FFE903801FC0F903907E003
8090390FC001C0D93F8013E090387F000701FE131F485A485A16C0485A000F15804990C7
FC121F485AA3127F5BA312FF90C9FCA6007E1560007F15E01501ED03C06CEC07806DEB0F
00001F141E6C6C137C3907E001F03901F01FC06CB5C7FCEB1FF023297DA727>99
D<D907C013FE903A0FF003FF80903A1C7C0F07E0903A383C1C03F0903A783E7801F80170
EBF0009026F03FE013FC01E05B4B13FE0001017F147E01C090C7FC147E17FF000313FEA2
C75AA201015C17FE5CA20103140317FC5CA20107EC07F8A24A14F0160F010F15E0161F17
C0EE3F80011F15006E137E5E9138B801F890393FBC03E091389E0FC0DA07FFC7FCEC01F8
49C9FCA2137EA213FEA25BA21201A25BA21203A2B512E0A3303A84A72E>112
D<D801F0EB3F80D807FCEBFFE03A0F1F03C0F0000E90380F00F8391E0F9E03001C13BC00
3CEBF807003813F0A226781FE013F000709038C001C092C7FC5C12F0133F000090C8FCA3
5B137EA313FE5BA312015BA312035BA312075BA3120F5BEA038025297EA729>114
D<D901F8133FD907FEEBFFE0903A1E0F83C0F0903A3807C780F890397003CF0301E013FE
D801C0EBFC071203018013F8D8070015F0EE01C0000E4AC7FCA2001E1307A2C75BA2140F
5DA3141F5DA3143F92380001C0A34A1303001E1680003F017E1307267F80FE14005ED8FF
81141ED901DF131CD8FE035C3A7C078F80F03A3C0F07C1E03A1FFC03FF802707F0007EC7
FC2D297EA734>120 D<137C48B4EC03802603C7C0EB0FC0EA0703000F7F000E151F001C
168013071238163FD8780F150000705BA2D8F01F5C4A137E1200133F91C712FE5E5B137E
150113FE495CA2150300015D5BA215075EA2150F151F00005D6D133F017C137F017E13FF
90393F03DF8090380FFF1FEB01FC90C7123F93C7FCA25DD80380137ED80FE013FE001F5C
4A5AA24848485A4A5A6CC6485A001C495A001E49C8FC000E137C380781F03803FFC0C648
C9FC2A3B7EA72D>I<02F8130ED903FE131ED90FFF131C49EB803C49EBC0784914F09039
7E07F1E09038F800FF49EB1FC049EB07800001EC0F006C48131E90C75A5D5D4A5A4A5A4A
5A4AC7FC143E14785C495A495A495A49C8FC011E14E05B5B4913014848EB03C0485AD807
F8EB078048B4131F3A1F87E07F00391E03FFFE486C5B00785CD870005B00F0EB7FC04801
1FC7FC27297DA72A>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fc cmex10 10 9
/Fc 9 126 df<151E153E157C15F8EC01F0EC03E01407EC0FC0EC1F8015005C147E5CA2
495A495AA2495AA2495AA2495AA249C7FCA2137EA213FE5B12015BA212035BA21207A25B
120FA35B121FA45B123FA548C8FCA912FEB3A8127FA96C7EA5121F7FA4120F7FA312077F
A21203A27F1201A27F12007F137EA27FA26D7EA26D7EA26D7EA26D7EA26D7E6D7EA2147E
80801580EC0FC0EC07E01403EC01F0EC00F8157C153E151E1F94718232>16
D<12F07E127C7E7E6C7E7F6C7E6C7E12017F6C7E137EA27F6D7EA26D7EA26D7EA26D7EA2
6D7EA26D7EA280147E147F80A21580141FA215C0A2140F15E0A3140715F0A4140315F8A5
EC01FCA9EC00FEB3A8EC01FCA9EC03F8A515F01407A415E0140FA315C0141FA21580A214
3F1500A25C147E14FE5CA2495AA2495AA2495AA2495AA2495AA249C7FC137EA25B485A5B
1203485A485A5B48C8FC123E5A5A5A1F947D8232>I<F107C0F11FF0F17C3CF1F80E0601
133EF1F07F953803E0FF1807A24E5A1A7E95381F803C1A00A24EC7FCA260A2187E18FEA3
601701A34D5AA4170760A3170FA260A2171FA260A3173FA360177FA44DC8FCA55E5FA316
03A35FA21607A35FA2160FA44C5AA5163F5FA4167F5FA416FF5FA45D94C9FCA45D5EA54B
5AA54B5AA45EA2151FA35EA2153FA35EA3157F5EA54BCAFCA45D1401A35DA31403A25DA2
1407A25DA3140F5DA44A5AA35D143FA392CBFC5CA2147E14FE5CA2383C01F8127E12FF49
5A5C130700FE5B387C0F80D8701FCCFCEA3C3EEA0FFCEA03F048B87B7F2E>90
D<B512E0A500F8C7FCB3B3B3B3B3B3B3ACB512E0A513946E8227>104
D<B512E0A5EA0003B3B3B3B3B3B3B3ACB5FCA513947F8227>I<EE7F80ED0FFF157F4AB5
FC140F143F5C49B6FC13075B4991C7FC4913E090B5C8FC4813F84813E014804848C9FC48
5AEA1FF0485A5B485A48CAFCA25A5A5A291B838925>122 D<B4FC13F813FF14C014F814
FE8015C015F081C66C7F01037F9039007FFF80020F7F02037F1400ED3FF06F7EED07FC6F
7E15016F7EEE7F80A2163F161F160F291B818925>I<12F87E7E7EA26C7E6C7E7F6C7EEA
0FFC6C7E6C6C7E14E06C13F86C13FF013F13E06D13FF6DECFF807F13016D7E80140F1401
6E7E150FED007F291B839A25>I<EE0F80161F163F167FA2EEFF004B5A15034B5AED1FF8
4B5AEDFFE01403020F5B027F5B902603FFFEC7FC017F5BB65A5D15C092C8FC5C14F814C0
91C9FC13F890CAFC291B819A25>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fd cmmi6 6 2
/Fd 2 113 df<ED01C01507151FED7F00EC01FCEC07F0EC1FC0027FC7FC14FCEB03F0EB
0FC0EB3F8001FEC8FCEA03F8EA0FE0EA3F8000FEC9FC12F812FEEA3F80EA0FE0EA03F8EA
00FEEB3F80EB0FC0EB03F0EB00FC147FEC1FC0EC07F0EC01FCEC007FED1FC01507150122
237A9D30>60 D<3801E01F3903F07FC0390639C1E0390C3F80F0EB3E00001814F8013C13
7815F8C65AA49038F001F0A3EC03E0D801E013C0EBF00715809038F80F003803DC3CEBCF
F8EBC7E001C0C7FC485AA448C8FCA2EA7FF012FF1D20809520>112
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fe cmmi8 8 14
/Fe 14 121 df<15C0140114031580A214071500A25C140EA2141E141CA2143C14381478
1470A214F05CA213015CA213035C130791C7FCA25B130EA2131E131CA2133C1338A21378
137013F05BA212015BA212035BA2120790C8FC5A120EA2121E121CA2123C1238A2127812
70A212F05AA21A437CB123>61 D<000FB8FCA23B1FC003F8003F0100151F001C4A130E12
3C003801071406123000704A130EA20060010F140C12E0485CA2141FC715005DA2143FA2
92C8FCA25CA2147EA214FEA25CA21301A25CA21303A25CA21307A25C130F131F001FB512
F0A2302D7FAC29>84 D<EB07E0EB1FF890387C1CE0EBF80D3801F00F3803E007EA07C012
0FD81F8013C0A2EA3F00140F481480127EA2141F00FE14005AA2EC3F02EC3E06A25AEC7E
0E007CEBFE0C14FC0101131C393E07BE18391F0E1E38390FFC0FF03903F003C01F1F7D9D
25>97 D<13F8121FA21201A25BA21203A25BA21207A25BA2120FEBC7E0EB9FF8EBB83C38
1FF01EEBE01F13C09038800F80EA3F00A2123EA2007E131FA2127CA2143F00FC14005AA2
147EA2147C14FC5C387801F01303495A383C0F806C48C7FCEA0FFCEA03F0192F7DAD1E>
I<EB01F8EB0FFE90383E0780EB7C01D801F813C03803F0073807E00FEA0FC00180138012
1F48C8FCA25A127EA312FE5AA51560007C14E0EC01C0EC03806CEB0F00001E131C380F81
F83807FFE0C648C7FC1B1F7D9D1F>I<1307EB0F80EB1FC0A2EB0F80EB070090C7FCA9EA
01E0EA07F8EA0E3CEA1C3E123812301270EA607EEAE07C12C013FC485A120012015B1203
5BA21207EBC04014C0120F13801381381F01801303EB0700EA0F06131EEA07F8EA01F012
2E7EAC18>105 D<15E0EC01F01403A3EC01C091C7FCA9147CEB03FE9038078F80EB0E07
131C013813C01330EB700F0160138013E013C0EB801F13001500A25CA2143EA2147EA214
7CA214FCA25CA21301A25CA21303A25CA2130700385BEAFC0F5C49C7FCEAF83EEAF0F8EA
7FF0EA1F801C3B81AC1D>I<131FEA03FFA2EA003FA2133EA2137EA2137CA213FCA25BA2
120115F89038F003FCEC0F0E0003EB1C1EEC387EEBE07014E03807E1C09038E3803849C7
FC13CEEA0FDC13F8A2EBFF80381F9FE0EB83F0EB01F81300481404150C123EA2007E141C
1518007CEBF038ECF83000FC1470EC78E048EB3FC00070EB0F801F2F7DAD25>I<90387C
01F89038FE07FE3901CF8E0F3A03879C0780D907B813C0000713F000069038E003E0EB0F
C0000E1380120CA2D8081F130712001400A249130F16C0133EA2017EEB1F80A2017C1400
5D01FC133E5D15FC6D485A3901FF03E09038FB87C0D9F1FFC7FCEBF0FC000390C8FCA25B
A21207A25BA2120FA2EAFFFCA2232B829D24>112 D<3807C01F390FF07FC0391CF8E0E0
383879C138307B8738707F07EA607E13FC00E0EB03804848C7FCA2128112015BA21203A2
5BA21207A25BA2120FA25BA2121FA290C8FC120E1B1F7E9D20>114
D<EB07E0EB3FF8EB781EEBF0063801E0073803C00F141FA20007131E140CEBE00013F8EB
FF806C13E06C13F06C13F8EB3FFC13011300147C0078133C12FCA2147C48137800E013F8
14F0386001E0387807C0381FFF00EA07F8181F7C9D21>I<130E131FA25BA2133EA2137E
A2137CA213FCA2B512F8A23801F800A25BA21203A25BA21207A25BA2120FA25BA2001F13
10143013001470146014E0381E01C0EB0380381F0700EA0F0EEA07FCEA01F0152B7EA919
>I<D801E01370D807F813F8380E3C01D81C3E13FC1238003013000070147CEA607ED8E0
7C133812C013FC485A0000143012015B1570000314605B15E015C01207EBC00115801403
EC070000031306EBE00E00015BEBF07838007FE0EB1F801E1F7E9D22>118
D<013F137C9038FFC1FF3A01C1E383803A0380F703C0390700F60F000E13FE4813FC1218
0038EC0700003049C7FCA2EA200100005BA313035CA301075B5D14C000385CD87C0F1306
00FC140E011F130C011B131C39F03BE038D8707113F0393FE0FFC0260F803FC7FC221F7E
9D28>120 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Ff cmbx10 10 9
/Ff 9 90 df<ED03E04B7EA24B7EA34B7EA24B7EA34B7EA292B57EA34A8015F302038015
E1A202078015C0020F80ED807FA2021F80ED003F4A80023E131FA2027E80027C7F02FC81
4A7FA20101824A7F49B77EA3498202C0C7FC010F824A147FA2011F8291C8123F4982013E
151FA2017E82017C8101FE83B500F80107B61280A4413A7DB948>65
D<DB3FFCEB01C00203B5EAC003021FECF00791B6EAFC0F01039039FC00FF3F4901C0EB1F
FFD91FFEC77E49481403D97FF080494880485B48177F4849153F4890C9FC181F485A180F
123F5B1807127FA24993C7FC12FFAD127F7FF003C0123FA27F001F1707A26C6C1780180F
6C6D16006C6D5D6C173E6C6D157ED97FF85D6D6C4A5A6DB44A5A010701C0EB0FE06D01FC
EBFF80010090B548C7FC021F14F8020314E09126003FFEC8FC3A3B7BB945>67
D<B87E17F817FF18C028007FF8000713F09338007FF8EF1FFE717E050313807113C0A271
13E0F07FF0A2F03FF8A219FC181FA219FEA419FFAC19FEA419FC183FA219F8187F19F0F0
FFE0A24D13C04D13804D1300EF1FFEEF7FFC933807FFF0B912C095C7FC17FC178040397D
B849>I<B612FCA439007FF800B3B3ADB612FCA41E397DB824>73
D<B7FCA426007FF8C9FCB3ACEF0780A5170F1800A35FA25FA25F5F5E5EEE0FFE167FB8FC
A431397DB839>76 D<B500FC0203B512F0A28080C66C6D90390003F0006F6E5A81017B7F
13798101787F6E7E6E7E6E7F6E7FA26E7F6E7F6E7F6E7F6F7E153F826F13806F13C06F13
E06F13F06F13F88117FCEE7FFEEE3FFF7013817013C17013E18218F17013F97013FDEF7F
FF8383A28383838383187FA2183F181F01FC160FB500FC150718031801A244397DB84B>
78 D<D907FF130E013FEBE01E90B5EAF83E0003ECFE7E3A07FC01FFFE390FF0001F4848
130F48481303491301007F140090C8FC167E5A163EA27F161E7F7F6D91C7FC13FC387FFF
E014FEECFFF06C14FE6F7E6C816C15F06C816C81C681133F010F801301D9000F1480EC00
7F030F13C01503818100F0157FA3163FA27E17807E167F6C16007E6D14FE01E0495A01F8
13039039FF801FF800FC90B512E0D8F83F5CD8F00749C7FC39E0007FF02A3B7BB935>83
D<B600F00103B512E0A4C601F0C83807F0006E5E017F5F6E150FA2013F5F6E151F011F94
C7FC6E5D6D163E6F147E6D167CA26F14FC6D5E6F13016D5E6F13036D5E811707027F5D6F
130F023F5D6F131F021F92C8FC815F6E143EEE807E6E147CEEC0FC6E5C16E016E16E5C16
F36E5C16FF6F5BA36F5BA26F90C9FCA26F5AA36F5AA26F5AA26F5A433A7EB848>86
D<B600F049B512E0A4C601FCC8380FF000017F705A6E4B5A6D6C4B5A6D7F4EC7FC6D6D14
7E6D7F606D6D495A6D7F4D5A6D6D495A6E7E4D5A6E6C495A6E13804DC8FC6EEBC07E6E13
E05F6EEBF1F86E13F9EEFBF06EEBFFE0815F6F5B816F90C9FCB3A2021FB6FCA443397EB8
48>89 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fg cmr10 10 39
/Fg 39 123 df<121C127FEAFF80A213C0A3127F121C1200A412011380A2120313005A12
06120E5A5A5A12600A19798817>44 D<B512FCA516057F941C>I<121C127FEAFF80A5EA
7F00121C0909798817>I<B712E016FC16FF0001903980007FC06C90C7EA1FE0707E707E
707EA2707EA283A75F16035F4C5A4C5A4C5A4C5AEEFF8091B500FCC7FCA291C7EA7F80EE
1FE0EE07F0707E707E83707EA21880177F18C0A7188017FFA24C13005F16034C5AEE1FF8
486DEB7FF0B812C094C7FC16F832397DB83B>66 D<B712C016F816FE000190398001FF80
6C90C7EA3FE0EE0FF0EE03F8707E707E177FA2EF3F8018C0171F18E0170F18F0A3EF07F8
A418FCAC18F8A4EF0FF0A218E0A2171F18C0EF3F80A2EF7F0017FE4C5A4C5AEE0FF0EE3F
E0486DEBFF80B8C7FC16F816C036397DB83F>68 D<B812FCA30001903880000F6C90C712
01EE007E173E171E170EA31706A317078316C0A394C7FCA31501A21503150F91B5FCA3EC
000F15031501A21500A21860A318E093C712C0A41701A3EF0380A21707A2170F173F177F
486D903807FF00B9FCA333397DB839>I<B812F8A30001903880001F6C90C71201EE00FC
177C173C171CA2170CA4170E1706A2ED0180A21700A41503A21507151F91B5FCA3EC001F
15071503A21501A692C8FCAD4813C0B612C0A32F397DB836>I<B648B512FEA300019026
80000313006C90C76C5AB3A491B6FCA391C71201B3A6486D497EB648B512FEA337397DB8
3E>72 D<B612C0A3C6EBC0006D5AB3B3AD497EB612C0A31A397EB81E>I<B5933807FFF8
6E5DA20001F0FC002600DFC0ED1BF8A2D9CFE01533A3D9C7F01563A3D9C3F815C3A2D9C1
FCEC0183A3D9C0FEEC0303A2027F1406A36E6C130CA36E6C1318A26E6C1330A36E6C1360
A26E6C13C0A3913901FC0180A3913900FE0300A2ED7F06A3ED3F8CA2ED1FD8A3ED0FF0A3
486C6D5A487ED80FFC6D48497EB500C00203B512F8A2ED018045397DB84C>77
D<B5913807FFFE8080C69238007FE06EEC1F80D9DFF0EC0F001706EBCFF8EBC7FCA2EBC3
FEEBC1FFA201C07F6E7EA26E7E6E7E81140F6E7E8114036E7E168080ED7FC016E0153FED
1FF0ED0FF8A2ED07FCED03FEA2ED01FF6F1386A2EE7FC6EE3FE6A2EE1FF6EE0FFEA21607
1603A216011600A2177E486C153E487ED80FFC151EB500C0140EA2170637397DB83E>I<
B712C016F816FE000190398001FF806C90C7EA3FC0EE0FE0EE07F0EE03F817FC17FE1601
A217FFA717FEA2EE03FCA2EE07F817F0EE0FE0EE3FC0923801FF0091B512FC16F091C9FC
B3A5487FB6FCA330397DB839>80 D<B612FEEDFFE016F8000190388007FE6C90C76C7EEE
3FC0707E707E707EA2707EA283A65FA24C5AA24C5A4C5AEE3F8004FFC8FCED07FC91B512
E05E9138000FF0ED03F8ED00FE82707E707EA2161F83A583A6F00180A217F8160F180348
6D01071400B66D6C5A04011306933800FE0ECAEA3FFCEF07F0393B7DB83D>82
D<D90FF813C090383FFE0190B512813903F807E33907E000F74848137F4848133F48C712
1F003E140F007E1407A2007C140312FC1501A36C1400A37E6D14006C7E7F13F86CB47E6C
13F8ECFF806C14E06C14F86C14FEC680013F1480010714C0EB007F020713E0EC007FED3F
F0151F150FED07F8A200C01403A21501A37EA216F07E15036C15E06C14076C15C06C140F
6DEB1F80D8FBF0EB3F00D8F0FE13FE39E03FFFF8010F13E0D8C00190C7FC253D7CBA2E>
I<003FB812E0A3D9C003EB001F273E0001FE130348EE01F00078160000701770A3006017
30A400E01738481718A4C71600B3B0913807FF80011FB612E0A335397DB83C>I<B500FC
91387FFF80A30003018091380FFC006C90C8EA07E0715A6C705A6E1403017F93C7FCA280
013F1506A26E140E011F150C80010F5DA28001075DA26E147001031560A26D6C5CA2806D
4A5AA2ED8003027F91C8FCA291383FC006A215E0021F5BA2EDF01C020F1318A26E6C5AA2
15FC02035BA2EDFEE002015BA26E6C5AA36FC9FCA3153EA2151CA3393B7EB83E>86
D<EB1FE0EBFFFC3803E03F3907000F80390F8007E0486C6C7E13E06E7EA26E7E6C5A6C5A
C8FCA4147FEB07FFEB3FE0EBFE00EA03F8EA0FF0EA1FC0123F485A90C7FC160C12FEA314
01A26C13036CEB077C903980063E18383FC01E3A0FE0781FF03A03FFF00FE03A007F8007
C026277DA52A>97 D<EA03F012FFA3120F1203B0EC1FE0EC7FF89038F1E03E9039F3801F
809039F7000FC001FEEB07E049EB03F049EB01F85BED00FCA216FEA2167E167FAA167E16
FEA216FC15016D14F8ED03F07F01EEEB07E001C6EB0FC09039C7801F00903881E07E9038
00FFF8C7EA1FC0283B7EB92E>I<EB03FC90381FFF8090387E03E03901F80070484813F8
3907E001FC380FC003A2EA1F80123F90380001F848EB00F01500A2127E12FEAA127E127F
A26C14067F001F140E6D130C000F141C6C6C13386C6C13706C6C13E039007C07C090381F
FF00EB07F81F277DA525>I<ED0FC0EC03FFA3EC003F150FB0EB03F8EB1FFF90387E078F
9038F801EF3903F0007F4848133F4848131FA24848130F123F90C7FC5AA2127E12FEAA12
7E127FA27EA26C6C131FA26C6C133F6C6C137F6C6CEBEFF03A01F801CFFF39007C078F90
381FFE0FD907F813C0283B7DB92E>I<EB07F8EB1FFF90387C0FC03901F803E03903F001
F0D807E013F8380FC0004848137CA248C7127E153E5A153F127E12FEA3B7FCA248C8FCA5
127EA2127FA26C14037F001F14076C6C13060007140E6D131CD801F013386C6C13709038
7E03E090381FFF80903803FC0020277EA525>I<147E903803FF8090380FC1E0EB1F8790
383F0FF0137EA213FCA23901F803C091C7FCADB512FCA3D801F8C7FCB3AB487E387FFFF8
A31C3B7FBA19>I<ED03F090390FF00FF890393FFC3C3C9039F81F707C3901F00FE03903
E007C03A07C003E010000FECF000A248486C7EA86C6C485AA200075C6C6C485A6D485A6D
48C7FC38073FFC38060FF0000EC9FCA4120FA213C06CB512C015F86C14FE6CECFF804815
C03A0F80007FE048C7EA0FF0003E140348140116F8481400A56C1401007C15F06CEC03E0
003F1407D80F80EB0F80D807E0EB3F003901FC01FC39007FFFF0010790C7FC26387EA52A
>I<EA03F012FFA3120F1203B0EC0FF0EC3FFCECF03F9039F1C01F809039F3800FC0EBF7
0013FE496D7EA25BA35BB3A3486C497EB500C1B51280A3293A7EB92E>I<EA0380EA0FE0
487EA56C5AEA0380C8FCAAEA03F012FFA312071203B3AA487EB512C0A312387EB717>I<
EA03F012FFA3120F1203B3B3AD487EB512C0A3123A7EB917>108
D<2703F00FF0EB1FE000FFD93FFCEB7FF8913AF03F01E07E903BF1C01F83803F3D0FF380
0FC7001F802603F70013CE01FE14DC49D907F8EB0FC0A2495CA3495CB3A3486C496CEB1F
E0B500C1B50083B5FCA340257EA445>I<3903F00FF000FFEB3FFCECF03F9039F1C01F80
3A0FF3800FC03803F70013FE496D7EA25BA35BB3A3486C497EB500C1B51280A329257EA4
2E>I<EB03FE90380FFF8090383E03E09038F800F84848137C48487F48487F4848EB0F80
001F15C090C712074815E0A2007EEC03F0A400FE15F8A9007E15F0A2007F14076C15E0A2
6C6CEB0FC0000F15806D131F6C6CEB3F006C6C137EC66C13F890387E03F090381FFFC0D9
03FEC7FC25277EA52A>I<3903F01FE000FFEB7FF89038F1E07E9039F3801F803A0FF700
0FC0D803FEEB07E049EB03F04914F849130116FC150016FEA3167FAA16FEA3ED01FCA26D
EB03F816F06D13076DEB0FE001F614C09039F7803F009038F1E07E9038F0FFF8EC1FC091
C8FCAB487EB512C0A328357EA42E>I<D903F813C090381FFE0190387E07819038FC01C3
3903F000E3000714774848133749133F001F141F485A150F48C7FCA312FEAA127FA37E6D
131F121F6D133F120F6C6C137F6C6C13EF3901F801CF39007E078F90381FFE0FEB07F890
C7FCABED1FE00203B5FCA328357DA42C>I<3807E01F00FFEB7FC09038E1E3E09038E387
F0380FE707EA03E613EE9038EC03E09038FC0080491300A45BB3A2487EB512F0A31C257E
A421>I<EBFF03000313E7380F80FF381E003F487F487F00707F12F0A2807EA27EB490C7
FCEA7FE013FF6C13E06C13F86C7F00037FC67F01071380EB007F141F00C0EB0FC01407A2
6C1303A37E15806C13077EEC0F00B4131E38F3C07C38E1FFF038C03F801A277DA521>I<
1318A51338A31378A313F8120112031207001FB5FCB6FCA2D801F8C7FCB215C0A93800FC
011580EB7C03017E13006D5AEB0FFEEB01F81A347FB220>I<D803F0EB07E000FFEB01FF
A3000FEB001F00031407B3A4150FA3151F12016D133F0000EC77F86D9038E7FF8090383F
03C790381FFF87903A03FC07E00029267EA42E>I<B538803FFEA33A0FF8000FF06C48EB
07E00003EC03C06D148000011500A26C6C1306A26D130E017E130CA26D5BA2EC8038011F
1330A26D6C5AA214E001075BA2903803F180A3D901FBC7FCA214FF6D5AA2147CA31438A2
27257EA32C>I<B53A1FFFE03FFEA3260FF8009038000FF86C48017EEB03E018C0000302
3EEB0180A26C6C013FEB0300A36C6CEC8006156FA2017E9038EFC00C15C7A2D93F016D5A
15830281EBF038D91F831430150102C3EBF87090260FC6001360A2D907E66D5A02EC137C
A2D903FCEB7F804A133FA2010192C7FC4A7FA20100141E4A130E0260130C37257EA33C>
I<B538803FFEA33A0FF8000FF06C48EB07C00003EC03806C7E16007F00001406A2017E5B
A2137F6D5BA26D6C5AA2ECC070010F1360A26D6C5AA214F101035BA2D901FBC7FCA214FF
6D5AA2147CA31438A21430A214701460A25CA2EA7C0100FE5B130391C8FC1306EAFC0EEA
701C6C5AEA1FF0EA0FC027357EA32C>121 D<003FB512FCA2EB8003D83E0013F8003CEB
07F00038EB0FE012300070EB1FC0EC3F800060137F150014FE495AA2C6485A495AA2495A
495A495AA290387F000613FEA2485A485A0007140E5B4848130C4848131CA24848133C48
C7127C48EB03FC90B5FCA21F247EA325>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fh cmr7 7 2
/Fh 2 51 df<13381378EA01F8121F12FE12E01200B3AB487EB512F8A215267BA521>49
D<13FF000313E0380E03F0381800F848137C48137E00787F12FC6CEB1F80A4127CC7FC15
005C143E147E147C5C495A495A5C495A010EC7FC5B5B903870018013E0EA018039030003
0012065A001FB5FC5A485BB5FCA219267DA521>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fi cmsy8 8 4
/Fi 4 50 df<B812C0A32A037A9137>0 D<130C131EA50060EB01800078130739FC0C0F
C0007FEB3F80393F8C7F003807CCF83801FFE038007F80011EC7FCEB7F803801FFE03807
CCF8383F8C7F397F0C3F8000FCEB0FC039781E078000601301000090C7FCA5130C1A1D7C
9E23>3 D<137813FE1201A3120313FCA3EA07F8A313F0A2EA0FE0A313C0121F1380A3EA
3F00A3123E127E127CA35AA35A0F227EA413>48 D<D93F80EC07F0D9FFF0EC3FFC000301
FC91B5FC4801FF903901F80780D80F80903A8007C001C03D1E003FC00F8000E0486D6C48
C71270003890260FF03E143048902607F83C14386E6C48141800606D6C5A00E06D6C4814
1C48027F150C5E153F6F7E6F7E82151F6C6F141C0060DA3DFE1418DB78FF143800704A6C
7E003001016D6C1370003849486C6C13F06C903B07C00FF001E06C903B0F8007FC07C028
07807E0003B512806CB44801001400C601F0EC3FFCD93F80EC07F03E1F7C9D47>I
E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fj cmr6 6 39
/Fj 39 121 df<EB03FCEB1FFEEB7C079038F003803801E0073803C00F14073907800300
91C7FCA6EC3FC0B6FCA238078003B1397FF83FFCA21E247EA323>12
D<EB03FC90381FFFC0EB7C07EBF00FEA01E03803C0071403EA0780A8B6FCA238078003B1
397FF83FFCA21E247EA323>I<13FF000313C0380781E0380F00F0001E137848133CA248
131EA400F8131FAD0078131EA2007C133E003C133CA26C13786C13F0380781E03803FFC0
C6130018227DA01E>48 D<13E01201120712FF12F91201B3A7487EB512C0A212217AA01E
>I<EA01FC3807FF80381C0FC0383003E0386001F0EB00F812F86C13FCA2147C12780030
13FCC7FC14F8A2EB01F0EB03E014C0EB0780EB0F00131E13385B5B3801C00CEA03803806
00185A5A383FFFF85AB512F0A216217CA01E>I<13FF000313C0380F03E0381C00F014F8
003E13FC147CA2001E13FC120CC712F8A2EB01F0EB03E0EB0FC03801FF00A2380003E0EB
00F01478147C143E143F1230127812FCA2143E48137E0060137C003813F8381E03F0380F
FFC00001130018227DA01E>I<127812FCA412781200A9127812FCA4127806157A9412>
58 D<127812FCA412781200A9127012F812FCA3127C120CA3121C1218A21230A2126012
40061F7A9412>I<B712FEA3CAFCA9B712FEA3270F7C932F>61 D<1438A2147CA314FEA2
497E149FA29038030F80A201067F1407010E7FEB0C03A2496C7EA201387FEB3000A24913
7C90387FFFFC90B57E9038C0003EA248487FA20003158090C7120F5A16C0D81F8014E0D8
FFE0EB7FFEA227247DA32D>65 D<B6FC15E03907C003F0EC00FC157E153E153FA5153E15
7E5DEC03F890B512E0A29038C003F8EC007E81ED1F80A2ED0FC0A51680151FED3F00157E
4A5AB612F015C022227CA12A>I<49B41320010FEBC06090393F80F0E09038FC0019D801
F0130D48481307484813034848130148C7FC481400123E127E1660127C12FC1600A7007C
1560127EA2123E003F15C07E6C6CEB01806C7E6C6CEB03006C6C1306D800FC131C90383F
807890380FFFE0010190C7FC23247CA22B>I<B67E15F0390FC001F80007EB007E151FED
0F80ED07C0ED03E0ED01F0A216F81500A216FCA816F8A2150116F0A2ED03E0ED07C0ED0F
80ED1F00153E000FEB01FCB612F0158026227CA12E>I<B612FEA2390FC0007E0007141F
818181A39138060180A392C7FC140E141EEBFFFEA2EBC01E140E1406A216C0A291C7FCED
0180A31503A21507150F000FEC7F00B7FCA222227CA129>I<EAFFFEA2EA0FE0EA07C0B3
AAEA0FE0EAFFFEA20F227CA116>73 D<3801FFFEA2380007E01303B3A4123012FCA31307
00F813C038700F8038381F00EA1FFCEA07F017237CA11F>I<D8FFC0EB7FF87FD807F0EB
0FC0ED07806DEB0300EA06FC137E7FA2EB1F80EB0FC0EB07E0130314F0EB01F8EB00FC14
7EA2143FEC1F83EC0FC3EC07E3A2EC03F3EC01FB6EB4FC81A28181000F80487ED8FFF07F
8125227CA12D>78 D<B6FC15E0390FC003F80007EB00FC153E153F811680A516005D153E
15FCEC03F890B512E092C7FC01C0C8FCAC487EEAFFFEA221227CA129>80
D<B512FCECFF80390FC007E00007EB01F8EC007C157E153E153FA4153E157E157C4A5AEC
07E090B5128092C7FC9038C00FC0EC03E06E7E811400A381A3160615FEA2486CEB7E0ED8
FFFEEB3F1CED1FF8C8EA03E027237CA12C>82 D<EBFF01000713C3380F01F7381C003F00
307F00707F00607F12E080A36C90C7FC1278127EEA3FC0EA1FFE380FFFE06C13F8C67FEB
07FEEB007FEC0F801407EC03C0A200C01301A46C14806C13036CEB07006C130E38EF803C
38C3FFF038807FC01A247CA222>I<007FB612F0A2397C00F8010070EC0070A200601530
00E01538A2481518A4C71400B3497E90387FFFF0A225227DA12B>I<EA01FCEA0FFF381E
0780486C7E383E01E0130080121CC7FC130113FF1207EA1FC0EA3F00127CA24814C0A313
01387C0370393E0E7980391FFC3F003807F01E1A187D961E>97 D<120FB4FCA2121F7EA9
EB07F0EB3FFCEB703F9038C00F8090388007C0EB000315E0140115F0A715E0140315C090
38800780390EC00F00EB703E380C3FFC380007E01C247DA222>I<137F3803FFE03807C0
F0380F0078001E13F85AA2007C13700078130012F8A7127C1418123C6C13306C13603807
C0E03803FF8038007E0015187D961B>I<140F14FFA2141F80A913FF000313CF3807C0FF
380F003F001E7F487F127C127812F8A71278127C123C003E5B6CEB3F80390FC1EFF03803
FF8F3900FE0F001C247DA222>I<13FC3803FF80380F83C0381F01E0383E00F0123C127C
14785AA2B512F8A200F8C7FCA4127C14187E001E1338001F1370380781E03803FF803800
7E0015187D961B>I<EB0F80EB7FC0EBF1E0EA01E3EA03C3EBC1C038078000A9EAFFFEA2
EA0780B1EA7FFCA213247EA313>I<3801F83F3907FEFF80381E07E3391C038300383801
C000787FA500385B6C485AEA1E07D83FFEC7FCEA31F80030C8FC1238A2383FFF806C13F0
6C7F487F3838007E48130E48130F80A36C5B0070130E003C133C001F13F83807FFE0C690
C7FC19227D951E>I<120FB4FCA2121F7EA9EB07F0EB1FFCEB703EEBC01E497EA21300AE
39FFF0FFF0A21C237DA222>I<120C123FA4120CC7FCA7120FB4FCA2121F7EB0EAFFE0A2
0B237DA212>I<3A0F07F007F03AFF1FFC1FFC9039703E703E3A1FC01EC01E6C486C487E
A201001300AE3BFFF0FFF0FFF0A22C167D9532>109 D<380F07F038FF1FFCEB703E381F
C01E6C487EA21300AE39FFF0FFF0A21C167D9522>I<137E3803FFC0380781E0380F00F0
001E137848133CA248131EA200F8131FA70078131E007C133E003C133C003E137C6C13F8
380F81F03803FFC0C6130018187D961E>I<380F07F038FF3FFCEB703F391FC00F80390F
8007C01300EC03E0A2EC01F0A7EC03E0A2EC07C0018013809038C01F00EB703EEB3FFCEB
07E090C8FCA7EAFFF0A21C207D9522>I<380E0F8038FE3FC0EB73E0EA1EC3120FEB81C0
EB800090C7FCADEAFFF8A213167D9518>114 D<3807F080EA1FFFEA380FEA700312E013
01A212F06CC7FCEA7FC0EA3FF8EA1FFEEA07FF38001F80EB07C0EAC003130112E0A200F0
1380130338FC0F00EACFFEEA83F812187D9618>I<487EA41203A21207A2120F123FB512
80A238078000AA14C0A63803C180EBE300EA01FEEA007C12207E9E18>I<000F130FB413
FFA2001F131F6C7FAD5CA26CEB3F809038C0EFF03803FF8F3900FE0F001C177D9522>I<
397FE07FE0A2390FC03F000007133C3803E0386C6C5A6C6C5AEB7DC0EB3F806DC7FC7F49
7EEB3BC0EB71E0EBE0F03801C0783803807C00077F001F133F39FFC07FF0A21C157E9420
>120 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fk lcircle10 10 4
/Fk 4 40 df[<EA7FFFB67E15FF6C15F8D80001ECFF8090C714F80301EBFF80DB000F13
F0040013FE94380FFFC0050013F8F01FFF060313C09538007FF8F10FFE963801FF809638
007FE0F20FF8F203FE973800FF80F33FE0F30FF8F303FEF300FFF43FC0F40FF0F403F8F4
01FEF4007FF51FC0777EF503F8777EF5007E787E787EF607E0F603F8787EF6007E8B797E
F70FE0797EF701F8797E207E8C7A7E7A7E7A7E7A7E7A7E7A7E217E8D7B7E210F7B7E8E7B
7E7B7E7B7E227C8E223F7C7E220F7C7E8F7C7E22017C7E8F237C8F233F8F7D7EA17E2307
7D7EA27D7EA27D7EA17EA1127CA17EA2A17EA2A16C7EA2A16C7EA2A16C7EA2A16C7EA2A1
1200A17FA2A1137CA2A1133CA1133EA2A17FA2A17FA180A2A11307A180A2A11303A180A2
A11301A180A2A11300A2A180A2A11478A2A1147CA2A1143CA3A1143EA2A1141EA3A1141F
A2A180A4A11580A2A11407A8A115C0A2A11403ADA1EC0180>170
170 294 131 332 36 D[<A1EC0180A1EC03C0ADA11407A2A11580A8A1140FA2A11500A4
A15CA2A1141EA3A1143EA2A1143CA3A1147CA2A11478A2A114F8A2A15CA2A11301A2A15C
A11303A2A15CA11307A2A15CA1130FA2A191C7FCA15BA2A1133EA2A1133CA1137CA2A15B
A2A15BA11201A2A1485AA2A1485AA2A1485AA2A148C8FCA2A1123EA2A15AA112FCA15A59
5AA2595AA2595A230FA15A59C9FC6B233E6B23FC6B585A2203585A6B585A221F58CAFC22
3E6A22FC575A575A575A6A575A211F57CBFC217E69565A565A565A565A565A56CCFC207E
68555AF707F0555AF71F8055CDFC1F7E545A545AF607E0F61FC0545A0C7ECEFC535A535A
F50FE0535A0B7FCFFCF401FEF403F8F40FF0F43FC00AFFD0FCF303FEF30FF8F33FE0F3FF
80E003FED1FCF20FF8F27FE0963801FF80DF0FFED2FCF17FF8953803FFC0061F90D3FCF0
FFF8050F13C0DDFFFED4FC040F13F04BB5128092B500F8D5FC49B61280007FB600F8D6FC
B7D7FC15806C90D7C7FC>170 170 294 297 332 I[<126012F0AD7EA21278A7127CA212
3CA5123EA2121EA3121FA27EA27FA21207A27FA21203A27FA212017FA212007FA2137813
7CA2133C133EA27FA27F80A26D7EA2130380A26D7EA26D7EA2147CA280A280A26E7E8114
076E7EA26E7EA26E7E81157C81153F816F7E8215076F7E826F7E1500167C167E8282707E
83707E707E707E1600177C177E83717E717E717E717E717E717E187E84727E727E727E72
7EF001FC727E193F737E737EF107F0737EF100FC1A7F747EF20FC0F207F0747EF200FE1B
7FF31FC0F30FF0F303F8F301FE9838007F80F41FE0F40FF8F403FE993800FF80F53FE0F5
0FF8F503FE9A3800FFC0F63FF0F60FFE9B3803FF809B38007FF0F71FFE9C3803FFE00D00
13FC9D381FFFC00E0313FE9D39003FFFF00F07EBFFC0E7007FEBFFF0100391B51280E800
1F15C0FB007FA1D8001F1380>170 170 128 297 332 I[<A190381FFF80A1007FB512C0
111FB6FC1003B71280107F02F0C7FC0F07B500C0C8FC0F3F01F0C9FC9D2603FFFECAFC0E
1F13C0E6FFFCCBFC0D0313E0E51FFECCFCF77FF09B3803FF80E40FFECDFCF63FF0F6FFC0
E303FECEFCF50FF8F53FE0F5FF80E203FECFFCF40FF8F41FE0F47F80E101FED0FCF303F8
F30FF0F31FC0097FD1FC1BFEF203F8505AF20FC0F23F8050D2FC1AFCF103F84F5AF10FC0
4F5A4FD3FC19FE4E5AF003F04E5A4E5A4E5A4ED4FC187E604D5A4D5A4D5A4D5A4D5A4DD5
FC177E177C5F16014C5A4C5A4C5A5F4CD6FC5E167E167C5E15014B5A5E4B5A150F5E4BD7
FC5D153E5D15FC5D4A5AA24A5AA24A5A140F5D4AD7C6FCA2143EA25CA25CA2495AA2495A
A25C1307A2495AA291D7C7FC5BA2133EA2133C137CA2137813F8A25B1201A25B1203A25B
A21207A25BA2120FA290D7C8FCA25AA2121EA3123EA2123CA5127CA21278A712F8A25AAD
1260>170 170 128 131 332 I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fl cmti12 12 54
/Fl 54 123 df<4CB414FC040F9039C003FF80933B3F81F00783C0933B7C00781F01E04C
9038F83F03923C01F001FC3E07F003030103EB7E0F922607E007EB7C1F19FCDB0FC001F8
14E0943A03F0F80FC0DD01E1EB0780031FD9000190C7FC5E180361153F93C7FCA2180761
5D157EA2180F6115FE91B912F0A3DA00FCC7D81F80C7FC1401A25D183F96C8FCA214035D
A260187E14075DA218FE60140F5DA2170160141F5DA2170360143F92C7FCA21707605C14
7EA2170F6014FE5CA24D5AA2495A95C9FC5F5C0103153E177E001CEBE038007F02FE137C
26FF07E114FC02C15C4C5AEB0F8100FE903901FC03E0D8F81F9038F007C03B701E00E00F
80D8783CD9F83ECAFCD81FF0EB3FF8D807C0EB0FE04C5A83C53C>11
D<EF7FF80407B5FC93391FC00FC093393E0001E004FCEB00F04B4813014B4813075E0307
140FA24B5A19E0031FEC03804C90C7FCA3153F93C9FCA45D157EA415FE91B8FCA260DA00
FCC7127E020115FE4B5CA317016014035D170360A214074B130760A3020F140F4B5CA317
1F021F5D5DA2053F13E01801023F16C092C7FCA2EF7F03057E13805C027E15071900173E
180E02FEEC1E1E4AEC1F1CEF07F8EF01E094C8FC495AA35C1303A2001C5B127FEAFF075C
A2495A00FE90CBFCEAF81FEA701EEA783CEA1FF0EA07C03C5A83C537>I<167016E0ED01
C0ED0380ED0700150E153C5D15F85D4A5A4A5A4A5A140F4AC7FC141E143E5C147814F849
5A5C1303495AA2495AA249C8FCA25B133E137E137CA25BA212015BA212035BA212075BA2
120FA25BA2121FA290C9FCA25AA2123EA3127EA2127CA65AAB1278A6127C123CA47EA212
0E120FA27E6C7EA26C7EA26C7E1360246472CA28>40 D<1560A2157081A281151E150E15
0FA2811680A3ED03C0A516E0A21501A71503A91507A216C0A4150FA21680A2151FA21600
A25DA2153EA2157EA2157C15FCA25D1401A25D14035DA214075D140F5DA24AC7FCA2143E
A25C147814F8495AA2495A5C1307495A91C8FC131E133E5B13785B485A485A485A48C9FC
121E5A5A12E05A23647FCA28>I<13F0EA03FC1207A2EA0FFEA4EA07FCEA03CCEA000C13
1C1318A2133813301370136013E0EA01C013801203EA0700120E5A5A5A5A5A0F1D7A891E
>44 D<007FB5FCB6FCA214FEA21805789723>I<120FEA3FC0127FA212FFA31380EA7F00
123C0A0A76891E>I<ED3F80913801FFE0913807C0F891381F007C023C7F4A131E4A131F
49487F01031580495A5C130F49C713C0A25B137EA213FE5B161F12014915801203A24914
3F1207A2170048485CA4484814FEA44848495AA448C7485AA35E1507127E5E00FE140F5E
A248141F5EA24BC7FC153E157E007C147C15FC5D4A5A003C495A003E5C4A5A6C011FC8FC
380F803E3807C0F83801FFE06C6CC9FC2A4475C132>48 D<16C01501A215031507ED0F80
151F153F157F913801FF005C140F147F903807FCFEEB0FF0EB0700EB00015DA314035DA3
14075DA3140F5DA3141F5DA3143F5DA3147F92C7FCA35C5CA313015CA313035CA313075C
A2130FA2131F133FB612FCA25D224276C132>I<ED3FC0913801FFF0913807C07C4AC67E
021CEB1F800278130F4AEB07C0494814E04A1303494814F0130749C7FCEB0E06D91E0714
F8EB1C03133C1338137813704A1307D9F00614F013E0140E020C130F0001011C14E0EBC0
180238131F4A14C06C6C48EB3F80D9E1C0137FD97F801400013EC712FE90C7485A4B5A4B
5A4B5AED1F804BC7FC15FC4A5AEC03E0EC0FC0023FC8FC147CEB01F0495AEB0780011FC9
FC133E49EC03805B49140748481500485A48485C90C8121E5A001E5D001C157CD83FFC5C
9038FFC0013A7C0FFC07F0D87803B55AEA700126F0007F5B486D90C7FCEC0FFEEC03F82D
4478C132>I<ED1FE0EDFFFC913803E03F91390F000F80023EEB07C00278EB03E05C4948
EB01F0495A495A91C713F85BEB0E0CEB1E0EEB1C061603013C15F01338A2020E1307020C
14E0141CD91C78EB0FC0D90FE0131F6D48148090C8EA3F00167E5E4B5A4B5AED0FE09138
3FFF804A48C7FC15F8EC007E151F6F7E6F7E82150382A482A34B5A121FEA7F80A2150F48
C75BA2484A5A12F800E04A5AA24BC7FC007014FE5D0078495A0038495A003CEB0FC06C49
5A260780FEC8FC3803FFF038007F802D4477C132>I<EE0380EE0FC0A2161F1780A3163F
1700A3167EA35EA34B5AA34B5AA25E1507A24B5AA24B5AA293C7FC5D153E157E157C15FC
5D4A5AA24A5A14075D4A5A16E091381F01F0EC3E03143C147CECF807D901F05B14E01303
903807C00FD90F805BEB1F00131E49131F495C5B485A3903FFC03F000F01F890C7FC4813
FF397E003FFF007801071480480101EBFFC000606D7EC8EBFE0003FEC7FC5DA314015DA3
14035DA314075DA4EC03802A557DC132>I<026014300278EB01F091397F801FE091B612
C01780170016FC4914F016C0DACFFEC7FC02C0C8FC13035CA3130791C9FCA35B130EA313
1E90381C07F8EC3FFE9138F80F8090393DC007C0D93F807F90383E0003013C80496D7E13
70A290C7FC82A41503A415075E120E123F486C130F00FF5DA390C7485A5A00F84A5A12E0
4B5A93C7FC15FE14016C5C0070495A0078495A6CEB1FC0003E495A261F80FEC8FC6CB45A
000313E0C66CC9FC2C4476C132>I<ED03FCED1FFF037F13C0913801FE07913903F001E0
91380FE00091381F800391383F000F027E131F5C495A495A010715C04948EB07004A90C7
FC131F495AA249C9FCA213FE1201A2485AEC07F09038F83FFC0007EB781F9039F9E00F80
3A0FFB8007C0EBF70001FE80491303001F815B5B82485AA3491307127F5BA2150F5E90C7
FCA2151F485DA25A4B5AA2007E5D157F93C7FC5D5D4A5A003E495A003F5C4A5A6C6C485A
000FEB3F80D9C0FEC8FC3803FFFC6C13F038007F802B4475C132>I<9026380FC0131C90
38787FE0902671FFF0133C01F3157801EF15F090B5FC4801E0EB01E09139007003C04848
EB380701F8EC1F804848EB1C3F4990381FFF004848EB07DF49EB001E48C85A121E5E4815
F800385D0078140100705D00F01403485D1507C8485AA24BC7FCA25D153E157E157C15FC
5D1401A24A5AA214075D140F5D141FA25D143FA24AC8FCA314FEA21301A25C1303A25C13
07A35C130FA35C5C6D5A2E4472C132>I<130FEB1FC0133FEB7FE013FFA214C0EB7F8014
00131E90C7FCB3A5120FEA3FC0127FA212FFA35B6CC7FC123C132B76AA1E>58
D<0007B912FE19FFA219FECDFCB0BA12C019E0A219C0401875A44B>61
D<EF03801707A24D7EA2171FA2173F177FA217FFA25EA2EE03BF1607173F160F160E161C
841638171F167016F016E0ED01C0A2ED0380A2ED0700A2150E151E151C5D845D170F5D14
015D14035D4AC7FC92B6FC5CA2021CC7120F143C14385CA24A81A249481407A2495A1307
91C8FC130E131EA25B137C13FC00014C7ED807FE151FB500E00107B512F8A219F03D477B
C648>65 D<91B712F818FF19C00201903980003FF06E90C7EA0FF84AED03FCF000FE4B15
7FA2F13F800203EE1FC05DF10FE0A214074B16F01907A2140F5D1AF8A2141F5DA2190F14
3F5D1AF0A2147F4B151FA302FF17E092C9123FA34918C04A167F1A80A2010317FF4A1700
A24E5A13074A4B5A611807010F5F4A4B5A181F61011F4C5A4A4BC7FC18FE4D5A013F4B5A
4A4A5A4D5A017FED3FC005FFC8FC4AEB03FE01FFEC1FF8B812E094C9FC16F845447AC34A
>68 D<91B912C0A30201902680000313806E90C8127F4A163F191F4B150FA30203EE0700
5DA314074B5D190EA2140F4B1307A25F021F020E90C7FC5DA2171E023F141C4B133C177C
17FC027FEB03F892B5FCA39139FF8003F0ED00011600A2495D5CA2160101034B13705C19
F061010791C8FC4A1501611803010F5F4A150796C7FC60131F4A151E183E183C013F167C
4A15FC4D5A017F1503EF0FF04A143F01FF913803FFE0B9FCA26042447AC342>I<91B912
80A30201902680000713006E90C8FC4A163FA24B81A30203160E5DA314074B151E191CA2
140F5D17075F021F020E90C7FC5DA2171E023F141C4B133CA2177C027F5CED800392B5FC
A291B65AED00071601A2496E5A5CA2160101035D5CA2160301075D4A90CAFCA3130F5CA3
131F5CA3133F5CA2137FA313FFB612E0A341447AC340>I<031FB512F05DA29239000FFC
005FA35FA2161FA25FA2163FA25FA2167FA25FA216FFA294C7FCA25DA25EA21503A25EA2
1507A25EA2150FA25EA2151FA25EA2153FA25EA2157FA25EEA0F80D83FE013FF93C8FC12
7FA24A5AEAFFC04A5A1300007C495A0070495A4A5A6C5C003C495A6C01FEC9FC380F81F8
3803FFE0C690CAFC344679C333>74 D<91B56C93387FFFC08298B5FC02014DEBC0006E61
4A5FA203DF4C6CC7FC1A0E63912603CFE05D038F5F1A381A711407030FEEE1FCA2F101C3
020FEE0383020E60F107036F6C1507021E160E021C60191CF1380F143C023804705BA2F1
E01F0278ED01C091267003F85EF003801A3F02F0ED070002E0030E5CA24E137F130102C0
4B91C8FC606201036D6C5B02805F4D5A943803800113070200DA07005BA2050E1303495D
010E606F6C5A1907011E5D011C4B5CA27048130F133C01384B5C017892C7FC191F01F85C
486C027E5DD807FE027C4A7EB500F00178013FB512C0A216705A447AC357>77
D<91B56C49B512E0A28202009239000FFC00F107F0706E5A4A5F15DF705D1907EC03CFDB
8FF892C7FCA203875D02077F0303150EA270141EEC0F01020E161C826F153C141E021C6E
1338167F1978023C800238013F1470A27113F00278131F02705E83040F130102F014F84A
5E1607EFFC0313014A01035C17FE1807010314014A02FF90C8FCA2705B0107168F91C813
8E177F18DE5B010EED3FDC18FCA2011E151F011C5EA2170F133C01386F5A1378A201F815
03486C5EEA07FEB500F01401A2604B447AC348>I<EE1FF84BB5FC923907F01FC092391F
8003F092397E0001F8DA01F86D7EDA03E0147EDA0FC0804A48EC1F804AC813C0027E150F
4A16E049481507494816F01307495A494816F8013F16035C137F49C9FC4917FC12011203
5B1207491607120FA25B121F19F849160F123FA34848EE1FF0A3183F19E0485A19C0187F
A2F0FF80A219005F604D5AA2007F4C5A4D5AA24D5A003F5F4D5A6D4BC7FC001F5E4C5A6C
6C5DEE03F06C6C4A5A0003ED1FC06C6C4A5A6C6C027EC8FC017EEB01F890393F8007F090
390FE03F80902603FFFEC9FC9038007FE03E4872C54B>I<91B712F018FEF0FF80020190
3980007FE06E90C7EA1FF04AED07F818034B15FCF001FE1403A24B15FFA21407A25DA214
0FF003FE5DA2021F16FC18074B15F8180F023F16F0F01FE04B15C0F03F80027FED7F0018
FE4BEB03FCEF0FF002FFEC7FC092B6C7FC17F892CAFC5BA25CA21303A25CA21307A25CA2
130FA25CA2131FA25CA2133FA25CA2137FA25C497EB67EA340447AC342>I<91B77E18F8
18FE020190398001FF806E90C7EA3FC04AED1FE0F00FF04BEC07F8180319FC14034B15FE
A314075DA3020FED07FC5DA2F00FF8141F4B15F0F01FE0F03FC0023F16804BEC7F0018FE
EF03F8027F4A5A4BEB1FC04CB4C7FC92B512F891B612E092380003F8EE00FE177F496F7E
4A6E7EA28413034A140FA2171F13075CA2173F130F5CA24D5A131F5CA3013F170E5CA201
7FEE801E191C4A163C496C1638B66C90383FC070051F13F094380FE1E0CA3803FF809438
00FE003F467AC347>82 D<48B912F85AA2913B0007FC001FF0D807F84A130701E0010F14
0349160148485C90C71500A2001E021F15E05E121C123C0038143F4C1301007818C01270
00F0147F485DA3C800FF91C7FC93C9FCA35C5DA314035DA314075DA3140F5DA3141F5DA3
143F5DA3147F5DA314FF92CAFCA35B5CA21303A21307497E007FB612C0A25E3D446FC346
>84 D<001FB500F090383FFFFCA326003FF0C7000113806D48913800FE00013F167C1878
5C187018F0017F5E5CA2170101FF5E91C8FCA21703485F5BA21707000394C7FC5BA25F00
07160E5BA2171E120F49151CA2173C121F491538A21778123F491570A217F0127F495DA2
160100FF5E90C8FCA216035F16074893C8FC5E160E161E5E007E1538007F15785E6C4A5A
6D495A001F4A5A6D49C9FC6C6C133E6C6C13F83903FC07F0C6B512C0013F90CAFCEB07F8
3E466DC348>I<B6913807FFFEA25C000301C0020013E06C90C9EA7F00183E183C60A26C
1770601701604D5AA24DC7FC5F170E6E5CA2017F5D177817705FA24C5AA24C5A16076E91
C8FC160E133F5E163C16385EA25E15015E6E485AA24BC9FC131F150E151E151C5DA25D15
F05DECF1C0A290380FF38014F792CAFC14FEA25CA25C5CA25C13075CA25C91CBFC3F466C
C348>I<023FB5D8C003B512E0A21780020001F8C7387FFC006F48EC3FE06F48158097C7
FC031F153E705C1978030F15E07013014E5A03074A5A7091C8FC180E03035C705B187803
015C70485A606FEB83800587C9FC178FEE7FDE17FC5F705A5F161F83A2160F4C7EA2163F
EE77FC16F7ED01E3923803C3FEED07831601030E7F151CED3C004B805D4B6D7E4A5A4A5A
4AC76C7E5C141E4A6E7E14384A140F4A81495A01031507494881130F133F017F4B7E2603
FFC04A7E007F01F849B512FEB5FC614B447CC348>88 D<007FB54AB51280B65CA2000101
E09139007FF0006C49ED3FC04A93C7FC6D6C153E601878013F5E6E4A5A604D5A6D6C4AC8
FC5F171E010F151C6E5C5F010715F06E495A5F4C5A6D6C49C9FC5E161E0101141C6E5B5E
16F06DEB81E05EED8380DA7F87CAFC15CF15DEEC3FDC15F85DA26E5A5D143FA35D147FA3
92CBFC5CA35C1301A35C1303A3495AA3497E000FB512F8A341446DC348>I<EC1F80EC7F
E0903901F07070903907C039F890380F801D90381F001F013E6D5A137E5B484813075E48
5A120749130F000F5DA2485A151F003F5D5BA2153F007F92C7FC90C7FCA25D157E12FEA2
9238FE0380EDFC071700A2007E13015E913803F80E1407003E010F131E161C6C131C0238
5B3A0F80F078783A07C3E07C703A01FF801FE03A007E000780292D76AB32>97
D<EB0FE0EA07FFA338001FC0130F131FA25CA3133F91C8FCA35B137EA313FE5BA312015B
EC1F80EC7FE03903F9E0F89038F3C07C9038F7003E13FE48487F5BA2491480485AA25BA2
121F5BA2153F123F90C7FCA2157F481500127EA25D5D5AA24A5AA24A5AA2007C5C4A5A14
0F5D4A5A003C49C7FC003E137E001E5B6C485A380783E03803FF80C648C8FC214676C42D
>I<EC0FE0EC7FF8903801F81E903807E00F90390F80078090381F0003017E14C049131F
0001143F5B4848EB7F801207485AED3E00484890C7FCA2485AA2127F90C9FCA35A5AA45A
A5ED0180ED03C0ED0780A2007CEC0F00007E141E003E147C15F06CEB03E0390F800F8026
07C07EC7FC3801FFF838007FC0222D75AB2D>I<EE07F0ED03FFA39238000FE01607160F
A217C0A2161FA21780A2163FA21700A25EA2167EA216FEA25EEC1F80EC7FE1903801F071
903907C039F890380F801D90381F001F013E130F017E5C5B48481307A248485C12074913
0F120F5E485A151F123F495CA2153F127F90C790C7FCA25DA200FE147EA29238FE038016
0703FC1300A2007E13015E913803F80E1407003E010F131E161C6C131C02385B3A0F80F0
78783A07C3E07C703A01FF801FE03A007E0007802C4676C432>I<EC0FE0EC7FF8903801
F83E903807C00F90391F800780EB3F00017E14C0491303485A48481307000715805B000F
140F484814005D4848133E15FCEC07F0007FEBFFC0D9FFFEC7FC14C090C9FC5A5AA55AA4
ED0180ED03C0007CEC0780A2007EEC0F00003E141E157C6C14F06CEB03E03907800F8026
03C07EC7FC3801FFF838003FC0222D75AB2D>I<EE0F80EE3FE0EEF870923801F0389238
03E0F8923807E1FC16C3ED0FC7A2EE87F892381F83F0EE81E0EE8000153F93C7FCA45D15
7EA415FE5DA349B512FEA390260001F8C7FCA314035DA414075DA4140F5DA4141F5DA414
3F92C8FCA55C147EA314FE5CA413015CA4495AA35C1307121C007F5B12FF495AA291C9FC
485AEAF81E485AEA7878EA1FF0EA07C02E5A83C51E>I<15FCEC03FF91390F8383809139
3E01CFC091387C00EF4A13FF4948137F010315804948133F495A131F4A1400133F91C75A
5B167E13FE16FE1201495CA215011203495CA21503A2495CA21507A25EA2150F151F5E00
01143F157F6C6C13FF913801DF8090387C039F90383E0F3FEB0FFCD903F090C7FC90C7FC
5DA2157EA215FEA25DA2001C495A127F48495A14074A5A485C023FC8FC00F8137E387C01
F8381FFFE0000390C9FC2A407BAB2D>I<14FE137FA3EB01FC13001301A25CA21303A25C
A21307A25CA2130FA25CA2131FA25C157F90393F83FFC091388F81F091381E00F802387F
4948137C5C4A137EA2495A91C7FCA25B484814FE5E5BA2000314015E5BA2000714035E5B
1507000F5DA249130F5E001F1678031F1370491480A2003F023F13F0EE00E090C7FC1601
48023E13C01603007E1680EE070000FEEC1E0FED1F1E48EC0FF80038EC03E02D467AC432
>I<143C147E14FE1301A3EB00FC14701400AE137C48B4FC3803C780380703C0000F13E0
120E121C13071238A21278EA700F14C0131F00F0138012E0EA003F1400A25B137EA213FE
5B12015BA212035B141E0007131C13E0A2000F133CEBC038A21478EB807014F014E0EB81
C0EA0783EBC7803803FE00EA00F8174378C11E>I<EB03F8EA01FFA3380007F013031307
A214E0A2130FA214C0A2131FA21480A2133FA21400A25BA2137EA213FEA25BA21201A25B
A21203A25BA21207A25BA2120FA25BA2121FA25BA2123FA290C7FCA2387F01C01303007E
1380A2130700FE130012FCA25B130EEA7C1E131CEA3C3CEA3E786C5AEA07C0154678C419
>108 D<D801F0D90FE0EB07F0D803FCD97FF8EB3FFC28071E01F03EEBF81F3E0E1F03C0
1F01E00F80271E0F8700D983807F001C018E90390F870007003C019C148E003801B802DC
8002F814FC26781FF05C0070495CA24A5C00F0494948130FD8E03F6091C75B1200043F14
1F4960017E92C7FCA24C143F01FE95C7FC49147E6104FE147E1201494A14FE610301EE07
80000305011400494A14F8A2030302035B0007F0F00E495C1A1E0307EDE01C000F193C49
4A153862030F020113F0001FF0F1E0494A903800FF800007C7D80380023EC7FC492D78AB
50>I<D801F0EB0FE0D803FCEB7FF83A071E01F03E3A0E0F03C01F001ED987001380001C
018E130F003C139C003801B814C014F838781FF000705BA25C00F049131FD8E03F158091
C7FC1200163F491500137EA25E01FE147E5B16FE5E12014913015E170F00030203130E49
14F0A20307131E0007EDE01C5B173CEEC038000F167849157017E0ED03C1001FEDE3C049
903801FF000007C8127C302D78AB37>I<EC0FE0EC7FFC903801F83E903907E00F809039
0F8007C0EB1F00017EEB03E04914F0A248481301484814F81207485AA2485AA2485A1503
127F90C7FCA215074815F05AA2150F16E05AED1FC0A21680153F16005D157E5D007C495A
007E495A003E5C4A5A6CEB1F80260F803EC7FC3807C0FC3801FFF038003F80252D75AB32
>I<D903E0137E903A07F801FF80903A0E3C0783E0903A1C1E0F01F0903A3C1F1C00F801
385B017849137C01705BA24A48137E01E05BA292C7FC00015B13C0147EC7FC02FE14FEA2
5CA20101140117FC5CA20103140317F85CA20107EC07F0A24AEB0FE0A2010F15C0EE1F80
163F1700496C137E5E4B5A9138B803F090393F9C07E091389E0F80DA07FEC7FCEC01F849
C9FCA2137EA213FEA25BA21201A25BA21203A21207B512F0A25C2F3F7FAB32>I<D801F0
EB3F803A03FC01FFF03A071E03C0F83A0E0F0F007C001E90389E01FC001C139CECB80300
3813F0A2D91FE013F80078EC00E00070491300A200F05BEAE03F91C8FC1200A25B137EA3
13FE5BA312015BA312035BA312075BA3120F5BA3121F5B0007C9FC262D78AB29>114
D<EC0FE0EC7FF8903801F01E903803C00F90390780078090380F0003011E14C015074913
1FA2017CEB3F801378137CED0E0092C7FC137E137F14F014FF6D13C06D13F06D7F6D7F13
00EC0FFE14011400157F81120E003F141E487EA2153E48C7123CA200FC5C12705D007849
5A6C495A6CEB0F80260F803EC7FC3803FFF838007FC0222D7AAB28>I<1470EB01F8A313
035CA313075CA3130F5CA3131F5CA2007FB512E0B6FC15C0D8003FC7FCA25B137EA313FE
5BA312015BA312035BA312075BA3120F5BA2EC0780001F140013805C140E003F131EEB00
1C143C14385C6C13F0495A6C485AEB8780D807FEC7FCEA01F81B3F78BD20>I<137C48B4
14072603C780EB1F80380703C0000F7F000E153F121C0107150012385E1278D8700F147E
5C011F14FE00F05B00E05DEA003FEC0001A2495C137E150313FE495CA215071201495CA2
030F13380003167849ECC070A3031F13F0EE80E0153F00011581037F13C06DEBEF830000
0101148090397C03C787903A3E0F07C70090391FFE01FE903903F000782D2D78AB34>I<
017CEE038048B4020EEB0FC02603C780013FEB1FE0380703C0000E7F5E001C037E130F01
071607123804FE130300785DEA700F4A1501011F130100F001804914C012E0EA003FDA00
0314034C14805B137E0307140701FE1700495CA2030F5C0001170E495CA260A24848495A
60A2601201033F5C7F4B6C485A000002F713036D9039E7E0078090267E01C349C7FC903A
1F0781F81E903A0FFF007FF8D901FCEB0FE03B2D78AB41>119 D<02F8133FD907FEEBFF
E0903A0F0F83C0F0903A1C07C780F890393803CF03017013EE01E0EBFC07120101C013F8
000316F00180EC01C000074AC7FC13001407485C120EC7FC140F5DA3141F5DA3143F92C8
FCA34AEB03C01780147EA202FEEB0700121E003F5D267F81FC130E6E5BD8FF83143CD903
BE5B26FE079E5B3A7C0F1F01E03A3C1E0F83C0271FF803FFC7FC3907E000FC2D2D7CAB2D
>I<137C48B414072603C780EB1F80380703C0000F7F000E153F001C1600130712385E00
78157EEA700F5C011F14FE00F0495B12E0EA003FEC00015E5B137E150301FE5C5BA21507
00015D5BA2150F00035D5BA2151F5EA2153F12014BC7FC6D5B00005BEB7C0390383E0F7E
EB1FFEEB03F090C712FE5DA214015D121F397F8003F0A24A5A4848485A5D48131F00F049
C8FC0070137E007813F8383801F0381E07C06CB4C9FCEA01FC294078AB2F>I<027C1307
49B4130F49EB800E010F141E49EBC03CEDE03890393F03F07890397C00FDF00178EB3FE0
0170EB03C001F0148049130790C7EA0F00151E5D5D5D4A5A4A5A4A5A4AC7FC141E5C5C5C
495A495A495A49C8FC011E14F04914E05B491301485A4848EB03C0D807B0130701FEEB0F
80390FCF801F3A1F07E07F00393E03FFFED83C015B486C5B00705C00F0EB7FC048011FC7
FC282D7BAB28>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fm cmsy10 12 6
/Fm 6 115 df<007FB912E0BA12F0A26C18E03C04789A4D>0 D<0060160600F8160F6C16
1F007E163F6C167E6C6C15FC6C6CEC01F86C6CEC03F06C6CEC07E06C6CEC0FC06C6CEC1F
80017EEC3F006D147E6D6C5B6D6C485A6D6C485A6D6C485A6D6C485A6D6C485ADA7E3FC7
FCEC3F7E6E5A6E5A6E5AA24A7E4A7EEC3F7EEC7E3F4A6C7E49486C7E49486C7E49486C7E
49486C7E49486C7E49C7127E017E8049EC1F804848EC0FC04848EC07E04848EC03F04848
EC01F84848EC00FC48C9127E007E163F48161F48160F00601606303072B04D>2
D<16C04B7EB3AC007FBA1280BB12C0A26C1980C8D801E0C9FCB3A9007FBA1280BB12C0A2
6C198042427BC14D>6 D<49B4FC010F13E0013F13F8497F48B6FC4815804815C04815E0
4815F0A24815F8A24815FCA3B712FEA96C15FCA36C15F8A26C15F0A26C15E06C15C06C15
806C15006C6C13FC6D5B010F13E0010190C7FC27277BAB32>15 D<126012F0B3B3B3B3B3
A81260046474CA1C>106 D<BCFCA36C19FEA26C19FCA26C19F801F8CB12786C6C18701A
F06C6C18E019016C6C18C019036C6D178019076C6D1700616D6C160E191E6D6C161C193C
6D6C163819786D6C167019F06D6C5E18016D6C5E18036D6D5D18076D6D92C7FC606E6C14
0E181E6E6C141C183C6E6C143818786E6C147018F06E6C5C17016E6C5C17036E01805B17
076E01C090C8FC5F92387FE00EA26F6C5AA26F6C5AA26F6C5AA26F6C5AA26F6C5AA26F5B
A26F90C9FCA2167EA2163CA248477BC353>114 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fn cmmi12 12 29
/Fn 29 123 df<157E913801FF80913807C3E091381F01F0EC3E004A13F814FC4948137C
495A5C0107147E495A131F5C133F49C7127FA213FEA212015B12034914FF1207A25B000F
15FE1501A2485AA21503003F15FC5B90B6FCA24815F89038800007A2150F00FF15F090C7
FCA2ED1FE0A25AED3FC0A21680157F16005A15FEA24A5AA25D14035D4A5A007C495AA24A
5A007E49C7FC003E133E5C001E5B6C485A380783C06CB4C8FCEA00FC28477CC52D>18
D<EB07C014F8EB00FE147F6E7E6E7EA36E7EA36E7EA36E7EA36E7EA36E7EA3157FA36F7E
A36F7EA36F7EA36F7EA34B7E151F153BED71FC15F1EC01E1913803C0FEEC0780EC0F0002
1E137F143E5C4AEB3F80495A495A4948EB1FC0130F495A49C7120F017E15E05B48481407
000316F0485A48481403484815F8485A48C8EA01FC5A4816FE4815000078167E2F467BC4
39>21 D<ED07F0ED1FFEED7C1F913901F00FC0913907C007E091380F8003DA1F0013F002
3EEB01F8147E5C4A14FC1301495AA2495AA2495A1603131F5CA21607013F15F891C7FCA2
49140F17F0137E17E001FE141F17C049143F17800001157F170016FE5E486C495A4B5A01
F7495A9039F3800FC02707F1C01FC7FC9038F0E07E9038E07FF8EC1FC0000F90C9FCA25B
A2121FA25BA2123FA290CAFCA25AA2127EA212FEA25A12382E417DAB32>26
D<010FB612FC013F15FE5B48B712FC4816F82707E001C0C7FC01805B380F0003121E121C
5A4849C8FC126012E000405BC7FC140E141EA45CA3147CA2147814F8A4495AA31303A25C
1307A3130FA25C6D5A2F2C7EAA2A>28 D<161CA21618A21638A21630A21670A21660A216
E0A25EA21501A25EA21503A293C8FCA25DED7FE0913807FFFE91391FC63F809139FE0E07
C0D901F8EB03F0903A07E00C00F8D91FC08090263F001C137E017E814913184848ED1F80
00031438485A4848013014C0A248481370A248481360A248C712E0A24B133F4817804813
01A24B137F180014034816FE92C7FC4C5A6C49495AA2007E0106495A4C5A6C010E495A4C
5A261F800C49C7FC000F15FC3A07C01C01F8D803E0EB07E03A01F8181F80D8007E01FEC8
FC90381FFFF801011380D90030C9FCA21470A21460A214E0A25CA21301A25CA21303A291
CAFCA332597BC43A>30 D<121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A0A78891B>58
D<121EEA7F8012FF13C0A213E0A3127FEA1E601200A413E013C0A312011380120313005A
1206120E5A5A5A12600B1D78891B>I<1618163C167CA2167816F8A216F01501A216E015
03A216C01507A21680150FA2ED1F00A2151E153EA2153C157CA2157815F8A25D1401A24A
5AA25D1407A25D140FA292C7FC5CA2141E143EA2143C147CA25CA25C1301A25C1303A25C
1307A25C130FA291C8FC5BA2133EA2133C137CA2137813F8A25B1201A25B1203A2485AA2
5B120FA290C9FC5AA2121E123EA2123C127CA2127812F8A25A126026647BCA31>61
D<127012FCB4FCEA7FC0EA1FF0EA07FCEA01FF38007FC0EB1FF0EB07FE903801FF809038
007FE0EC1FF8EC03FE913800FF80ED3FE0ED0FF8ED03FF030013C0EE3FF0EE0FFCEE01FF
9338007FC0EF1FF0EF07FCEF01FF9438007FC0F01FE0A2F07FC0943801FF00EF07FCEF1F
F0EF7FC04C48C7FCEE0FFCEE3FF0EEFFC0030390C8FCED0FF8ED3FE0EDFF80DA03FEC9FC
EC1FF8EC7FE0903801FF80D907FECAFCEB1FF0EB7FC04848CBFCEA07FCEA1FF0EA7FC048
CCFC12FC12703B3878B44C>I<ED7FC0913803FFF8020F13FE91393F807F80913978000F
C04A6D7ED901C06D7E49486D7E49C87E1306D90FC0147E8083131F1880171F5C0107C8FC
90C913C0A84AB4FC020FEBC03F91387F00F0D901F813384948131CD90FC0130C4948EB0E
7F49C700061380017E1407491403000116FF48481600485A120F4980001F5E1603485A5F
127F5B5F160712FF90C85B160F5F161F485EA24C5AA24CC7FC167E16FE4B5A007E5D007F
4A5A6C4A5A6D495A001F4A5A6C6C017FC8FC6C6C13FC3903F807F8C6B512E06D1380D90F
FCC9FC32497CC633>64 D<027FB512F8A217F09139007FF000ED3FC0157FA25EA315FF93
C7FCA35C5DA314035DA314075DA3140F5DA3141F5DA3143F5DA3147F5DA314FF92C8FCA3
5B5CA313035CA313075CA3130F5CA2131FA25CEB7FF0007FB512F0B6FCA22D447DC32B>
73 D<91B712F018FF19E002009039C0003FF86F48EB07FC03FFEC01FEF0007F93C8EA3F
801AC0F11FE05C5D1AF0A214035DA30207EE3FE05DA2F17FC0020F17804B15FF1A004E5A
021F4B5A4B4A5AF00FE04E5A023F037FC7FC4BEB03FCEF1FF092B612804A4AC8FC923980
007F80EF0FC0EF07F002FF6E7E92C77F1701845B4A1400A2170113035CA2170313075CA2
4D5A130F5CA3011F18185CA2013F4C13381A304A6F1370D9FFE0020314E0B600E0ED01C0
0501EB0380943900FE0F00CBEA3FFEF007F045467CC34A>82 D<9339FF8001800307EBF0
03033F13FC9239FF007E07DA01F8EB0F0FDA07E09038079F004A486DB4FC4AC77E023E80
4A5D187E5C495A183C495AA213074A1538A3130F183080A295C7FC806D7E8014FF6D13E0
15FC6DEBFFC06D14FC6E13FF6E14C0020F80020314F8EC003F03077F9238007FFE160F16
03707E8283A283A21206A4000E163EA2120C177E001E167CA25F5F003F15014C5A6D4A5A
4C5A486C4AC8FC6D143ED87CF85CD8787E495A3AF01FC00FE0D8E007B51280010149C9FC
39C0003FF039487BC53C>I<48BA12C05AA291C7D980001380D807F092C7121F4949150F
0180170748C75B1903120E48020316005E12181238003014074C5C00701806126000E014
0F485DA3C8001F92C7FC5EA3153F5EA3157F5EA315FF93CAFCA35C5DA314035DA314075D
A3140F5DA3141F5DA3143F5DA2147FA214FF01037F001FB612FCA25E42447EC339>I<EC
0FC0EC7FF0903901F8381C903907E01C7E90380FC00E90393F0007FE496D5A13FE485A49
130100035D485A120F491303001F5DA2485A1507007F5D5BA2150F00FF5D90C7FCA2151F
5E5AA2033F1330EE00701760A24B13E017C015FE007E130102031301003ED9073E138000
3F010E13036C011C14006C6C486C5A3A07C0F00F0E3A01FFC007FC3A007F0001F02C2D7C
AB33>97 D<EB0FE0EA07FFA338001FC0130F131FA25CA3133F91C8FCA35B137EA313FE5B
A312015BEC0FC0EC3FF00003EBF07C9038F3C03E9038F7001F01FE14804848130F4914C0
5B16E0485A5BA3121F5BA2151F123F90C7FCA2153F4815C0127EA2157F16805A16005DA2
4A5A007C5CA24A5A4A5A5D003C130F003E495A001E495A001F017EC7FC6C5B3807C1F038
01FFC06C6CC8FC23467CC429>I<EC07F8EC3FFF9138FC07C0903903F000E049481370D9
1F80133049C71270017EEB03F801FE1307485A4848EB0FF012075B000FEC07C0484890C7
FCA2485AA2127F5BA312FF90C9FCA45AA5161816381670007E15E0ED01C06CEC0380ED07
006C6C131E000F14383907C001F03903F00FC02600FFFEC7FCEB1FF0252D7CAB2A>I<EE
01FC16FFA3EE03F816011603A217F0A21607A217E0A2160FA217C0A2161FA21780A2163F
A21700EC0FC091387FF07F903801F838903907E01C7E90380FC00E90393F0007FE491303
01FE5C485A491301120348485C120F491303121F5E485A1507127F495CA2150F12FF90C7
5BA2151FA2485DA2033F13301770EE0060A24B13E017C015FE007E130102031301003ED9
073E1380003F010E13036C011C14006C6C486C5A3A07C0F00F0E3A01FFC007FC3A007F00
01F02E467CC433>I<EC07F8EC3FFE903901FC0780903903F003C090390FC001E090381F
8000017FC7FC01FE1470485A484814F0000715E05B000F1401484814C015034848EB0780
ED1F0015FC007FEB1FF090B5128002F0C7FC0180C8FC12FF90C9FCA55AA41618007E1538
1670007F15E06CEC01C0ED03806CEC07006C6C131E6D13383907E001F03901F00FC02600
7FFEC7FCEB1FF0252D7CAB2D>I<157E913803FF8091390FC1E0E091391F0073F0027E13
334A133F4948131F010315E04948130F495AA2494814C0133F4A131F137F91C713805B16
3F5A491500A25E120349147EA216FEA2495CA21501A25EA21503150700015D150F000014
1F6D133F017CEB77E090383E01E790381F078F903807FE0FD901F85B90C7FC151FA25EA2
153FA293C7FCA2001C147E007F14FE485C4A5A140348495AEC0FC000F8495A007C01FEC8
FC381FFFF8000313C02C407EAB2F>103 D<163C16FEA21501A316FCED00701600AE15FC
EC03FF91380F0780021C13C091383803E0147014E014C01301EC8007130314005B010613
0F130E010C14C090C7FC151FA21680A2153FA21600A25DA2157EA215FEA25DA21401A25D
A21403A25DA21407A25DA2140FA25DA2141F5DA2143F001C91C7FC127F48137E5CA24848
5AEB03E038F807C038781F80D83FFEC8FCEA07F0275681C128>106
D<14FE137FA3EB01FC13001301A25CA21303A25CA21307A25CA2130FA25CA2131FA25C16
3F013FECFFC0923803C0E09138000703ED1E0F491338ED701F017E13E0EC01C001FE0180
13C00203EB07004948C8FC140E00015B5C495A5C3803FBC001FFC9FC8014F83807F1FE90
38F03F809038E00FE06E7E000F130381EBC001A2001FED01C017801380A2003F15031700
010013F05E481506160E007E150C161C00FE01005BED787048EC3FE00038EC0F802B467B
C433>I<D903E0EB3F80D90FF8EBFFE0903A1C7C03C0F8903A383E07007C9026703F1E13
7E9026601F387F5D01E00160EB1F8001C013E04A5A00014A14C0018090C7FCA200035B13
00147EC7FC02FE143FA25CA20101157F18805CA2010315FF18005C5F010714015F4A1303
5F010F14075F4C5A5F496C495A4CC7FC02B8137E02985B90393F9C01F891388F07E09138
03FF80DA00FCC8FC4990C9FCA2137EA213FEA25BA21201A25BA21203A21207B512F0A25C
323F83AB31>112 D<141C147EA314FE5CA313015CA313035CA313075CA2007FB512FCB6
FC15F839000FC000A2131F5CA3133F91C7FCA35B137EA313FE5BA312015BA312035BA215
70000714605B15E015C0000F130101C013801403EC070000071306140E5C6C6C5A000113
F03800FFC0013FC7FC1E3F7EBD23>116 D<133ED9FF8014E02603C3C0EB03F0380703E0
380601F0000E1507121CD818035D12380030150FA2D870075D00605B161FEAE00F00C049
5CEA001F4A133FA2013F92C7FC91C7FC5E5B017E147EA216FE13FE495CA20301EB018017
03484802F81300A25F0303130616F000001407030F130E6D010D130C017C011D131C0339
13186D9038F0F838903A1F03C07870903A07FF803FE0903A01FC000F80312D7DAB38>I<
013E1738D9FF80D901C013FC2603C3C0903907E001FE380703E0380601F0000E150F001C
16C0D8180316000038187E0030031F143E00705ED86007171E5C163FD8E00F92C7121C00
C049160CEA001F4A49141C047E1418133F91C7FC04FE1438491730017E5CA20301157001
FE1760495C19E019C0A24949481301198018031900606D0107140670130E017C010F5C01
7E010C1418013ED91CFC13386DD9387E13F0903B0FC0F01F01C0903B03FFC00FFF809028
007F0001FEC7FC3F2D7DAB46>119 D<02FCEB07E0903A03FF801FFC903A0F07C0781E90
3A1C03E0E01F903A3801F1C07FD9700013804901FB13FF4848EBFF00495B000316FE90C7
1438484A130012061401000E5C120CC7FC14035DA314075DA3140F5DA3021F143817305D
1770023F1460121E003F16E0267F807FEB01C0026F148000FF01EF1303D901CFEB070000
FE903887C00E267C03835B3A3C0F01E0783A1FFC00FFE0D803F0EB3F80302D7EAB37>I<
133ED9FF8014E02603C3C0EB03F0380703E0380601F0000E1507001C16E0EA1803123800
30150F007016C0EA60075C161FD8E00F158000C05BEA001F4A133F1700133F91C7FC5E49
147E137EA216FE01FE5C5BA215015E485AA215035EA200001407150F6D5C017C131F153F
6D13FF90391F03CFC0903807FF8F903801FC0F90C7121F5EA2153F93C7FCD807C05BD81F
E0137E5DA24848485A4A5A01805B39380007C00018495A001C49C8FC6C137C380781F838
03FFE0C66CC9FC2C407DAB30>I<027CEB018049B413034901801300010F6D5A49EBE00E
6F5A90393F03F838903978007EF80170EB1FF00160EB01E001E05C49495A90C748C7FC15
0E5D5D5D5D4A5A4A5A4AC8FC140E5C5C5C5CEB03C049C9FC130E49141C4914185B491438
48481430491470D8039014F048B4495A3A0FEFC007C0391E03F01FD81C01B55A486C91C7
FC485C00606D5A00E0EB3FF048EB0FC0292D7CAB2D>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fo line10 10 7
/Fo 7 83 df<1C0C1C1E1C3E1C7E1CFCF301F8F303F0F307E0F30FC0F31F80F33F001B7E
63505A505A505A505A505A50C7FC1A7E624F5A4F5A4F5A4F5A4F5A4FC8FC197E614E5A4E
5A4E5A4E5A4E5A4EC9FC187E604D5A4D5A4D5A4D5A4D5A4DCAFC177E5F4C5A4C5A4C5A4C
5A4C5A4CCBFC167E5E4B5A4B5A4B5A4B5A4B5A4BCCFC157E5D4A5A4A5A4A5A4A5A4A5A4A
CDFC147E5C495A495A495A495A495A49CEFC137E5B485A485A485A485A485A48CFFC127E
5A5A1260575782D453>0 D<1506151E157EEC01FE1407143F14FF1307133F48B5FC120F
B6FCA2120F1201EA003F13071300143F14071401EC007E151E15061F187E8B53>27
D<12C012F012FCB4FC13C013F813FEEBFFC014F814FF15E015FEA215E0150014F814C049
C7FC13F813C090C8FC12FC12F012C01F184E8B53>45 D<1318A4133CA3137EA313FFA348
1380A34813C0A24813E0A34813F0A24813F8A24813FCA24813FEA2B6FCA2181F8CD053>
54 D<B6FCA26C13FEA26C13FCA26C13F8A26C13F0A26C13E0A36C13C0A26C1380A36C13
00A3137EA3133CA31318A4181F8CA053>63 D<126012F87E127E7E6C7E6C7E6C7E6C7E6C
7E6C7E137E7F6D7E6D7E6D7E6D7E6D7E6D7E147E806E7E6E7E6E7E6E7E6E7E6E7E157E81
6F7E6F7E6F7E6F7E6F7E6F7E167E82707E707E707E707E707E707E177E83717E717E717E
717E717E717E187E84727E727E727E727E727E727E197E85737E737E737E737E737E737E
1A7E86747E747E747E747E747E747E1B7E87F31F80F30FC0F307E0F303F0F301F8F300FC
1C7E1C3E1C1E1C0C575782D453>I<144014C01301497E1307130F497E133F137F497E5A
487F5A5A487F5A487FB6FC001F14801203C66C13C0131F010313E01300EC3FF0140FEC03
F81400153C150C1502150120204D9F53>82 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fp cmbx12 14.4 62
/Fp 62 122 df<EEFFFC031FEBFF804AB612E0020781021F9038C00FF8913A7FFE0003FC
DAFFF0EB00FE4949EB03FF4901805B4990C7487F49485CA2495A4D7F013F6F5B5CA37190
C7FC715AEF01F894C9FCA90403B512C0BAFCA526003FFCC7120783B3B3A6003FB5D8FC03
B612C0A542547DD34B>12 D<EA07F0EA1FF8487E487E7FB5FC1480A314C0A37EA27E7EEA
07F3EA0003A213071480A3130F1400A25B131E133E133C137C5BA2485A485A485A485A48
C7FC121E120C1228769025>44 D<B712F0AB240B7F9F2D>I<EA07F0487E487E487E487E
B51280A76C13006C5A6C5A6C5A6C5A1111769025>I<913803FFC0023F13FC91B6FC0103
15C0010F018113F0903A1FFC003FF849486D7E49486D7E49486D7E48496D138048496D13
C0A24817E04890C813F0A34817F8A24817FC49157FA3007F17FEA600FF17FFB3A5007F17
FEA6003F17FCA26D15FFA26C17F8A36C17F0A26C6D4913E0A26C6D4913C06C17806E5B6C
6D4913006D6C495AD91FFCEB3FF8903A0FFF81FFF06D90B55A01011580D9003F01FCC7FC
020313C0384F7BCD43>48 D<157815FC14031407141F14FF130F0007B5FCB6FCA2147F13
F0EAF800C7FCB3B3B3A6007FB712FEA52F4E76CD43>I<EC3FFE0103B512E0010F14FC01
3F14FF90B712C048D9C07F7F2703FE000F13F8D807F801037FD80FE06D7F48486D7F4848
8001F01680486C6E13C07F486C6E13E07FA27013F0A56C5AA26C5AEA0FF0EA03C0C914E0
5EA218C05E1880A24C13005F4C5A4B5B5F4B5B5F4B5B4B90C7FC4B5A5E4B5AED7FE04B5A
4A5B4A48C8FC4A5A5D4A48EB01F04A5AEC3F804AC7FC02FEEC03E0495A495A495A495AD9
1F80140749C8FC013E150F017FB7FC90B812C05A5A5A5A5A5A5AB9FC1880A4344E79CD43
>I<91380FFFC091B512FC0107ECFF80011F15E090263FF8077F9026FF800113FC4848C7
6C7ED803F86E7E491680D807FC8048B416C080486D15E0A4805CA36C17C06C5B6C90C75A
D801FC1680C9FC4C13005FA24C5A4B5B4B5B4B13C04B5BDBFFFEC7FC91B512F816E016FC
EEFF80DA000713E0030113F89238007FFE707E7013807013C018E07013F0A218F8A27013
FCA218FEA2EA03E0EA0FF8487E487E487EB57EA318FCA25E18F891C7FC6C17F0495C6C48
16E001F04A13C06C484A1380D80FF84A13006CB44A5A6CD9F0075BC690B612F06D5D011F
1580010302FCC7FCD9001F1380374F7ACD43>I<177C17FEA2160116031607160FA2161F
163F167FA216FF5D5DA25D5DED1FBFED3F3F153E157C15FCEC01F815F0EC03E01407EC0F
C01580EC1F005C147E147C5C1301495A495A5C495A131F49C7FC133E5B13FC485A5B485A
1207485A485A90C8FC123E127E5ABA12C0A5C96C48C7FCAF020FB712C0A53A4F7CCE43>
I<D80380150ED807E0157E01FEEC03FED9FFF0137F91B65A5F5F5F5F5F94C7FC5E5E16F0
16C093C8FC15F801E190C9FC01E0CAFCABEC0FFF027F13F001E3B512FE01E76E7E9026FF
F8077FDAC0017F49C713F8496E7E49143F4981496E7E6C481680C9FC18C08218E0A418F0
A3EA0FE0487E487E487E487EA418E0A35B6C484A13C05B491680003EC85A003F17006C6C
4A5A6D5D6C6C4A5AD807F8495BD803FE01075B2701FFC03F5B6C90B65A013F4AC7FC6D14
F8010314C09026007FF8C8FC344F79CD43>I<ED0FFF92B512E0020780021F14FC91397F
FE03FE903A01FFF0007F4901C0EB3F804990C7121F4948EC7FC0494814FF49484913E049
485B01FF5C485BA2485B5AA2486F13C04A6D1380486F1300177E94C7FC5AA291CAFC5AA2
1508913801FFF8020713FFB54814C04A14F04AC66C7E023C6D7E4A6D7E4A6D7E7013804A
15C0A24A15E07013F05C18F8A491C714FCA37EA67EA46C17F880A27E18F06C5D18E06C6D
15C07E6E4913806C6D15006D6C495A6D6CEB7FFC6DB448485A6D90B55A010315C0010092
C7FC023F13FC020713C0364F7ACD43>I<121F7F7FEBFF8091B81280A45A1900606060A2
606060485F0180C86CC7FC007EC95A4C5A007C4B5A5F4C5A160F4C5A484B5A4C5A94C8FC
16FEC812014B5A5E4B5A150F4B5AA24B5AA24B5A15FFA24A90C9FCA25C5D1407A2140FA2
5D141FA2143FA4147F5DA314FFA55BAC6D5BA2EC3FC06E5A395279D043>I<913807FFC0
027F13FC0103B67E010F15E090261FFC0113F8903A3FE0003FFCD97F80EB0FFE49C76C7E
48488048486E1380000717C04980120F18E0177FA2121F7FA27F7F6E14FF02E015C014F8
02FE4913806C7FDBC00313009238F007FE6C02F85B9238FE1FF86C9138FFBFF06CEDFFE0
17806C4BC7FC6D806D81010F15E06D81010115FC010781011F81491680EBFFE748018115
C048D9007F14E04848011F14F048487F48481303030014F8484880161F4848020713FC16
01824848157F173FA2171FA2170FA218F8A27F007F17F06D151FA26C6CED3FE0001F17C0
6D157F6C6CEDFF806C6C6C010313006C01E0EB0FFE6C01FCEBFFFC6C6CB612F06D5D010F
1580010102FCC7FCD9000F13C0364F7ACD43>I<91380FFF8091B512F8010314FE010F6E
7E4901037F90267FF8007F4948EB3FF048496D7E484980486F7E484980824817805A91C7
14C05A7013E0A218F0B5FCA318F8A618FCA46C5DA37EA25E6C7F6C5DA26C5D6C7F6C6D13
7B6C6D13F390387FF803011FB512E36D14C30103028313F89039007FFE03EC00401500A2
18F05EA3D801F816E0487E486C16C0487E486D491380A218005E5F4C5A91C7FC6C484A5A
494A5A49495B6C48495BD803FC010F5B9027FF807FFEC7FC6C90B55A6C6C14F06D14C001
0F49C8FC010013F0364F7ACD43>I<171F4D7E4D7EA24D7EA34C7FA24C7FA34C7FA34C7F
A24C7FA34C8083047F80167E8304FE804C7E03018116F8830303814C7E03078116E08303
0F814C7E031F81168083033F8293C77E4B82157E8403FE824B800201835D840203834B80
0207835D844AB87EA24A83A3DA3F80C88092C97E4A84A2027E8202FE844A82010185A24A
820103854A82010785A24A82010F855C011F717FEBFFFCB600F8020FB712E0A55B547BD3
66>65 D<BA12C019FEF1FFC01AF01AFCD8000701F0C7000313FFDE007F7F737F070F7F73
7F878587858785A287A84F5BA263616361634F5B4F5B077F90C7FC4E485A060713F892B8
12E097C8FC861AF003F0C7000313FE9539003FFF80070F13E0737F07017F87737F747E1C
807413C0A27413E0A31CF0A386A362A31CE0A2621CC0A250138097B5FC1C004F5B19074F
5B073F13F04EB55ABC128098C7FC1AF81AC007F8C8FC54527CD160>I<932601FFFCEC01
C0047FD9FFC013030307B600F81307033F03FE131F92B8EA803F0203DAE003EBC07F020F
01FCC7383FF0FF023F01E0EC0FF94A01800203B5FC494848C9FC4901F882494982494982
4949824949824990CA7E494883A2484983485B1B7F485B481A3FA24849181FA3485B1B0F
A25AA298C7FC5CA2B5FCAE7EA280A2F307C07EA36C7FA21B0F6C6D1980A26C1A1F6C7F1C
006C6D606C6D187EA26D6C606D6D4C5A6D6D16036D6D4C5A6D6D4C5A6D01FC4C5A6D6DEE
7F806D6C6C6C4BC7FC6E01E0EC07FE020F01FEEC1FF80203903AFFE001FFF0020091B612
C0033F93C8FC030715FCDB007F14E0040101FCC9FC525479D261>I<BA7E19FCF1FF801A
F01AFCD8000701F0C7000F13FF060014C0071F7F070713F807017F737F747E747F747F86
747F747F8886888688A2757EA31D8087A21DC0A51DE0A387A963A31DC0A51D80A2631D00
A3515AA2646264505B6264505B505B5090C7FCF2FFFE4F5B07075B071F5B96B512C0060F
91C8FCBB5A1AF01AC007FCC9FC19805B527CD167>I<BC1280A5D8000701F8C7000114C0
F0001F19071901851A7F1A3F1A1FA2F20FE0A21A07A31A03A318F81BF01A01A497C7FC17
01A317031707170F177F92B6FCA59238F8007F170F170717031701A317001B3EA31B7CA3
95C8FCA21BFCA21BF8A21A01A31A031BF01A071A0FA21A1F1A3FF27FE0F101FF1907191F
0603B5FCBCFCA21BC0A34F517CD058>I<BB12FEA5D8000701F8C700077FF0007F191F19
0785858586861B80A21A1FA31A0FA41BC006F81307A497C7FCA31701A317031707170F17
7F92B6FCA59238F8007F170F170717031701A31700A795C9FCB3B812F8A54A517CD055>
I<932601FFFCEC01C0047FD9FFC013030307B600F81307033F03FE131F92B8EA803F0203
DAE003EBC07F020F01FCC7383FF0FF023F01E0EC0FF94A01800203B5FC494848C9FC4901
F8824949824949824949824949824990CA7E494883A2484983485B1B7F485B481A3FA248
49181FA3485B1B0FA25AA298C8FC5CA2B5FCAE6C057FB712E0A280A36C94C7003FEBC000
A36C7FA36C7FA27E6C7FA26C7F6C7FA26D7E6D7F6D7F6D6D5E6D7F6D01FC93B5FC6D13FF
6D6C6D5C6E01F0EC07FB020F01FEEC1FF10203903AFFF001FFE0020091B6EAC07F033FEE
001F030703FC1307DB007F02E01301040149CAFC5B5479D26A>I<B8D8C003B8FCA5D800
0701F8C9001FEBE000B3AE92BAFCA503F8C9121FB3B1B8D8C003B8FCA560527CD169>I<
B812C0A5D8000701F8C7FCB3B3B3B2B812C0A52A527CD132>I<B800C091B612F8A5D800
0701F8C90003EBF8009738007F8051C7FC505AF203F8F20FF0505A505A505A50C8FCF101
FCF107F84F5A4F5A4F5A4F5A07FEC9FCF003FC4E5A4E5A4E5A4E5A4E5ADD01FECAFC4D5A
4D5A4D5A4D7E173F4D7E4C487E4C7F5E4C804C804C80EEFF7F9226F9FE3F7FDBFBFC8092
26FFF81F7F4C7EDCC0077F0480804C7E4B6D804B6D804B8284727F727F8684727F727F87
84728087737F85737F87737F85737F88857380747F888697B512FCB800C0013FECFFFEA5
5F527CD169>75 D<B812F8A5D8000701F8CAFCB3B3A91A7CA41AFC1AF8A51901A31903A2
19071AF0190FA2191F193F197F19FF180360183F4DB5FCBB12E0A546527CD151>I<B600
FC073FB512FE6F61A26F96B6FCA2D80007F5C00070EF01EFA202EF6DEF03CFA202E76DEF
078FA202E36DEF0F0FA202E16D171EA302E06D173CA26F6C1778A26F6C17F0A26F6DED01
E0A26F6DED03C0A36F6DED0780A26F6DED0F00A26F6D151EA26F6D5DA3706C5DA2706C5D
A2706D495AA2706D495AA2706D495AA3706D49C7FCA2706D131EA2706D5BA2716C5BA371
6C5BA271EB81E0A271EBC3C0A271EBE780A27101FFC8FCA3715BA2715BA2725AA2725AA2
D93FFC6F5AB74DB712FEA2725AA2725A77527CD180>I<B600FC93B7FC8181A282D80007
6E9239003FFC0070EE07E08282A28202EF7F02E77F02E380A202E18002E0806F7F6F7F6F
7FA26F7F6F7F6F806F80A26F80707F707F707F707FA2707F7080708070808583717F717F
717F717FA27114807114C07114E07213F07213F8A27213FC7213FE7213FF721487A27214
C77214E77313F77313FF85A285858585A28586868686A286868686A2D93FFC187FB7173F
1B1F1B0F1B07755A60527CD169>I<93380FFFC00303B6FC031F15E092B712FC0203D9FC
0013FF020F01C0010F13C0023F90C7000313F0DA7FFC02007F494848ED7FFE4901E0ED1F
FF49496F7F49496F7F4990C96C7F49854948707F4948707FA24849717E48864A83481B80
4A83481BC0A2481BE04A83A2481BF0A348497113F8A5B51AFCAF6C1BF86E5FA46C1BF0A2
6E5F6C1BE0A36C6D4D13C0A26C6D4D1380A26C1B006C6D4D5A6E5E6C626D6C4C5B6D6D4B
5B6D6D4B5B6D6D4B5B6D6D4B5B6D6D4B90C7FC6D6D4B5A6D01FF02035B023F01E0011F13
F0020F01FC90B512C0020390B7C8FC020016FC031F15E0030392C9FCDB001F13E0565479
D265>I<BAFC19F819FF1AE086D8000701F0C7001F13FC060113FF726C13807313C0070F
13E01BF0857313F81BFCA27313FEA41BFFA81BFEA31BFC61A21BF84F13F04F13E0614F13
C04F13004E485A061F5B92B812F01AC04FC7FC19E003F8CBFCB3AEB812C0A550527CD15C
>I<93380FFFC00303B6FC031F15E092B712FC0203D9FC0013FF020F01C0010F13C0023F
90C7000313F0DA7FFC02007F902601FFF0ED3FFE49496F7E49496F7F49496F7F4990C96C
7F4948707F4948707F01FF854A177F48864849717EA24849711380A2481BC04A83481BE0
A24A83481BF0A3481BF8A291CB7EA3B51AFCAF6C1BF8A26E5FA36C1BF0A36C6D4D13E0A3
6C1BC06E5F6C1B806E5F6CDB01FE16006C6D902607FF80495A4C13E06C6D013F6D495A01
7F91267F03F85C6D6C90277C00FC015B6D6C49D97E035B6D01806E485B6D6D48D91F8F5B
6D01E0039F90C7FC6D01F06EB45A6DD9FCF85DDA3FFF6E13F0020F6D4913C0020301FF90
B5C8FC020091B512FC031F180C0303181EDB001FEBE3FE93C7EA01FF74133E74137E7413
FEF2F8077290B5FC1CFCA285A21CF8A2851CF07314E0A27314C0731480731400735B9638
007FF8F21FE0576A79D265>I<B912F0F0FF8019F819FF1AC0D8000701F0C714F0060F7F
060113FE727F737F737F85737F87A2737FA387A863A2616363A24F5B4F5B4F90C8FC4F5A
06035B060F13F095B512C092B8C9FC19F819E019F89226F0000313FE9439007FFF80727F
727F727F727F727F8684A28684A787A71D1C75133EA38575137E73157C7513FC731401B8
6C6D9038F803F807039038FE07F07390B512E0736C14C0080F1400CEEA7FFC5F537CD164
>I<91260FFF80130791B500F85B010702FF5B011FEDC03F49EDF07F9026FFFC006D5A48
01E0EB0FFD4801800101B5FC4848C87E48488149150F001F824981123F4981007F82A284
12FF84A27FA26D82A27F7F6D93C7FC14C06C13F014FF15F86CECFF8016FC6CEDFFC017F0
6C16FC6C16FF6C17C06C836C836D826D82010F821303010082021F16801400030F15C0ED
007F040714E01600173F050F13F08383A200788200F882A3187FA27EA219E07EA26CEFFF
C0A27F6D4B13806D17006D5D01FC4B5A01FF4B5A02C04A5A02F8EC7FF0903B1FFFC003FF
E0486C90B65AD8FC0393C7FC48C66C14FC48010F14F048D9007F90C8FC3C5479D24B>I<
003FBC1280A59126C0003F9038C0007F49C71607D87FF8060113C001E08449197F49193F
90C8171FA2007E1A0FA3007C1A07A500FC1BE0481A03A6C994C7FCB3B3AC91B912F0A553
517BD05E>I<B800C00103B612FCA5D8000701F8CAEBF000F31F80B3B3B11B3FA26D97C7
FC81637F1B7E6D6D17FE505A6E7E505A6E6D15076E4D5A6E6D4B5A6E6D4B5A6E01F84B5A
6E6DDA03FFC8FC6E6CB46CEB0FFE6F9039F001FFF8030F90B65A030316C0DB007F92C9FC
040F14F8DC007F13805E537CD167>I<B700FE031FB512FEA5D8001F01F0CA383FFE00F3
07F06D626F170F6D62811B1F6D6D601B3F6D97C7FC6F5F6D197E821BFE6E6D5E1A016E6D
5E1A036E60701507A26E6D5E1A0F6E6D5E1A1F6E6070153FA26E6D93C8FC626E6E147E1A
FE6F5E711301A26F6D5C19036F6D5C19076F5E71130FA26F6D5C191F6F6D5C193F6F93C9
FC715BA26FEC807E19FE706D5A18C1705C18E3705C18F318F770EBFFE0A2705CA2705CA3
7091CAFCA2705BA2715AA3715AA2715AA2715A715A5F537DD166>I<B700FC017FB600FE
91B612F0A5D8003F01C0C8001F01E0C9EBF8006F71EE0FC06D7161876F1C1F6D7196C7FC
6F8373606D1E3E6F836D7160876F1CFC6D666F4B801F016D66704A806E525A88704A1707
6E059F5F70021F80080F160F6E6570023F806EDC3E074CC8FC8870027E5F6EDC7C03163E
7002FC804F6C167E6E1C7C700101814F6C16FC6E745B70010317016E4C6D5D060716C005
80496D14036F63DDC00F16E04F6D14076F07F05BDDE01F170F6F92C76C5D1DF8DDF03E6E
141F6F98C9FCDDF87E16FC067C6E5C6FF1FE3EDDFCFC177E6F4A6E147C1DFFDDFFF06E14
FC6F62A24E816F62A270496F5BA24E817061A295C97E7061A270487090CAFCA37048705A
A24D1601040360A27048705A84537DD18B>I<003FB7D88003B7FCA5D8000749C8000701
F8C7FC6D6D9238007F806D6E93C8FC7015FE6D17016E6D5D704A5A6E16076E6D4A5A6E6D
5D4F5A6E6D143F6E6D4A5A7191C9FC6E16FE6EECC00171485A6F5D6F6D485A6FEBF80F71
485A6F5D6F6D485AEFFF7F6F4ACAFC6F5C6F5CA2705B705B8482707F707FA2707F708085
5E4C80855E4C80DC3FCF7F058F7FEE7F074C6C7FDB01FE814C7E4B486C8003076E7F4B48
814C7F4B486D7F033F824C7F4BC76C7F4B6E7F4A5A4B6E804A486E800207844A48814B6F
7F4A4883023F824A486F7F92C96C7F02FE840101830103718090263FFFC084B76C0103B7
12F8A55D527CD166>I<B8030FB61280A5D8000F01FCCA003F90C7FC6FEF07F86D6D606D
4F5A826D6E4C5A6D4F5A826E6D4CC8FC6E18FE826E6D4B5A6E4D5A826E6D4B5A6E4D5A83
6E6E4A5A6E4D5A836F6D4AC9FC6F5E715C6F6D495A6F1503715C6F6D495A6F150F06805B
6F6E485A6F153F06E05B706D48CAFC705C725A70EBFDFC7013FF61705C82705C6182715B
96CBFCB3AA030FB712F8A561527ED166>I<001FBA12C01AE0A40380C714C002F8C75A02
C0178091C8481400495D495F494B5B495D495F48484B5B5F495F94B55A5E90C85D4C91C7
FC5E60003E4B5B5E604C5B5EC95C93B55A5D604B91C8FC5D5F4B5B5D5F4B5B5D5F92B55A
5C5F4A91C9FC5C5E4A5B5C4CEC03E04A5B5C5E91B55A5B4C14074991C8FC4918C05D495B
5B4B150F495B5B4B151F90B55A48183F5D4891C9127F4818FF4A5D48495D485F4A5D4849
033F1380484CB5FC4A143FBBFCA47E435279D152>I<EC7FFF0107B512F0013F14FE90B7
7E48D9E00F7F2703FE000113F0486C6D7F6EEB3FFC48826E131F83707FA36C496D7FA26C
90C7FC6C5AC9FCA6037FB5FC020FB6FC91B7FC01071487013FEBF0074913803901FFFC00
4813F0485B485B485B4890C7FC5A5BA2485AA45EA26D5C007F151D163D6C6C02797F6C6D
01F113F86C9026C003E1EBFFE06C9026F81FC014F06C90B5487EC6ED001F011F01FC0107
13E0010101E090C8FC3C387CB641>97 D<EB3FF0B5FCA51203C6FCB3A4923801FFE0030F
13FE033FEBFFC092B612F002F301017F913AF7F8003FFEDAFFE0EB0FFF03806D7F92C76C
7F4A6E7F4A824A6E7FA2727EA285A28584A31A80AC1A00A44E5AA36118FF616E4A5BA26E
4A5B6E4A5B6F495BDACFC04990C7FCDA87F0EB7FFC913A03FE03FFF849C6B612E0496D14
8049011F01FCC8FC90C7000313C041547BD24B>I<913801FFF8021FEBFF8091B612F001
0315FC010F9038C00FFE903A1FFE0001FFD97FFC491380D9FFF05B4817C048495B5C5A48
5BA2486F138091C7FC486F1300705A4892C8FC5BA312FFAD127F7FA27EA2EF03E06C7F17
076C6D15C07E6E140F6CEE1F806C6DEC3F006C6D147ED97FFE5C6D6CEB03F8010F9038E0
1FF0010390B55A01001580023F49C7FC020113E033387CB63C>I<4DB47E0407B5FCA5EE
001F1707B3A4913801FFE0021F13FC91B6FC010315C7010F9038E03FE74990380007F7D9
7FFC0101B5FC49487F4849143F484980485B83485B5A91C8FC5AA3485AA412FFAC127FA3
6C7EA37EA26C7F5F6C6D5C7E6C6D5C6C6D49B5FC6D6C4914E0D93FFED90FEFEBFF80903A
0FFFC07FCF6D90B5128F0101ECFE0FD9003F13F8020301C049C7FC41547CD24B>I<9138
03FFC0023F13FC49B6FC010715C04901817F903A3FFC007FF849486D7E49486D7E484913
0F48496D7E48178048497F18C0488191C7FC4817E0A248815B18F0A212FFA490B8FCA318
E049CAFCA6127FA27F7EA218E06CEE01F06E14037E6C6DEC07E0A26C6DEC0FC06C6D141F
6C6DEC3F806D6CECFF00D91FFEEB03FE903A0FFFC03FF8010390B55A010015C0021F49C7
FC020113F034387CB63D>I<ED3FFC0203B5FC020F14C0023F14E09139FFF81FF0499038
C03FF849EB807F49903800FFFC495A495AA2495AA2EE7FF8495AEE3FF0EE0FC093C7FCAE
B712E0A526007FF8C8FCB3B3A7007FB512FEA52E547CD329>I<DA3FFF14FF0103B5D8F0
0713C0010FDAFC1F13E0013FECFF7F90267FFC0F9038FF9FF09026FFE001EBF83F48496C
13E0484990387FF01F4890C7D83FF813E0489338FC0FC0F0078048486E6CC7FCA2003F82
A9001F5EA26C6C4A5AA26C5E6C6D495A6C6D495A6C6D485BDAFC0F5B4890B6C8FCD803EF
14FC01C314F02607C03F90C9FC91CBFCA2120FA37FA213F813FE90B7FC6C16F817FF18C0
6C836C836C836D828448B9FC12074848C700031480D81FF8EC003F4848150748486F13C0
83485A83A56D5D007F18806D5D003F18006C6C4B5AD80FFEED1FFC6C6C6CEC7FF86C01E0
49485A6C01FE011F5B6C6CB71280010F03FCC7FC010115E0D9000F01FCC8FC3C4F7CB543
>I<EB3FF0B5FCA51203C6FCB3A4EE1FFC93B512C0030314F0030F8092391FE07FFC9239
3F001FFE037C8003F07FDAF1E081ECF3C0DAF7807F8502FFC7FC5CA25CA45CB3ACB6D8F8
07B612C0A542537BD24B>I<137F497E000313E0487FA2487FA76C5BA26C5BC613806DC7
FC90C8FCADEB3FF0B5FCA512017EB3B3A6B612E0A51B547BD325>I<EB3FF0B5FCA51203
C6FCB3A54CB512F8A59339003FFE00EF1FF0EF3FC04D5A4DC7FCEE03FEEE07F84C5A4C5A
EE7FC04CC8FC4B5A4B5AED0FF8ED1FE04B7E4B7EECF1FF02F37F02F77F91B6FC83159F03
0F7F02FE80DAF8077F4A7E6F7F6F7F83707E82707F84707F707F82707F84707F177F717E
4D13C0B6D8F003B6FCA540537CD247>107 D<EB3FF0B5FCA512017EB3B3B3B1B612F0A5
1C537BD225>I<D93FF0D91FFCEDFFE0B591B500C0010713FE030302F0011F6D7E030F6E
017F8092271FE07FFCD9FF037F922A3F001FFE01F8007F0003027C9126FF03E080C602F0
6DD90780137FDAF1E0038FC77FDAF3C0159EDAF7806D01BC143F07FC8102FFC75C4A5EA2
4A5EA44A5EB3ACB6D8F807B6D8C03FB512FEA567367BB570>I<D93FF0EB1FFCB591B512
C0030314F0030F8092391FE07FFC92393F001FFE0003027C80C602F07FDAF1E081ECF3C0
DAF7807F8502FFC7FC5CA25CA45CB3ACB6D8F807B612C0A542367BB54B>I<913801FFE0
021F13FE91B612C0010315F0010F9038807FFC903A1FFC000FFED97FF86D6C7E49486D7F
48496D7F48496D7F4A147F48834890C86C7EA24883A248486F7EA3007F1880A400FF18C0
AC007F1880A3003F18006D5DA26C5FA26C5F6E147F6C5F6C6D4A5A6C6D495B6C6D495B6D
6C495BD93FFE011F90C7FC903A0FFF807FFC6D90B55A010015C0023F91C8FC020113E03A
387CB643>I<903A3FF001FFE0B5010F13FE033FEBFFC092B612F002F301017F913AF7F8
007FFE0003D9FFE0EB1FFFC602806D7F92C76C7F4A824A6E7F4A6E7FA2717FA285187F85
A4721380AC1A0060A36118FFA2615F616E4A5BA26E4A5B6E4A5B6F495B6F4990C7FC03F0
EBFFFC9126FBFE075B02F8B612E06F1480031F01FCC8FC030313C092CBFCB1B612F8A541
4D7BB54B>I<90397FE003FEB590380FFF80033F13E04B13F09238FE1FF89139E1F83FFC
0003D9E3E013FEC6ECC07FECE78014EF150014EE02FEEB3FFC5CEE1FF8EE0FF04A90C7FC
A55CB3AAB612FCA52F367CB537>114 D<903903FFF00F013FEBFE1F90B7FC120348EB00
3FD80FF81307D81FE0130148487F4980127F90C87EA24881A27FA27F01F091C7FC13FCEB
FFC06C13FF15F86C14FF16C06C15F06C816C816C81C681013F1580010F15C01300020714
E0EC003F030713F015010078EC007F00F8153F161F7E160FA27E17E07E6D141F17C07F6D
EC3F8001F8EC7F0001FEEB01FE9039FFC00FFC6DB55AD8FC1F14E0D8F807148048C601F8
C7FC2C387CB635>I<143EA6147EA414FEA21301A313031307A2130F131F133F13FF5A00
0F90B6FCB8FCA426003FFEC8FCB3A9EE07C0AB011FEC0F8080A26DEC1F0015806DEBC03E
6DEBF0FC6DEBFFF86D6C5B021F5B020313802A4D7ECB34>I<D93FF8913801FFC0B50207
B5FCA50003ED001FC61607B3AE5FA35FA2017F5D173B177B6D6C14F3DC01E313F06D6CD9
07C3EBFFC0903A0FFFC03F836D90B51203010114FE6D6C13F8020701E091C7FC42377BB5
4B>I<B600F00107B5FCA5000101F8C8EA7FE06C6DED3F00A2017F163E6E157E013F167C
6E15FC6D5E6F13016D5E8117036D5E6F13076D5E6F130F6D5E6F131F6D93C7FC815F6E6C
133E177E023F147C6F13FC6E5C16816E5C16C3A26EEBE3E016E76E5C16FF6E5CA26E91C8
FCA26F5AA36F5AA26F5AA26F5AA26F5A6F5A40367DB447>I<B6D8E07FB5D8C003B512C0
A5000101F0C701F0C7381FF8006E027FED07E06C715DA26E023F150F017F705DA26E181F
013F4B6C92C7FC6E606D70143E94B5FC6F177E6D4A6E137C03C001F315FC6D715B160303
E001E114016D020702E05B03F013C06D71485A160F03F8D9807F13076D05F85B93381F00
3F03FC160F027F4902FC5BDBFE3E011F131F023F04FE90C8FC167EDBFF7C010F5B6E01FC
ECFF3E4C6D137E6E5FA24C7F6E5F4C7F6E5FA24C7F6E5F4C147FA26E5F93C8123F6F5EA2
033E6FC9FC5A367DB461>I<007FB500F090387FFFFEA5C66C48C7000F90C7FC6D6CEC07
F86D6D5C6D6D495A6D4B5A6F495A6D6D91C8FC6D6D137E6D6D5B91387FFE014C5A6E6C48
5A6EEB8FE06EEBCFC06EEBFF806E91C9FCA26E5B6E5B6F7E6F7EA26F7F834B7F4B7F92B5
FCDA01FD7F03F87F4A486C7E4A486C7E020F7FDA1FC0804A486C7F4A486C7F02FE6D7F4A
6D7F495A49486D7F01076F7E49486E7E49486E7FEBFFF0B500FE49B612C0A542357EB447
>I<B600F00107B5FCA5C601F8C8EA7FE06EED3F00A26D6C153E187E013F167C6E15FC6D
5E6F13016D5E6F13036D5E8117076D6D5C170F6D6D5C171F6D93C7FC6F5B027F143E6F13
7E023F147C6F13FCA26E6D5A16816EEBC1F016C36E5C16E76E5C16FF6E5CA26E91C8FCA3
6F5AA26F5AA26F5AA26F5AA26F5AA35E150F5E151F93C9FC5DD81FC0133E486C137E486C
137C486C13FC5D14015D14034A5A6C48485A49485A263FC07FCAFCEB81FE6CB45A6C13F0
00035BC690CBFC404D7DB447>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fq cmr10 10.95 73
/Fq 73 123 df<4AB4EB0FE0021F9038E03FFC913A7F00F8FC1ED901FC90383FF03FD907
F090397FE07F80494801FF13FF4948485BD93F805C137F0200ED7F00EF003E01FE6D91C7
FC82ADB97EA3C648C76CC8FCB3AE486C4A7E007FD9FC3FEBFF80A339407FBF35>11
D<EC03FE91383FFF809138FE03E0903903F800F0D90FE013384948137C90393F8001FE90
387F00035B5BA2485A6F5AED007093C7FCAA16FEB7FCA33901FC000315011500B3AC486C
497EB5D8F87F13FCA32E407EBF33>I<EC03FF023F13EE9138FE01FEEB03F090380FE003
EB1FC0EB3F80EB7F005B5B150148481300AEB7FCA3D801FCC7FCB3AE486C497EB5D8F87F
13FCA32E407EBF33>I<DA03FE49B4FC91273FFF801F13C0913BFE03E07F01F0903C03F0
00F1FC0078D90FE0D97FF0131C49484948133E4948484913FF494848495A5B491500A248
485C03016E5A0300153896C7FCAA197FBBFCA3D801FCC738FE00018485B3AC486C496CEC
FF80B5D8F87FD9FC3F13FEA347407EBF4C>I<EC0F80EC7FE0ECF870903803E038010713
3CECC01CEB0F80011F131E150EA2EB3F00A55D1480A25D157815705D6D6C5A14C1ECC380
02C7CAFC02EE91387FFFFCEB0FEC14FC4A020713C06D48913801FE006E5DEF00F06D7E01
074B5A496C5D011D1503D939FF4A5A017093C7FC496D5B0001017F140E496C6C131E0003
6E131C2607801F143C000F6E5B001F6D6C1370263F000714F0486E485ADA03FE5B913801
FF03486D495A0487C8FCED7FCFED3FFE6F4814386D5C150F007F6E6C14786D6D6C147000
3F4A6C14F06D496C6C13E0001F91393E3FC0016C6C903AFC1FF003C03D07FC07F007FC1F
800001B5D8C001B512006C6C90C7EA7FFCD90FF8EC0FF03E437CC047>38
D<1430147014E0EB01C0EB03801307EB0F00131E133E133C5B13F85B12015B1203A2485A
A2120F5BA2121F90C7FCA25AA3123E127EA6127C12FCB2127C127EA6123E123FA37EA27F
120FA27F1207A26C7EA212017F12007F13787F133E131E7FEB07801303EB01C0EB00E014
701430145A77C323>40 D<12C07E12707E7E121E7E6C7E7F12036C7E7F12007F1378137C
A27FA2133F7FA21480130FA214C0A3130714E0A6130314F0B214E01307A614C0130FA314
80A2131F1400A25B133EA25BA2137813F85B12015B485A12075B48C7FC121E121C5A5A5A
5A145A7BC323>I<121EEA7F8012FF13C0A213E0A3127FEA1E601200A413E013C0A31201
1380120313005A120E5A1218123812300B1C798919>44 D<B512FEA617067F961E>I<12
1EEA7F80A2EAFFC0A4EA7F80A2EA1E000A0A798919>I<ED0180ED03C01507A21680150F
A216005DA2151E153EA2153C157CA2157815F8A25D1401A25D1403A25D1407A25D140FA2
4AC7FCA2141E143EA2143C147CA2147814F8A25C1301A25C1303A25C1307A25C130FA291
C8FC5BA2131E133EA25BA2137813F8A25B1201A25B1203A25B1207A25B120FA290C9FC5A
A2121E123EA2123C127CA2127812F8A25A1260225B7BC32D>I<EB01FE90380FFFC09038
3F03F090387C00F849137C48487F48487F4848EB0F80A2000F15C04848EB07E0A3003F15
F0A290C712034815F8A64815FCB3A26C15F8A56C6CEB07F0A3001F15E0A36C6CEB0FC0A2
6C6CEB1F80000315006C6C133E6C6C5B017C5B90383F03F090380FFFC0D901FEC7FC263F
7DBC2D>I<EB01C013031307131F137FEA07FFB5FC139FEAF81F1200B3B3ACEB7FF0B612
F8A31D3D78BC2D>I<EB07FC90383FFF8090B512E03903F01FF83907C007FC390F0001FE
001E6D7E001C1580003CEC7FC05AED3FE01270B4FC6DEB1FF07FA56C5A6CC7FC120CC813
E0153FA216C0157F168015FF16004A5A5D4A5A4A5A5D4A5A4A5A4AC7FC147E147C5C495A
495A495A495A49C71270133E133C5B4914E0485A485A485A48C7120148B6FCA25A4815C0
B7FCA3243D7CBC2D>I<EB07FC90383FFF809038F80FE03901E003F839078001FCD80F00
7F000E6D7E001E1580D81F80137F486C14C07FA27F5BA2121F6C5AC8138015FF1600A24A
5AA24A5A5DEC07E04A5A023FC7FCEB1FFCECFF809038000FE0EC07F86E7E6E7E6E7E1680
ED7FC0A216E0153FA216F0A2120C123F487E487EA316E0A249137F6CC713C01278EDFF80
7E6C4913006C495A3907C007FC3903F80FF0C6B55A013F1380D907F8C7FC243F7CBC2D>
I<150E151E153EA2157EA215FE1401A21403EC077E1406140E141CA214381470A214E0EB
01C0A2EB0380EB0700A2130E5BA25B5BA25B5B1201485A90C7FC5A120E120C121C5AA25A
5AB8FCA3C8EAFE00AC4A7E49B6FCA3283E7EBD2D>I<00061403D80780131F01F813FE90
B5FC5D5D5D15C092C7FC14FCEB3FE090C9FCACEB01FE90380FFF8090383E03E090387001
F8496C7E49137E497F90C713800006141FC813C0A216E0150FA316F0A3120C127F7F12FF
A416E090C7121F12FC007015C012780038EC3F80123C6CEC7F00001F14FE6C6C485A6C6C
485A3903F80FE0C6B55A013F90C7FCEB07F8243F7CBC2D>I<EC1FE0ECFFF8903803F03E
90380FC00F90391F000780133E017EEB1FC049133F4848137F12035B12074848EB3F80ED
1F00001F91C7FC5BA2123FA3485AA214FE903887FF8039FF8F07E090389C01F09038B800
FC01B0137E13F0497F16804914C0A2ED1FE0A34914F0A5127FA6123F6D14E0A2121FED3F
C0A26C6C1480A20007EC7F006C6C137E6C6C5B6C6C485A90387E07F06DB45A010F1380D9
03FCC7FC243F7CBC2D>I<1238123C123F90B612FCA316F85A16F016E00078C712010070
EC03C0ED078016005D48141E151C153C5DC8127015F04A5A5D14034A5A92C7FC5C141EA2
5CA2147C147814F8A213015C1303A31307A3130F5CA2131FA6133FAA6D5A0107C8FC2640
7BBD2D>I<EB03FC90381FFF8090387C07E09038F001F83901E0007C48487F48487F48C7
FCED0F80121E16C0003E1407A4123FA26DEB0F807F6C6C131F6D140001FC133E6C6C5B90
38FF80786C6D5A6CEBF3E06CEBFF806C91C7FC133F6D13C06D7F013F13F801787F48486C
7E3903E01FFF48486C1380260F800313C048487E489038007FE0003E143F007E141F007C
EC0FF01507481403A31501A46C15E0007C1403A2007E15C06C14076CEC0F806DEB1F006C
6C133ED807F05B3901FC03F86CB512E0011F1380D903FCC7FC243F7CBC2D>I<EB03FCEB
1FFF90387E07C09038FC03F048486C7E48486C7E4848137C000F147E4848137F81003F15
805B007F15C0A2151F12FF16E0A516F0A5127F153FA36C7EA2001F147F120F6C6C13FF6D
13DF000313013900F8039F90387E0F1FD91FFE13E0EB07F090C7FCA2ED3FC0A41680157F
D80F801400487E486C13FEA24A5A5D49485AEB8007391E000FE0001F495A260FC07FC7FC
3803FFFE6C13F838003FC0243F7CBC2D>I<15074B7EA34B7EA34B7EA34B7EA34B7E15E7
A2913801C7FC15C3A291380381FEA34AC67EA3020E6D7EA34A6D7EA34A6D7EA34A6D7EA3
4A6D7EA349486D7E91B6FCA249819138800001A249C87EA24982010E157FA2011E82011C
153FA2013C820138151FA2017882170F13FC00034C7ED80FFF4B7EB500F0010FB512F8A3
3D417DC044>65 D<B712FCEEFF8017F00001903980000FF86C6CC7EA03FE707E701380EF
7FC0EF3FE0A2EF1FF0A218F8A3170F171FA318F0A2EF3FE0177F18C0EFFF804C1300EE03
FCEE0FF8EE7FE091B6C7FC17E091C7EA07FCEE01FE933800FF80EF7FC0EF3FE0EF1FF018
F8170F18FC1707A218FEA718FC170FA2EF1FF818F0173FEF7FE0EFFFC00403138048486C
90380FFE00B85A17E094C7FC373E7DBD40>I<DB3FF01306912603FFFE130E020F9038FF
801E913A3FF007E03E9139FF8000F8D903FEC7EA7C7ED907F8EC1EFE4948140FD93FE014
0749481403495A91C812014848150012034848167E5B000F173EA24848161EA2123F5B18
0E127FA349160012FFAC127F7F180EA2123FA27F001F171E181C6C7EA20007173C6D1638
6C6C1678000117706C6C16F06EEC01E06D6C15C06D6C1403D90FF0EC07806D6CEC1F00D9
03FE143E902600FF8013F891393FF007F0020FB512C0020391C7FC9138003FF037427BBF
42>I<B712FCEEFF8017E000019039C0001FF86C6C48EB03FEEE00FF717E717EEF0FE084
717E717E170184717EA21980187F19C0A3F03FE0A519F0AB19E0A5F07FC0A21980A218FF
19004D5AA24D5A6017074D5A4D5AEF7FC04DC7FCEE03FE48486CEB1FF8B85A178004FCC8
FC3C3E7DBD45>I<B912E0A300019038C000016C6C48EB001FEF0FF01703A217011700A3
1870A418381638A41800A21678A216F81501150791B5FCA3EC8007150115001678A21638
A2180EA3181C93C7FCA4183C1838A21878A318F8EF01F0A21707170F173F48486CEB03FF
B912E0A3373E7DBD3E>I<B91280A300019038C000036C6C48EB007FEF1FC0170F1707A2
1703A31701A4EF00E0A21638A31800A31678A216F81501150791B5FCA3EC800715011500
1678A21638A693C8FCAF3801FFE0B612F0A3333E7DBD3B>I<DB3FE0130C912603FFFE13
1C021F9038FF803C913A7FF00FC07C9139FF0001F0D903FC90380078FC4948143DD91FE0
141F4948140F4948140701FF15034890C8FC491501485A000716005B000F177C5B001F17
3CA2485AA2181C127FA25B95C7FC12FFAB041FB512F0127FA26D9139000FFE00EF03FC12
3FA27F121FA26C7EA212077F12036C7E7F6C7F6D6C14076D7E6D6C140FD907F8141ED903
FEEC3C7C902600FF80EBF83C913A7FF007F01C021FB5EAC00C020391C8FC9138003FF03C
427BBF47>I<B6D8C01FB512F8A3000101E0C7383FFC0026007F80EC0FF0B3A691B7FCA3
0280C7120FB3A92601FFE0EC3FFCB6D8C01FB512F8A33D3E7DBD44>I<B612F0A3C6EBF0
00EB3FC0B3B3B2EBFFF0B612F0A31C3E7EBD21>I<011FB512FCA3D9000713006E5A1401
B3B3A6123FEA7F80EAFFC0A44A5A1380D87F005B007C130700385C003C495A6C495A6C49
5A2603E07EC7FC3800FFF8EB3FC026407CBD2F>I<B600C090387FFFFCA3000101E0C700
0F138026007F80913807FE0018F818E0604D5A4DC7FC173E5F5F4C5A4C5A4C5A4C5A4CC8
FC163E5E5E4B5A4B5AED07804B7E151F4B7E4B7E15FF913881EFF8913883C7FCEC878791
388F03FE91389E01FF14BCDAF8007F4A6D7E5C4A6D7E4A6D7EA2707E707EA2707E707EA2
707F717E84173F717E717EA2717E848419802601FFE04A13C0B600C090B6FCA3403E7DBD
47>I<B612F8A3000101E0C9FC38007F80B3B0EF0380A517071800A45FA35FA25F5F5F4C
5A160748486C133FB8FCA3313E7DBD39>I<B500C093B512C0A300016D4BEBE000D8007F
1880D977F0ED03BFA3D973F8ED073FA3D971FC150EA2D970FE151CA3027F1538A36E6C14
70A36E6C14E0A26E6CEB01C0A36E6CEB0380A36E6CEB0700A26E6C130EA36E6C5BA3037F
5BA26F6C5AA36F6C5AA392380FE1C0A3923807F380A26FB4C7FCA36F5AA213F8486C6D5A
D807FFEFFFE0B500F80178017FEBFFC0A34A3E7CBD53>I<B56C91B512F88080D8007F03
0713006EEC01FC6E6E5A1870EB77FCEB73FEA2EB71FF01707FA26E7E6E7EA26E7E6E7EA2
6E7E6E7EA26E7E6E7FA26F7E6F7EA26F7E6F7EA26F7E6F7EA26F7E6F1380A2EE7FC0EE3F
E0A2EE1FF0EE0FF8A2EE07FCEE03FEA2EE01FF7013F0A2177F173FA2171F170FA2170701
F81503487ED807FF1501B500F81400A218703D3E7DBD44>I<ED7FE0913807FFFE91391F
C03F8091397E0007E04948EB03F8D907F0EB00FE4948147F49486E7E49486E7E49C86C7E
01FE6F7E00018349150300038348486F7EA248486F7EA2001F188049167F003F18C0A300
7F18E049163FA300FF18F0AC007F18E06D167FA4003F18C0A26C6CEEFF80A36C6C4B1300
A26C6C4B5A00035F6D150700015F6C6C4B5A6D5E6D6C4A5A6D6C4A5A6D6C4AC7FC6D6C14
FED901FCEB03F8D9007FEB0FE091391FC03F80912607FFFEC8FC9138007FE03C427BBF47
>I<B712F8EEFF8017E000019039C0003FF86C6C48EB07FCEE01FE707EEF7F80EF3FC018
E0A2EF1FF0A218F8A818F0A2EF3FE0A218C0EF7F80EFFF004C5AEE07FCEE3FF091B612C0
4CC7FC0280C9FCB3A73801FFE0B612C0A3353E7DBD3E>I<ED7FE0913807FFFE91391FC0
3F8091397F000FE0D901FCEB03F8D907F0EB00FE4948147F49486E7E49486E7E49C86C7E
498248486F7E49150300038348486F7EA2000F834981001F1880A24848EE7FC0A3007F18
E0A249163FA200FF18F0AC007F18E0A26D167FA3003F18C0A26C6CEEFF80A3000F18006D
5D0007DA0F805B6C6C90393FE003FCED70706C6C496C485A6C6C48486C485A017FD9800E
5BD93F819038061FC0D91FC19038073F80D90FE14AC7FCD907F1EB03FE902601FDC013F8
903A007EE007E091271FF03FC013180207B5FC9139007FE1E0DB0001143883711378A270
6C13F0EFFF0318FFA27113E0A37113C0711380711300715AEF01F83D527BBF47>I<B712
C016FCEEFF800001D9C00013E06C6C48EB1FF0EE07FCEE01FE707E84717EA2717EA284A7
60177F606017FF95C7FCEE01FCEE07F8EE1FE0EEFF8091B500FCC8FC16F091388001FCED
003FEE1FC0707E707E83160383160183A383A484A4F0C004190EA28218E0057F131E2601
FFE0161CB600C0EB3FF094381FF83805071370CA3801FFE09438003F803F407DBD43>I<
D907FC131890391FFF8038017FEBE0783901FC03F83A03F0007CF8D807C0133F4848130F
001F140748C7FC003E1403007E1401A2007C140012FC1678A46C1538A27EA26C6C14007F
7FEA3FF8EBFF806C13F86CEBFF806C14F06C14FC6C14FF6C15C0013F14E0010714F0EB00
7F020713F89138007FFC150FED07FE15031501ED00FFA200E0157FA3163FA27EA3163E7E
167E6C157C6C15FC6C15F86D13016DEB03F06DEB07E0D8F9FCEB0FC03AF07F803F809039
1FFFFE00D8E00713F839C0007FC028427BBF33>I<003FB91280A3903AF0007FE0010180
90393FC0003F48C7ED1FC0007E1707127C00781703A300701701A548EF00E0A5C81600B3
B14B7E4B7E0107B612FEA33B3D7DBC42>I<B600C090B512F8A3000101E0C70007130026
007F80EC01FC715A1870B3B3A4013F16F06E5DA21701011F5E80010F15036E4A5A010793
C7FC6D6C5C6D6C141E6D6C5C027F14F86E6C485A91390FF00FE00203B51280020049C8FC
ED1FF03D407DBD44>I<B691380FFFFEA3000301E0020113E06C01809138007F806CEF3F
00017F163E181C6E153C013F1638A26E1578011F1670A26D6C5DA26E140101075EA26E14
0301035EA26D6C4AC7FCA2806D150EA26F131E027F141CA26F133C023F1438A26E6C5BA2
6F13F0020F5CA2EDF80102075CA26E6C485AA2EDFE07020191C8FCA26F5A6E130EA2ED7F
9CA216DCED3FF8A36F5AA36F5AA26F5AA36F5A3F407EBD44>I<B500FE017FB5D88007B5
FCA3000301C0010101E0C713F86C90C849EC3FE07148EC0F807E7215006E143F017F190E
84A26D6C60A24D7E6D6C60A2EFE7F86D6C60A2933801C3FC6E18F001076104037F6E0281
140101036104077F17006D6C4D5AA2040EEB7F806D6C4DC7FCA24CEB3FC0DA7F80160EA2
4CEB1FE003C0161E023F171C047814F0DBE070010F133C021F173804F014F84C1307DA0F
F05EA2DBF1C0EB03FCDA07F95EA2DBFB80EB01FEDA03FF6F5AA293C8FCA26E5FA24B157F
020094C8FCA24B81037C153EA20378151E0338151C58407EBD5D>I<007FB5D8C003B512
E0A3C649C7EBFC00D93FF8EC3FE06D48EC1F806D6C92C7FC171E6D6C141C6D6C143C5F6D
6C14706D6D13F04C5ADA7FC05B023F13036F485ADA1FF090C8FC020F5BEDF81E913807FC
1C163C6E6C5A913801FF7016F06E5B6F5AA26F7E6F7EA28282153FED3BFEED71FF15F103
E07F913801C07F0203804B6C7EEC07004A6D7E020E6D7E5C023C6D7E02386D7E14784A6D
7E4A6D7F130149486E7E4A6E7E130749C86C7E496F7E497ED9FFC04A7E00076DEC7FFFB5
00FC0103B512FEA33F3E7EBD44>I<B66C0103B51280A3000101F0C8EBF8006C6C48ED3F
C0725A013F041EC7FC6D7E606D6C15386D6C1578606D6C5D6E14016D5E6D6D1303606E6C
49C8FC6E6C5B170E6E6C131E171C6E6C5B6E6C137817706E6C13F06F5B6E13016EEB83C0
5FED7FC7DB3FE7C9FC16EFED1FFE5E150F6F5AB3A4ED1FFC020FB512FCA3413E7FBD44>
I<003FB712F8A391C7EA1FF013F801E0EC3FE00180EC7FC090C8FC003EEDFF80A2003C4A
1300007C4A5A12784B5A4B5AA200704A5AA24B5A4B5AA2C8485A4A90C7FCA24A5A4A5AA2
4A5AA24A5A4A5AA24A5A4A5AA24990C8FCA2495A4948141CA2495A495AA2495A495A173C
495AA24890C8FC485A1778485A484815F8A24848140116034848140F4848143FED01FFB8
FCA32E3E7BBD38>I<EB0FF8EBFFFE3903F01F8039078007E0000F6D7E9038E001F8D81F
F07F6E7EA3157F6C5AEA0380C8FCA4EC1FFF0103B5FC90381FF87FEB7F803801FC00EA07
F8EA0FE0485A485AA248C7FCEE038012FEA315FFA3007F5BEC03BF3B3F80071F8700261F
C00E13CF3A07F03C0FFE3A01FFF807FC3A003FC001F0292A7DA82D>97
D<EA01FC12FFA3120712031201B1EC03FC91381FFF8091387C07E09039FDE001F09039FF
C000FC4A137E91C77E49158049141F17C0EE0FE0A217F0A2160717F8AA17F0A2160FA217
E0161F17C06D1580EE3F006D5C6E13FE9039F3C001F89039F1E003F09039E0780FC09026
C03FFFC7FCC7EA07F82D407EBE33>I<49B4FC010F13E090383F00F8017C131E4848131F
4848137F0007ECFF80485A5B121FA24848EB7F00151C007F91C7FCA290C9FC5AAB6C7EA3
003FEC01C07F001F140316806C6C13076C6C14000003140E6C6C131E6C6C137890383F01
F090380FFFC0D901FEC7FC222A7DA828>I<ED01FC15FFA3150715031501B114FF010713
E190381F80F990387E003D49131FD803F81307485A49130348481301121F123F5B127FA2
90C7FCA25AAA7E7FA2123FA26C7E000F14037F000714076C6C497E6C6C497ED8007C0179
13F890383F01F190380FFFC1903A01FE01FC002D407DBE33>I<EB01FE90380FFFC09038
3F03F09038FC01F848486C7E4848137E48487F000F158049131F001F15C04848130FA212
7F16E090C7FCA25AA290B6FCA290C9FCA67EA27F123F16E06C7E1501000F15C06C6C1303
6DEB07806C6C1400C66C131E017E5B90381F80F8903807FFE0010090C7FC232A7EA828>
I<EC1FC0EC7FF8903801F83C903807E07E90380FC0FFEB1FC1EB3F811401137FEC00FE01
FE137C1500AEB6FCA3C648C7FCB3AE487E007F13FFA320407EBF1C>I<167C903903F801
FF903A1FFF078F8090397E0FDE1F9038F803F83803F001A23B07E000FC0600000F6EC7FC
49137E001F147FA8000F147E6D13FE00075C6C6C485AA23901F803E03903FE0FC026071F
FFC8FCEB03F80006CAFC120EA3120FA27F7F6CB512E015FE6C6E7E6C15E06C810003813A
0FC0001FFC48C7EA01FE003E140048157E825A82A46C5D007C153E007E157E6C5D6C6C49
5A6C6C495AD803F0EB0FC0D800FE017FC7FC90383FFFFC010313C0293D7EA82D>I<EA01
FC12FFA3120712031201B1EC01FE913807FFC091381E07E091387803F09138E001F8D9FD
C07F148001FF6D7E91C7FCA25BA25BB3A6486C497EB5D8F87F13FCA32E3F7DBE33>I<EA
01E0EA07F8A2487EA46C5AA2EA01E0C8FCACEA01FC127FA3120712031201B3AC487EB512
F0A3143E7DBD1A>I<1478EB01FEA2EB03FFA4EB01FEA2EB00781400AC147FEB7FFFA313
017F147FB3B3A5123E127F38FF807E14FEA214FCEB81F8EA7F01387C03F0381E07C0380F
FF803801FC00185185BD1C>I<EA01FC12FFA3120712031201B292B51280A392383FFC00
16E0168093C7FC153C5D5D4A5AEC07C04A5A4AC8FC143E147F4A7E13FD9038FFDFC0EC9F
E0140F496C7E01FC7F496C7E1401816E7E81826F7E151F826F7EA282486C14FEB539F07F
FFE0A32B3F7EBE30>I<EA01FC12FFA3120712031201B3B3B1487EB512F8A3153F7DBE1A>
I<2701F801FE14FF00FF902707FFC00313E0913B1E07E00F03F0913B7803F03C01F80007
903BE001F87000FC2603F9C06D487F000101805C01FBD900FF147F91C75B13FF4992C7FC
A2495CB3A6486C496CECFF80B5D8F87FD9FC3F13FEA347287DA74C>I<3901F801FE00FF
903807FFC091381E07E091387803F000079038E001F82603F9C07F0001138001FB6D7E91
C7FC13FF5BA25BB3A6486C497EB5D8F87F13FCA32E287DA733>I<14FF010713E090381F
81F890387E007E01F8131F4848EB0F804848EB07C04848EB03E0000F15F04848EB01F8A2
003F15FCA248C812FEA44815FFA96C15FEA36C6CEB01FCA3001F15F86C6CEB03F0A26C6C
EB07E06C6CEB0FC06C6CEB1F80D8007EEB7E0090383F81FC90380FFFF0010090C7FC282A
7EA82D>I<3901FC03FC00FF90381FFF8091387C0FE09039FDE003F03A07FFC001FC6C49
6C7E6C90C7127F49EC3F805BEE1FC017E0A2EE0FF0A3EE07F8AAEE0FF0A4EE1FE0A2EE3F
C06D1580EE7F007F6E13FE9138C001F89039FDE007F09039FC780FC0DA3FFFC7FCEC07F8
91C9FCAD487EB512F8A32D3A7EA733>I<02FF131C0107EBC03C90381F80F090397F0038
7C01FC131CD803F8130E4848EB0FFC150748481303121F485A1501485AA448C7FCAA6C7E
A36C7EA2001F14036C7E15076C6C130F6C7E6C6C133DD8007E137990383F81F190380FFF
C1903801FE0190C7FCAD4B7E92B512F8A32D3A7DA730>I<3901F807E000FFEB1FF8EC78
7CECE1FE3807F9C100031381EA01FB1401EC00FC01FF1330491300A35BB3A5487EB512FE
A31F287EA724>I<90383FC0603901FFF8E03807C03F381F000F003E1307003C1303127C
0078130112F81400A27E7E7E6D1300EA7FF8EBFFC06C13F86C13FE6C7F6C1480000114C0
D8003F13E0010313F0EB001FEC0FF800E01303A214017E1400A27E15F07E14016C14E06C
EB03C0903880078039F3E01F0038E0FFFC38C01FE01D2A7DA824>I<131CA6133CA4137C
A213FCA2120112031207001FB512C0B6FCA2D801FCC7FCB3A215E0A912009038FE01C0A2
EB7F03013F138090381F8700EB07FEEB01F81B397EB723>I<D801FC14FE00FF147FA300
0714030003140100011400B3A51501A31503120015076DEB06FF017E010E13806D4913FC
90381FC078903807FFE00100903880FE002E297DA733>I<B539E00FFFE0A32707FE0003
13006C48EB00FC5E00015D7F00005DA26D13016D5CA26D6C485AA2ECC007011F91C7FCA2
90380FE00EA2ECF01E0107131CA26D6C5AA2ECFC7801011370A2ECFEF001005BA2EC7FC0
A36E5AA26EC8FCA3140E2B287EA630>I<B53BC3FFFE03FFF8A3290FFE003FE00013C06C
486D48EB3F806C4817006D010F141E00016F131C15076D163C00004A6C1338A2017F5E4B
7E151DD93F805DED3DFC1538D91FC04A5AED78FE9238707E03D90FE0017F5BEDE03F02F0
140701070387C7FC9138F1C01F02F9148F010315CE9138FB800F02FF14DE6D15FCED0007
6D5DA24A1303027E5CA2027C1301023C5C023813003D287EA642>I<B539F01FFFE0A300
03D9C00F1300C690388007F8D97F0013E002805BD93FC05B011F49C7FC90380FE00EECF0
1E6D6C5A01035B6D6C5A6E5AEB00FF6E5A6E5A81141F814A7E81147BECF1FC903801E1FE
ECC0FF01037F49486C7ED90F007F011E6D7E013E130F496D7E01FC80486C80000F4A7EB5
39803FFFF8A32D277FA630>I<B539E00FFFE0A32707FE000313006C48EB01FC6F5A0001
5D7F00005DA2017F495AA2EC8003013F5CA26D6C48C7FCA26E5A010F130EA26D6C5AA2EC
F83C01031338A26D6C5AA2ECFEF001005BA2EC7FC0A36E5AA36EC8FCA2140EA2141E141C
143C1438A2147800181370127EB45BA2495AA248485AD87E07C9FCEA780EEA3C3CEA1FF8
EA07E02B3A7EA630>I<001FB61280A2EBE0000180140049485A001E495A121C4A5A003C
495A141F00385C4A5A147F5D4AC7FCC6485AA2495A495A130F5C495A90393FC00380A2EB
7F80EBFF005A5B484813071207491400485A48485BA248485B4848137F00FF495A90B6FC
A221277EA628>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fr cmbx10 10.95 29
/Fr 29 117 df<140F143F5C495A130F48B5FCB6FCA313F7EAFE071200B3B3A8007FB612
F0A5243C78BB34>49 D<16FCA24B7EA24B7EA34B7FA24B7FA34B7FA24B7FA34B7F157C03
FC7FEDF87FA2020180EDF03F0203804B7E02078115C082020F814B7E021F811500824A81
023E7F027E81027C7FA202FC814A147F49B77EA34982A2D907E0C7001F7F4A80010F835C
83011F8391C87E4983133E83017E83017C81B500FC91B612FCA5463F7CBE4F>65
D<B812F8EFFF8018F018FC8426003FFCC7EA3FFF050F13807113C07113E08319F0A27113
F8A719F05FA24D13E019C04D13804D1300EF3FFE933801FFF891B712E0188018F818FE02
FCC7380FFF80050313C07113E07113F019F8F07FFCA2F03FFEA219FFA38460A419FE187F
A2F0FFFC4D13F85F4D13F0053F13E0BA12C0190018FC18F095C7FC403E7DBD4A>I<9226
07FFC0130E92B500FC131E020702FF133E023FEDC07E91B7EAE1FE01039138803FFB4990
39F80003FF4901C01300013F90C8127F4948151FD9FFF8150F48491507485B4A15034817
01485B18004890CAFC197E5A5B193E127FA349170012FFAC127F7F193EA2123FA27F6C18
7E197C6C7F19FC6C6D16F86C6D150119F06C6D15036C6DED07E0D97FFEED0FC06D6CED3F
80010F01C0ECFF006D01F8EB03FE6D9039FF801FFC010091B55A023F15E0020715800200
02FCC7FC030713C03F407ABE4C>I<B812F8EFFF8018F018FC18FF26003FFCC76C13C005
077F05017F716C7E727E727E727E721380A27213C0A27213E0A21AF084A21AF8A41AFCA5
197FA319FFA51AF8A41AF0A2601AE0A24E13C0A24E13804E1300604E5A4E5A4D485A0507
13E0057F5BBA5A4EC7FC18F818C005F8C8FC463E7DBD50>I<BAFCA4198026003FFEC712
3F1707170183183FA2181FF00FC0A31807EE07C0A3F003E0A3160F95C7FC161F163F16FF
91B6FCA54AC6FC163F161F040F147CA2160719F8A593C71201A219F01803A21807A2180F
F01FE0183F18FF1703173FBAFCA219C0A33E3D7DBC45>I<B912FEA48426003FFEC77E17
0F1703170084A284F01F80A3180FA2EE07C0A2F007C0A4040F90C7FCA2161F163F16FF91
B6FCA54AC6FC163F161F160FA21607A693C9FCACB712E0A53A3D7DBC42>I<922607FFC0
130E92B500FC131E020702FF133E023FEDC07E91B7EAE1FE01039138803FFB499039F800
03FF4901C01300013F90C8127F4948151FD9FFF8150F48491507485B4A1503481701485B
18004890CAFC197E5A5B193E127FA34994C7FC12FFAB0407B612FC127F7FA3003F92C738
3FFE00A27F7EA26C7FA26C7F6C7FA26C7F6C7FD97FFE157F6D6C7E010F01E014FF6D01F8
13036D9038FF801F010091B512F3023F15C00207ED803E02009138FE000E030701E090C7
FC46407ABE52>I<B7D8803FB612E0A526003FFEC8000FEB8000B3A491B9FCA54AC8120F
B3A7B7D8803FB612E0A54B3E7DBD52>I<B71280A526003FFEC7FCB3B3B0B71280A5213E
7DBD28>I<B76C90B6FCA526003FFEC8D801FCC7FCF007F84E5A4E5AF03F804EC8FC18FE
EF03FC4D5A4D5AEF1FC04D5A4DC9FCEE01FE4C5A4C5AEE0FE04C5A4C5A16FF4B7F4B7F5D
4B7F4B7F037F7F92B5FC6E486C7E9238F83FFF03F0804B7E4B6C7F4B6C7F0300804A7F70
7F707F84717E83717F85717F83717F85717F83727E85727F84B7D88007B612C0A54A3E7D
BD52>75 D<B712E0A526003FFEC9FCB3AD183EA4187E187CA418FCA21701A2EF03F8A217
07170F171F177FEE01FF160FB9FC18F0A4373E7DBD3F>I<B6051FB512C06F5EA26F5EA2
D8003F97C7FC6F16F7A26E6CED01E7A26E6CED03C7A36E6CED0787A26E6CED0F07A26E6C
151EA36E6D143CA26E6D1478A26E6D14F0A26F6CEB01E0A36F6CEB03C0A26F6CEB0780A2
6F6CEB0F00A36F6C131EA26F6D5AA26F6D5AA26F6D5AA393387FF1E0A293383FFBC0A270
B45AA37090C7FCA2705AA2705AB600C0031FB612C0A2705AA2705A5A3E7CBD63>I<B603
7FB512E0A2818181D8003F6D9139001F800081A281816E7E6E7F6E7F80826E7F6E7F6E7F
6E7F157F826F7F6F7F6F7F6F7F81836F7F6F7F707E701380A27013C07013E07013F07013
F87013FCA27013FEEF7FFF71139F7113DF8319FF8383838384A28484848484A284B600C0
80197F193F191FA24B3E7DBD52>I<ED3FFF0203B512F0021F14FE027F6E7E902701FFF8
0713E00107D9C00013F84990C7EA3FFCD93FFCEC0FFF49486E7F49486E7F48496E7F4A80
488448496F7EA24890C96C7E4884A249161F003F84A34848701380A400FF19C0AD007F19
806D5EA3003F1900A26D5E6C60A26C6D4B5AA26C6D4B5A6C6D4A5BA26C6D4A5B6C6D4A5B
6D6C4A5B6DB4023F90C7FC6D01C0EBFFFE0107D9F80713F8010190B612E06D5E021F4AC8
FC020314F0DA003F90C9FC42407ABE4F>I<B812F017FF18C018F018FC26003FFCC77FEF
1FFF7113807113C07113E0A27113F0A319F8A819F0A34D13E019C05F4D1380053F1300EF
FFFE91B712F860188005FCC7FC4ACAFCB3A4B77EA53D3E7DBD47>I<ED3FFF0203B512F0
021F14FE027F6E7E902701FFF80713E00107903980007FF84948C7EA1FFCD93FFC6EB4FC
49486E7F49486E7F48496E7F4A8048496F7E488491C9123F48844848707EA34848707EA3
007F1980A24982A200FF19C0AD007F1980A26D5EA2003F1900A36C6C4C5AA26C6C4C5AED
07F06C9026801FFC495A6C4AB45C6E48EB80FF6C9027E07E0FC15B6C9126F807E15B9028
7FF0F003E35BD93FFC6DB5C7FCD91FFE6D5B902607FFF814F80101D9FE0313E06D90B65A
021F4AC7124002036E14E0DA003FEB3F8092C77FF0E001F0F80F71B5FCA21AC083A21A80
83A271140061715B715B725AF01FC043517ABE4F>I<B87E17FCEFFF8018F08428003FFC
000113FE9338003FFF050F7F717F717FA2858385A761A25F61614D5B4D90C8FCEF3FFE4C
B45A91B712F018C04DC9FC717E9126FC000F7F040113F0707F717EA2717EA2717EA685A6
F207C019C0A271140F07E01380B76DEBF01F719038FC3F007190B5FC716C5B061F13F8CB
000113E04A3F7DBD4E>I<903A03FFC001C0011FEBF803017FEBFE0748B6128F4815DF48
010013FFD80FF8130F48481303497F4848EB007F127F49143F161F12FF160FA27F1607A2
7F7F01FC91C7FCEBFF806C13F8ECFFC06C14FCEDFF806C15E016F86C816C816C816C1680
6C6C15C07F010715E0EB007F020714F0EC003F1503030013F8167F163F127800F8151FA2
160FA27EA217F07E161F6C16E06D143F01E015C001F8EC7F8001FEEB01FF9026FFE00713
004890B55A486C14F8D8F81F5CD8F00314C027E0003FFEC7FC2D407ABE3A>I<003FB912
FCA5903BFE003FFE003FD87FF0EE0FFE01C0160349160190C71500197E127EA2007C183E
A400FC183F48181FA5C81600B3AF010FB712F8A5403D7CBC49>I<B76C90B61280A52600
3FFEC9003EC7FCB3B3A4197E011F177C80A26D17FC616D6D14014E5A6D6D4A5A6D6D140F
6D01F8EC3FC0DA7FFEECFF8091273FFFC00F90C8FC020F90B512FC02035D020015E0031F
1480030101F8C9FC493F7DBD50>I<B600FC020FB512C0A5C66C48C9381F8000013F95C7
FC80616D173E6F157E6D177C6F15FC6D5F8118016D6D5D18036D5F6F14076D5F6F140F02
7F5E81181F023F93C8FC6F5C6E153E70137E6E157C8218FC6E6D5B17016E5DEEF0036E5D
EEF8076E5D16FC170F037F5CEEFE1F033F91C9FC705A6F133E17BE17FE6F5BA26F5BA26F
5BA26F5BA36F5BA2705AA270CAFCA24A3F7EBD4F>I<B6D8FC03B600F090B512FEA5C601
FCC7000301F0C8EA7E00017F6F177C856E6E17FC013F63856D6C037F4B5AA26F4A6C1403
6D634D7F6F18076D634D806F02EF150F6D636F01076E131F6D04C793C7FC050F806F0283
5D6D1A3E051F806F0201157E027F197C6F013F6E13FC023FDA3E005D057E806F017C017F
13016E6105FC14FE7048013F13036E6104C1EDFF076E4A6D5C04C31687DCE3E06D138F6E
6104E716CFDCF7C06D13DF6E96C8FC04FF16FF6E4A6D5BA294C77E6F5FA24C80033F5FA2
6F486F5AA24C153F030F5FA24C151F03075FA26F486F5A673F7EBD6C>I<903807FFC001
3F13F848B6FC48812607FE037F260FF8007F6DEB3FF0486C806F7EA36F7EA26C5A6C5AEA
01E0C8FC153F91B5FC130F137F3901FFFE0F4813E0000F1380381FFE00485A5B485A12FF
5BA4151F7F007F143F6D90387BFF806C6C01FB13FE391FFF07F36CEBFFE100031480C6EC
003FD91FF890C7FC2F2B7DA933>97 D<13FFB5FCA512077EAFEDFFE0020713FC021FEBFF
80027F80DAFF8113F09139FC003FF802F06D7E4A6D7E4A13074A80701380A218C082A318
E0AA18C0A25E1880A218005E6E5C6E495A6E495A02FCEB7FF0903AFCFF01FFE0496CB55A
D9F01F91C7FCD9E00713FCC7000113C033407DBE3A>I<EC7FF00107B5FC011F14C0017F
14E09039FFF01FF0489038800FF848EB001F4848EB3FFC120F485AA2485AA2007FEC1FF8
49EB0FF0ED03C000FF91C7FCAB127F7FA3003F153E7F001F157E6C6C147C6C6C14FC9138
8001F86C9038C003F0C69038F81FE06DB512C0011F14800107EBFE009038007FF0272B7D
A92E>I<3901FE01FE00FF903807FF804A13E04A13F0EC3F1F91387C3FF8000713F80003
13F0EBFFE0A29138C01FF0ED0FE091388007C092C7FCA391C8FCB3A2B6FCA525297DA82B
>114 D<90383FFC1E48B512BE000714FE5A381FF00F383F800148C7FC007E147EA200FE
143EA27E7F6D90C7FC13F8EBFFE06C13FF15C06C14F06C806C806C806C80C61580131F13
00020713C014000078147F00F8143F151F7EA27E16806C143F6D140001E013FF9038F803
FE90B55A15F0D8F87F13C026E00FFEC7FC222B7DA929>I<EB07C0A5130FA4131FA3133F
137FA213FF5A1207001FEBFFFEB6FCA40001EBC000B3151FA96CEBE03EA2017F137EECF8
FC90383FFFF86D13F0010713E001001380203B7EB929>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fs cmr8 8 13
/Fs 13 117 df<13031307130E131C1338137013F0EA01E013C01203EA0780A2EA0F00A2
121EA35AA45AA512F8A25AAB7EA21278A57EA47EA37EA2EA0780A2EA03C0120113E0EA00
F013701338131C130E1307130310437AB11B>40 D<12C07E12707E7E7E120FEA07801203
13C0EA01E0A2EA00F0A21378A3133CA4131EA5131FA2130FAB131FA2131EA5133CA41378
A313F0A2EA01E0A2EA03C013801207EA0F00120E5A5A5A5A5A10437CB11B>I<EC0380B3
A4B812FCA3C7D80380C7FCB3A42E2F7CA737>43 D<EB3FC0EBFFF03803E07C48487E4848
7E497E001EEB0780A2003E14C0A248EB03E0A500FC14F0B0007C14E0A3007E1307003E14
C0A36CEB0F806C14006D5A3807C03E3803F0FC3800FFF0EB3FC01C2D7DAB23>48
D<130C133C137CEA03FC12FFEAFC7C1200B3B113FE387FFFFEA2172C7AAB23>I<EB7F80
3801FFF0380780FC380E003F48EB1F8048EB0FC05A0060EB07E012F000FC14F07E1403A3
007C1307C7FCA215E0140F15C0141F1580EC3F00147E147C5C495A495A495A495A011EC7
FC5B5B4913305B485A4848136048C7FC000E14E0001FB5FC5A4814C0B6FCA21C2C7DAB23
>I<EB3FC03801FFF03807C0FC380E007E487FEC1F80003F14C0A2EB800F1300A2000C13
1FC7FC1580A2EC3F00143E5C5CEB03F0EBFFC014F0EB00FC143FEC1F8015C0140F15E0A2
EC07F0A21238127C12FEA3EC0FE012F8006014C00070131F6C1480001EEB3F00380780FC
3801FFF038007FC01C2D7DAB23>I<140EA2141E143EA2147E14FEA2EB01BE1303143E13
06130E130C131813381330136013E013C0EA0180120313001206120E120C5A123812305A
12E0B612FCA2C7EA3E00A9147F90381FFFFCA21E2D7EAC23>I<EB03F8EB0FFE90383E07
80EBF8013901F007C03803E00FEA07C0EA0F80A2391F00078091C7FC123EA2127EA2127C
EB0FC038FC3FF0EBF07C38FDC01EB4487E01001380EC07C04814E0A214034814F0A4127C
A3127EA2003E14E01407121E001F14C06CEB0F803907801F003803C03E6C6C5A38007FF0
EB1FC01C2D7DAB23>54 D<B812FCA3CBFCADB812FCA32E137C9937>61
D<007FB712F8A29039000FC003007C150000701638A200601618A200E0161CA248160CA5
C71500B3A94A7E011FB512E0A22E2D7EAC33>84 D<EA07C012FFA2120F1207AC14FE9038
C3FF809038C703E09038DE01F013F8496C7EA25BA25BB2486C487E3AFFFE1FFFC0A2222E
7EAD27>104 D<1360A413E0A312011203A21207121FB512F0A23803E000AF1418A71438
3801F03014703800F860EB3FE0EB0F80152A7FA81B>116 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Ft cmr12 14.4 33
/Ft 33 122 df<15E01401EC03C0EC0780EC0F00141E5C147C5C495A13035C495A130F5C
131F91C7FC133E137EA25BA2485AA25B1203A2485AA3120F5BA2121FA25BA2123FA290C8
FCA35AA5127EA312FEB3A3127EA3127FA57EA37FA2121FA27FA2120FA27F1207A36C7EA2
12017FA26C7EA2137EA2133E7F80130F8013076D7E8013016D7E147C143C8080EC0780EC
03C0EC01E014001B7974D92E>40 D<12E07E12787E7E7E6C7E7F6C7E6C7E7F1200137C13
7E133E133F7F6D7E80A26D7EA26D7EA2130180A26D7EA380147EA2147FA280A21580A214
1FA315C0A5140FA315E0B3A315C0A3141FA51580A3143FA21500A25CA2147EA214FE5CA3
495AA25C1303A2495AA2495AA25C49C7FC5B133E137E137C5B12015B485A485A5B48C8FC
121E5A5A5A5A1B797AD92E>I<120FEA3FC0EA7FE012FF13F0A213F8A3127F123FEA0F38
1200A513781370A313F013E0A2120113C0120313801207EA0F00121EA25A5A12300D2376
8B21>44 D<120FEA3FC0EA7FE0EAFFF0A6EA7FE0EA3FC0EA0F000C0C768B21>46
D<EC1FF891B5FC010314C090390FF81FF090391FC003F849486C7E017EC7127E49800001
168049141F4848EC0FC0000716E0491407000F16F0A34848EC03F8A2003F16FCA44848EC
01FEA700FF16FFB3A5007F16FEA56D1403A2003F16FCA4001F16F8A26D1407000F16F0A2
6C6CEC0FE0A26C6CEC1FC0A26C6CEC3F806C6CEC7F00017F14FE6D6C485A6D6C485A9039
0FF81FF00103B512C0010091C7FCEC1FF830517BCE3B>48 D<14075C5C147F5C1307133F
000FB5FCB6FC13F913C1EAF0011200B3B3B3A7497F010F13E0B712FEA4274F75CE3B>I<
EC7FE0903803FFFE010F6D7E013F14E0D9FF0013F8D801F8EB1FFCD803E06D7E4848EB03
FF48486D138090C813C0001E16E0001C157F003CED3FF012380078ED1FF81270A2B4ED0F
FC13C07FA66C5A6C5A000EC8FCC9EA1FF8A317F0163FA2EE7FE017C016FF17804B1300A2
4B5A4B5A5E4B5A4B5A4B5A5E4BC7FC15FE4A5A4A5A4A5A4A5A5D4A5A4AC8FC147E5C4948
141CEB03E0495A4948143891C8FC131E5B5B491578485A48481570484815F048B7FCA25A
5A5AB812E0A42E4F7ACE3B>I<000316C001C0140301F8141F903AFFC003FF8091B61200
5E5E5E16E016804BC7FC019F13F8018113800180C9FCB0EC0FF0ECFFFE01836D7E903987
F01FE090399F0007F801BE6D7E01F86D7E496D7E49EC7F805BEE3FC04915E0C9121F17F0
A317F8160FA317FCA5120EEA3F80487E12FF7FA217F85B161F5B48C813F012700078ED3F
E0A26C16C0167F6CEDFF80001F16006C6C495A6C6C13036C6CEB07F8D801F8EB1FF06CB4
EB7FE06DB51280011F49C7FC010713F8010013C02E517ACE3B>53
D<EE03804C7EA34C7EA34C7EA34C7EA34C7EA24C7E16E7A203017F16C3A20303801681A2
DB07017F82A2030E80177FA24B80173FA24B6D7EA20378800370130FA203F0804B1307A2
0201814B7FA24A488183A24AC78083A2020E82187FA24A6F7E021FB7FC4A82A30278C8EA
1FFC0270150FA202F0824A1507A249488284A249488384A249CA7FA24984010E177FA201
1E84193F133E017F8448486C4C7E000F01E04B487EB500FE037FEBFFFEA44F557CD458>
65 D<B812FEEFFFC018F818FE26007FF8C73807FF806D4802017F011F6F6C7E727E727E
727E727EA2727EA2721380A21AC0A384A360A21A80A2601A00A24E5A180F614E5A4E5AF0
FFE04D1380050790C7FCEF7FFC91B712E08418FE02F0C73801FF809438007FE0F01FF872
7EF003FE857213807213C0F17FE0A2F13FF0A21AF8191FA21AFCA81AF8193FA21AF0197F
F1FFE0A24E13C04E1380604E1300F03FFC013FEEFFF8496C02075BBA12C096C7FC18FC18
C046527AD153>I<BB1280A426007FFCC8123F6D48030313C0011F1600193F191F190F19
07A21903A2F101E0A31900A6050E1470A41A00A3171EA3173E177E17FE160791B6FCA491
38F800071600177E173E171EA3170EA31A0EA31A1C94C8FCA41A3C1A38A31A78A31AF0A2
1901A21903A21907F10FE0193F19FF013F1603496C153FBBFC1AC0A347527BD150>69
D<DC1FFC14060303B56C130E031F02F0131E037F14FC912801FFF801FE133E0207903980
001F80DA1FFCC73807C07EDA3FF0913803E0FEDAFFE0EC00F049018015794990C9123D49
48161F4948160F49481607495A494816034A160113FF484916004890CBFC1A7E485AA248
48183EA2121F49181EA2123F5B1A0E127FA397C7FC5B12FFAE127F6D4BB612FEA4003F93
C7003F13806D94380FFE001907121FA27F120FA26C7EA26C7EA26C7F6C7F137F806D7E6D
6C160F6D7E6D7E6D6C161F6D01C0153D6D6D157DDA3FF815F8DA1FFE913803F07E912607
FFC090380FE03E020101FC90387F801E6E6CB538FE000E031F02F81306030302E090C7FC
9226001FFEC9FC4F567AD35C>71 D<49B612FEA490C7003F138092380FFE001507B3B3B3
A21206EA3FC0487E487EA44B5AA25B007F5D0180131F0078C75B6C143F003E4A5A6C5D6C
6C495A2707E003FEC7FC3901FC07FC6CB512F0013F13C0D907FCC8FC2F547BD13C>74
D<B712E0A4C66C90CAFCEB3FFC6D5AB3B3A9191CA51938A61978A319F819F0A218011803
A21807180F181F183F18FF013F1503496C023F13E0BAFCA43E527BD149>76
D<B500FC95B512FCA36E5FD8007FF2F800D93DFF943803BFF0011D62A2011C6DEE073FA3
6E6C160EA36E6C161CA26E6C1638A36E6C1670A36E6C16E0A36E6CED01C0A26E6CED0380
A36E6DEC0700A36F6C140EA36F6C5CA26F6C5CA36F6C5CA36F6C5CA26F6C495AA36F6C49
5AA36F6D48C7FCA393387FC00EA2706C5AA3706C5AA3706C5AA3706C5AA270B45AA3705B
A3013E6E90C8FC137F496C4E7E000701F0027E4B7EB66C4BB612FC173CA35E527AD16B>
I<B500FC030FB512F8A28080D8003FDC007F13006D6DED0FF8735A011D6D6F5A011C6D6F
5AA26E7E81143F6E7E81140F6E7E82806E7F82806F7E82153F6F7EA26F7E6F7EA26F7F83
816F7F83167F707E83161F707E838270138018C0827013E0A2EF7FF0EF3FF8A2EF1FFC18
FE170FEF07FF1981837113C119E183F07FF119F9183FF01FFD19FF8484A28484A284A219
7F193F133E017F171F496C160F000713F0B66C15071903A219014D527BD158>I<B812FC
EFFFC018F818FE26007FFCC7381FFF806D4802017F011F9238007FF0F01FF8727E727E72
7E841A807213C0A21AE0197FA21AF0A91AE0A219FF1AC0A24E13801A00604E5A4E5A4E5A
F07FE04D485A051F90C7FC91B712FC18F0188002F8CBFCB3AE497E497EB7FCA444527BD1
50>80 D<B812C017FEEFFFC018F026007FFCC713FC6D48EC0FFF011F03017F9438007FE0
727E727E727E180785727EA28684A286A762A26097C7FCA24E5A614E5A4E5A4E5AF0FFC0
4D90C8FCEF0FFEEFFFF891B712C04DC9FC839126F8000113C09338003FF0EF0FFC717EEF
01FF85717F727EA2727EA2727EA985A81B0785180FA21B0F0607140E496C82496C6F141E
B76EEB801C72EBC03C96387FE0F896381FFFF0CC000713E09638007F8050547BD156>82
D<ECFFC0010F13F8013F13FE9039FF00FF80D801F0EB3FE0D803C0EB0FF0486C6D7E01F8
6D7E000F816D13016F7EA3707E6C5AEA01E0C9FCA6ED3FFF020FB5FC9138FFFC7F010713
00EB1FF0EB7FC04848C7FCEA03FC485A485A485A123F5B485A187012FF90C8FCA216FFA3
5D6D14BF007F14036DEB073F6C6C90390F1FC0E06C6C131E6C6C90393C0FE1C02707FE01
F013FF0001B5486C13806C6C90398003FE00D907FCC712F834367BB43B>97
D<EB7F80B5FCA41203C6FC137FB3A6ED07FC92387FFF800281B512E0913987F00FF89139
8F8001FC029EC7B4FC02BC6E7E02F86E7E4A6E7E4A6E7E4A1407844A6E7EA2841701A284
A283A21980AB19005FA360A24D5AA24D5A804D5A6E5D6E4A5AD97E784A5A6E4AC7FCD97C
1EEB01FE6E495A903A7807E01FF00201B512C0902670007F90C8FC90C7EA0FF839547DD2
41>I<EC0FFE91387FFFE049B512F8903907F801FE90391FE0001FD93F80EB078049C7EA
0FC001FE143F484815E00003157F485A485AA2485AEE3FC0003FED0F004991C7FCA2127F
A35B12FFAB127F7FA3123F6D1570121F6D15F0000F16E06D140112076C6CEC03C06D1580
6C6C14076C6DEB0F00D93FC0131E6D6C137C903907FC03F06DB55AD9007F1380DA0FF8C7
FC2C367CB434>I<17FF4BB5FCA4ED0007160182B3A6EC0FF8EC7FFF49B512E0903907FC
03F090391FE0007C49487F49C7120F01FE80484880485A000781484880A2485AA2485AA2
127FA35B12FFAB127FA27FA2123FA27F121FA26C6C5C00075D7F6C6C5C6C6C5C6C6C021E
7F6D6C017C13E0D91FC049EBFF8090390FF807E00103B512800100495ADA1FF091C7FC39
547CD241>I<EC0FF891B5FC010314C090390FF80FF090391FC003FC90397F8001FE49C7
7E4848EC7F804848143F49EC1FC0485A000FED0FE05B001F16F01607485AA2007F16F8A2
5B160312FF90B7FCA30180C9FCA8127F7FA2123FA26D1538121F17786C6C1570000716F0
6D15E06C6C14016C6CEC03C06C6C15806D6C130F6D6CEB1F00D90FF0133C903907FE01F8
0101B512E06D6C1380DA07FCC7FC2D367DB434>I<EB7F80B5FCA41203C6FC137FB3A6ED
07FC92383FFF8092B512E0913981F00FF8913983C007FC9139870003FE028E1301029C6D
7E14B814B002F06E7E5CA25CA35CB3AD2601FFE0903801FFE0B600C0B612C0A43A537CD2
41>104 D<EBFF80B5FCA41203C6FC137FB3A793B512F8A4043F138093381FFC0017F017
C094C7FC163E5E5E4B5A4B5AED07804BC8FC151E5D15FC1481EC83FEEC87FF148F029E7F
9138BC7FC0ECF83F02F07F4A6C7EECC00F02807F4A6C7E6F7EA26F7E6F7F167F83707E16
1F83707E160783707E8318802601FFC04913E0B6D8803F13FFA438537DD23E>107
D<01FFD907FEEC03FFB590261FFFC0010F13E0037F01F0013F13F8912701F80FFC9038FC
07FE913D03C003FE01E001FF000390260700019038038000C6010E6D6C48C76C7E6D48DA
7F8E6E7E4A159CA24ADA3FF86E7E02605D14E04A5DA34A5DB3AD2601FFE0DAFFF0EC7FF8
B6D8C07F9026FFE03FB512F0A45C347CB363>109 D<01FFEB07FCB590383FFF8092B512
E0913901F00FF8913903C007FC000349C66C7EC6010E13016D486D7E5C143002706E7E14
6014E05CA35CB3AD2601FFE0903801FFE0B600C0B612C0A43A347CB341>I<EC0FFC9138
7FFF8049B512E0903907F807F890391FE001FE90393F80007F017EC7EA1F80496E7E4848
6E7E00038248486E7EA248486E7EA248486E7EA2003F82A24848ED7F80A400FF17C0AB00
7F1780A26D15FFA2003F1700A2001F5E6D1401000F5E6D140300075E6C6C4A5A6C6C4A5A
A2D8007FEC3F806D6C49C7FC90391FE001FE903907F807F86DB55AD9007F1380DA0FFCC8
FC32367CB43B>I<01FFEB1F80B5EB7FF0913801FFF8913803E1FC91380783FE0003EB0F
07C6131EEB7F1C1438143091387003FC91386000F0160014E05CA45CB3AA8048487EB612
F0A427347DB32E>114 D<EB01C0A71303A41307A3130FA2131FA2133F137F13FF5A5A00
1F90B512E0B7FCA326003FC0C7FCB3A71638AC6E1378011F1470A26D6C13F016E0903807
F801903903FC03C0903901FE07806DB51200EC3FFCEC07F0254B7EC92E>116
D<B60103B51280A4000301F09039007FF800C601C0EC3FE0017FED1F8095C7FC133F171E
6D7E171C6E143C010F1538A26E1478010715708001035DA26E130101015D806D4A5AA2ED
8007027F91C8FC15C0023F130EA2EDE01E021F131CA26E6C5AA2EDF87802071370A26E6C
5AA215FF6E5BA26E5BA36FC9FCA2153EA3151C39347EB23E>118
D<B60007B5D8F007B5FCA400039027E0001FFEC713F06C0180D90FF8EC7FC06C0307ED3F
80F21F00017F0203151EA26D6C801A1CA26D6C496C5CA26E6E1478010FDA0E7F1470A26E
6F13F00107DA1C3F5CA26EEDC0010103DA381F5CA26E0178EBE0030101DA700F5CA26E01
F0EBF0076DDAE00791C7FCA2DA7F81ECF80EEEC003A2DA3FC36E5AEE8001A2DA1FE76E5A
93C7FCA2DA0FFEEC7F70A219F06E486E5AA36E486E5AA36E486E5AA36E486EC8FC50347E
B255>I<B60103B51280A4000301F09039007FF800C601C0EC3FE0017FED1F8095C7FC13
3F6E141E131F171C6E143C010F15388001075DA26E14F001035D8001014A5AA26E13036D
5D1580027F49C8FCA26F5A023F130E15E0021F5BA2EDF03C020F133815F802075BA2EDFC
F002035B15FE6E6C5AA36E5BA26FC9FCA3153EA2151CA2153C153815781570A215F05D14
015DA2003E495A127F486C48CAFCA2140E141E495A6C5B007C5B383F03E06CB45A00075B
D801FCCBFC394B7EB23E>121 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fu cmr17 20.74 33
/Fu 33 122 df<DD3FF8ED0FFE0407B592B512C0043F02C0010714F09327FFC00FF09039
3FF803FC922803FE0001F89039FF80003FDB0FF09027007C01FEC7EA0F80DB3FE091261E
07FC6E7EDB7F8091260F0FF014034A48C82607BFE06E7E4A4892261BFFC0EC07F04A4803
7F49141F4A484AB5C8127F4B4A4982021F1BFF4A485EA24A485EA24A485E72715A785A49
90C96C486F5A073F93C9FCB3A6F61FF8C0FCA5D8000190C9D83FE0C8FC1E3F1E1FA21E0F
B3B3B3A4496D4B6C4B7E010F01E0912601FFFCED7FFF001FB6D8F003B600FE90B71280A5
79797EF881>14 D<EA0780EA1FE0EA3FF0EA7FF8EAFFFCA6EA7FF8EA3FF0EA1FE0EA0780
0E0E728D2B>46 D<ED7FF00207B57E023F14F091B612FC4915FF902707FE007F13C0D90F
E0010F7FD91F80010113F849C87F017CED3FFE496F7E48486F138048486F13C048488171
13E0484817F090CAFC48EF7FF8121E003EEF3FFC123CA2007CEF1FFE1278A2EA7FC0D8FF
F0EE0FFF7F7F7FA76C5A6C5A6C5AD807C0EE1FFECBFCA3F03FFCA3F07FF8A219F018FF19
E05F19C04D1380A24D130060170F4D5A604D5A4D5A604D5A4C90C7FC4C5A4C5A5F4C5A4C
5A4C5A4C5A94C8FC16FE4B5A4B5A4B5A4B5A4B5A4B5A4BC9FC157E5D4A5A4A5A4A5A4A5A
4A4815074AC9FC143E4A160E5C495A495A495A495A49CA121E011E171C5B5B49173C485A
4848177C4848EE01FC48B912F8A25A5A5ABAFCA219F0A3407279F14F>50
D<ED1FFE4AB512E0020F14FC023F14FF9126FFE00713C0D903FEC713F0D907F0EC3FF8D9
1FC06E7E49C8EA07FE017E6F7E017883496F7F48486F7F120349834848167F01F88313FE
6D6C153F486D82A4805CA37E6C5B6C48C95BD80078167F90CAFCA261A218FF61A24D5B61
5F96C7FC4D5A60170F4D5AEF3FE04D5A4D5A4C48C8FCEE07FCEE1FF092381FFFC091260F
FFFEC9FCA2EEFFE091C7EA07FCEE00FFEF3FC0EF1FF0717EEF07FE717E717F717F85727E
727EA285727EA2727EA31A80A2841AC0A3EA07E0EA1FF8487E487EB5FCA51A80605BA26C
48180013F001C05E007CCA5B7E4E5A7E6D4C5A6C6C5F000717FF01F04B5B6C6C4B5B6C6C
5F6CB4030F90C7FC6D6C4A5AD93FF04A5AD90FFCECFFF8902707FFE00713E0010190B612
806D6C92C8FC020F14F8020314E09126001FFEC9FC42757AF14F>I<EA0780EA1FE0EA3F
F0EA7FF8EAFFFCA6EA7FF8EA3FF0EA1FE0EA0780C7FCB3B3AAEA0780EA1FE0EA3FF0EA7F
F8EAFFFCA6EA7FF8EA3FF0EA1FE0EA07800E4A72C92B>58 D<BA12FCF1FFE01AFC1AFF1B
C0D8003F01F0C8003F13F0010749030113FC4B9238003FFF6D060F7F08037F080013F075
7E757EF30FFE757E757F757F87767E89767E767E1C0F891C0789767FA2767FA2767FA28A
1D7FA28A1D3FA28AA21D1F8AA48A89A51F80B11F00A56566A4661D3FA3661D7F66A21DFF
66A2525BA2525BA25290C7FC651C0F525A651C3F525A525A515B515B5190C8FC515A515A
F37FF8515A08035B080F138049063F90C9FC6F923801FFFC013F6D031F5BBC12E01B8008
FCCAFC1AE007FCCBFC697678F57A>68 D<BD12FEA5D8003F01F0C96C7F01074916034BEE
007F6D190F871B018788A2F43F801C1FA21C0FA21C07A31C03A21DC0A31C01A6F400E019
1CA41D00A5193CA4197CA219FC18011803180F18FF92B7FCA503C0C7FC180F1803180118
00197CA2193CA4191CA41D07A41D0E96C9FCA51D1E1D1CA41D3CA31D381D78A31DF8A21C
01A2F403F0A21C07A21C0F1C1F1C3FF4FFE0631B0749191F6F4CB5FC013F6D163FBEFC1D
C0A4607678F56C>I<B8FCA5D8003FEBFC00010713E0A26D5BB3B3B3B3B3AC497FA2013F
13FCB8FCA5287678F538>73 D<B812E0A5D8003F49CCFC010713F05D6D5BB3B3B3AC1C70
A51CE0A81B01A31CC01B03A41B07A21B0FA21B1FA2F33F80A21B7F1BFF62621A0F621A7F
494DB5FC6F150F013F6D4AB61200BDFCA5547678F563>76 D<B600E00803B61280A36F62
A227003FBFF8080E49C7FC01071EF0A29026039FFC505BA3DA8FFE62A3DA87FF62A20283
6D61A302816D4E5AA302806D4E5AA26F6C4E5AA36F6C180EA36F6C60A36F6C60A26F6C60
A36F6D5FA36F6D4C5AA26F6D4C5AA3706C4CC7FCA3706C160EA3706C5EA2706C5EA3706C
5EA3706D5DA2706D4A5AA3706D4A5AA3716C4AC8FCA3716C140EA2716C5CA3716C5CA371
6C5CA2716D5BA3716D485AA3716D485AA3726C48C9FCA295383FF80EA3726C5AA3726C5A
A2726C5AA3725BA3496C6F5BA2497E725B496C517FD97FFC70C9FC0003B56C080F13FEB6
00FE073FB71280193EA3191C817678F592>I<943801FFF0053FEBFF804CB612F0040F90
38001FFEDC3FF0903801FF80DCFF809038003FE0DB03FEC8EA0FF8DB0FF8ED03FEDB1FE0
ED00FFDB7FC0EE7FC04B48707E4A48CAEA0FF0DA07FCEF07FC4A48717E4A48717E4A4871
7F4A48727E02FF864949727E92CC121F4948737E0107874948737E4A1903011F87494873
7FA24948737FA24948747E4889A24849747EA34890CE6C7EA24889491B0FA2001F89A348
48751380A5007F1EC0A24987A400FF1EE0B16C6C5113C0A6003F1E806D63A3001F1E00A2
6D636C65A36C6D505AA36C6D505AA26C6D505AA26C656E61017F646D6C4F5BA26D6C4F90
C7FCA26D6C4F5A6D6C4F5A6D636F183F6D6D4E5A6D636E6C4E5A6E6C4D5B6E6C4D90C8FC
6E6C4D5A6E6C4D5A6E6C4D5A02006DEE3FE0DB7FE0EEFFC06F6C4B5BDB0FFCDB07FEC9FC
DB03FEED0FF8922601FFC0EC7FF09226003FF0903801FF80DC0FFFD91FFECAFC040390B5
12F8DC003F1480050101F0CBFC6B7C78F87C>79 D<BA12F0F1FF801AF01AFCF2FF80D800
3F01F0C86C7F010749030713F04B030013FC6DF03FFEF20FFF747F08017F747F757E8875
7E1B1F881B0F88A2751380A21DC0A287A21DE0AA1DC0A263A21D80A2511300A2641B1F64
515A515A1BFF6408035B5090C7FC505AF23FFCF2FFF007075B077F138092B848C8FC1AF0
1A8007F0C9FC03C0CDFCB3B3AB497FA2013F13FCB8FCA55B7678F56C>I<DB3FF815E002
03B512C0021F02F81301027F14FE49B7128049D9C007EBC003D90FFEC7EA3FF0D91FF891
3807F807D93FE0EC01FC4948913800FE0F4948153F4890C9EA1F9F4848EE0FDF49EE07FF
484882000F834982121F49177F003F183F5B191F127F190F5B190712FFA21903A31901A2
7FA36D1700A2127F7F7F1A006C7E7F7F6C7F806C7F14F86C7F6CEBFF8015F86CECFF806C
15F86DECFF806D15F06D15FF6D16E0010316F86D16FE6D6C81021F16C0020382DA003F81
030781DB007F80040780DC007F7F050F14801700063F13C07213E018077213F084841AF8
197F193F1AFC191FA2190F00E019FE1907A41903A27EA57E1AFCA27E19077E1AF86C180F
A26D18F0191F6D18E06D173F6D18C06DEF7F806D17FF017E4C13006D6C5E486C6C4B5AD9
0FF0ED0FF826FC07FC4B5AD901FF4B5A486C01F0ECFFC091273FFF800F5B48010F90B548
C7FC020315F8020015E048020F14809226007FF8C8FC477C78F858>83
D<001FBE12F8A502F8C7000F01F0C7121F4801806E49020113FC01FCC86C49EC003F491B
1F01E01B07491B03491B0190C91800A2003E1D7CA2003C1D3CA3481D1EA500701D0EA848
1D07A6CA1900B3B3B3B14D7F4D7F057F13FE031FB812F8A568757BF473>I<B700F00503
B612C0A5C602FCCC003FEBFC00011F01E0070F13E06D497313807748C7FC6D64775A7F6F
627F666F19036D64811D07027F6381023F50C8FCA26F61021F1A1E811D3E6E1A3C826E62
A27018F86E62821C016E62826E4F5AA2701707037F61821C0F033F96C9FC82031F181EA2
70173E6F183C831C7C6F1878836F60A27115016F60831B036F6083047F4C5AA271150F04
3F94CAFC8363041F161E83705EA272147C701678841BF8705E84704B5AA2721303705E84
1A07057F5D84053F4ACBFCA2725B051F141E841A3E71143C1980715CA2F1C0F8715C19E0
19E1715C19F171EBF3C0A219FF725BA37290CCFCA2725AA3725AA3725AA2725AA3725A72
797EF577>86 D<913803FF80021F13F891B512FE903A03FC01FF80903A07E0003FE0D91F
80EB0FF8013EC76C7E496E7E01F06E7E48486E7F717E4848153F4982D807A06F7E13FC48
7E6D6F7E80A2717EA46C90C8FC6C5A6C5ACAFCA6EE07FF0303B5FC157F913903FFFE0702
1F138091387FF800903801FFC0010790C7FCEB1FFCEB3FF0EBFFE0485B485B4890C8FC5B
485A485AA2485A1A0E485AA312FF5B170FA4171FA26D153F007F163B177B6DDBF1FE131C
003F16E16C6C14016C6C912603C0FF13386C6CEC0F806C6C6C903A1F007F80706C6D017C
ECE1E028007FF803F8EB3FFF011FB500E06D1380010391C7000713009026003FF8EC01FC
474D79CB4F>97 D<ED07FE92387FFFE00203B512FC91390FFC01FF913A3FE0001FC0DA7F
80EB03E0D901FEC812F84948157C494881494881494881013FEE0780494815034948ED0B
C048177F91C9EAFFE048485D00075EA2485AA2485AA27113C0003F70138049EE7F0095C7
FC127FA35BA212FFAE127F7FA4123F7FA2121F6D1738120F19786C6C1770A26C6C17F019
E06C6D15016C18C06D6C15036D6CED07806EED0F006D6C151E6D6C153ED903FE5D6D6C15
F06D01C0EB03E0DA3FF0EB0FC0DA0FFE01FFC7FC0203B512FCDA007F13E0030790C8FC3D
4D7BCB46>99 D<191FF07FFF051FB5FCA5EF001F180784A284B3B0ED07FE92387FFFC002
03B512F091390FFC01FC91393FE0001FDAFF80EB07814990C7EA03E1D903FCEC01F14948
EC0079D91FF0153D4948151D4A151F49488101FF824890C9FC48835B0007835B120F5B12
1FA2123F5BA2127FA35BA212FFAE127FA27FA3123FA36C7EA36C7EA200075F7F00035F6C
7E606C6D5D6D6C153D013F16396D6C03797F6D6C15F16D6CDA03E17FD903FEDA078113F0
D900FFDA1F01EBFFF0DA7FC0137E91391FF803F80207B512E0020114809127001FF800EC
80004C797AF758>I<ED1FFC4AB512C0020714F091391FF00FFC91397F8001FFD901FEC7
EA7FC049486E7E49486E7E49486E7E49486E7E49486E7E4948140101FF824890C91380A2
4848EE7FC0A2485A000FEF3FE05BA2001F18F0181F485AA3007F18F8A349160FA212FF90
B9FCA301E0CBFCAB127F7FA3123FA36C7EA219386C7E1978000718707F000318F06C6C17
E018016C6DED03C06D6C1680013F16076D6CED0F006D6C151E6D6C5D6D6C5D6DB44A5A6D
6C6C495ADA3FE0EB1F80DA0FFE01FEC7FC0203B512F8DA007F13E0DB07FEC8FC3D4D7BCB
46>I<EE7FC0923803FFF8030F7F92383FC07F9239FF000F804A48EB3FC04A48137F4A48
EBFFE04A485AEC1FE0143F15C0147F158002FF6D13C0EF7F804990C7EA0C0094C7FCA349
5AB3A9B812C0A5260003FEC9FCB3B3B3A7805B011F13E0001FB612F8A533797DF82F>I<
F103F8F13FFEDB1FF891B5FC92B5903903FC078002079139E007E01F913D1FF00FF81F80
3FC0913B3FC003FC3E0002FFC7B45A49486E5A49486E5A49486E48EB1F8049486E6CEB06
0097C7FC49486E7E013F82A249486E7EA201FF82A24A80A24884AA6C95C8FCA26E5CA201
7F5EA26D6C4A5AA2011F5E6D6C4A5AA26D6C4A5A6D6C4A5A496C4A5A6E4AC9FC903A0F3F
C003FC903A1E1FF00FF80207B512E0D91C0091CAFC013CEB1FF892CCFCA25BA3137CA413
7EA27F8080EB1FF091B612FE6DEDFFF818FF6D17E06D17F8010017FE010383010F84D93F
E0C7000114E001FFC9120FD801FC04017F48489338003FF84848171F4848717E48481707
003F727E49170148CBFC737EA200FE85A76C616C616D1701003F616D17036C6C4D5A6C6C
4D5A6C6C4D5A6C6C4D5A6C6C4D5A26007F80DB01FEC7FCD93FE0ED07FCD90FF8ED1FF0D9
03FFEDFFC0010001F8011F90C8FC021FB612F802011580DA000F01F0C9FC4A707DCC4F>
I<14F8EA03FFB5FCA5C6FC133F131FA2130FB3B0933803FF80041F13F8047F13FE923A01
FC03FF80923A03E0007FE0DB0F80EB1FF0031EC76C7E5D4B6E7E4B6E7E5D14F9DAFBC06E
7E5D14FF92C9FC865CA35CA45CB3B3A8496C4B7FD97FFF030713F0B7D8800FB612F8A54D
787AF758>I<131EEB7F80497E487F487FA66C5B6C5B6D5A011EC7FC90C8FCB3A7EB01F0
EA07FFB5FCA51201EA007F133FA2131FB3B3B3A3497EEBFFFEB612FCA51E727AF12A>I<
EB01F0EA07FFB5FCA51201EA007F133FA2131FB3B3B3B3B3AC497EEBFFFEB612FEA51F78
7AF72A>108 D<D901F0902601FFC0ED0FFED807FF021F01FC92B512E0B5027F01FF0203
14F8922601FC0101C090390FE00FFE922803E0003FE090391F0001FFDB0F80D91FF8017C
6D13C04BC7000F4A147FC6023C912707FC01E06E7E013F496E6C48486E7E011F0170DA01
FF496E7E03F0160790260FF1E04CC8FCDAF3C06E019E6F7E4B169C02F717BC92C913B802
FFDC7FF86F7E4A5FA34A5FA44A5FB3B3A8496C4C6C4B7ED97FFF030301F8031F13C0B7D8
8007B600FC013FB612E0A57B4B7ACA86>I<D901F0903803FF80D807FF021F13F8B5027F
13FE923A01FC03FF80923A03E0007FE0DB0F80EB1FF0031EC76C7EC65C013F496E7E011F
496E7E5DEB0FF1DAF3C06E7E5D14F792C9FC02FF835CA35CA45CB3B3A8496C4B7FD97FFF
030713F0B7D8800FB612F8A54D4B7ACA58>I<ED07FE92387FFFE00203B512FC91390FFC
03FF913A3FC0003FC04AC7EA0FE0D901FEEC07F8D903F8EC01FC49486E7E4948157F4948
6F7E49486F7E017F8349C96C7E4916070001844848707EA2000784491601000F84A24848
701380A2003F19C0A349177F007F19E0A412FF1AF0AD007F19E0A26D17FFA2003F19C0A4
6C6C4C1380A2000F1900A26C6C4C5AA26C6C4C5A0001606D160F6C606D6C4B5A6D6C4B5A
A26D6C4B5AD907F003FEC7FCD903FCEC03FC6D6C4A5A6D6C6CEB1FF0DA3FE0EB7FC09127
0FFC03FFC8FC0203B512FCDA007F13E0DB07FEC9FC444D7BCB4F>I<D903E0EB1FE0D80F
FFECFFFCB501037F923907E01F8092391F807FC092383E00FF4B4813E000011478D8007F
13F090383FE1E015C0EB1FE39126E7800013C0EF7F8092C7EA3F0002EF91C7FC14EE14FE
5CA45CA55CB3B3A480133F90B5FCB712C0A5334B7ACA3D>114 D<DA1FFFEB038049B512
E0010FECF807903A3FE001FE0F01FEC7EA1F9FD801F8EC07DFD807E0EC03FF4848804980
48C9127F48163F003E161F127E170F127C12FC1707A46C1603A27E7F6C7E7F6D92C7FCEA
3FFC13FF6C13E06C13FF6C14F06CECFF806C15F86C15FE013F6E7E010F15E00103810100
81020F14FEDA007F7F1503DB003F1380040713C0040113E000E081177FEF3FF06C161F17
0FEF07F8A217037E1701A27EA37E18F07E17036D16E0A26D15076DED0FC06D168000FE16
1F017CED3F00486C157E6DEC01F826F80FC0EB07F026F003F8EB7FC00100B6C7FC48013F
13FC02071380354D7CCB3E>I<1407A85CA65CA35CA35CA25CA25BA25B5B5B5B5B5B48B7
12FE120FB8FCA3D8000190C9FCB3B3A2EF01C0B0EF03806D7FA3027FEC0700815F6E6C13
0E021F141E6F131C6E6C5B6E6C13F8913901FF01F09139007FFFC0031F5BDB03FCC7FC32
6B7EE93D>I<02F8EE0F80D803FFEE3FFFB5030FB5FCA5C6EE000F013F1603011F82A201
0F82B3B3A660A460A3601307606E150E0103161E606E4B7F010116706D6C03F07F6FD903
E013F86E6C4948EBFFF8DA1FE0EB1F00DA0FFE13FE0203B512F8DA007F13E0030790C7EB
C0004D4C7ACA58>I<B600F0017FB500F849B512FCA5000149C849C8003F13E026007FF8
DB3FF8030F13004A031F705A013F4DED03F8180F011F755A735E6D6C1507667315036D6C
63A24E7E6D6C50C7FC85606D6C031C160E866FEC387F6D63866FEC703F027F62866FDAE0
1F1578023F1A70866F902601C00F15F0021F62866F90260380071401020F62866F902607
00031403020762866F010E01011407020397C8FC866F496D5C6E190E053C1580DC803802
7F131E6E191C057815C0DCC070023F133C037F183805F015E07048021F1378033F187004
E116F092261FF1C0020F5BA204F316F892260FFB80913807F9C0A204FF16FD6F90C86CB4
5AA36F486F90C9FCA36F486F5AA36F48167CA24C163C047016386E4B7EC973>119
D<B600F84AB512FCA5000191C9003F13C026007FFC040F13006D4817FC011F715A62010F
715A6E5F13076E4C5A130397C7FC6E5E6D170E816D5FA26F153C027F163881023F5EA26F
15F0021F5E81020F4B5AA26F140302075E8102034BC8FCA26F5C6E150E826E5DA270133C
037F143882033F5CA27013F0031F5C82030F495AA2EEFC0303075C16FE030349C9FCA270
5A6F130E178E6F139CA217FC705AA2705AA3705AA2705AA3705AA294CAFCA25E160EA25E
A2163C1638A25EA216F05EA24B5A120FD83FC01303486C5C486C130793CBFC5D150E5D15
3C6C485B495B6C48485A383C0003001F495A260FE03FCCFC3803FFFE6C13F838003FE04E
6C7EC953>121 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fv cmr12 12 90
/Fv 90 124 df<B91280A300019038C000036C6C489038003FC0171F17071703A21701A2
EF00E0A31860A418701830A31800B3B3A58048487EB612F8A334447CC33D>0
D<BAFCA3D87FE0C8123F050313806C6CED007F6C6C163F181F6C6C160F6C6C160718036C
6C17C06C1701806C7F017F1600806D7E011F17E06E16606D7E13076E16006D7E7F816D7F
147F816E7E141F816E7E1407A214036E5A5D6E5A4A5A4A5A92CAFC5C140E5C4A16605C5C
4A16E0010117C0495A49CAFC010E16015B5B4916030160178001E016074848160F484816
1F48CA123F000E177F48EE03FF0018167F003FB912005ABAFCA23B447BC346>6
D<9239FFC001FC020F9038F80FFF913B3F803E3F03C0913BFC00077E07E0D903F890390F
FC0FF0494890383FF81F4948EB7FF0495A494814E049C7FCF00FE04991393FC003804902
1F90C7FCAFB912F0A3C648C7D81FC0C7FCB3B2486CEC3FF0007FD9FC0FB512E0A33C467E
C539>11 D<4AB4FC020F13E091387F80F8903901FC001C49487FD907E0130F4948137F01
1FECFF80495A49C7FCA25B49EC7F00163E93C7FCACEE3F80B8FCA3C648C7FC167F163FB3
B0486CEC7FC0007FD9FC1FB5FCA330467EC536>I<913801FFC0020FEBFB8091387F803F
903801FC00494813FFEB07E0EB1FC0A2495A49C7FC167F49143F5BAFB8FCA3C648C7123F
B3B2486CEC7FC0007FD9FC1FB5FCA330467EC536>I<DBFF80EB3FE0020F9039F001FFFC
913B3F807C0FF01F913CFC000E3F800380D903F86D48486C7E4948D90FFC804948D93FF8
130F4948017F4A7E49485C49C75BA25B494B6D5A041F6E5A96C8FCACF107F0BBFCA3C648
C7391FC0001F190F1907B3B0486C4A6C497E007FD9FC0FB50083B512E0A34B467EC551>
I<EA03F0EA0FFCEA1C0EEA300338600180A238C000C0A538600180A238300300EA1C0EEA
0FFCEA03F0121165C649>23 D<121EEA7F80EAFFC0A9EA7F80ACEA3F00AB121EAC120CA5
C7FCAA121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A4778C61B>33
D<001EEB03C0397F800FF000FF131F01C013F8A201E013FCA3007F130F391E6003CC0000
EB000CA401E0131C491318A3000114384913300003147090C712604814E0000614C0000E
130148EB038048EB070048130E0060130C1E1D7DC431>I<EC03F0EC0FF8EC3E1EEC7C0E
4A7E49487E130302E07F01071301A3EB0FC0A4150393CAFC14E05D1506150E5D15180107
13386E5A156015E0ECF1C0DAFB800107B512C06DB4C7FC5C4A9139007FFC000101EE1FE0
19806E6FC7FC0100160E497E495E496C6C1418010E1638496C6C1430011816709026381F
E05C01705E496C6C1301D801C06D5C000301071403D807806D91C8FC000F6D6C5B001F01
01140E003F6E130C90C7EB801C48027F5BEEC0304891383FE070031F5B705AED0FF99238
07FB806D6DB4C812C05E6F7E007F6E6D13016D6E6C14804C6C13036C6C496D1400001F91
2603CFF85B6C6C90260F07FC130E6C6C90263E01FE133C3D03FE01F800FF80F8C6B54890
383FFFF0013F0180010713C0D907FCC890C7FC42497CC64C>38 D<121EEA7F8012FF13C0
A213E0A3127FEA1E601200A413E013C0A312011380120313005A1206120E5A5A5A12600B
1D78C41B>I<140C141C1438147014E0EB01C01303EB0780EB0F00A2131E5BA25B13F85B
12015B1203A2485AA3485AA348C7FCA35AA2123EA2127EA4127CA312FCB3A2127CA3127E
A4123EA2123FA27EA36C7EA36C7EA36C7EA212017F12007F13787FA27F7FA2EB0780EB03
C01301EB00E014701438141C140C166476CA26>I<12C07E12707E7E7E120F6C7E6C7EA2
6C7E6C7EA21378137C133C133E131E131FA2EB0F80A3EB07C0A3EB03E0A314F0A21301A2
14F8A41300A314FCB3A214F8A31301A414F0A21303A214E0A3EB07C0A3EB0F80A3EB1F00
A2131E133E133C137C13785BA2485A485AA2485A48C7FC120E5A5A5A5A5A16647BCA26>
I<14F0A2805CA70078EC01E000FCEC03F0B4140FD87F80EB1FE0D83FC0EB3FC03A0FF060
FF003903F861FC3900FC63F090383F6FC0D90FFFC7FCEB03FCEB00F0EB03FCEB0FFF9038
3F6FC09038FC63F03903F861FC390FF060FF3A3FC0F03FC0D87F80EB1FE0D8FF00EB0FF0
00FC14030078EC01E0C790C7FCA7805CA2242B7ACA31>I<16C04B7EB3AB007FBAFCBB12
80A26C1900C8D801E0C9FCB3AB6F5A41407BB84C>I<121EEA7F8012FF13C0A213E0A312
7FEA1E601200A413E013C0A312011380120313005A1206120E5A5A5A12600B1D78891B>
I<B612C0A61A067F9721>I<121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A0A78891B>I<16
18163C167CA2167816F8A216F01501A216E01503A216C01507A21680150FA2ED1F00A215
1E153EA2153C157CA2157815F8A25D1401A24A5AA25D1407A25D140FA292C7FC5CA2141E
143EA2143C147CA25CA25C1301A25C1303A25C1307A25C130FA291C8FC5BA2133EA2133C
137CA2137813F8A25B1201A25B1203A2485AA25B120FA290C9FC5AA2121E123EA2123C12
7CA2127812F8A25A126026647BCA31>I<14FF010713E090381F81F890383E007C01FC13
3F4848EB1F8049130F4848EB07C04848EB03E0A2000F15F0491301001F15F8A2003F15FC
A390C8FC4815FEA54815FFB3A46C15FEA56D1301003F15FCA3001F15F8A26C6CEB03F0A3
6C6CEB07E0000315C06D130F6C6CEB1F806C6CEB3F00013E137C90381F81F8903807FFE0
010090C7FC28447CC131>I<143014F013011303131F13FFB5FC13E713071200B3B3B049
7E497E007FB6FCA3204278C131>I<EB03FE90381FFFC0017F13F03901F80FFC3903C001
FE48486C7E000EC7EA7F8048EC3FC0ED1FE04815F00030140F007015F800601407126CB4
15FC7F7F1503A46C4813076CC7FCC8FC16F8A2150F16F0151F16E0A2ED3FC0ED7F801600
5D5D4A5A4A5A4A5A5D4A5A4A5A4AC7FC147C5C5C495A495A495A49C7120C131E5B013814
185B5B485A4848143848C81230000E1570001FB612F0A25A5AB712E0A326427BC131>I<
49B4FC010F13E0013F13FC9038FE01FE3A01F0007F80D803C0EB3FC048C7EA1FE0120EED
0FF0EA0FE0486C14F8A215077F5BA26C48130FEA03C0C813F0A3ED1FE0A2ED3FC01680ED
7F0015FE4A5AEC03F0EC1FC0D90FFFC7FC15F090380001FCEC007FED3F80ED1FC0ED0FE0
16F0ED07F816FC150316FEA2150116FFA3121EEA7F80487EA416FE491303A2007EC713FC
00701407003015F80038140F6C15F06CEC1FE06C6CEB3FC0D803E0EB7F803A01FE01FE00
39007FFFF8010F13E0010190C7FC28447CC131>I<ED0380A21507150FA2151F153FA215
7F15FFA25CEC03BF153F14071406140C141C141814301470146014C013011480EB03005B
13065B131C13185B1370136013E0485A5B120390C7FC1206120E120C5A123812305A12E0
B812C0A3C8383F8000ADEDFFE0027FEBFFC0A32A437DC231>I<000615C0D807C0130701
FCEB7F8090B612005D5D5D15E0158026063FFCC7FC90C9FCAE14FF010713C090381F01F0
90383800FC01F0137ED807C07F49EB1F8016C090C7120F000615E0C8EA07F0A316F81503
A216FCA5123E127F487EA416F890C712075A006015F0A20070140F003015E00038EC1FC0
7E001EEC3F806CEC7F006C6C13FE6C6C485A3901F807F039007FFFE0011F90C7FCEB07F8
26447BC131>I<EC07FCEC3FFF91B512C0903903FC03E0903907E000F0D91FC0133849C7
1258017EEB01FC01FE1303491307485A485AA24848EB03F8000FEC01F092C7FC485AA348
5AA3127FA29038007F80903801FFF090380780FC39FF0E003E49EB1F8049EB0FC049EB07
E0136001E0EB03F04914F8150116FC5BED00FEA390C812FFA47EA57F123FA216FE121F15
016D14FC120FED03F86C7EED07F06C6C14E06C6CEB0FC06C6CEB1F80017EEB3F0090383F
80FE90380FFFF8010313E00100138028447CC131>I<121CA2EA1F8090B712C0A3481680
A217005E0038C8120C0030151C00705D0060153016705E5E4814014B5A4BC7FCC8120615
0E5D151815385D156015E04A5AA24A5A140792C8FC5CA25C141E143EA2147E147CA214FC
A21301A3495AA41307A6130FAA6D5AEB01C02A457BC231>I<14FF010713E0011F13F890
387F00FE01FC133FD801F0EB1F804848EB0FC049EB07E00007EC03F048481301A290C713
F8481400A47FA26D130116F07F6C6CEB03E013FC6C6CEB07C09039FF800F806C9038C01F
006CEBF03EECF87839007FFEF090383FFFC07F01077F6D13F8497F90381E7FFFD97C1F13
80496C13C02601E00313E048486C13F000079038007FF84848EB3FFC48C7120F003EEC07
FE150148140016FF167F48153FA2161FA56C151E007C153EA2007E153C003E157C6C15F8
6DEB01F06C6CEB03E06C6CEB07C0D803F8EB1F80C6B4EBFF0090383FFFFC010F13F00101
138028447CC131>I<14FF010713E0011F13F890387F80FC9038FC007E48487F4848EB1F
804848EB0FC0000FEC07E0485AED03F0485A16F8007F140190C713FCA25AA216FE1500A5
16FFA46C5CA36C7E5D121F7F000F5C6C6C130E150C6C6C131C6C6C5BD8007C5B90383F01
E090390FFF80FE903801FE0090C8FC150116FCA4ED03F8A216F0D80F801307486C14E048
6C130F16C0ED1F80A249EB3F0049137E001EC75A001C495A000F495A3907E01FE06CB512
80C649C7FCEB1FF028447CC131>I<121EEA7F80A2EAFFC0A4EA7F80A2EA1E00C7FCB3A5
121EEA7F80A2EAFFC0A4EA7F80A2EA1E000A2B78AA1B>I<121EEA7F80A2EAFFC0A4EA7F
80A2EA1E00C7FCB3A5121E127FEAFF80A213C0A4127F121E1200A512011380A312031300
5A1206120E120C121C5A5A12600A3E78AA1B>I<007FBAFCBB1280A26C1900CEFCB0007F
BAFCBB1280A26C190041187BA44C>61 D<EB0FFC90387FFFC03901F007F039078001FC00
0EC77E48147F48EC3F804815C00060141F00FE15E07E7FA56CC7FC001CEC3FC0C8FCED7F
80A2EDFF004A5AEC03F84A5A5D4A5A4A5A92C7FC143E143C5CA2147014F05CA25C1301A3
5CA990C9FCAAEB03C0EB0FF0A2497EA46D5AA2EB03C023467BC52E>63
D<16C04B7EA34B7EA34B7EA34B7EA3ED19FEA3ED30FFA203707FED607FA203E07FEDC03F
A2020180ED801FA2DA03007F160FA20206801607A24A6D7EA34A6D7EA34A6D7EA2027081
0260147FA202E08191B7FCA249820280C7121FA249C87F170FA20106821707A2496F7EA3
496F7EA3496F7EA201788313F8486C83D80FFF03037FB500E0027FEBFFC0A342477DC649
>65 D<B8FC17E017FC00019039C00003FF6C6C4801007FEF3FC0717E717E717E84170384
170184A760A21703601707604D5A4D5AEF7FC04DC7FCEE03FEEE3FF091B65A17FC0280C7
B47EEF1FC0EF0FF0717E717E717E717E1980187F19C0A2183F19E0A8F07FC0A2198018FF
4D1300A24D5AEF0FFC4D5AEF7FE048486C903803FFC0B9C7FC17FC17C03B447CC345>I<
DB0FFE146092B500C013E0020314F0913A0FFC01FC0191393FC0003E02FFC7EA0F83D903
FCEC03C74948EC01E74948EC00FF4948157F4948153F4948151F49C9120F485A49160712
0348481603A248481601A248481600A2123FA2491760127FA31900485AAE6C7EA21960A2
123F7FA2001F18E07F000F18C0A26C6C160119806C6C160312016DEE07006C6C16066D6C
150E6D6C5D6D6C5D6D6C15786D6C5D6D6C4A5AD900FFEC0780DA3FC0011FC7FCDA0FFC13
FC0203B512F0020014C0DB0FFEC8FC3B487BC546>I<B8FC17F017FC00019039C00007FF
6C499038007FC0017FED1FE0EF07F0EF03FC717E717E84727E727E727EA2727E85180385
A2180185A38584A31A80AD1A00A36061A361180361180761180F614E5A183F614EC7FC18
FEEF03FC4D5AEF1FE001FFED7FC0486DD907FFC8FCB812FC17F094C9FC41447CC34B>I<
B912F8A3000101C0C7127F6C6C48EC07FC17011700187C183C181CA284A31806A4180704
067FA395C7FCA4160EA2161E163E16FE91B5FCA3EC8000163E161E160EA21606A319C0A3
F0018093C7FCA41803A21900A260A260A2181EA2183E187EEF01FE170748486C147FB95A
A33A447CC342>I<B912F0A3000101C0C7127F6C6C48EC0FF817031701170018781838A2
181CA3180CA4180E1806160CA21800A5161CA2163C167CED01FC91B5FCA3EC8001ED007C
163C161CA2160CA793C8FCB08048487EB612F8A337447CC340>I<DB0FFE146092B500C0
13E0020314F0913A0FFC01FC0191393FC0003E02FFC7EA0F83D903FCEC03C74948EC01E7
4948EC00FF4948157F4948153F4948151F49C9120F485A491607120348481603A2484816
01A248481600A2123FA2491760127FA396C7FC485AAD4CB612C06C7EA293C7387FF00072
5A003F171F7FA2121F7F120FA26C7EA26C7E6C7EA26C7E6D7E6D6C153F6D7E6D6C157F6D
6C15E7D903FEEC01C7D900FFEC0383DA3FE0EB0F01DA0FFCEBFE000203B500F813600200
02E090C7FCDB0FFEC9FC42487BC54D>I<B6D8C003B6FCA3000101E0C70007138026007F
80913801FE00B3A991B7FCA30280C71201B3AC2601FFE0913807FF80B6D8C003B6FCA340
447CC349>I<B612F0A3C6EBF0006D5A6D5AB3B3B3A4497E497EB612F0A31C447DC323>I<
010FB512FEA3D9000313806E130080B3B3AB123F487E487EA44A5A13801300006C495A00
705C6C13076C5C6C495A6CEB1F802603E07FC7FC3800FFFCEB1FE027467BC332>I<B600
C049B512C0A3000101E0C8387FFC006C49ED3FE06D481680063EC7FC183C183860604D5A
4D5A4DC8FC171E17385F5F4C5A4C5A4CC9FC160E5E5E5E5E4B5A4B7E4B7E150F4B7E4B7E
1577EDE3FE913881C1FFEC8381DA87007F028E6D7E149C02B86D7E02F06D7E14C04A6D7E
707EA2707E707EA2707F717EA2717E717EA2717E717EA2717E717EA2717F8585496C8248
6D4A13FCB600C0011FEBFFE0A343447CC34C>I<B612F8A3000101E0C9FC6C6C5A5CB3B3
1830A418701860A518E0A3EF01C0A217031707A2170F173F177FEE01FF48486C011F1380
B9FCA334447CC33D>I<B56C933807FFFC6E5EA20001F1FE0026006FE0EE1BF8A3D967F0
1633A2D963F81663A3D961FC16C3A3D960FEED0183A2027FED0303A36E6C1406A36E6C14
0CA26E6C1418A36E6C1430A36E6C1460A26E6C14C0A36E6CEB0180A3037FEB0300A29238
3F8006A36F6C5AA36F6C5AA26F6C5AA36F6C5AA36F6C5AA26FB45AA370C7FC13F0A2486C
143ED80FFFEF0FFEB500F0011C0107B512FCA34E447BC359>I<B56C020FB5FC8080C604
0013F06D6CED1F80D96FF8ED0F00A2D967FC1506EB63FEA2EB61FF01607FA26E7E6E7EA2
6E7E6E7EA26E7E6E7EA26E7E6E7FA26F7E6F7EA26F7E6F7EA26F7E6F7EA26F7E6F1380A2
EE7FC0EE3FE0A2EE1FF0EE0FF8A2EE07FCEE03FEA2EE01FF701386A2EF7FC6EF3FE6A2EF
1FF6EF0FFEA217071703A217011700A201F0167E183E487ED80FFF161EB500F0150EA218
0640447CC349>I<ED1FFC4AB512C0913907F007F091391F8000FC027EC7123FD901F8EC
0FC049486E7E49486E7E49486E7E49486E7E49C9127E017E8201FE834848707E4848707E
A24848707EA2000F84491603001F84A24848707EA3007F84A24982A300FF1980AD6C6C4C
1300A4003F606D1603A2001F60A26C6C4C5AA26C6C4C5AA20003606D161F6C6C4C5A0000
60017F4CC7FC6E5D013F5E6D6C4A5AD907E0EC03F06D6C4A5AD901FCEC1FC0D9007E4AC8
FCDA1F8013FC913907F007F00201B512C09126001FFCC9FC41487BC54C>I<B712FCEEFF
C017F800019039C0000FFC6C6C48EB01FF9338007F80EF1FE0170FEF07F018F8EF03FCA2
18FE1701A218FFA718FEA2170318FCA2EF07F818F0EF0FE0EF1FC0EF7F80933801FE00EE
0FFC91B612F017800280C9FCB3AA3801FFE0B612C0A338447CC342>I<ED1FFC4AB512C0
913907F007F091391F8000FC027EC7123F4948EC1FC0D903F0EC07E049486E7E49486E7E
49486E7E49C9127E49167F01FE707E4848707E00038449160F000784491607000F84A248
48707EA2003F84491601A2007F84A34982A200FF1980AD007F19006D5EA3003F60A26D16
03001F60A2000F606D16070007606DD903F0130F0003DA0FFC5C6DD91C0E131F00014A6C
5C6C6C903A3003803F80017FD9700149C7FC92386000C0D93F8015FED91FC0ECE1FCD907
E0EC63F0D903F0EC77E0902601FC70EB7FC09026007E3091C8FCDA1FB813FC912707FC07
F814C00201B57E9139001FFC3C92C7FC053E1301171E051F13031A80F08007F0C00F9438
0FF03F95B51200A28361715BA2715B9438007FE0F01F8042597BC54C>I<B712E016FF17
C000019039C0003FF86C6C48EB03FCEE00FF717E717E717E717E717EA284170384A760A2
1707604D5AA24D5A4D5A4DC8FCEE01FEEE07F8EE3FE091B6C9FC16FC913980007F80EE0F
E0707EEE03FC707E160083717EA2717EA784A71A6084171FA21AE0716C13C02601FFE002
071301B600C01680943801FC03943900FE0700CBEA3FFEF007F843467CC348>I<49B413
03010FEBE007013F13F89039FE00FE0FD801F8131FD807E0EB079F49EB03DF48486DB4FC
48C8FC4881003E81127E82127C00FC81A282A37E82A27EA26C6C91C7FC7F7FEA3FF813FE
381FFFE06C13FE6CEBFFE06C14FC6C14FF6C15C0013F14F0010F80010180D9001F7F1401
9138001FFF03031380816F13C0167F163F161F17E000C0150FA31607A37EA36C16C0160F
7E17806C151F6C16006C5D6D147ED8FBC05CD8F9F0495AD8F07C495A90393FC00FE0D8E0
0FB51280010149C7FC39C0003FF02B487BC536>I<003FB912F8A3903BF0001FF8001F01
806D481303003EC7150048187C0078183CA20070181CA30060180CA5481806A5C81600B3
B3A54B7EED7FFE49B77EA33F447DC346>I<B600C0010FB5FCA3000101E0C813F026007F
80ED1F80F00F00A21806B3B3A7180E6D6C150CA2181C131F6E1518010F163818306D6C15
70606D6C14016D6C5D6D6CEC0780027F4AC7FC6E6C131EDA1FE0137C913907FC03F00201
B55A6E6C1380DB07FCC8FC40467CC349>I<B692383FFFF0A3000301E003071300C649ED
01FC4A5E017F705A6E5E133F616E1501011F5FA26D6C4BC7FCA28001071606A26E150E01
03160CA26D6C5DA2806D5EA26F1470027F156081023F5DA281021F4A5AA26F1303020F92
C8FC8102071406A26F130E0203140CA26E6C5BA2816E5CA2EE8070037F1360A26F6C5AA2
16E092381FE180A216F3030F90C9FC16FBED07FEA36F5AA36F5AA26F5AA3166044467EC3
49>I<B60107B500F890380FFFFEA3000301E0D9001F90C813F06C0180DA0FFCED3FC091
C86C48ED1F006C871C0E6D6C6E7E1C0CA26D6C6F5DA36EDA06FF1538011F1A30A26E020E
6D1470010FDB0C7F1560A26E021C7F0107DB183F5DA2856D6CDA301F4A5AA36D6C4A6C6C
49C7FCA36D6C4A6C6C1306A3DB80016E130E027FDA8003140CA2DBC00380023FDA00015C
A203E081021F01066D5CA36E6C486E6C5AA36E6C486E6C5AA36F48EC1FE1020360A2DBFE
7015F302010160020F90C8FCA2DBFFE015FB6E49EC07FEA36F486E5AA36FC86C5AA3031E
6F5AA4030C16605F467EC364>I<003FB500E0011FB5FCA3C691C7000713E0D93FFC0201
90C7FC6D4815FC010F6F5A6D6C15E0A26D6C4A5A6D6C5D4DC8FC6D6D5B6E6C13065F6E6C
131C6E6C13185F6E6C13706E6C13605F913803FE01DA01FF5B4CC9FC6E1387ED7FC616CC
ED3FFC6F5A5E6F7E6F7EA26F7E82A203067F150E92380C7FC04B6C7E15389238301FF04B
6C7E15E04B6C7E4A486C7E14034B6C7E02066D7F140E020C6E7E4A6E7E143802306E7E4A
6E7E14E04A6E7E49486E7E130349C86C7E496F7F5B496C8201FF83000701E0020313F8B5
00F8021FEBFFF0A344447EC349>I<B66C91380FFFFCA3000101F8C8000313C026007FE0
923800FE0061013F17F06D6C5E80010F5F6D6C4B5A18036D6C93C7FC6E15066D160E6D6D
140C181C6E6C14186E6C5C18706E6C146018E06E6C5C6E6C495A17036E6C91C8FC5F6E6C
13066E6D5A171C92387FC0185FED3FE06F6C5A17E06F6C5AEEF980ED07FF6F90C9FCA26F
5AB3A6923807FF800203B6FCA346447FC349>I<001FB81280A39126800001130001FCC7
FC01F04A5A01C04A5A5B90C8485A121E4C5A484B5AA200384B5A4C5AA24B90C7FC00304A
5AA24B5AA24B5AC8485AA24B5A4B5AA24B5A5C93C8FC4A5AA24A5A4A5AA24A5A4A5AA24A
5A14FF5D4990C9FCEF0180495A495AA2495A494814031800495AA2495A495A5F4890C8FC
485A5F485A48485D5F48485D17FE484814034848140F16FFB8FCA331447BC33C>I<EAFF
FCA4EAF000B3B3B3B3B3A2EAFFFCA40E6476CA1B>I<01C01318000114384848137048C7
12E0000EEB01C0000C1480001C13030018140000385B003013060070130E0060130CA300
E0131C481318A400CFEB19E039FFC01FF801E013FCA3007F130FA2003F130701C013F839
0F0001E01E1D71C431>I<EAFFFCA4EA003CB3B3B3B3B3A2EAFFFCA40E647ECA1B>I<13C0
1201EA0380EA0700120E120C121C12181238123012701260A312E05AA412CFEAFFC013E0
A3127FA2123F13C0EA0F000B1D79C41B>96 D<EB07FC90383FFF809038F80FE03903C003
F048C66C7E000E6D7ED80FC0137E486C137F6D6D7EA36F7EA26C5AEA0380C8FCA4EC0FFF
49B5FC90380FFE1FEB3FC0EBFF00EA03FC485A485A485A485A127F5B176048C7FCA3153F
A36D137F007F14EF6D9038C7E0C0003F13013A1FE00783F13B07F81E03FF802701FFFC01
13003A001FE0007C2B2E7CAC31>I<EA01FC12FFA3120712031201B3EC03FC91380FFF80
91383C07E091387001F89039FDE0007E02807F01FFEC1F8091C713C049EC0FE049140717
F0A2EE03F8A217FCA2160117FEAB17FC1603A217F8A2EE07F0A26DEC0FE017C06D141F01
FBEC3F80D9F380EB7E00D9E1C05B9039E0F001F89039C03C07E09039801FFF80C7D803FC
C7FC2F467DC436>I<EC7F80903803FFF090380FC07C90383F000F01FCEB03804848EB01
C00003140F4848EB1FE049133F120F485AA2485AED1FC0007FEC070092C7FCA290C9FC5A
AB7E7FA2123F16307F001F15706C6C146016E06C6C14C06C6C13010001EC03806C6CEB07
00013F131E90381FC078903807FFF001001380242E7DAC2B>I<167FED3FFFA315018182
B3EC7F80903803FFF090380FC07C90383F000E017E1307496D5AD803F87F48487F5B000F
81485AA2485AA2127FA290C8FC5AAB7E7FA2123FA26C7EA2000F5D7F6C6C5B00035C6C6C
9038077F806C6C010E13C0013F011C13FE90380FC0F8903803FFE09026007F0013002F46
7DC436>I<EB01FE903807FFC090381F03F090387E00FC49137E48487F485A4848EB1F80
000F15C049130F121F484814E01507A2007F15F090C7FCA25AA390B6FCA290C9FCA67EA2
7FA2123F16306C7E1670000F15606D14E06C6C14C0000314016C6CEB03806C6CEB070001
3E131E90381F80F8903803FFE0010090C7FC242E7DAC2B>I<EC0FE0EC7FF8903801F81E
903803F03F90390FE07F8090381FC0FF5C133F495AA2ED7F0001FE131C92C7FCAFB67EA3
C648C8FCB3B2486C7E007F13FFA321467EC51E>I<EE0F80D901FCEB7FE0903A0FFF81F0
F090393F07E3819039FC01FF033A01F800FE014848017E13E00007027FC7FC497F000F81
49131F001F81A9000F5D6D133F000792C7FC6D5B0003147E6C6C5B6D485A3903BF07E090
380FFF80260701FCC8FC90CAFCA25AA37F6C7E7F90B512F86C14FF16E06C15F86C6C8048
B67E3A07C0000FFF48481300003FC8EA3F80003E151F48ED0FC0A2481507A56C150F007C
1680007E151F003E16006C153E6C6C5CD807E0495AD801F8EB07E0D8007FEB3F8090261F
FFFEC7FC010113E02C427DAC31>I<EA01FC12FFA3120712031201B3EC01FE913807FFC0
91381E07F091383801F802707FECE000D9FDC07F5C01FF147F91C7FCA25BA35BB3A8486C
ECFF80B5D8F83F13FEA32F457DC436>I<EA01E0EA07F8A2487EA46C5AA2EA01E0C8FCAD
EA01FC12FFA3120712031201B3B0487EB512F8A315437DC21C>I<143C14FFA2491380A4
6D1300A2143C91C7FCADEC7F80EB3FFFA31300147F143FB3B3AA123E127F39FF807F00A2
147EA25C6C485A383C01F06C485A3807FF80D801FEC7FC195785C21E>I<EA01FC12FFA3
120712031201B3A292381FFFE0A36F1300ED07F816E05E5E030EC7FC5D5D5D5D4A5A4A5A
4AC8FC5CEC3F804A7E14FF9038FDCFE09038FF8FF01407496C7E01FC7F14016E7E81816F
7E82151F6F7E821507826F7E8282486C491380B5D8F81F13F8A32D457DC433>I<EA01FC
12FFA3120712031201B3B3B3A5487EB512F8A315457DC41C>I<D801FC01FFEC1FE000FF
010701E0EBFFFC913B0F03F801E07F913C3C01FC07803F800007903C7000FE0E001FC000
0349D97E1C130F2601FDC0D97F38804A143001FFDA3FF06D7E91C75BA2495DA3495DB3A8
486C4A6C497EB5D8F81FB50003B512E0A34B2C7DAB52>I<3901FC01FE00FF903807FFC0
91381E07F091383801F8000701707F0003EBE0002601FDC07F5C01FF147F91C7FCA25BA3
5BB3A8486CECFF80B5D8F83F13FEA32F2C7DAB36>I<EC7F80903803FFF090380FC0FC90
383E001F496D7E496D7E48486D7E48486D7E48486D7E000F81A24848147E003F157FA290
C87E481680A44816C0AA6C1680A26D147F003F1600A2001F157E6D14FE000F5D6D130100
075D6C6C495A6C6C495A6C6C495A013E49C7FC90381FC0FE903807FFF89038007F802A2E
7DAC31>I<3901FC03FC00FF90380FFF8091383C07E091387001F83A07FDE000FE000301
80137FD801FFEC3F8091C7EA1FC04915E049140F17F0160717F8160317FCA3EE01FEABEE
03FCA3EE07F8A217F0160F6D15E0EE1FC06D143F17806EEB7E00D9FDC05B9039FCF003F8
91383C0FE091381FFF80DA03FCC7FC91C9FCAE487EB512F8A32F3F7DAB36>I<91387F80
03903903FFE00790380FE07890393F801C0F90387E000E496D5AD803F8EB039F0007EC01
BF4914FF48487F121F5B003F81A2485AA348C8FCAB6C7EA3123F7F121F6D5C120F6D5B12
076C6C5B6C6C497E6C6C130E013F131C90380FC0F8903803FFE09038007F0091C7FCAEEE
FF80033F13FEA32F3F7DAB33>I<3903F803F000FFEB1FFCEC3C3EEC707F0007EBE0FF38
03F9C000015B13FBEC007E153C01FF13005BA45BB3A748B4FCB512FEA3202C7DAB26>I<
90383FE0183901FFFC383907E01F78390F0003F8001E1301481300007C1478127800F814
38A21518A27EA27E6C6C13006C7E13FC383FFFE06C13FC6C13FF6C14C06C14E0C614F001
1F13F81300EC0FFC140300C0EB01FE1400157E7E153EA27EA36C143C6C147C15786C14F8
6CEB01F039F38003E039F1F00F8039E07FFE0038C00FF01F2E7DAC26>I<1306A5130EA4
131EA3133E137EA213FE12011207001FB512F0B6FCA2C648C7FCB3A4150CAA017E131C01
7F1318A26D133890381F8030ECC070903807E0E0903801FFC09038007F001E3E7EBC26>
I<D801FC147F00FFEC3FFFA300071401000380000181B3A85EA35DA212006D5B017E9038
077F80017F010E13C06D011C13FE90380FC078903803FFF09026007F8013002F2D7DAB36
>I<B539F001FFFCA3000790C7EA7FE06C48EC1F8000011600160E1200160C017F5CA280
013F5CA26E1370011F146080010F5CA2ECF00101075CA26D6C48C7FCA26E5A01011306A2
6D6C5AA214FF6E5AA215B8EC3FB015F06E5AA36E5AA26E5AA36EC8FC2E2C7EAA33>I<B5
00E0B539E03FFF80A30007903C000FFE000FFC00D803FCD903F8EB03F8F001E012010301
5D6D80000060A26D6E13036DD9037E91C7FCA20280017F5B013FD9063F1306A2D91FC06E
5AED0C1FA2D90FE06E5AED180FA2D907F06E5AED3007A2D903F86E5AED6003A2902601FC
E06D5AEDC00117FCD900FFECFD80ED800017FF027F92C8FC92C77EA26E147E023E143EA2
021E143C021C141CA2412C7EAA46>I<B539F007FFFCA30003D9C00113C0C6496C130001
7F14FC013F5C6E13E06D7E010F495A6D6C485A02F890C7FC903803FC060101130E6E5A90
3800FF186E5AEC3FF05D141F140F6E7E81140FEC0DFCEC19FEEC38FF4A7E9138603F8002
C07F0101131F49486C7E02007F01066D7E010E1303496D7E013C80017C80D801FC1580D8
0FFE4913C0B5D8800F13FFA3302B7FAA33>I<B539F001FFFCA3000790C7EA7FE06C48EC
1F8000011600160E0000150C6D141C6D1418A26E1338013F1430A26D6C5BA26E13E0010F
5CA26D6C485AA2ECF803010391C7FCA2903801FC06A2ECFE0E0100130CA2EC7F18A215B8
EC3FB0A2EC1FE0A36E5AA26E5AA36EC8FCA21406A35CA25CA2123C007E5BB4FC5CA25CEA
FE01387C0380D87007C9FCEA3C1EEA0FFCEA03F02E3F7EAA33>I<003FB612E0A29038C0
003F90C713C0003CEC7F800038ECFF00A20030495A0070495AA24A5A0060495AA24A5A4A
5AA2C7485A4AC7FC5B5C495A13075C495A131F4A1360495A495AA249C712C0485AA2485A
485A1501485A48481303A24848EB07804848131F00FF14FF90B6FCA2232B7DAA2B>I<B9
FCA23002809B31>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fw cmbx12 12 63
/Fw 63 123 df<EC01E01403EC0FC0EC1F80EC3F00147E5C1301495A495A5C130F495A13
3F5C137F49C7FCA2485AA2485AA212075BA2120F5BA2121FA25B123FA4485AA612FFA25B
AE7FA2127FA66C7EA4121F7FA2120FA27F1207A27F1203A26C7EA26C7EA26D7E133F8013
1F6D7E1307806D7E6D7E1300147E80EC1F80EC0FC0EC03E014011B6476CA2C>40
D<12F07E127E7E6C7E6C7E6C7E7F6C7E6C7E12007F137F80133F806D7EA26D7EA26D7EA2
801303A2801301A280A27F1580A4EC7FC0A615E0A2143FAE147FA215C0A6ECFF80A41500
5BA25CA213035CA213075CA2495AA2495AA2495A5C137F91C7FC13FE5B1201485A485A5B
485A485A48C8FC127E12F85A1B647ACA2C>I<EA07C0EA1FF0EA3FF8EA7FFC12FF13FEA2
13FFA47E7E7EEA07CFEA000FA2131F131EA2133EA2133C137C13F8A2EA01F0120313E0EA
07C0EA1F801300121E120C1022788E1F>44 D<B612F8A91D097F9A25>I<EA07C0EA1FF0
EA3FF8EA7FFCEAFFFEA7EA7FFCEA3FF8EA1FF0EA07C00F0F788E1F>I<EC3FF849B5FC01
0F14E0013F14F890397FF01FFC9039FFC007FE4890380001FF48486D1380000716C04914
7F000F16E049143F001F16F0A2003F16F8A249141F007F16FCA600FF16FEB3A3007F16FC
A56C6CEC3FF8A3001F16F0A2000F16E06D147F000716C06D14FF6C6C4913806C6D481300
6C6D485A90397FF01FFC6DB55A010F14E0010314809026003FF8C7FC2F427CC038>48
D<EC03C01407141F147FEB03FF133FB6FCA413C3EA0003B3B3ADB712FCA5264177C038>
I<ECFFE0010F13FE013F6D7E90B612E0000315F82607FC0313FE3A0FE0007FFFD81F806D
138048C7000F13C0488001C015E001F07F00FF6E13F07F17F881A46C5A6C5A6C5AC9FC17
F05DA217E05D17C04B13804B1300A2ED1FFC4B5A5E4B5A4B5A4A90C7FC4A5A4A5AEC0FF0
4A5AEC3F804AC7127814FE495A494814F8D907E014F0495A495A49C8FC017C1401491403
48B7FC4816E05A5A5A5A5AB8FC17C0A42D417BC038>I<ECFFF0010713FF011F14C0017F
14F049C66C7ED803F8EB3FFED807E06D7E81D80FF86D138013FE001F16C07FA66C5A6C48
15806C485BC814005D5E4B5A4B5A4B5A4A5B020F1380902607FFFEC7FC15F815FF16C090
C713F0ED3FFCED0FFEEEFF80816F13C017E0A26F13F0A217F8A3EA0FC0EA3FF0487EA248
7EA217F0A25D17E06C5A494913C05BD83F80491380D81FF0491300D80FFEEBFFFE6CB612
F800015D6C6C14C0011F49C7FC010113E02D427BC038>I<163FA25E5E5D5DA25D5D5D5D
A25D92B5FCEC01F7EC03E7140715C7EC0F87EC1F07143E147E147C14F8EB01F0EB03E013
0714C0EB0F80EB1F00133E5BA25B485A485A485A120F5B48C7FC123E5A12FCB91280A5C8
000F90C7FCAC027FB61280A531417DC038>I<0007150301E0143F01FFEB07FF91B6FC5E
5E5E5E5E16804BC7FC5D15E092C8FC01C0C9FCAAEC3FF001C1B5FC01C714C001DF14F090
39FFE03FFC9138000FFE01FC6D7E01F06D13804915C0497F6C4815E0C8FC6F13F0A317F8
A4EA0F80EA3FE0487E12FF7FA317F05B5D6C4815E05B007EC74813C0123E003F4A1380D8
1FC0491300D80FF0495AD807FEEBFFFC6CB612F0C65D013F1480010F01FCC7FC010113C0
2D427BC038>I<4AB47E021F13F0027F13FC49B6FC01079038807F8090390FFC001FD93F
F014C04948137F4948EBFFE048495A5A1400485A120FA248486D13C0EE7F80EE1E00003F
92C7FCA25B127FA2EC07FC91381FFF8000FF017F13E091B512F89039F9F01FFC9039FBC0
07FE9039FF8003FF17804A6C13C05B6F13E0A24915F0A317F85BA4127FA5123FA217F07F
121FA2000F4A13E0A26C6C15C06D4913806C018014006C6D485A6C9038E01FFC6DB55A01
1F5C010714C0010191C7FC9038003FF02D427BC038>I<121E121F13FC90B712FEA45A17
FC17F817F017E017C0A2481680007EC8EA3F00007C157E5E00785D15014B5A00F84A5A48
4A5A5E151FC848C7FC157E5DA24A5A14035D14074A5AA2141F5D143FA2147F5D14FFA25B
A35B92C8FCA35BA55BAA6D5A6D5A6D5A2F447AC238>I<EA07C0EA1FF0EA3FF8EA7FFCEA
FFFEA7EA7FFCEA3FF8EA1FF0EA07C0C7FCAEEA07C0EA1FF0EA3FF8EA7FFCEAFFFEA7EA7F
FCEA3FF8EA1FF0EA07C00F2C78AB1F>58 D<EE1F80A24C7EA24C7EA34C7EA24B7FA34B7F
A24B7FA34B7F169F031F80161F82033F80ED3E07037E80157C8203FC804B7E02018115F0
820203814B137F0207815D173F020F814B7F021F8292C77EA24A82023E80027E82027FB7
FCA291B87EA2498302F0C8FCA20103834A157F0107834A153FA249488284011F8491C97E
4984133E017E82B6020FB612F0A54C457CC455>65 D<B9FC18F018FE727E19E026003FFC
C700077F05017F716C7E727E727EA2721380A37213C0A74E1380A24E1300A24E5A4E5A4E
5A4D5B05075B94B5128091B700FCC7FC18F018FF19E002FCC7000113F8716C7EF01FFE72
7E7213801AC07213E0A27213F0A31AF8A71AF0A2601AE0604E13C0604E138095B5120005
075BBA12F86119C04EC7FC18E045447CC350>I<DCFFF01470031F01FF14F04AB6EAE001
0207EDF803023FEDFE0791B539E001FF0F4949C7EA3F9F010701F0EC0FFF4901C0804990
C87E4948814948814948167F4849163F4849161F5A4A160F485B19074890CAFC19035A5B
A2007F1801A34994C7FC12FFAE127F7F1AF0A2123FA27F6C18011AE06C7F19036C6D17C0
6E16077E6C6DEE0F806C6DEE1F006D6C5E6D6C167E6D6C6C5D6D6D4A5A6D01F0EC07F001
0101FEEC1FE06D903AFFF001FF80023F90B6C7FC020715FC020115F0DA001F1480030001
F8C8FC44467AC451>I<B9FC18F018FE727E19E026003FFEC7001F13F805017F9438003F
FF060F7F727F727F727F84737E737EA2737EA2737EA21B80A2851BC0A51BE0AD1BC0A51B
8061A21B006162193F624F5A19FF624E5B06075B4E5B063F90C7FC4DB45A050F13F8BA5A
19C04EC8FC18F095C9FC4B447CC356>I<BA12F8A485D8001F90C71201EF003F180F1803
18011800A2197E193EA3191EA21778A285A405F890C7FCA316011603161F92B5FCA5ED00
1F160316011600A2F101E01778A2F103C0A494C7FC1907A21A80A2190FA2191FA2193FF1
7F0061601807181F4DB5FCBBFC61A443447DC34A>I<BA1280A419C026003FFEC7121F17
01EF007F183F181F180F180719E01803A31801A3EE01E0F000F0A419001603A31607160F
167F91B6FCA59138FE007F160F16071603A31601A693C9FCAFB712F0A53C447CC346>I<
DCFFF01470031F01FF14F04AB6EAE0010207EDF803023FEDFE0791B539E001FF0F4949C7
EA3F9F010701F0EC0FFF4901C0804990C87E4948814948814948167F4849163F4849161F
5A4A160F485B19074890CAFC19035A5BA2007F1801A34994C8FC12FFAD057FB612F0127F
7FA3003FDC0001EBF000A27F7EA26C7FA26C7F807E6C7F6C7F6D7E6D6C5D6D6C7E6D6D5C
6D01F05C010101FE143F6D903AFFF001FF9F023F90B6120F0207EDFC030201EDF000DA00
1F02C01330030001FCC9FC4C467AC458>I<B7D88003B612FEA526003FFEC9EBF800B3A7
91B9FCA54AC9FCB3AAB7D88003B612FEA54F447CC358>I<B712E0A5D8001F90C7FCB3B3
B3A4B712E0A523447DC32A>I<0107B7FCA590C7001F1300B3B3A9EA1FE0487E487EA248
7EA44B5AA26C48495A495C6C4813FF6C48485B260FFC0713C06CB65A6C4AC7FCC66C13F8
010F138030457DC33A>I<B76C0103B512F8A526003FFEC93807E0004F5A4F5A077EC7FC
614E5A4E5A4E5AF01F804EC8FC187E604D5AEF07F0EF0FC04D5A4DC9FC177E4C5AEE03F0
4C5A4C5A4C7EEE7FF04C7E5D4B7F4B7F4B7FED3F3FDB7E1F7F03FC806E486C7F4B7E4B6C
7F0380804B6C7F4A7F717E84717F83717F85717F83717F85717F187F727E86727F84727F
86727F84B76C90B612FCA54E447CC358>I<B712F0A526003FFECAFCB3B1F00780A4180F
1900A460A360A2187EA218FE170117031707171F177FEE03FFB95AA539447CC343>I<B5
00FE067FB512806E95B6FCA26F5EA2D8003F50C7FC013D6DEE03DFA2013C6DEE079FA26E
6CEE0F1FA26E6C161EA26E6C163CA36E6C1678A26E6C16F0A26E6DEC01E0A26E6DEC03C0
A36E6DEC0780A26F6CEC0F00A26F6C141EA26F6C5CA36F6C5CA26F6C5CA26F6D485AA26F
6D485AA26F6D485AA3706C48C7FCA293383FF81EA2706C5AA2706C5AA3706C5AA2705BA2
705BA2705BA2B6057FB6128071C7FCA2173E171C61447CC36A>I<B64BB512FE8181A281
D8003F6D91C7EA780081013D7F81133C6E7E6E7F6E7F6E7F6E7F82806E7F6E7F6F7E6F7F
83816F7F6F7F6F7F6F7F6F7F8382707F707F707F707F8482707F707F717E7113807113C0
19E0837113F07113F87113FC7113FE19FF847213F884848484A28484197F193F191FA219
0F1907B61603190119001A78A24F447CC358>I<923807FFC092B512FE0207ECFFC0021F
15F091267FFE0013FC902601FFF0EB1FFF01070180010313C04990C76C7FD91FFC6E6C7E
49486F7E49486F7E01FF8348496F7E48496F1380A248496F13C0A24890C96C13E0A24819
F04982003F19F8A3007F19FC49177FA400FF19FEAD007F19FC6D17FFA3003F19F8A26D5E
6C19F0A26E5D6C19E0A26C6D4B13C06C19806E5D6C6D4B13006C6D4B5A6D6C4B5A6D6C4B
5A6D6C4A5B6D01C001075B6D01F0011F5B010101FE90B5C7FC6D90B65A023F15F8020715
C002004AC8FC030713C047467AC454>I<B9FC18F018FE727E19E0D8001F90C7000F7F05
017F716C7E727E727E721380A21AC084A21AE0A91AC0A24E1380A21A00604E5A4E5A4D48
5A050F5B92B712C096C7FC18FC18C092CBFCB3A7B712E0A543447DC34D>I<923807FFC0
92B512FE0207ECFFC0021F15F091267FFE0013FC902601FFF0EB1FFF010701C0010713C0
4990C700017F49486E7F49486F7E49486F7E49486F7E48496F7E48496F1380A248496F13
C0A24819E091C97E4819F0A248487013F8A3007F19FCA249177FA300FF19FEAD007F19FC
A36D17FF003F19F8A3001F19F06D5EA26C19E06E01FE5B6C912603FF8014C06C6D486D48
13804B13E06C9028E01F83F00F13006C903BF01E00F81FFE90267FF83E90387C3FFC9026
3FFC3C6D485AD91FFE91381EFFF0D90FFF021F5B6D01FE5D010194C7FC6D6D6CB45A023F
90B512F8020703E0130202006F1307030713C792C7EA07F8716C130F72131F9538FF80FF
96B5FC7114FEA3831AFCA27213F81AF0847213E07213C0721300F001FC48587AC454>I<
B812F8EFFFC018F818FE727ED8001F90C7003F13E005037F05007F727E727E727EA28684
A286A762A24E90C7FCA24E5A61187F943801FFF005075B053F138092B7C8FC18F818E018
F892C77FEF3FFF050F7F717F717FA2717FA2717FA785A61B0F85A2187F73131F72141EB7
00E06DEB803E72EBE0FC72EBFFF8060114F0726C13E0CC0007138050457DC354>I<DAFF
E0131C010701FE133C013F9038FF807C90B6EAE0FC4815F9489038801FFF3907FC000148
48EB007F4848143F4848140F491407007F15035B1601160012FF177CA27FA26D153C7F7F
6D92C7FC6C7EEBFFE014FE6CEBFFF015FF6C15E016FC6C816C6F7E6C826C826C6C81011F
810107811300020F80140003077FED007F82040F1380828212F082A282A27EA218007EA2
6C5D6C5E6D14036D5D6D140701F84A5A01FFEC3FF002F8EBFFE0486CB65AD8FC1F92C7FC
D8F80714FC48C614F0480107138031467AC43E>I<003FBA12E0A59026FE000FEB8003D8
7FE09338003FF049171F90C71607A2007E1803007C1801A300781800A400F819F8481978
A5C81700B3B3A20107B8FCA545437CC24E>I<B76C010FB512F8A526003FFEC93803E000
B3B3A9011F17076280190F6D606F151F6D95C7FC6D6D5D197E6D6D5D6D6D1403DA7FFC4A
5A6EB4EC3FF0020F9039F003FFE06E90B61280020193C8FC6E6C14FC030F14E09226007F
FEC9FC4D457CC356>I<B792B6FCA526003FFECAEAFC00806D606F15016D608119036D60
6F15076D606F150F6D6081191F6D6D93C7FC61027F163E6F157E023F167C8119FC6E6D5C
18016E5E7013036E5E8218076E6D5C180F6E5E70131F6E93C8FC705B037F143E82187E03
3F147C7013FC6F5C17816F5C17C117C36F5C17E76F5C17FF6F5CA36F91C9FCA2705AA270
5AA3705AA2705AA2705AA250457EC355>I<B600FE017FB691B512FEA526007FFCC8D83F
FEC9EA7C006E82013F701778807415F86D705F6F7014016D705FA26F7014036D64814E6D
14076D646F70140F6D041E94C7FCA26F023E6D5C6DDC3C7F151E81027F037C6D5CF0783F
6F70147C023F4B6C1578A26F01016F13F86E4B6C5D16806E02036F485A4E7E04C0EEE003
6E4A486C5DA2DCE00FEDF0076E4B6C5D16F06E4A6F48C8FC051E7F04F8705A6E4A027F13
1EA2DCFC7CEDFE3E037F0178023F133C04FE16FF033F01F85E4D8004FF17F86F496E5BA3
6F496E5BA26F604D80A26F90C86C5BA36F486F90C9FCA26F48167EA30478163C6F457EC3
74>I<007FB6D8C003B61280A5D8000F01E0C7D801F8C7FC6D4C5A6F14076D6D5D6D6D4A
5A4E5A6D6D143F6E6C92C8FC6E157E705B6EEBC0016E01E05B4D5A6E6D485A6EEBF80F6E
01FC5B4D5A6E6D48C9FC6F6C5A6F137E5F6F5B815F816F7F81836F7F707E93B5FC844B80
5D4B8004E77FDB0FC37FED1F83DB3F817F04007F037E137F4B8002016E7F4B6D7F4A5A4A
486D7F020F6E7F4B7F4A48814AC76C7F717F147E4A6F7E0101707F4A8149488349486F7F
010F707FB600E00103B612FCA54E447DC355>I<B76C027FB5FCA5D8003F0180C9EAFC00
6D6D4B5AA26D6D4B5A6D6D4B5A816D4D5A6D6D4B5A816D4DC7FC6E6C157E826E5E6E6D49
5A826E4B5A6E6D495A6E7F4E5A6E6D495A6E7F4EC8FC6F6C137E6F1380606FEBC1F86F13
E1EFF3F06FEBF7E06F13FF606F5C8195C9FC705A163FB3A592B77EA550447EC355>I<00
1FB812FEA59126F8000113FC028015F801FCC75A494A13F04916E0495C494A13C0484816
805E90C84813005F003E15FF4B5B5F003C5C4B5B5F5D4B5BC85C4B90C7FC5D5E4B5A5C5E
4A5B5C5E4A5B5C5E4A90C8FC5C5D4A48140F5B5D495B5B4949141F5D49161E495B92C8FC
49163E495A5C48177E485B4A15FE481601484914034A140748160F4849143F91C8EAFFFC
48150FB9FCA538447AC344>I<903801FFE0011F13FE017F6D7E48B612E03A03FE007FF8
4848EB1FFC6D6D7E486C6D7EA26F7FA36F7F6C5A6C5AEA00F090C7FCA40203B5FC91B6FC
1307013F13F19038FFFC01000313E0000F1380381FFE00485A5B127F5B12FF5BA35DA26D
5B6C6C5B4B13F0D83FFE013EEBFFC03A1FFF80FC7F0007EBFFF86CECE01FC66CEB8007D9
0FFCC9FC322F7DAD36>97 D<EB7FC0B5FCA512037EB1ED0FF892B57E02C314E002CF14F8
9139DFC03FFC9139FF000FFE02FCEB03FF4A6D13804A15C04A6D13E05CEF7FF0A218F817
3FA318FCAC18F8A2177F18F0A3EFFFE06E15C06E5B6E491380027C491300496C495A903A
FC1FC07FFC496CB512F0D9F00314C049C691C7FCC8EA1FF036467DC43E>I<EC3FFC49B5
12C0010F14F0013F14FC90397FF003FE9039FFC001FF0003495A48494813805B120F485A
A2485A6F1300007F6E5AED00784991C7FCA212FFAC6C7EA3123F6DEC03C0A26C6C140700
0F16806D140F6C6DEB1F006C6D133E6C01F05B3A007FFC03F86DB55A010F14C0010391C7
FC9038003FF82A2F7CAD32>I<EE03FEED07FFA5ED001F160FB1EC3FE0903803FFFC010F
EBFF8F013F14CF9039FFF807FF48EBC00148903880007F4890C7123F4848141F49140F12
1F485AA3127F5BA212FFAC127FA37F123FA26C6C141FA26C6C143F0007157F6C6C91B5FC
6CD9C00314FC6C9038F01FEF6DB5128F011FEBFE0F010713F89026007FC0EBF80036467C
C43E>I<EC3FF80103B57E010F14E0013F8090397FF83FF89039FFC007FC48496C7E4849
6C7E48486D1380485A001FED7FC05B003FED3FE0A2127F5B17F0161F12FFA290B7FCA401
F0C9FCA5127FA27FA2123F17F06C7E16016C6C15E06C6C14036C6DEB07C06C6DEB0F806C
01F0EB3F0090397FFE01FE011FB55A010714F0010114C09026001FFEC7FC2C2F7DAD33>
I<EDFF80020F13E0027F13F049B512F849EB8FFC90390FFE0FFE90381FFC1F14F8133FEB
7FF0A2ED0FFCEBFFE0ED03F0ED00C01600ABB612F8A5C601E0C7FCB3B0007FEBFFE0A527
467DC522>I<DAFFE0137E010F9039FE03FF80013FEBFF8F90B812C048D9C07F133F4890
38001FF84848EB0FFC4848903907FE1F80001F9238FF0F00496D90C7FCA2003F82A8001F
93C7FCA26D5B000F5D6C6C495A6C6C495A6C9038C07FF04890B55A1680D8078F49C8FC01
8013E0000F90CAFCA47F7F7F90B612C016FC6CEDFF8017E06C826C16FC7E000382000F82
D81FF0C77ED83FC014074848020113808248C9FC177FA46D15FF007F17006D5C6C6C4A5A
6C6C4A5AD80FFEEC3FF83B07FFC001FFF0000190B612C06C6C92C7FC010F14F8D9007F90
C8FC32427DAC38>I<EB7FC0B5FCA512037EB1ED07FE92383FFF8092B512E002C114F891
39C7F03FFC9138CF801F9139DF000FFE14DE14FC4A6D7E5CA25CA35CB3A7B60083B512FE
A537457CC43E>I<137C48B4FC4813804813C0A24813E0A56C13C0A26C13806C1300EA00
7C90C7FCAAEB7FC0EA7FFFA512037EB3AFB6FCA518467CC520>I<EB7FC0B5FCA512037E
B293387FFFE0A593380FE0004C5A4CC7FC167E5EED03F8ED07E04B5A4B5A037FC8FC15FE
ECC1FCECC3FE14C7ECDFFF91B57E82A202F97F02E17F02C07FEC807F6F7E826F7E816F7F
836F7F816F7F83707E163FB60003B512F8A535457DC43B>107 D<EB7FC0B5FCA512037E
B3B3B3A3B61280A519457CC420>I<90277F8007FEEC0FFCB590263FFFC090387FFF8092
B5D8F001B512E002816E4880913D87F01FFC0FE03FF8913D8FC00FFE1F801FFC0003D99F
009026FF3E007F6C019E6D013C130F02BC5D02F86D496D7EA24A5D4A5DA34A5DB3A7B600
81B60003B512FEA5572D7CAC5E>I<90397F8007FEB590383FFF8092B512E0028114F891
3987F03FFC91388F801F000390399F000FFE6C139E14BC02F86D7E5CA25CA35CB3A7B600
83B512FEA5372D7CAC3E>I<EC1FFC49B512C0010714F0011F14FC90397FF80FFF9026FF
C0017F48496C7F4848C7EA3FE000078248486E7E49140F001F82A2003F82491407007F82
A400FF1780AA007F1700A46C6C4A5AA2001F5E6D141F000F5E6C6C4A5AA26C6C6CEBFFE0
6C6D485B27007FF80F90C7FC6DB55A010F14F8010114C09026001FFCC8FC312F7DAD38>
I<90397FC00FF8B590B57E02C314E002CF14F89139DFC03FFC9139FF001FFE000301FCEB
07FF6C496D13804A15C04A6D13E05C7013F0A2EF7FF8A4EF3FFCACEF7FF8A318F017FFA2
4C13E06E15C06E5B6E4913806E4913006E495A9139DFC07FFC02CFB512F002C314C002C0
91C7FCED1FF092C9FCADB67EA536407DAC3E>I<90387F807FB53881FFE0028313F0028F
13F8ED8FFC91389F1FFE000313BE6C13BC14F8A214F0ED0FFC9138E007F8ED01E092C7FC
A35CB3A5B612E0A5272D7DAC2E>114 D<90391FFC038090B51287000314FF120F381FF0
03383FC00049133F48C7121F127E00FE140FA215077EA27F01E090C7FC13FE387FFFF014
FF6C14C015F06C14FC6C800003806C15806C7E010F14C0EB003F020313E0140000F0143F
A26C141F150FA27EA26C15C06C141FA26DEB3F8001E0EB7F009038F803FE90B55A00FC5C
D8F03F13E026E007FEC7FC232F7CAD2C>I<EB01E0A51303A41307A2130FA2131FA2133F
137F13FF1203000F90B51280B7FCA4C601E0C7FCB3A3ED01E0A9150302F013C0137F1507
90393FF80F8090391FFC1F006DB5FC6D13FC01015B9038003FE023407EBE2C>I<D97FC0
49B4FCB50103B5FCA50003EC000F6C81B3A85EA25EA25E7E6E491380017FD901F713FE91
38F807E76DB512C7010F1407010313FE9026007FF0EBFC00372E7CAC3E>I<B6903803FF
FCA5000101E09038003E006C163C80017F5D8017F8013F5D6E1301011F5D6E1303010F5D
6E13076D5DED800F6D92C7FC15C05E6DEBE01E163E6D143CEDF07C027F1378EDF8F8023F
5B15FD021F5B15FF6E5BA36E5BA26E90C8FCA26E5AA26E5AA21578362C7EAB3B>I<B5D8
FE1FB539801FFFF0A500019027C0003FE0C7EA7C007114786E17F86C6F6C5C6E1601017F
6E6C5CA26E011F1403013F6F5C6E013F1407011F6F5CA26E0179140F010F048090C7FC6E
01F95C6D02F0EBC01E15806D902681E07F5B18E003C3157C6D9139C03FF07815E76DDA80
1F5B18F803FF14F96E9039000FFDE018FF6E486D5BA36E486D5BA26E486D90C8FCA24B7F
02075DA26E48147C4B143C4C2C7EAB51>I<B6903803FFFCA5000101E09038003E006C16
3C80017F5D8017F8013F5D6E1301011F5D6E1303010F5D6E13076D5DED800F6D92C7FC15
C05E6DEBE01E163E6D143CEDF07C027F1378EDF8F8023F5B15FD021F5B15FF6E5BA36E5B
A26E90C8FCA26E5AA26E5AA21578A215F85D14015D001F1303D83F805B387FC007D8FFE0
5B140F92C9FC5C143E495A387FC1F8EB07F06CB45A6C5B000790CAFCEA01FC36407EAB3B
>121 D<001FB71280A49026FC001F130001E0495A5B49495A90C7485A48495B123E4A5B
4A5B003C495BA24A90C7FC4A5A4A5AC7FC4A5A495B495BA2495B499038800780491300A2
495A4948130F49481400A2485B48495B485BA248495B4890C75A48485C15034848EB1FFE
B7FCA4292C7DAB32>I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fx cmbx12 17.28 52
/Fx 52 123 df<DD7FFF923807FFF8043FB500E049B6FC4BB600F8011F15C0030F03FE90
B77E037FDBFF0716F84AB5D8E007019F49C66C7E4A01FCC790B500E0EB07FE020F01F002
3F91C7EA01FF4A01C091B500FC14074A90C74802F04A7F4A484A4A5C4A484A4A4A7F4949
4D5C49494A91C8FCA249495E9BB57E49765B4B5EA284785B727190C7FC72715A72715A9B
C9FCAB0B3FB512E0C1FCA6D8000F01E0C849C8121F8AB3B3AF003FB6D8F803B7D8803FB6
12F8A67D657DE486>14 D<B812C0AD2A0D7EA636>45 D<EA01FCEA07FF4813804813C048
13E04813F0A2B512F8A76C13F0A26C13E06C13C06C13806C1300EA01FC151574942D>I<
16F04B7E1507151F153FEC01FF1407147F010FB5FCB7FCA41487EBF007C7FCB3B3B3B300
7FB91280A6395E74DD51>49 D<913801FFF8021FEBFFC091B612F8010315FF010F16C001
3F8290267FFC0114F89027FFE0003F7F4890C7000F7F48486E7FD807F86E148048486E14
C048486E14E048486F13F001FC17F8486C816D17FC6E80B56C16FE8380A219FFA283A36C
5BA26C5B6C90C8FCD807FC5DEA01F0CA14FEA34D13FCA219F85F19F04D13E0A294B512C0
19804C14004C5B604C5B4C5B604C13804C90C7FC4C5A4C5A4B13F05F4B13804B90C8FC4B
5AED1FF84B5A4B5A4B48143F4A5B4A48C8FC4A5A4A48157E4A5A4A5AEC7F8092C9FC02FE
16FE495A495A4948ED01FCD90FC0150749B8FC5B5B90B9FC5A4818F85A5A5A5A5ABAFCA2
19F0A4405E78DD51>I<92B5FC020F14F8023F14FF49B712C04916F0010FD9C01F13FC90
271FFC00077FD93FE001017F49486D8049C86C7F484883486C6F7F14C0486D826E806E82
487FA4805CA36C5E4A5E6C5B6C5B6C495E011FC85A90C95CA294B55A614C91C7FC604C5B
4C5B4C5B4C5B047F138092260FFFFEC8FC020FB512F817E094C9FC17F817FF91C7003F13
E0040713F8040113FE707F717F7113E085717FA2717F85A285831A80A31AC0EA03FCEA0F
FF487F487F487FA2B57EA31A80A34D14005C7E4A5E5F6C495E49C8485BD81FF85F000F5E
D807FE92B55A6C6C6C4914806C01F0010791C7FC6C9026FF803F5B6D90B65A011F16F001
0716C001014BC8FCD9001F14F0020149C9FC426079DD51>I<F01F804E7E187F18FFA25F
5F5F5FA25F5F5FA294B5FC5E5E5EA25E5EEE3FBFEE7F3FA216FEED01FCED03F8ED07F0A2
ED0FE0ED1FC0ED3F8016005D15FE4A5A4A5AA24A5A4A5A4A5A4A5AA24AC7FC14FE495A5C
1303495A495A495A5C133F49C8FC13FE485AA2485A485A485A5B121F485A48C9FC12FEBC
FCA6CA6CEBC000B1037FB8FCA6485E7CDD51>I<01C0EE01C0D801F8160F01FF167F02F0
EC07FFDAFF8090B5FC92B7128019006060606060606095C7FC17FC5F17E0178004FCC8FC
16E09026FC3FFCC9FC91CBFCADED3FFE0203B512F0020F14FE023F6E7E91B712E001FDD9
E00F7F9027FFFE00037F02F801007F02E06EB4FC02806E138091C8FC496F13C04917E071
13F0EA00F090C914F8A219FC83A219FEA419FFA3EA03F0EA0FFC487E487E487FA2B57EA3
19FEA35C4D13FC6C90C8FC5B4917F8EA3FF001804B13F06D17E0001F5E6C6C17C06D4B13
80D807FC92B512006C6C4A5B6C6C6C01075B6C01E0011F5BD97FFE90B55A6DB712C0010F
93C7FC6D15FC010115F0D9003F1480020301F0C8FC406078DD51>I<EE1FFF0303B512E0
031F14F892B612FE0203814AD9FC037F021F9039C0007FC04A90C7EA1FE0DAFFFC6E7E49
4914074949EC7FF8494914FF49495B4949497F4990C7FC495D5C13FF485BA25A4A6E5B5A
715B48496E5B725A4894C8FCA35AA35C48913801FFE0030F13FE033F6D7E4B14E092B612
F89126E1FE037FB53AE3F0007FFEDAE7E06D7EDAEFC06D7F4B6D7F02FFC76C7F4A82717F
4A82A2854A8085A24A1780A54A17C0A37EA77EA47E6E1780A27EA21A007E4D5B7E6E5E7E
6E5E6C4C5B6D7E013F4B5B6D6C4A5B6D01C0495B6D6D90B5C7FC6DD9FC0713FC6D90B65A
6D5E023F15C0020F92C8FC020114F8DA001F1380426079DD51>I<EA07E0120F7F13FCEB
FFFC91B912F8A45AA21AF01AE01AC01A801A00A248606161616101E0C9123F01804C5A48
CA485A4D90C7FC60007E4C5A17074D5A4D5A4D5A485F4D5A17FF4C90C8FCC9485A5F4C5A
160F4C5A5F163F4C5A16FF5F5D94C9FC5D5D5E150FA24B5AA2153FA24B5AA215FFA34A5B
A25CA35CA44A5BA45CA65CAD6E5BA26E5BDA03FECAFC6E5A456377E051>I<EA01FCEA07
FF4813804813C04813E04813F0A2B512F8A76C13F0A26C13E06C13C06C13806C1300EA01
FCC8FCB3A4EA01FCEA07FF4813804813C04813E04813F0A2B512F8A76C13F0A26C13E06C
13C06C13806C1300EA01FC154074BF2D>58 D<F00FE04E7EA24E7EA34E7EA24E7EA34D7F
A24D80A24D80A34D80A24D80A34D80A2DD7FBF7FA2181F05FF8017FE04016D7FA24D7E04
038217F804076D80A24D7E040F8217E0041F6D80A24D7F043F825F047F6E7FA294C77E4C
825E03016F7FA24C800303845E03076F80A24C80030F845E031F6F80A24C81033F845E03
7F707F93B9FCA292BA7EA24A85A203FCC912070203865D020771805D86020F864B82021F
865D87023F864B83027F8692CBFC874A864A840101875C496C728090381FFFC0B700E092
B812FEA66F647BE37A>65 D<BB12F0F2FF801BF81BFEF3FFC088D800010280C7000114F8
DF003F7F080F13FF74807480867480757FA2757FA28987A289A965A26365A2515BA298B5
5A505C505C5091C7FC505B505B087F13F00703B512C096B6C8FC93B812F81BC01BF8F3FF
801CE00480C8001F13F8080713FE08016D7E7480757F757F757F89757F89871E80871EC0
A41EE087A663A21EC0A3631E80A2511400A2515B515B6398B55A505C08075C081F5C97B6
C7FCBD5A1CF81CE099C8FC1BF898C9FC63627AE173>I<4DB5ED03C0057F02F014070407
B600FE140F047FDBFFC0131F4BB800F0133F030F05FC137F033F9127F8007FFE13FF92B6
C73807FF814A02F0020113C3020702C09138007FE74A91C9001FB5FC023F01FC16074A01
F08291B54882490280824991CB7E49498449498449498449865D49498490B5FC484A84A2
484A84A24891CD127FA25A4A1A3F5AA348491A1FA44899C7FCA25CA3B5FCB07EA380A27E
A2F50FC0A26C7FA37E6E1A1F6C1D80A26C801D3F6C6E1A00A26C6E616D1BFE6D7F6F4E5A
7F6D6D4E5A6D6D4E5A6D6D4E5A6D6E171F6D02E04D5A6E6DEFFF806E01FC4C90C7FC020F
01FFEE07FE6E02C0ED1FF8020102F8ED7FF06E02FF913803FFE0033F02F8013F1380030F
91B648C8FC030117F86F6C16E004071680DC007F02F8C9FC050191CAFC626677E375>I<
BB12E0F2FF801BF01BFE757E1CF0D800010280C7000780DF007F13FE080F6D7E08018074
80093F7F090F13FC757F757F877580767F8A88767F8A888AA2767FA28A881F80A37614C0
A41FE0A5881FF0B05214E0A51FC0A4521480A31F006466A2525BA2525BA2525B666499B5
5A515C5191C7FC515B515B515B097F5B50B512C008075C083F91C8FC0707B512FCBD12F0
1CC051C9FC1BF81B8008E0CAFC6C627AE17C>I<BD12FCA488A2D8000102C0C71201F100
0F1A01F2007F1B3F1B0F1B07757EA28787A288A3F43F80A31C1FA3197EA3F40FC0A499C7
FC19FEA31801A218031807181F18FF93B6FCA6EEC000181F180718031801A21800A21D7E
197EA21DFCA696C812011DF8A31C03A3F407F0A31C0FA21C1F1C3F1DE01C7F1CFF63631B
0F093F13C098B5FC1A0797B6FCBEFCA31D80A35F617AE06A>I<BD12E0A41CF0A2D80001
02C0C71207F1003F1A0F1A031A001B7F1B3FF31FF81B0FA21B07A21B03A21B011CFCA31B
00A419FCA21C7EA41C00A21801A31803A21807180F183FEF01FF93B6FCA6EEC001EF003F
180F18071803A21801A31800A896C9FCB3A5B912F8A657617AE065>I<4DB5ED03C0057F
02F014070407B600FE140F047FDBFFC0131F4BB800F0133F030F05FC137F033F9127F800
7FFE13FF92B6C73807FF814A02F0020113C3020702C09138007FE74A91C9001FB5FC023F
01FC16074A01F08291B54882490280824991CB7E49498449498449498449865D49498490
B5FC484A84A2484A84A24891CD127FA25A4A1A3F5AA348491A1FA44899C8FCA25CA3B5FC
B07E071FB812F880A37EA296C70001ECC000A26C7FA37E807EA26C80A26C80A26C807F6D
7F816D7F7F6D7F6D6D5F6D14C06D6E5E6E7F6E01FC5E020F01FF5E6E02C0ED7FEF020102
F8EDFFC76E02FF02071383033F02FC013F1301030F91B638FC007F03014D131F6F6C04E0
1307040704801301DC007F02F8CAFC050191CBFC6D6677E37F>I<B912E0A6C702E0C7FC
B3B3B3B3AEB912E0A633627CE13C>73 D<B912F8A6D8000102C0CBFCB3B3B1F307E0A5F3
0FC0A61B1FA31B3F1C80A21B7FA21BFFA262A262625013006262624FB5FC1907191F4EB6
FCBDFC63A553627AE161>76 D<B700C0083FB612F070627097B7FCA37061D800010DF8C7
FC70F103EFA202FD6DF107CFA202FC6DF10F8FA36F6DF01F0FA26F6D183EA26F6D187CA2
6F6D18F8A36F6DEF01F0A26F6DEF03E0A26F6DEF07C0A26F6DEF0F80A3706DEE1F00A270
6D163EA2706D5EA2706D5EA3706D4B5AA2706D4B5AA2706D4B5AA2706D4B5AA3716D4AC7
FCA2716D143EA2716D5CA2716D5CA3716D495AA2716D495AA2716D495AA2716D495AA372
6D48C8FCA272EBC03EA2726D5AA2726D5AA372EBF9F0A272EBFFE0A2725CA2725CA37390
C9FCA2735AA2735A90381FFFC0B700F86E480207B812F0A3735AA2735A8C627AE199>I<
B700E0040FB7128082828282A2D800016EDC000101FCC7FC719338001FC08383A28302FD
808302FC80816F7F6F806F8084816F806F806F8084707F82708070808570808270807080
85717F83718071807180868371807180727F8672808472807280877280847280737F8773
1480857314C07314E01CF07314F8857314FC7413FE7413FF1D9F867414DF7414FF86A286
868787A287878787A28787888888A288888890261FFFC084B712F8881D7F1D3F1D1F775A
71627AE17E>I<94381FFFE00407B67E043F15F04BB712FE030FEEFFC0033FD9FC0014F0
92B500C0010F13FC020349C7000113FF4A01F86E6C7F021F496F13E04A01C0030F7F4A49
6F7F91B5C96C7F0103497013FF494970804B834949717F49874949717F49874B8390B586
484A717FA24891CB6C7FA2481D804A84481DC0A348497214E0A3481DF0A34A85481DF8A5
B51CFCB06C1DF8A36E96B5FCA36C1DF0A46C6D4E14E0A36C1DC06E606C1D80A26C6E4D14
00A26C6E4D5BA26C6E4D5BA26D6D4D5B6D636D6D4D5B6F94B5FC6D636D6D4C5C6D6D4C91
C7FC6D6E4B5B6D02E0031F5B023F6D4B13F06E01FC92B55A6E01FF02035C020302C0010F
91C8FC020002FC90B512FC033F90B712F0030F17C0030394C9FCDB007F15F804071580DC
001F01E0CAFC666677E379>I<BB7E1AFCF2FFC01BF81BFE757ED800010280C7001F8007
0114F0736C7F081F7F747F747F7414807414C0A27414E0A21DF0A27513F8A41DFCA91DF8
A498B512F0A21DE0A25014C01D8062501400505B505B087F5B4FB512E0071F5C93B9C7FC
1BFC1BF01B8008F0C8FC04C0CCFCB3B3A2B97EA65E627AE16E>I<BA12F8F1FFE01AFEF2
FFC01BF01BFED800010280C76C7F070714C0070014F0747F081F7F747F747F7480A27480
89A37480A389A865A3505CA265A2505C9AC9FC505B505B505B087F5B4FB55A0707148096
B548CAFC93B812F81BC050CBFC621AFF932680000314C0DE007F7F071F13F8737F737F73
7F73808885888688A2747FA688A688A676140FF71F80A374801F3F86771400745E746E5B
B96E6E5B746E485A75EBFE07091F90B55A090715E009015DCF003F91C7FC0A0013FC7164
7AE178>82 D<DBFFFCEC01E0020FD9FFE01303027F02FC130749B7130F0107EEC01F011F
16F049D9C007EBF83F4948C7383FFE7FD9FFF8020FB5FC4801E014014849804849153F91
C97E484882001F834982003F83845B007F187FA2193FA200FF181FA27F190FA27FA26D17
078080806C01F893C7FC80ECFF8015F86CECFFC016FC6CEDFFE017FE6CEEFFE018F86C17
FE6C717E6C846C846D17F86D836D836D8313036D18806D6C17C0020F17E01401DA000F16
F01500040715F8EE007F1703050014FC183F84060713FE84A2007C8300FC83A2197FA319
3F7EA31AFC7EA27F1AF86D177F7F1AF06D17FF6D18E06D5E01FF18C06E4B138002E04B13
0002F84B5A02FFED3FFC01CF01E0ECFFF8018301FF010F5B010191B65A6D6C5E48011F93
C7FC48010315FC48D9003F14E048020149C8FC476677E35A>I<001FBEFCA64849C79126
E0000F148002E0180091C8171F498601F81A0349864986A2491B7FA2491B3F007F1DC090
C9181FA4007E1C0FA600FE1DE0481C07A5CA95C7FCB3B3B3A3021FBAFCA663617AE070>
I<B96C023FB612FEA6D8000102C0CA0007EBF000E2007FC7FCB3B3B3AA656D63A2821C01
806570170380525A6E7F6E4F5A70171F6E626E6D4D5A6E6D177F525A6E6E030390C8FC03
3F01E04B5A6F6DED1FFC6F01FCED7FF80303D9FF80903803FFE06F02F8017F5B6F6C90B7
C9FC041F5E040716F8040016C0050F4ACAFCDD003F13C06F647AE17C>I<B800FC047FB6
12E0A6D800070280CB6CEB80006D6EDE07FCC7FC666D6E611D0F6D6E611D1FA26E6D611D
3F6E6D611D7F6E6D96C8FC65A26E6D4D5AA26E6E5F1C036E6E5F1C076E6E5F1C0FA26E6E
5F1C1F6F6D5F1C3F6F6D5F1C7FA26F6D4CC9FCA26F6D5E1B016F6E5D1B03A26F6E4A5AA2
6F6E5D1B0F6F6E5D1B1F706D5D1B3FA2706D5D1B7F706D92CAFC63706D5C1A01A2706E48
5AA27002C05B1A077002E05B1A0F7002F05B1A1FA27101F85B1A3F7101FC5B1A7F7101FE
90CBFC62A2716D5AA2715CA2715CA3715CA2715CA2725BA2725BA37290CCFCA2725AA272
5AA2725A73637DE17A>I<913803FFFE027FEBFFF00103B612FE010F6F7E4916E090273F
FE001F7FD97FE001077FD9FFF801017F486D6D7F717E486D6E7F85717FA2717FA36C496E
7FA26C5B6D5AEB1FC090C9FCA74BB6FC157F0207B7FC147F49B61207010F14C0013FEBFE
004913F048B512C04891C7FC485B4813F85A5C485B5A5CA2B55AA45FA25F806C5E806C04
7D7F6EEB01F96C6DD903F1EBFF806C01FED90FE114FF6C9027FFC07FC01580000191B548
7E6C6C4B7E011F02FC130F010302F001011400D9001F90CBFC49437CC14E>97
D<903807FF80B6FCA6C6FC7F7FB3A8EFFFF8040FEBFF80047F14F00381B612FC038715FF
038F010014C0DBBFF0011F7FDBFFC001077F93C76C7F4B02007F03F8824B6F7E4B6F1380
4B17C0851BE0A27313F0A21BF8A37313FCA41BFEAE1BFCA44F13F8A31BF0A24F13E0A24F
13C06F17804F1300816F4B5A6F4A5B4AB402075B4A6C6C495B9126F83FE0013F13C09127
F00FFC03B55A4A6CB648C7FCDAC00115F84A6C15E091C7001F91C8FC90C8000313E04F65
7BE35A>I<92380FFFF04AB67E020F15F0023F15FC91B77E01039039FE001FFF4901F801
0113804901E0010713C04901804913E0017F90C7FC49484A13F0A2485B485B5A5C5A7113
E0485B7113C048701380943800FE0095C7FC485BA4B5FCAE7EA280A27EA2806C18FCA26C
6D150119F87E6C6D15036EED07F06C18E06C6D150F6D6DEC1FC06D01E0EC7F806D6DECFF
00010701FCEB03FE6D9039FFC03FFC010091B512F0023F5D020F1580020102FCC7FCDA00
0F13C03E437BC148>I<F17FF8050FB5FCA6EF000F8484B3A892380FFF804AB512F8020F
14FE023FECFF8391B712E301039138807FF3499039F8000FFB011F01E00103B5FC494913
004990C87E49488148498148834A815A485BA2485BA25AA3485BA4B5FCAE7EA46C7FA37E
A26C7FA26C5F806C5F6C6D5D6C6D5D017F93B5FC6D6C6C0103806D6D49806D01F0D91FF7
EBFFFE6D9039FE01FFE7010190B612876D6CECFE07021F14F8020314E09127003FFE00EC
C0004F657BE35A>I<92380FFFC04AB512FC020FECFF80023F15E091B712F80103D9FE03
7F499039F0007FFF011F01C0011F7F49496D7F4990C76C7F49486E7F48498048844A8048
84485B727E5A5C48717EA35A5C721380A2B5FCA391B9FCA41A0002C0CBFCA67EA380A27E
A27E6E160FF11F806C183F6C7FF17F006C7F6C6D16FE6C17016D6C4B5A6D6D4A5A6D01E0
4A5A6D6DEC3FE0010301FC49B45A6D9026FFC01F90C7FC6D6C90B55A021F15F8020715E0
020092C8FC030713F041437CC14A>I<EE3FFC0307B51280033F14C04AB612F0020715F8
4A9038F03FFC4AEB807F913A7FFE00FFFE4A5A4B4813FF4913F05B4913E0A24913C0A270
13FE4949EB7FFCEF3FF8EF1FF0EF07C094C7FCB0B812C0A6D8001F01C0C8FCB3B3B0007F
B612FCA638657CE431>I<F107F8DB7FFEEC3FFE020FB5D8F001B5FC027FDAFE03148049
B7128F49DCDFFD13C0010FD9F00FEBFFC149D9800114014990C7EBFC0349486E6C7E4948
EC3FFF48496E018113800780130048F0C03E97C7FC48496E7FA34884A96C60A36C6D4A5B
A26C60A26C6D4A90C8FC6D6C4A5A6D6C4A5A6D6D485BDBF00F5B4990B612C060D97C7F4A
C9FCD9FC0F14F09126007FFECAFC92CCFC1201A47FA27F8014F091B77E18FE6CEFFFC019
F06D17FC19FF6D846D846D846D84013F8490BAFC0003854801E0C712014890C9000F7F48
4816014848EE007F4848717E8512FF5B85A56D5F007F616D173F003F616D177F6C6C4D5A
6C01C003035B6C6D4B5B6C01F8031F5BC601FF92B5C7FC6D01F8011F5B011F90B712F801
0717E0010094C8FC020F15F0DA003F01FCC9FC4A607CC151>I<903807FF80B6FCA6C6FC
7F7FB3A8EF1FFF94B512F0040714FC041F14FF4C8193267FE07F7F922781FE001F7FDB83
F86D7FDB87F07FDB8FC0814C7F039FC78015BE03BC8003FC825DA25DA25DA45DB3B2B7D8
F007B71280A651647BE35A>I<EB0FE0EB3FF8497E48B5FCA24880A24880A76C5CA26C91
C7FCA238007FFC6D5AEB0FE090C9FCAF903807FF80007FB5FCA6C6FC7F7FB3B3AEB712C0
A622657BE42C>I<903807FF80B6FCA6C6FC7F7FB3A90503B61280A6DD003FEB8000DE0F
FCC7FCF01FF04E5AF0FFC04D5B4D90C8FCEF07FC4D5AEF3FF04D5A4D5A4C90C9FC4C5AEE
0FFC4C5A4C5AEE7FC04C7E03837F03877F158F039F7F03BF7F92B5FC838403FC804B7E03
F0804B6C7F4B6C7F1580707F707F707FA270807080717FA2717F717F717FA2717F717F83
867180727F95B57EB7D8E00FECFFF0A64C647BE355>107 D<903807FF80B6FCA6C6FC7F
7FB3B3B3B3ADB712E0A623647BE32C>I<902607FF80D91FFFEEFFF8B691B500F00207EB
FF80040702FC023F14E0041F02FF91B612F84C6F488193267FE07F6D4801037F922781FE
001F9027E00FF0007FC6DA83F86D9026F01FC06D7F6DD987F06D4A487F6DD98FC0DBF87E
C7804C6D027C80039FC76E488203BEEEFDF003BC6E4A8003FC04FF834B5FA24B5FA24B94
C8FCA44B5EB3B2B7D8F007B7D8803FB612FCA67E417BC087>I<902607FF80EB1FFFB691
B512F0040714FC041F14FF4C8193267FE07F7F922781FE001F7FC6DA83F86D7F6DD987F0
7F6DD98FC0814C7F039FC78015BE03BC8003FC825DA25DA25DA45DB3B2B7D8F007B71280
A651417BC05A>I<923807FFE092B6FC020715E0021F15F8027F15FE494848C66C6C7E01
0701F0010F13E04901C001037F49496D7F4990C87F49486F7E49486F7E48496F13804819
C04A814819E048496F13F0A24819F8A348496F13FCA34819FEA4B518FFAD6C19FEA46C6D
4B13FCA36C19F8A26C6D4B13F0A26C19E06C6D4B13C0A26C6D4B13806C6D4B13006D6C4B
5A6D6D495B6D6D495B010701F0010F13E06D01FE017F5B010090B7C7FC023F15FC020715
E0020092C8FC030713E048437CC151>I<902607FF80EBFFF8B6010FEBFF80047F14F003
81B612FC038715FF038F010114C09227BFF0003F7FC6DAFFC0010F7F6D91C76C7F6D496E
7F03F86E7F4B6E7F4B17804B6F13C0A27313E0A27313F0A21BF885A21BFCA3851BFEAE4F
13FCA41BF861A21BF0611BE0611BC06F92B512801B006F5C6F4A5B6F4A5B03FF4A5B7049
5B04E0017F13C09226CFFC03B55A03C7B648C7FC03C115F803C015E0041F91C8FC040313
E093CBFCB3A3B712F0A64F5D7BC05A>I<D90FFFEB0FFCB690383FFF8093B512E04B14F0
4B14F8923907FC7FFC92390FE0FFFEC6EC1F806DD93F0113FF6D133E157E157C15F8A215
F07013FEA24BEB7FFCEF3FF8EF0FE04B90C7FCA55DB3B0B712F8A638417BC042>114
D<913A3FFF8007800107B5EAF81F011FECFE7F017F91B5FC48B8FC48EBE0014890C7121F
D80FFC1407D81FF0801600485A007F167F49153FA212FF171FA27F7F7F6D92C7FC13FF14
E014FF6C14F8EDFFC06C15FC16FF6C16C06C16F06C826C826C826C82013F1680010F16C0
1303D9007F15E0020315F0EC001F1500041F13F81607007C150100FC81177F6C163FA217
1F7EA26D16F0A27F173F6D16E06D157F6D16C001FEEDFF806D0203130002C0EB0FFE02FC
EB7FFC01DFB65A010F5DD8FE0315C026F8007F49C7FC48010F13E035437BC140>I<EC07
E0A6140FA5141FA3143FA2147FA214FF5BA25B5B5B5B137F48B5FC000F91B512FEB8FCA5
D8001F01E0C8FCB3AFEF0FC0AC171F6D6D1480A2173F6D16006F5B6D6D137E6D6D5B6DEB
FF836EEBFFF86E5C020F14C002035C9126003FFCC7FC325C7DDA3F>I<902607FFC0ED3F
FEB60207B5FCA6C6EE00076D826D82B3B3A260A360A2607F60183E6D6D147E4E7F6D6D49
48806D6DD907F0ECFF806D01FFEB3FE06D91B55A6E1500021F5C020314F8DA003F018002
F0C7FC51427BC05A>I<B700C00103B512FCA6C66C01C0C8381FFE006D6DED07F0A26D6D
5E190F6D6D5E191F6D606F153F6D95C7FC6F5DA26D6D157E19FE6D6E5C18016E5E701303
6E5E701307A26E6D5C180F6E6D5C181F6E6D5C183F6E93C8FC705BA26E6D13FEA26E6E5A
17816FEBC1F817C36F5C17E76F5C17FFA26F5CA26F5CA26F91C9FCA26F5BA36F5BA2705A
A2705AA2705AA2705A4E417DBF55>I<B70081B600FC0103B512FCA6C66C0180C701FCC8
381FFE006F6FED03F86D047F5F856F6E16076D646F70140F6D705F866F6E161F6D646F4A
6D143F6D99C7FC4E7F6F616D1B7E6F4A6D14FE6D6395B57E7001FC15016E62DCC0016E13
036EDBF87F5D05038004E0496C14076E62DCF007ED800F6E4B6C5D050F15C004F8496C14
1F6E62DCFC1FEDE03F6E4B6C92C8FC053F15F004FE496C5C6E197E7048EDF8FE6E027E6D
5C05FE15FC4D6D13FD6F601BFF6F496E5BA24D806F60A26F496E5BA24D806F60A26F496E
90C9FCA294C87E6F5FA26F486F5A047C6F5A6E417DBF75>I<B700C00103B512FCA6D800
3F01C0C8381FFE006FED07F0A26D6D5E190F6D6D5E191F6D6D5E193F6D95C7FC6F5D6D17
7E6F15FEA26D6E495AA26E6D5C18036E6D5C18076E5E70130F6E5E70131FA26E6D495AA2
6E6D91C8FC606E6D137E18FE6E5D17816F5C17C3A26FEBE7F0A26FEBF7E017FF6F5CA26F
5CA26F91C9FCA36F5BA26F5BA2705AA2705AA2705AA35FA25F163F94CAFC5E167E16FED8
07E05CD81FF81301487E486C495AA2B5495AA24B5A5E151F4B5A6C4849CBFC15FEEBFC01
393FF807FC391FF03FF06CB55A6C5C6C91CCFCC613FCEB1FE04E5D7DBF55>121
D<0007B912E019F0A402FCC714E04801C04914C091C7FC494A1480494A1400494A5B5B4C
5B494A5B4C5B5B93B55A4B5C5D001F5F494991C7FC4B5BA24B5B4B5BC8485BA292B55A4A
5C4A5CA24A91C8FC4A5B4A5BA24A5B4A49EB03F091B55AA2495C495C4991C7FC18074949
15E0495B5B5D4949140F90B55AA2484A141F485C4891C8123F187F484915FF48495C4849
1407051F13C0484949B5FCBAFCA47E3C407CBF48>I E
%EndDVIPSBitmapFont
end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%BeginPaperSize: a4
a4
%%EndPaperSize

%%EndSetup
%%Page: 1 1
1 0 bop 111 52 a Fx(V)-13 b(ersion)53 b(2.3)g(Of)h(The)f(Met)h(O\016ce)
g(Large)f(Eddy)g(Mo)t(del:)690 188 y(P)l(art)h(I)t(I)t(I.)h(Soft)l(w)l
(are)d(Do)t(cumen)l(tation)569 429 y Fw(M.)37 b(E.)g(B.)h(Gra)m(y)-9
b(,)37 b(A.)g(R.)g(Bro)m(wn,)g(A.)h(P)-9 b(.)36 b(Lo)s(c)m(k)i(and)g
(J.)g(P)m(etc)m(h)0 882 y Fx(Con)l(ten)l(ts)0 1222 y
Fw(1)90 b(In)m(tro)s(duction)2959 b(1)0 1560 y(2)90 b(Ov)m(erview)37
b(of)h(the)f(Co)s(de)2505 b(2)146 1801 y Fv(2.1)100 b(Computing)31
b(Language)44 b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)141
b(2)146 2041 y(2.2)100 b(Running)32 b(of)g(the)h(Co)s(de)66
b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)141
b(2)146 2282 y(2.3)100 b(Decomp)s(osition)30 b(of)i(the)h(Mo)s(del)f
(Domain)77 b(.)49 b(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)141 b(3)146 2523 y(2.4)100
b(Main)32 b(V)-8 b(ariables)87 b(.)50 b(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)141 b(4)146 2764 y(2.5)100 b(Structure)33
b(of)f(Main)g(Program)25 b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)141
b(5)0 3102 y Fw(3)90 b(Initialization)2949 b(5)146 3343
y Fv(3.1)100 b(Input)33 b(Namelists)46 b(.)k(.)f(.)h(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)141 b(6)146 3584 y(3.2)100
b(Initial)30 b(Conditions)56 b(.)49 b(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)141 b(8)146 3824 y(3.3)100 b(Setting)32
b(Reference)i(Pro\014les)97 b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)141
b(9)146 4065 y(3.4)100 b(Ph)m(ysical)32 b(P)m(arameters)94
b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92
b(10)146 4306 y(3.5)100 b(Allo)s(cation)58 b(.)50 b(.)g(.)g(.)g(.)f(.)h
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(11)0
4644 y Fw(4)e(In)m(tegration)2975 b(11)146 4885 y Fv(4.1)100
b(Indexing)33 b(of)f(the)h(I-Lo)s(op)74 b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)92 b(12)146 5126 y(4.2)100 b(Calculation)30
b(of)i(Viscosit)m(y)101 b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92
b(16)146 5367 y(4.3)100 b(Dynamics)80 b(.)50 b(.)g(.)g(.)g(.)f(.)h(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(18)146
5607 y(4.4)100 b(Radiation)79 b(.)50 b(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(20)146 5848
y(4.5)100 b(Microph)m(ysics)27 b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)
h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(21)1876 6107 y(i)p
eop
%%Page: 2 2
2 1 bop 146 52 a Fv(4.6)100 b(Bac)m(kscatter)81 b(.)50
b(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92
b(22)146 293 y(4.7)100 b(Pressure)34 b(Solv)m(er)79 b(.)50
b(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92
b(23)146 534 y(4.8)100 b(Large-Scale)31 b(Adv)m(ection)j(and)e(F)-8
b(orcing)86 b(.)50 b(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)
h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(25)146 775 y(4.9)100
b(Stepping,)32 b(Sw)m(apping)h(and)g(Time-smo)s(othing)42
b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)92 b(26)146 1016 y(4.10)51 b(Numerics)101 b(.)50
b(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
92 b(27)0 1354 y Fw(5)e(Outputs)3119 b(27)146 1595 y
Fv(5.1)100 b(Instan)m(taneous)34 b(Diagnostics)79 b(.)50
b(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f
(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(29)146 1835 y(5.2)100
b(Time-Av)m(eraged)32 b(Diagnostics)95 b(.)50 b(.)g(.)g(.)g(.)g(.)f(.)h
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)92 b(30)146 2076 y(5.3)100 b(Conditionally)29 b(Sampled)j
(Diagnostics)83 b(.)50 b(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(31)146 2317
y(5.4)100 b(Microph)m(ysics)33 b(and)g(Radiation)d(Diagnostics)94
b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)92 b(32)146 2558 y(5.5)100 b(Timeseries)49 b(.)h(.)g(.)g(.)g(.)
f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92
b(33)146 2798 y(5.6)100 b(Sp)s(ectra)33 b(Diagnostics)40
b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92
b(34)146 3039 y(5.7)100 b(Animations)84 b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(34)146
3280 y(5.8)100 b(Mo)s(del)32 b(Dumps)53 b(.)d(.)g(.)f(.)h(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(35)146 3521
y(5.9)100 b(Error)32 b(Messages)j(and)d Fw(EXXIT)h Fv(.)50
b(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(36)0 3859 y Fw(6)e(P)m(arallel)35
b(Pro)s(cessing)i(Issues)2266 b(37)146 4100 y Fv(6.1)100
b(Pressure)34 b(Solv)m(er)79 b(.)50 b(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)92 b(38)146 4341 y(6.2)100 b(Diagnostics)88
b(.)50 b(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)92 b(40)146 4581 y(6.3)100 b(Means)33 b(and)g(Extremes)66
b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92
b(42)146 4822 y(6.4)100 b(2-D)31 b(P)m(arallel)f(Pro)s(cessing)45
b(.)50 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)92 b(42)0
5160 y Fw(7)e(Co)s(ding)37 b(Standards)2642 b(43)0 5499
y(A)61 b(Description)36 b(of)i(Main)f(V)-9 b(ariables)2050
b(46)0 5837 y(B)66 b(Alphab)s(etical)36 b(List)h(of)g(Common)g(Blo)s(c)
m(ks)1710 b(47)1863 6107 y Fv(ii)p eop
%%Page: 3 3
3 2 bop 0 52 a Fw(C)65 b(Alphab)s(etical)36 b(List)h(of)g(Subroutines)
1928 b(51)0 391 y(D)60 b(Alphab)s(etical)36 b(List)h(of)g(F)-9
b(unctions)1982 b(110)0 729 y(E)72 b(Pre-Compiler)35
b(Options)2381 b(112)0 1067 y(F)76 b(Glossary)38 b(of)f(GCOM)h
(Routines)2045 b(113)0 1406 y(G)58 b(Output)38 b(Unit)e(Num)m(b)s(ers)
2362 b(113)1849 6107 y Fv(iii)p eop
%%Page: 1 4
1 3 bop 155 482 a Fu(V)-13 b(ersion)53 b(2.3)f(Of)g(The)g(Met)g
(O\016ce)g(Large)g(Eddy)h(Mo)t(del:)723 689 y(P)l(art)f(I)t(I)t(I.)i
(Soft)l(w)l(are)d(Do)t(cumen)l(tation)512 1106 y Ft(M.)39
b(E.)f(B.)h(Gra)m(y)-10 b(,)37 b(A.)h(R.)h(Bro)m(wn,)e(A.)h(P)-10
b(.)39 b(Lo)s(c)m(k)f(and)h(J.)f(P)m(etc)m(h)1383 1466
y(15)1501 1423 y Fs(th)1610 1466 y Ft(No)m(v)m(em)m(b)s(er)e(2001)1690
1902 y Fr(Abstract)380 2177 y Fq(The)30 b(structure)g(and)g(co)s(ding)f
(of)i(the)f(Met)i(O\016ce)e(Large)h(Eddy)e(Mo)s(del)h(are)h(describ)s
(ed.)0 2630 y Fx(1)161 b(In)l(tro)t(duction)0 2969 y
Fv(The)38 b(Large-Eddy)f(Mo)s(del)f(\(LEM\))h(is)g(a)f(n)m(umerical)f
(mo)s(del)g(designed)j(to)e(in)m(tegrate)h(the)g(mo)s(di\014ed)0
3090 y(Na)m(vier-Stok)m(es)f(equations,)h(along)d(with)h
(parametrizations)e(for)i(turbulence,)i(microph)m(ysical)d(pro-)0
3210 y(cesses)i(and)e(radiation)d(to)i(pro)m(vide)h(a)g(high)e
(resolution)h(sim)m(ulation)e(of)i(cloud-scale)f(and)i(turbulen)m(t)0
3330 y(pro)s(cesses)h(in)e(the)h(trop)s(osphere.)47 b(This)33
b(requires)h(the)g(execution)g(of)f(a)g(large)g(n)m(um)m(b)s(er)h(of)e
(computa-)0 3451 y(tions)h(whic)m(h)i(had)f(led)g(to)f(the)i(LEM)f(b)s
(ecoming)f(a)h(rather)g(in)m(v)m(olv)m(ed)g(piece)h(of)e(soft)m(w)m
(are.)49 b(Ho)m(w)m(ev)m(er,)0 3571 y(the)38 b(soft)m(w)m(are)h(in)e
(earlier)g(v)m(ersions)h(of)g(the)g(LEM)h(w)m(as)f(not)g(comprehensiv)m
(ely)h(do)s(cumen)m(ted;)i(Der-)0 3691 y(b)m(yshire)29
b(et)g(al)f(\(1994\))f(discussed)j(some)f(asp)s(ects)g(of)f(the)h(co)s
(de)g(structure)h(and)f(v)-5 b(ariable)26 b(names)j(with)0
3812 y(a)f(more)f(comprehensiv)m(e)j(discussion)e(of)g(the)h(philosoph)
m(y)f(and)g(science)h(of)f(the)g(LEM,)h(whilst)f(Bro)m(wn)0
3932 y(et)38 b(al)g(\(1997\))f(concen)m(trated)j(primarily)35
b(on)j(asp)s(ects)h(of)f(the)h(soft)m(w)m(are)g(p)s(ertinen)m(t)f(to)g
(running)g(the)0 4053 y(LEM)g(on)e(a)h(massiv)m(ely)g(parallel)d(pro)s
(cessing)j(\(MPP\))h(mac)m(hine.)56 b(Recen)m(t)38 b(expansion)f(of)g
(the)g(co)s(de)0 4173 y(to)j(incorp)s(orate)f(more)h(detailed)f
(treatmen)m(t)h(of)g(diabatic)f(pro)s(cesses)j(\(three-phase)f(microph)
m(ysics)0 4293 y(and)27 b(radiation\))e(has)j(increased)g(the)f
(requiremen)m(t)h(for)f(full)e(do)s(cumen)m(tation)h(of)h(the)g(LEM)h
(soft)m(w)m(are.)0 4414 y(This)33 b(do)s(cumen)m(t)g(aims)e(to)h(pro)m
(vide)h(this.)146 4655 y(Whereas)43 b(P)m(art)f(I,)h(the)f(User)g(Do)s
(cumen)m(tation,)h(\(Gra)m(y)f(and)g(P)m(etc)m(h)h(2001\))e(and)h(P)m
(art)g(I)s(I,)g(the)0 4775 y(Scien)m(ti\014c)30 b(Do)s(cumen)m(tation,)
e(\(Gra)m(y)i(et)g(al)e(2001\))h(of)g(the)h(LEM)g(do)s(cumen)m(tation)f
(are)h(written)f(to)g(b)s(e)0 4895 y(understo)s(o)s(d)34
b(without)f(recourse)i(to)e(the)h(other)f(sections)h(of)f(the)h
(trilogy)-8 b(,)32 b(this)h(do)s(cumen)m(t,)h(P)m(art)g(I)s(I)s(I)0
5016 y(-)39 b(the)h(soft)m(w)m(are)h(do)s(cumen)m(tation,)g(should)f(b)
s(e)g(read)g(in)f(conjunction)g(with)h(the)g(other)g(t)m(w)m(o)g
(parts.)0 5136 y(F)-8 b(amiliarit)m(y)40 b(with)k(the)h(other)g(t)m(w)m
(o)g(v)m(olumes)g(will)d(b)s(e)j(assumed)h(in)d(the)j(follo)m(wing)c
(text,)48 b(as)d(will)0 5256 y(kno)m(wledge)31 b(of)f(computer)g
(programming.)40 b(This)30 b(do)s(cumen)m(t)h(is)f(really)f(aimed)g
(for)g(the)i(future)g(LEM)0 5377 y(soft)m(w)m(are)e(dev)m(elop)s(er,)h
(rather)d(than)h(the)h(a)m(v)m(erage)g(user,)g(although)e(an)m(y)m(one)
i(who)g(plans)e(to)h(mak)m(e)g(an)m(y)0 5497 y(c)m(hange)33
b(to)g(the)g(co)s(de)g(in)e(an)m(y)j(w)m(a)m(y)f(will)e(\014nd)i(this)f
(an)h(in)m(v)-5 b(aluable)30 b(do)s(cumen)m(t)j(for)f(reference.)146
5738 y(The)25 b(next)f(section)f(of)g(this)g(do)s(cumen)m(t)h(giv)m(es)
f(an)h(o)m(v)m(erview)g(of)f(the)h(purp)s(ose)g(and)g(structure)g(of)f
(the)0 5858 y(co)s(de,)k(in)m(tro)s(ducing)e(the)h(three)g(main)e
(sections)i(of)f(Initialization,)e(In)m(tegration)h(and)i(Outputs.)42
b(Co)s(de)1865 6107 y(1)p eop
%%Page: 2 5
2 4 bop 0 52 a Fv(concerned)26 b(with)f(the)g(mo)s(del)e
(Initialization)e(is)j(describ)s(ed)i(in)e(Section)h(3,)h(that)e(with)h
(the)g(In)m(tegration)0 173 y(in)k(Section)i(4)f(and)g(the)h(Outputs)g
(of)e(the)i(mo)s(del)e(are)h(describ)s(ed)h(in)e(Section)h(5.)43
b(P)m(arallel-pro)s(cessing)0 293 y(issues)31 b(are)f(discussed)i(in)d
(Section)g(6)h(and)g(the)g(co)s(ding)f(standards)i(recommended)f(for)g
(the)g(mo)s(del)e(in)0 414 y(Section)33 b(7.)44 b(Finally)-8
b(,)30 b(details)h(of)i(the)g(main)e(v)-5 b(ariables,)32
b(common)f(blo)s(c)m(ks,)j(subprograms)e(and)h(other)0
534 y(miscellaneous)e(items)h(are)g(con)m(tained)h(in)f(the)h(App)s
(endices.)146 775 y(In)38 b(the)f(follo)m(wing)e(text)j(subroutine)f
(names)g(are)g(written)g(in)g(b)s(old)f(fon)m(t,)i(and)f(v)-5
b(ariable)35 b(names)0 895 y(written)d(in)g(normal)f(fon)m(t)h
(capitals.)42 b(Filenames)31 b(external)i(to)f(the)h(co)s(de)g(are)g
(written)f(in)g(italics.)0 1348 y Fx(2)161 b(Ov)l(erview)54
b(of)f(the)g(Co)t(de)0 1717 y Fp(2.1)135 b(Computing)46
b(Language)0 2022 y Fv(The)i(LEM)g(is)e(written)h(using)g(F)m(OR)-8
b(TRAN)47 b(90.)86 b(Earlier)46 b(v)m(ersions)i(of)e(the)i(co)s(de)f(w)
m(ere)i(written)0 2142 y(in)41 b(F)m(OR)-8 b(TRAN)41
b(77)h(and,)i(hence,)h(large)c(parts)h(of)f(the)h(co)s(de)g(retain)f(F)
m(OR)-8 b(TRAN)41 b(77)h(structures.)0 2263 y(Ho)m(w)m(ev)m(er,)52
b(F)m(OR)-8 b(TRAN)46 b(90)g(features,)k(suc)m(h)e(as)e(INTENT)i(t)m
(yp)s(es)f(and)f(some)g(arra)m(y)h(structures,)0 2383
y(ha)m(v)m(e)31 b(b)s(een)g(used)g(throughout)f(the)h(co)s(de,)g(and)f
(so)g(the)h(LEM)g(will)c(only)j(run)g(with)g(an)g(f90)f(compiler.)0
2503 y(Details)i(of)h(the)h(co)s(ding)f(standards)h(used)h(in)e(dev)m
(eloping)g(V)-8 b(ersion)32 b(2.3)h(of)f(the)h(LEM)g(are)g(describ)s
(ed)0 2624 y(in)f(Section)g(7.)0 3033 y Fp(2.2)135 b(Running)45
b(of)g(the)g(Co)t(de)0 3338 y Fv(The)37 b(LEM)f(has)g(alw)m(a)m(ys)h(b)
s(een)f(co)s(ded)g(for)g(running)f(on)h(the)g(curren)m(t)h(Met)f
(O\016ce)h(sup)s(ercomputer.)0 3459 y(V)-8 b(ersion)27
b(1.4)g(ran)h(on)f(a)g(Cra)m(y)i(C90)e(whic)m(h)h(used)h(v)m(ector)f
(pro)s(cessors)h(and)f(required)g(the)f(\\expansion")0
3579 y(of)i(some)h(arra)m(ys)g(for)g(maxim)m(um)d(sp)s(eed)k(\(Derb)m
(yshire)g(et)f(al)f(1994\).)41 b(The)31 b(pro)s(curemen)m(t)f(of)g(an)f
(MPP)0 3699 y(mac)m(hine)36 b(b)m(y)i(the)f(Met)g(O\016ce)h(-)e(a)g
(Cra)m(y)i(T3E)f(-)f(led)g(to)g(the)i(dev)m(elopmen)m(t)f(of)f(V)-8
b(ersion)37 b(2.0)f(of)g(the)0 3820 y(LEM)29 b(whic)m(h)g(could)f(b)s
(e)h(distributed)f(on)m(to)h(an)m(y)g(n)m(um)m(b)s(er)g(of)f(single)f
(scalar)h(pro)s(cessing)h(elemen)m(ts)g(\(or)0 3940 y(PEs\))41
b(and)f(hence)h(ha)m(v)m(e)g(ma)5 b(jor)39 b(parts)g(of)h(the)g(co)s
(de)g(calculated)f(in)g(parallel.)62 b(This)40 b(required)g(the)0
4060 y(use)31 b(of)f(message)g(passing)g(soft)m(w)m(are)h(facilitated)d
(b)m(y)j(use)g(of)e(GCOM)i(subroutines)f(\(see)i(Bro)m(wn)e(et)h(al)0
4181 y(1997,)37 b(and)f(Section)h(6\).)55 b(Ho)m(w)m(ev)m(er,)40
b(jobs)d(run)f(on)h(the)g(sup)s(ercomputer)g(are)g(sub)5
b(ject)38 b(to)e(time)f(and)0 4301 y(memory)e(constrain)m(ts)i(to)f
(ensure)i(an)e(equitable)f(allo)s(cation)e(of)j(resources)i(across)f
(the)g(Met)g(O\016ce.)0 4422 y(This)d(restricts)h(the)g(amoun)m(t)f(of)
f(in)m(tegration)g(that)h(can)h(b)s(e)f(carried)g(out)g(in)f(eac)m(h)j
(run)e(of)g(the)h(LEM.)0 4542 y(Th)m(us,)i(to)e(enable)g(long)f(in)m
(tegrations)g(to)h(b)s(e)h(p)s(erformed,)f(the)g(LEM)h(is)f(run)h(as)f
(a)g(\\c)m(hain",)g(de\014ned)0 4662 y(as)41 b(a)g(succession)i(of)e
(discrete)h(jobs,)i(whic)m(h)d(read)h(in)e(a)h(dump)g(from)f(the)i
(previous)f(job,)j(p)s(erform)0 4783 y(a)37 b(n)m(um)m(b)s(er)g(of)f
(steps)j(of)d(in)m(tegration,)g(and)h(then)h(dump)e(\014elds)i(to)e
(\014le)h(for)f(the)h(subsequen)m(t)j(job)d(to)0 4903
y(retriev)m(e.)47 b(The)34 b(Unix)f(script)h(whic)m(h)f(runs)i(the)e
(job)h(can)f(resubmit)g(itself)f(on)h(completion)f(to)h(set-up)0
5023 y(the)h(next)h(job)f(in)f(the)i(c)m(hain.)47 b(The)35
b(\014rst)f(job)g(in)f(a)h(c)m(hain)g(is)f(kno)m(wn)j(as)e(the)g(setup)
h(run)g(and)f(carries)0 5144 y(out)e(sligh)m(tly)f(di\013eren)m(t)i
(tasks)h(to)e(the)h(main)e(c)m(hain)h(job)h(\(see)g(Section)g(3\).)1865
6107 y(2)p eop
%%Page: 3 6
3 5 bop 472 1608 1890 4 v 2279 1606 a Fo(-)p 471 1606
4 1418 v 472 272 a(6)472 1689 y(@)555 1772 y(@)638 1855
y(@)722 1938 y(@)805 2021 y(@)888 2105 y(@)971 2188 y(@)1054
2271 y(@)1137 2354 y(@)1216 2433 y(@)-83 b(R)p 591 1726
237 4 v 2197 1726 48 4 v 2102 1726 V 2008 1726 V 1913
1726 V 1819 1726 V 1724 1726 V 1630 1726 V 1535 1726
V 1441 1726 V 1346 1726 V 1252 1726 V 1157 1726 V 1063
1726 V 968 1726 V 874 1726 V 827 1962 237 4 v 2433 1962
48 4 v 2339 1962 V 2244 1962 V 2150 1962 V 2055 1962
V 1961 1962 V 1866 1962 V 1772 1962 V 1677 1962 V 1583
1962 V 1488 1962 V 1394 1962 V 1299 1962 V 1205 1962
V 1110 1962 V 1063 2199 1654 4 v 591 545 V 827 781 V
1063 1017 V 589 1724 4 1182 v 825 1961 V 1061 2197 V
2242 780 4 237 v 2242 1724 4 48 v 2242 1630 V 2242 1536
V 2242 1441 V 2242 1347 V 2242 1252 V 2242 1158 V 2242
1063 V 2242 969 V 2242 874 V 2479 1016 4 237 v 2479 1961
4 48 v 2479 1866 V 2479 1772 V 2479 1677 V 2479 1583
V 2479 1488 V 2479 1394 V 2479 1299 V 2479 1205 V 2479
1110 V 2715 2197 4 1182 v 448 142 a Fn(z)2409 1618 y(y)1323
2500 y(x)403 1759 y Fv(I-1)721 1995 y(I)832 2227 y(I+1)676
2991 y(Figure)32 b(1:)43 b(The)33 b(arrangemen)m(t)g(of)f(v)m(ertical)g
(slices)g(in)g(the)h(LEM.)0 3276 y Fp(2.3)135 b(Decomp)t(osition)46
b(of)g(the)f(Mo)t(del)g(Domain)0 3581 y Fv(Although)27
b(a)h(3-D)e(mo)s(del,)i(the)g(LEM)h(in)m(tegrates)f(the)g(\014elds)g
(in)f(a)h(succession)h(of)f(2-D)e(v)m(ertical)i(slices.)0
3701 y(These)k(are)f(orien)m(tated)g(in)f(the)h Fn(x)p
Fv(-direction)e(so)i(that)f(eac)m(h)i(v)m(ertical)e(slice)g(is)g(a)h
Fn(y)t Fv(-)p Fn(z)j Fv(plane,)c(as)h(sho)m(wn)0 3822
y(in)38 b(Fig.)g(1.)62 b(A)39 b(2-D)f(run)h(is)f(a)h(sp)s(ecial)f(case)
i(with)e(just)i(one)f Fn(x)p Fv(-direction)f(slice)g(\(or)g(I-slice\),)
i(whic)m(h)0 3942 y(do)s(es)33 b(mean)f(that)g(a)g(2-D)g(sim)m(ulation)
d(with)k(the)f(LEM)i(is)e(in)f(the)i Fn(y)t Fv(-)p Fn(z)j
Fv(plane)c(rather)h(than)f(the)h(more)0 4063 y(con)m(v)m(en)m(tional)g
Fn(x)p Fv(-)p Fn(z)k Fv(plane.)146 4303 y(The)h(LEM)e(w)m(as)i
(originally)32 b(constructed)38 b(in)e(this)g(w)m(a)m(y)h(to)f(allo)m
(w)f(the)i(p)s(ossibilit)m(y)d(of)i(dumping)0 4424 y(slices)d(to)g
(disk)h(and)f(so)h(reducing)f(the)h(n)m(um)m(b)s(er)g(of)f(I-slices)g
(held)g(in)f(memory)h(at)g(an)m(y)h(one)g(time.)44 b(In)0
4544 y(principle,)35 b(this)g(w)m(ould)h(p)s(ermit)e(running)h(larger)f
(sim)m(ulations)g(than)h(w)m(ould)h(b)s(e)g(p)s(ossible)f(with)g(the)0
4664 y(computing)d(memory)h(constrain)m(t.)47 b(Ho)m(w)m(ev)m(er,)36
b(computing)c(hardw)m(are)j(dev)m(elop)s(ed)f(faster)g(than)g(the)0
4785 y(LEM)26 b(soft)m(w)m(are,)i(and)d(this)g(functionalit)m(y)e(w)m
(as)j(nev)m(er)h(required.)42 b(It)25 b(w)m(as)h(not)f(un)m(til)f(the)i
(in)m(tro)s(duction)0 4905 y(of)f(the)g(MPP)h(T3E)g(that)e(adv)-5
b(an)m(tages)26 b(of)f(this)f(v)m(ertical)g(slice)h(structure)h(w)m
(ere)g(utilised)e(as)h(it)f(pro)m(vided)0 5026 y(a)35
b(simple)f(and)h(logical)d(w)m(a)m(y)37 b(of)d(distributing)g(the)h(mo)
s(del)f(domain)f(o)m(v)m(er)k(the)e(di\013eren)m(t)h(PEs.)53
b(Eac)m(h)0 5146 y(PE)43 b(holds)e(I)s(IP/NPES=I)s(IPEP)j(n)m(um)m(b)s
(er)f(of)e(I-slices)g(\(where)i(I)s(IP)g(is)e(the)h(total)f(n)m(um)m(b)
s(er)h(of)g(grid)0 5266 y(p)s(oin)m(ts)e(in)f(the)h Fn(x)p
Fv(-direction)f(and)h(NPES)h(is)e(the)h(n)m(um)m(b)s(er)h(of)e(PEs\))i
(on)f(whic)m(h)g(the)h(in)m(tegration)d(is)0 5387 y(p)s(erformed.)1865
6107 y(3)p eop
%%Page: 4 7
4 6 bop 0 52 a Fp(2.4)135 b(Main)45 b(V)-11 b(ariables)0
358 y Fv(The)37 b(LEM)h(holds)e(\014v)m(e)i(main)d(prognostic)h(v)-5
b(ariables.)54 b(They)38 b(are)e(the)h Fn(x)p Fv(,)h
Fn(y)i Fv(and)d Fn(z)k Fv(comp)s(onen)m(ts)c(of)0 478
y(v)m(elo)s(cit)m(y)d(\(U,)h(V)f(and)h(W)f(resp)s(ectiv)m(ely\),)i(p)s
(oten)m(tial)d(temp)s(erature)h(p)s(erturbation)g(\(TH\))h(and)f(other)
0 598 y(scalars,)44 b(suc)m(h)e(as)g(w)m(ater)g(mixing)e(ratio)f
(\(Q\).)j(All)d(these)k(v)-5 b(ariables)40 b(are)i(arra)m(ys)g
(dimensioned)e(\()p Fn(y)t Fv(,)0 719 y Fn(z)t Fv(,)45
b Fn(x)p Fv(\))d(to)f(b)s(e)h(consisten)m(t)g(with)g(the)g(2-D)e(v)m
(ertical)h(slices)g(used)i(in)e(the)h(in)m(tegration.)69
b(The)42 b(excep-)0 839 y(tion)c(is)g(the)i(Q)e(v)-5
b(ariable)38 b(whic)m(h)h(is)g(dimensioned)f(\()p Fn(y)t
Fv(,)h Fn(z)t Fv(,)j(NQP)-8 b(,)39 b Fn(x)p Fv(\),)i(where)f(NQP)f(is)g
(the)g(n)m(um)m(b)s(er)0 959 y(of)i(scalar)g(prognostic)g(v)-5
b(ariables)41 b(additional)e(to)i(TH.)h(F)-8 b(or)41
b(example,)j(when)e(using)g(a)f(w)m(arm)h(rain)0 1080
y(parametrization)32 b(NQP=3,)j(where)h(the)f(Q)g(\014elds)g(represen)m
(t)h(w)m(ater)g(v)-5 b(ap)s(our)34 b(mixing)f(ratio,)g(liquid)0
1200 y(w)m(ater)27 b(mixing)d(ratio)h(and)h(rain)g(mixing)e(ratio,)i
(resp)s(ectiv)m(ely)-8 b(.)42 b(The)27 b(index)g(for)f(eac)m(h)h(Q)f
(\014eld)g(is)g(stored)0 1321 y(in)36 b(the)i(common)e(blo)s(c)m(k)h
(QCNT)h(whic)m(h,)h(for)e(this)g(example,)h(w)m(ould)f(b)s(e)g(the)h(v)
-5 b(ariables)36 b(IQV,)i(IQL)0 1441 y(and)33 b(IQR)f(resp)s(ectiv)m
(ely)-8 b(.)146 1682 y(Eac)m(h)40 b(of)e(these)i(prognostic)d(v)-5
b(ariables)38 b(are)g(held)g(on)h(t)m(w)m(o)g(time)e(lev)m(els,)j(with)
e(a)h(Z)f(pre\014x)h(used)0 1802 y(on)e(the)g(v)-5 b(ariable)35
b(name)i(to)f(di\013eren)m(tiate)g(b)s(et)m(w)m(een)j(the)f(t)m(w)m(o.)
57 b(F)-8 b(or)36 b(example,)h(v)-5 b(ariable)35 b(U)i(usually)0
1923 y(represen)m(ts)49 b(the)e(curren)m(t)g(time-lev)m(el)e(of)h(the)h
Fn(x)p Fv(-comp)s(onen)m(t)f(of)g(v)m(elo)s(cit)m(y)g(whilst)g(ZU)g
(represen)m(ts)0 2043 y(the)c(other)f(time-lev)m(el.)68
b(T)-8 b(o)41 b(confuse)i(matters)e(sligh)m(tly)-8 b(,)41
b(the)h(time-lev)m(el)d(represen)m(ted)44 b(b)m(y)e(the)g(Z*)0
2163 y(v)-5 b(ariable)41 b(c)m(hanges)k(during)d(eac)m(h)i(step.)76
b(A)m(t)43 b(the)g(b)s(eginning)f(of)h(the)g(timestep)g(it)f(represen)m
(ts)j(the)0 2284 y(previous)35 b(time-lev)m(el,)e(and)h(then)h(at)f
(the)h(end)g(of)f(in)m(tegration)f(it)g(is)h(up)s(dated)h(to)f(b)s
(ecome)h(the)g(next)0 2404 y(time-lev)m(el.)40 b(Before)29
b(the)g(next)g(time-step)f(the)h(\014elds)g(are)f(sw)m(app)s(ed)j(bac)m
(k)e(\(and)g(time-smo)s(othed\))d(so)0 2524 y(that)35
b(the)g(Z*)f(v)-5 b(ariable)33 b(returns)j(to)e(b)s(eing)g(the)i
(previous)f(time-lev)m(el)d(for)j(the)g(next)h(timestep.)50
b(The)0 2645 y(rate)36 b(of)f(c)m(hange)i(with)f(resp)s(ect)h(to)f
(time)e(is)i(also)f(held)h(for)f(eac)m(h)i(prognostic)e(v)-5
b(ariable)35 b(in)g(v)-5 b(ariables)0 2765 y(with)32
b(an)h(S)g(pre\014x)h(\(referred)f(to)g(as)g(the)g(source)h(terms\).)44
b(F)-8 b(or)32 b(example,)g(the)h(source)h(term)e(for)g(Q)h(is)0
2886 y(held)f(in)g(SQ.)146 3126 y(The)37 b(next)g(set)g(of)f(mo)s(del)e
(v)-5 b(ariables)35 b(are)i(those)f(calculated)g(diagnostically)d(on)j
(eac)m(h)h(timestep)0 3247 y(and)28 b(used)g(in)f(the)h(in)m(tegration)
d(of)i(the)h(prognostic)f(equations.)42 b(These)29 b(include)e
(viscosit)m(y)h(and)g(di\013u-)0 3367 y(sion)34 b(co)s(e\016cien)m(ts)i
(\(VIS)f(and)g(DIFF)f(resp)s(ectiv)m(ely\))h(and)g(bac)m(kscattered)i
(energy)f(\(DIS,)e(DIST)h(and)0 3488 y(DISQ\).)41 b(Again,)i(these)f
(are)g(dimensioned)e(\()p Fn(y)t Fv(,)j Fn(z)t Fv(,)h
Fn(x)p Fv(\))e(although)e(the)i Fn(x)p Fv(-direction)e(represen)m(ts)k
(the)0 3608 y(maxim)m(um)35 b(n)m(um)m(b)s(er)j(of)g(v)m(ertical)e
(slices)i(required)g(at)f(an)m(y)i(one)f(time.)57 b(The)38
b(pressure)i(v)-5 b(ariable,)37 b(P)-8 b(,)0 3728 y(whic)m(h)30
b(is)f(the)g(ratio)f(of)h(the)h(pressure)h(p)s(erturbation)d(to)h(the)h
(densit)m(y)-8 b(,)31 b(is)e(also)f(calculated)h(diagnosti-)0
3849 y(cally)g(but,)j(lik)m(e)e(the)h(prognostic)f(v)-5
b(ariables,)30 b(is)g(held)g(on)h(all)d(v)m(ertical)i(slices.)43
b(This)31 b(is)f(necessary)j(due)0 3969 y(to)f(the)h(nature)g(of)f(the)
h(pressure)i(calculation)30 b(\(see)j(Section)g(4.7\).)146
4210 y(As)h(the)f(LEM)h(solv)m(es)g(the)f(Boussinesq)h(or)f(anelastic)f
(appro)m(ximation)f(of)h(the)h(basic)g(equations,)0 4330
y(it)38 b(is)h(necessary)j(to)d(hold)f(v)m(ertical)h(pro\014les)g(of)g
(v)-5 b(arious)39 b(reference)i(pro\014les.)63 b(These)42
b(include)c(den-)0 4451 y(sit)m(y)45 b(\(RHO,)g(RHON\),)g(reference)i
(pressure)f(\(PREFN\))g(and)f(reference)h(p)s(oten)m(tial)e(temp)s
(erature)0 4571 y(\(THREF\).)30 b(The)h(v)m(ertical)d(grid)h(is)g
(stored)h(in)f(the)h(v)-5 b(ariables)29 b(Z)g(and)h(ZN.)f(Because)i
(the)f(grid)f(is)g(stag-)0 4691 y(gered)40 b(in)f(the)i(v)m(ertical,)g
(with)e(W)h(held)g(on)g(di\013eren)m(t)g(lev)m(els)g(to)f(the)h(other)g
(prognostic)g(v)-5 b(ariables,)0 4812 y(grids)35 b(corresp)s(onding)g
(to)h(b)s(oth)f(sets)h(of)g(lev)m(els)f(are)h(required.)52
b(Z)35 b(is)h(used)g(for)f(the)h(w-lev)m(el)f(v)m(ertical)0
4932 y(grid)d(whilst)h(ZN)g(is)g(used)h(for)f(the)h(p-lev)m(el)e(grid.)
45 b(Throughout)34 b(the)g(co)s(de,)g(where)g(a)f(v)-5
b(ariable)32 b(exists)0 5052 y(along)j(with)h(a)g(similarly)c(named)k
(v)-5 b(ariable)35 b(but)h(with)g(an)h(N)f(su\016x,)j(the)d(name)g
(with)g(the)h(N)f(su\016x)0 5173 y(refers)k(to)e(the)i(p-lev)m(el)e
(grid,)h(and)g(the)h(v)-5 b(ariable)37 b(without)h(refers)i(to)e(the)i
(w-lev)m(el)e(grid.)62 b(It)39 b(should)0 5293 y(b)s(e)h(noted,)h(ho)m
(w)m(ev)m(er,)j(that)39 b(a)h(v)m(ertical)e(arra)m(y)i(v)-5
b(ariable)38 b(without)h(an)g(N)h(su\016x)h(is)e(not)g(necessarily)0
5414 y(alw)m(a)m(ys)33 b(on)g(the)g(w-lev)m(els.)146
5654 y(The)26 b(\014nal)e(set)i(of)e(v)-5 b(ariables)24
b(to)g(men)m(tion)g(are)h(the)g(con)m(trol)f(parameters.)41
b(These)27 b(are)e(in)m(teger)g(t)m(yp)s(e)0 5775 y(v)-5
b(ariables,)35 b(normally)f(ending)h(with)h(P)-8 b(,)36
b(whic)m(h)g(are)g(assigned)g(a)f(v)-5 b(alue)35 b(in)g(a)h(parameter)f
(statemen)m(t)1865 6107 y(4)p eop
%%Page: 5 8
5 7 bop 0 52 a Fv(and)33 b(de\014ne)h(the)g(options)e(used)i(in)f(the)g
(mo)s(del.)43 b(These)35 b(include)d(domain)g(size)h(sp)s
(eci\014cations,)g(suc)m(h)0 173 y(as)k(I)s(IP)-8 b(,)37
b(JJP)h(and)f(KKP)g(\(n)m(um)m(b)s(er)g(of)f(grid)g(p)s(oin)m(ts)h(in)f
(the)h Fn(x)p Fv(,)i Fn(y)h Fv(and)d Fn(z)k Fv(directions)36
b(resp)s(ectiv)m(ely\),)0 293 y(v)-5 b(ariable)21 b(selections)i
(\(e.g.)41 b(IUSETHP\))25 b(and)e(ph)m(ysics)h(c)m(hoices)g(\(e.g.)41
b(IRAINP\).)24 b(The)g(use)g(of)e(in)m(tegers)0 414 y(rather)j(than)h
(logicals)c(allo)m(ws)i(m)m(ultiple)f(exclusiv)m(e)j(c)m(hoices)g(from)
e(one)i(parameter)f(v)-5 b(ariable,)25 b(and)g(the)0
534 y(use)30 b(of)e(parameters,)h(rather)g(than)g(namelist)d(v)-5
b(ariables,)29 b(allo)m(ws)e(in)m(telligen)m(t)g(restriction)g(of)h
(memory)0 654 y(usage)33 b(and)g(the)g(optimization)c(of)j(some)g(IF)h
(blo)s(c)m(ks)g(at)f(compilation)146 895 y(F)-8 b(urther)33
b(description)f(of)g(the)h(main)e(v)-5 b(ariables)31
b(of)h(the)h(LEM)h(is)e(giv)m(en)g(in)g(App)s(endix)h(A.)0
1304 y Fp(2.5)135 b(Structure)45 b(of)g(Main)g(Program)0
1609 y Fv(A)30 b(diagrammatic)c(structure)31 b(of)e(the)h(main)e
(program,)h Fw(LES)p Fv(,)h(is)f(sho)m(wn)i(in)e(Fig.)f(2.)42
b(Apart)30 b(from)e(the)0 1730 y(initialization)d(of)31
b(the)g(GCOM)g(message)h(passing)f(routines)g(there)g(are)g(three)h
(main)d(sections)j(of)e(the)0 1850 y(co)s(de.)43 b(The)30
b(call)e(to)h(subroutine)g Fw(BEGIN)f Fv(initializes)e(the)k(run)f
(through)h(the)f(reading)g(of)g(namelists)0 1971 y(and)41
b(the)g(setting)f(of)h(the)g(initial)c(v)-5 b(alues)41
b(for)f(the)h(prognostic)f(v)-5 b(ariables,)42 b(or)e(b)m(y)i(reading)e
(in)g(data)0 2091 y(from)32 b(a)h(mo)s(del)f(dump.)46
b(This)34 b(phase)g(of)f(the)h(mo)s(del)e(is)h(referred)h(to)g(as)f
(the)h(Initialization)29 b(and)34 b(will)0 2211 y(b)s(e)f(discussed)h
(in)e(more)g(detail)f(in)h(Section)g(3.)146 2452 y(The)38
b(subroutine)g Fw(NNSTEPS)d Fv(is)i(then)g(called)f(successiv)m(ely)k
(in)c(lo)s(ops)g(o)m(v)m(er)i(NNDUMP)f(and)0 2573 y(NNDIA)m(G.)24
b Fw(NNSTEPS)g Fv(is)f(the)i(routine)f(whic)m(h)h(con)m(trols)f(the)h
(in)m(tegration)e(of)g(the)i(prognostic)f(v)-5 b(ari-)0
2693 y(ables)31 b(and)g(the)h(calculation)c(of)j(diagnostics.)42
b(Eac)m(h)32 b(call)d(to)i Fw(NNSTEPS)f Fv(in)m(tegrates)h(forw)m(ard)g
(NN)0 2813 y(steps.)48 b(Therefore)35 b(eac)m(h)f(LEM)h(run)e(will)f
(in)m(tegrate)h(a)g(maxim)m(um)f(of)h(NNDUMP)p Fm(\002)p
Fv(NNDIA)m(G)p Fm(\002)p Fv(NN)0 2934 y(steps.)55 b(This)36
b(section)h(of)e(the)i(co)s(de)f(is)g(referred)g(to)g(as)g(the)h(In)m
(tegration)e(and)h(will)e(b)s(e)i(discussed)i(in)0 3054
y(Section)32 b(4.)146 3295 y(The)37 b(\014nal)d(call)g(from)h
Fw(LES)g Fv(is)g(to)g Fw(EXXIT)p Fv(.)f(This)i(subprogram)f(can)h
(terminate)e(the)i(co)s(de,)h(or)0 3415 y(execute)f(other)e(options)f
(dep)s(ending)i(on)e(the)i(argumen)m(t,)f(ISTOPU.)h Fw(EXXIT)e
Fv(is)g(asso)s(ciated)h(with)0 3536 y(the)f(mo)s(del)e(outputs,)i(and)g
(these)h(are)e(describ)s(ed)i(further)f(in)e(Section)i(5.)0
3989 y Fx(3)161 b(Initialization)0 4328 y Fv(The)45 b(initialization)39
b(of)44 b(the)g(LEM)h(is)f(con)m(trolled)f(through)i(subroutine)f
Fw(BEGIN)p Fv(.)f(A)h(sc)m(hematic)0 4449 y(diagram)28
b(of)i(the)h(structure)g(of)f Fw(BEGIN)f Fv(is)h(sho)m(wn)i(in)d(Fig.)g
(3.)43 b(As)31 b(can)f(b)s(e)h(seen)g(the)g(path)g(through)0
4569 y(the)e(structure)g(dep)s(ends)h(on)e(the)g(v)-5
b(ariable)26 b(IST)-8 b(AR)g(T.)29 b(If)f(IST)-8 b(AR)g(T=0)29
b(then)g(the)f(LEM)h(is)f(run)g(as)g(one)0 4689 y(job)f(of)h(a)f(c)m
(hain)h(run)g(and)g(nearly)f(all)f(the)i(information)d(required)j(to)f
(con)m(tin)m(ue)i(the)f(run)g(is)f(con)m(tained)0 4810
y(in)34 b(the)g(mo)s(del)f(dump)h(whic)m(h)h(is)f(read)h(through)f
(subroutine)h Fw(RETRIEVE)c Fv(or)j Fw(NEWRETR)p Fv(.)f(If)0
4930 y(IST)-8 b(AR)g(T=1)31 b(then)g(the)g(LEM)g(is)f(b)s(eing)f(run)i
(as)g(a)f(setup)h(job,)g(that)f(is,)g(it)g(is)g(the)g(\014rst)h(part)g
(of)e(a)i(new)0 5050 y(c)m(hain)26 b(run.)41 b(There)27
b(is)f(no)g(mo)s(del)e(dump)i(to)f(read,)j(so)e(all)e(the)i(data)g
(required)g(to)g(initialize)c(the)k(mo)s(del)0 5171 y(m)m(ust)31
b(b)s(e)h(pro)m(vided)g(through)f(the)h(namelists.)41
b(Hence,)33 b(the)f(setup)h(run)e(and)g(normal)f(c)m(hain)h(run)g(use)0
5291 y(separate)k(namelist)e(\014les)i(\()p Fl(nmlsetup)f
Fv(and)h Fl(nmlchain)p Fv(\))e(whic)m(h)i(con)m(tain)f(di\013eren)m(t)h
(namelists.)49 b(Both)0 5412 y(\014les)31 b(do)g(ha)m(v)m(e)i(some)e
(namelists)f(in)g(common;)g(these)j(are)e(the)h(job)f(con)m(trol)f
(namelists)g(and)h(are)g(read)0 5532 y(in)40 b(at)g(the)h(b)s(eginning)
e(of)g(the)i(routine.)67 b(These)42 b(con)m(tain)e(information)d(suc)m
(h)42 b(as)f(\014le)f(names,)i(NN,)0 5652 y(NNDIA)m(G)29
b(and)g(NNDUMP)g(\(whic)m(h)h(are)f(passed)h(bac)m(k)g(to)f
Fw(LES)g Fv(through)g(the)g Fw(BEGIN)f Fv(argumen)m(t)0
5773 y(list\))j(and)i(IST)-8 b(AR)g(T.)1865 6107 y(5)p
eop
%%Page: 6 9
6 8 bop 1416 -34 a Fk(')p 1416 153 4 23 v 1416 321 a(&)2124
-34 y($)p 2124 153 V 2124 321 a(\045)p 1583 321 377 4
v 1583 -34 V 1670 176 a Fw(LES)p 1414 543 716 4 v 1414
898 4 355 v 2126 898 V 1414 901 716 4 v 1438 646 a Fq(Initialize)28
b(GCOM)1452 754 y(message)k(passing)1612 881 y(routines)p
1414 1134 V 1414 1488 4 355 v 2126 1488 V 1414 1491 716
4 v 1685 1239 a Fv(Call)1586 1404 y Fw(BEGIN)p 1414 1724
V 1414 2079 4 355 v 2126 2079 V 1414 2082 716 4 v 1685
1830 a Fv(Call)1508 1995 y Fw(NNSTEPS)p 1414 2315 V 1414
2669 4 355 v 2126 2669 V 1414 2672 716 4 v 1685 2421
a Fv(Call)1590 2585 y Fw(EXXIT)1416 2919 y Fk(')p 1416
3106 4 23 v 1416 3273 a(&)2124 2919 y($)p 2124 3106 V
2124 3273 a(\045)p 1583 3273 377 4 v 1583 2919 V 1684
3129 a Fv(End)p 1770 543 4 237 v 1770 1134 V 1770 1724
V 1770 2315 V 1770 2906 V 591 1561 1182 4 v 1063 1655
709 4 v 1063 2151 V 591 2789 1182 4 v 881 1889 a Fq(lo)s(op)e(o)m(v)m
(er)875 1992 y(NNDIA)m(G)409 2149 y(lo)s(op)f(o)m(v)m(er)381
2252 y(NNDUMP)p 589 2079 4 520 v 1061 1819 4 166 v 1061
2150 4 142 v 589 2787 4 497 v 2244 1325 237 4 v 2398
1323 a Fo(-)p 2244 1915 V 2397 1913 a(-)p 2244 2506 V
2397 2504 a(-)2598 1358 y Fv(Initialization)2598 1938
y(In)m(tegration)j(of)2598 2056 y(NN)h(timesteps)2598
2528 y(Outputs:)2598 2657 y(-)f(Call)f Fw(DIA)m(G)2598
2765 y Fv(-)h(Call)f Fw(DUMP)p Fv(,)p Fw(NEWDUMP)826
3700 y Fv(Figure)h(2:)43 b(Structure)34 b(of)e(the)h(Main)f(Programme,)
f(LES)146 3985 y(F)-8 b(ollo)m(wing)28 b(the)j(reading)g(of)f(the)h
(job)g(con)m(trol)f(namelists)f(the)j(parameter)e(c)m(hoices)i(in)e
(the)h(mo)s(del)0 4105 y(are)d(c)m(hec)m(k)m(ed)j(through)d(the)g
(subroutine)g Fw(CHKP)-9 b(ARMS)p Fv(.)27 b(Certain)g(parameter)g(c)m
(hoices)i(are)f(m)m(utu-)0 4225 y(ally)j(exclusiv)m(e)k(\(e.g.)45
b(bac)m(kscatter)35 b(in)d(t)m(w)m(o-dimensions,)h(microph)m(ysics)g
(and)g(no)g(Q)g(v)-5 b(ariables\))31 b(and)0 4346 y(an)m(y)j(suc)m(h)h
(con\015icts)e(are)h(iden)m(ti\014ed.)45 b(A)34 b(clear)e(message)i(is)
f(written)g(to)g(standard)h(out)f(and)g(the)h(run)0 4466
y(is)d(terminated)g(through)h(a)f(call)f(to)i Fw(EXXIT)e
Fv(with)h(an)h(error)g(co)s(de)g(of)f(5.)43 b(If)32 b(it)e(is)i(a)f
(setup)i(run)f(then)0 4586 y(the)h(parameter)f(selections,)h(along)e
(with)h(their)g(meanings,)g(are)h(written)f(to)g(the)h(\014le)f
Fl(run)p 3369 4586 30 4 v 36 w(info)p Fv(.)0 4996 y Fp(3.1)135
b(Input)45 b(Namelists)0 5301 y Fv(The)e(three)f(job)f(con)m(trol)g
(namelists)g(common)f(to)h(b)s(oth)h Fl(nmlsetup)f Fv(and)h
Fl(nmlchain)e Fv(are)i(CNTRL,)0 5421 y(TIMENML)37 b(and)d(JOBINF)m(O.)h
(CNTRL)h(con)m(tains)f(the)g(v)-5 b(ariables)33 b(IST)-8
b(AR)g(T,)36 b(NN,)f(NNDIA)m(G)f(and)0 5542 y(NNDUMP)-8
b(,)37 b(already)g(discussed.)58 b(TIMENML)39 b(con)m(tains)d(arra)m
(ys)i(whic)m(h)f(con)m(trol)f(at)h(what)g(mo)s(del)0
5662 y(time)42 b(the)i(run)g(is)f(to)h(stop,)j(or)c(when)i(diagnostics)
d(are)i(to)f(b)s(e)h(pro)s(duced.)78 b(JOBINF)m(O)43
b(con)m(tains)0 5782 y(the)38 b(names)g(of)g(the)g(dump,)h(p)s(oin)m
(ter)e(and)h(message)h(\014les,)g(FILEA,)f(FILEB,)g(FILEZ)g(and)g
(MESG,)1865 6107 y(6)p eop
%%Page: 7 10
7 9 bop 1416 -405 a Fk(')p 1416 -218 4 23 v 1416 -51
a(&)2124 -405 y($)p 2124 -218 V 2124 -51 a(\045)p 1583
-51 377 4 v 1583 -405 V 1586 -195 a Fw(BEGIN)p 1770 78
4 142 v 1414 78 716 4 v 1414 432 4 355 v 2126 432 V 1414
435 716 4 v 1685 183 a Fv(Call)1441 348 y Fw(CHKP)-9
b(ARMS)p 1770 550 4 119 v 2244 245 237 4 v 2398 243 a
Fo(-)2598 268 y Fv(Chec)m(k)35 b(mo)s(del)c(parameters)2598
386 y(for)h(consistency)j(-)d(Call)2598 514 y Fw(EXXIT)f
Fv(if)h(error)p 1414 550 716 4 v 1414 904 4 355 v 2126
904 V 1414 907 716 4 v 1459 653 a Fq(Read)f(and)e(c)m(hec)m(k)1542
738 y(job)h(con)m(trol)1572 842 y(namelists)p 1770 1046
4 142 v 1772 1613 a Fo(\000)1855 1530 y(\000)1938 1447
y(\000)1972 1413 y(\000)1689 1613 y(@)1606 1530 y(@)1523
1447 y(@)1488 1413 y(@)1772 1129 y(@)1855 1212 y(@)1938
1295 y(@)1972 1330 y(@)1689 1129 y(\000)1606 1212 y(\000)1523
1295 y(\000)1488 1330 y(\000)1553 1364 y Fv(IST)-8 b(AR)g(T)33
b(?)p 1063 1331 426 4 v 1061 1613 4 284 v 2055 1331 426
4 v 2479 1613 4 284 v 940 1271 a Fj(IST)-5 b(AR)g(T=0;)20
b(c)n(hain)709 b(IST)-5 b(AR)g(T=1;)21 b(setup)p 2123
1613 716 4 v 2123 1967 4 355 v 2835 1967 V 2123 1970
716 4 v 2197 1716 a Fq(Read)30 b(all)g(other)2192 1810
y(namelists)f(and)2238 1905 y(c)m(hec)m(k)j(v)-5 b(alues)p
2479 2086 4 119 v 2123 2086 716 4 v 2123 2440 4 355 v
2835 2440 V 2123 2443 716 4 v 2144 2179 a(Prepare)30
b(grids)f(for)2217 2274 y(input)g(pro\014les)2160 2368
y(\()p Fr(PREPGRID)p Fq(\))p 2479 2558 4 119 v 1890 2560
591 4 v 1888 2676 4 119 v 705 1613 716 4 v 705 1967 4
355 v 1417 1967 V 705 1970 716 4 v 976 1719 a Fv(Call)767
1813 y Fw(RETRIEVE)765 1907 y(NEWRETR)p 1061 2086 4 119
v 354 1804 237 4 v 354 1802 a Fo(\033)-434 1837 y Fv(Read)j(and)h(c)m
(hec)m(k)-298 1945 y(mo)s(del)e(dump)p 705 2086 716 4
v 705 2440 4 355 v 1417 2440 V 705 2443 716 4 v 740 2235
a Fq(Read)f(O)m(VRIDE1)896 2353 y(namelist)p 1061 2558
4 119 v 1063 2560 591 4 v 1652 2676 4 119 v 1414 2676
716 4 v 1414 4448 4 1772 v 2126 4448 V 1414 4451 716
4 v 1417 3032 709 4 v 1685 2782 a Fv(Call)1594 2947 y
Fw(SET1D)p 1181 2843 237 4 v 1181 2841 a Fo(\033)271
2805 y Fw(SET1D)-236 2935 y Fq(Allo)s(cate)g(diagnostics,)g(scalar)-236
3053 y(\014elds,)f(and)h(initialize)d(timeseries.)-236
3171 y(\(Call)i Fr(ALLOCDGS)p Fq(,)-236 3289 y Fr(ALLOCQS)g
Fq(and)g Fr(INTIMSER)p Fq(\))-236 3455 y(Calculate)h(v)m(ertical)g
(grids,)-236 3573 y(reference)h(and)e(initial)f(pro\014les)-236
3691 y(\(Call)h Fr(INTERPIN)p Fq(\))-236 3833 y(Calculate)h(pressure)f
(and)h(densit)m(y)-236 3951 y(\(Call)f Fr(SET)-9 b(ANEL)30
b Fq(or)g Fr(SETPREF)p Fq(\))-236 4116 y(Set)g(up)g(buo)m(y)m(ancy)h
(co)s(e\016cien)m(t,)g(mixing)-236 4234 y(length,)f(geostrophic)g
(wind,)f(moisture,)-236 4352 y(Exner)g(and)h(damping)f(la)m(y)m(er)i
(arra)m(ys)-236 4494 y(Calculate)f(lo)s(ok-up)f(table)h(for)h(surface)
-236 4612 y(b.c.)41 b(\(Call)29 b Fr(SETLOOK)p Fq(\))-236
4739 y(and)h(other)g(related)g(constan)m(ts)-236 4896
y(Set)g(up)g(w)m(arm-rain)f(thresholds)g(and)-236 5014
y(some)i(radiation)e(\014elds)g(\(Call)-236 5132 y Fr(CALC)p
64 5132 32 4 v 36 w(LEV)p Fq(,)p Fr(RAD)p 573 5132 V
38 w(LEM)p Fq(\))p -287 2676 1472 4 v -287 5204 4 2528
v 1181 5204 V -287 5207 1472 4 v 1417 3386 709 4 v 1685
3136 a Fv(Call)1590 3301 y Fw(SETSG)p 2244 3197 237 4
v 2398 3195 a Fo(-)2598 3221 y Fv(Set)k(subgrid)2598
3348 y(mo)s(del)e(constan)m(ts)p 1417 3741 709 4 v 1685
3490 a(Call)1485 3655 y Fw(SETDIA)m(GS)p 2244 3552 237
4 v 2398 3550 a Fo(-)2598 3575 y Fv(Set)i(up)g(and)g(c)m(hec)m(k)2598
3693 y(diagnostic)f(slices)p 1417 4095 709 4 v 1685 3845
a(Call)1468 4009 y Fw(MICR)m(OSET)p 2244 3906 237 4 v
2398 3904 a Fo(-)2598 3929 y Fv(Set)h(up)g(arra)m(ys)h(for)2598
4047 y(Microph)m(ysics)g(routines)1685 4199 y(Call)1600
4364 y Fw(SETLS)p 1652 5038 4 591 v 1888 4566 4 119 v
2244 4260 237 4 v 2398 4258 a Fo(-)2598 4284 y Fv(Sets)g(up)f
(large-scale)2598 4402 y(adv)m(ectiv)m(e)i(forcing)p
1768 4566 716 4 v 1768 4920 4 355 v 2480 4920 V 1768
4923 716 4 v 2039 4671 a(Call)1911 4836 y Fw(SST)-9 b(AR)g(T)p
1888 5038 4 119 v 2598 4733 237 4 v 2752 4731 a Fo(-)2953
4766 y Fv(Initialize)29 b(momen)m(tum)j(and)2953 4884
y(scalar)g(\014elds)2953 5002 y(Call)f Fw(NNSTEPS)g Fv(to)2953
5109 y(start)h(in)m(tegration)1416 5052 y Fk(')p 1416
5238 4 23 v 1416 5406 a(&)2124 5052 y($)p 2124 5238 V
2124 5406 a(\045)p 1583 5406 377 4 v 1583 5052 V 1622
5190 a Fv(Return)1610 5309 y(to)h Fw(LES)1002 5832 y
Fv(Figure)f(3:)43 b(Structure)34 b(of)e(subroutine)h(BEGIN)1865
6107 y(7)p eop
%%Page: 8 11
8 10 bop 0 52 a Fv(resp)s(ectiv)m(ely)-8 b(.)146 293
y(A)35 b(further)f(elev)m(en)h(namelists)e(are)i(read)f(in)f(if)g(IST)
-8 b(AR)g(T=1.)49 b(These)36 b(are)f(INPUT,)g(GRID,)e(TH-)0
414 y(PR)m(OF,)22 b(INITPR)m(OF,)i(SUBMODEL,)f(DIA)m(GNOST,)f(D)m
(YNAMICS,)i(NUMERICS,)g(D)m(AMPNML,)0 534 y(RADCNTL)33
b(and)g(MO)m(VD)m(A)-8 b(T)g(A.)33 b(A)g(resume)g(of)f(these)i
(namelists)d(is)h(giv)m(en)h(in)f(T)-8 b(able)32 b(1)g(b)s(elo)m(w.)p
437 666 2907 7 v 486 750 a(Namelist)285 b(Con)m(ten)m(ts)p
437 793 V 486 877 a(INPUT)347 b(Surface)33 b(\015uxes,)h(roughness)g
(lengths)e(plus)h(mo)s(del)e(time)486 998 y(GRID)405
b(V)-8 b(ertical)31 b(grid)g(description,)h(horizon)m(tal)f(spacing)486
1118 y(THPR)m(OF)246 b(Description)31 b(of)h(THREF)h(pro\014le)486
1238 y(INITPR)m(OF)176 b(Descriptions)31 b(of)i(initial)28
b(pro\014les)33 b(for)f(U,)h(V,)f(TH)i(and)e(Q)486 1359
y(SUBMODEL)101 b(Neutral)31 b(mixing)g(length)h(and)h(bac)m(kscatter)h
(co)s(e\016cien)m(ts)486 1479 y(DIA)m(GNOST)134 b(Flags)31
b(for)h(diagnostic)f(outputs)486 1600 y(D)m(YNAMICS)125
b(Coriolis)30 b(and)i(geostrophic)h(winds)486 1720 y(NUMERICS)132
b(Initial)29 b(and)k(max)f(timestep,)g(CFL)h(limits)486
1840 y(D)m(AMPNML)141 b(Damping)30 b(la)m(y)m(er)j(co)s(e\016cien)m(ts)
486 1961 y(RADCNTL)170 b(Lat,)32 b(long,)f(time,)h(alb)s(edo)f(and)i
(e\013ectiv)m(e)h(radii)486 2081 y(MO)m(VD)m(A)-8 b(T)g(A)157
b(Flags)31 b(for)h(animation)e(output)p 437 2124 V 225
2392 a(T)-8 b(able)33 b(1:)43 b(Brief)32 b(descriptions)g(of)g(the)h
(additional)d(namelists)h(read)i(in)f(for)g(a)g(setup)i(run.)146
2619 y(The)28 b(con)m(ten)m(ts)h(of)e(eac)m(h)h(of)f(these)h(namelists)
e(is)h(tested)h(for)f(v)-5 b(alidit)m(y)d(.)39 b(All)26
b(v)-5 b(ariables)26 b(ha)m(v)m(e)i(default)0 2739 y(v)-5
b(alues,)38 b(but)g(some)f(m)m(ust)g(b)s(e)h(input)f(and)g(hence)i
(their)e(default)f(v)-5 b(alue)37 b(is)g(nonsensical)g(\(e.g.)57
b(D)m(XX)0 2859 y(and)36 b(D)m(YY,)f(the)h(horizon)m(tal)e(grid)h
(spacing,)h(ha)m(v)m(e)h(default)e(v)-5 b(alues)35 b(of)h(0.0\).)52
b(If)35 b(an)h(incompatibilit)m(y)0 2980 y(is)31 b(found)h(then)h(the)f
(program)e(is)i(terminated)f(through)g(a)h(call)e(to)i
Fw(EXXIT)e Fv(with)h(an)h(error)g(co)s(de)g(of)0 3100
y(7.)43 b(Details)31 b(of)h(these)i(namelists)d(are)i(written)f(out)h
(to)f(\014le)g Fl(run)p 2347 3100 30 4 v 36 w(info)p
Fv(.)146 3341 y(Eac)m(h)41 b(c)m(hain)f(run)g(reads)h(the)f(namelist)e
(O)m(VRIDE1.)65 b(This)40 b(con)m(tains)g(a)g(n)m(um)m(b)s(er)g(of)g(v)
-5 b(ariables)0 3461 y(whic)m(h)50 b(can)g(b)s(e)g(c)m(hanged)h(during)
e(the)h(sim)m(ulation.)92 b(These)51 b(include)e(roughness)i(lengths,)j
(sur-)0 3582 y(face)32 b(\015uxes,)i(CFL)e(criteria,)e(geostrophic)i
(winds,)g(bac)m(kscatter)i(co)s(e\016cien)m(ts)f(and)f(diagnostic)e
(\015ags.)0 3702 y(These)39 b(are)e(not)g(c)m(hec)m(k)m(ed)j(for)c(v)-5
b(alidit)m(y)35 b(and)j(erroneous)g(v)-5 b(alues)36 b(input)h(through)g
(O)m(VRIDE1)g(could)0 3822 y(cause)32 b(the)g(mo)s(del)d(to)i(crash.)44
b(A)31 b(full)e(list)h(of)h(namelist)e(v)-5 b(ariables)30
b(can)h(b)s(e)h(found)f(in)f(App)s(endix)i(B)f(of)0 3943
y(P)m(art)i(I)g(of)f(the)h(do)s(cumen)m(tation.)0 4349
y Fp(3.2)135 b(Initial)47 b(Conditions)0 4655 y Fv(F)-8
b(or)46 b(the)i(setup)g(run,)j(when)d(IST)-8 b(AR)g(T=1,)52
b(initial)43 b(v)-5 b(alues)47 b(for)g(U,)g(V,)g(W,)h(TH)f(and)g(Q)g
(ha)m(v)m(e)i(to)0 4775 y(b)s(e)38 b(set.)59 b(This)37
b(is)g(done)h(through)f(subroutine)h Fw(SST)-9 b(AR)g(T)p
Fv(.)37 b Fw(SST)-9 b(AR)g(T)36 b Fv(has)i(an)f(extremely)h(simple)0
4895 y(structure,)28 b(lo)s(oping)23 b(o)m(v)m(er)j(all)e(the)h(mo)s
(del)f(p)s(oin)m(ts)h(and)g(setting)g(v)-5 b(alues)25
b(for)g(the)h(prognostic)f(v)-5 b(ariables,)0 5016 y(imp)s(osing)35
b(the)i(surface,)i(upp)s(er)f(and)f(wrap-around)g(b)s(oundary)g
(conditions,)h(initialising)32 b(a)k(few)i(of)0 5136
y(the)26 b(diagnostic)e(\014elds)i(and)f(calling)e Fw(NNSTEPS)p
Fv(,)h(with)h(a)g(forw)m(ard)h(step,)i(to)d(start)g(the)h(in)m
(tegration.)0 5256 y(By)37 b(default)e(the)i(initial)c(U,)j(V,)h(TH)g
(and)f(Q)g(are)h(set)g(to)f(UINIT,)h(VINIT,)h(THINIT-THREF)f(and)0
5377 y(QINIT)48 b(resp)s(ectiv)m(ely)-8 b(.)90 b(W)47
b(is)g(set)i(equal)e(to)g(zero.)89 b(These)49 b(default)e(initial)d
(conditions)i(can)i(b)s(e)0 5497 y(o)m(v)m(erwritten)34
b(b)m(y)f(up)s(dating)f(the)h(co)s(de.)146 5738 y(The)50
b(initial)44 b(pro\014le)k(v)-5 b(ariables)47 b(\(*INIT\))i(are)f(1-D)f
(v)m(ertical)h(arra)m(ys)h(\(except)h(QINIT)f(whic)m(h)0
5858 y(is)g(also)f(dimensioned)h(b)m(y)h(NQP\))f(whic)m(h)h(are)g
(calculated)e(using)h(input)g(from)f(the)i(INITPR)m(OF)1865
6107 y(8)p eop
%%Page: 9 12
9 11 bop 0 52 a Fv(namelist.)86 b(In)47 b(INITPR)m(OF)h(the)g(user)g
(will)d(ha)m(v)m(e)k(sp)s(eci\014ed)f(heigh)m(t)f(lev)m(els)g(and)h
(corresp)s(onding)0 173 y(initial)36 b(v)-5 b(alues)40
b(resp)s(ectiv)m(ely)h(in)e(arra)m(ys)i(ZN*I)p 1771 173
30 4 v 35 w(READ)e(and)i(*INIT)p 2591 173 V 35 w(READ)f(resp)s(ectiv)m
(ely)-8 b(.)67 b(These)0 293 y(v)-5 b(alues)44 b(will)f(b)s(e)h(used)i
(to)e(construct)i(a)e(piecewise-linear)f(pro\014le)h(of)g(the)h
(initial)c(quan)m(tit)m(y)-8 b(.)80 b(The)0 414 y(\014rst)51
b(stage)h(is)e(to)h(pro)s(cess)h(this)f(input)f(data)h(in)f(subroutine)
h Fw(PREPGRID)e Fv(whic)m(h)i(is)g(called)0 534 y(from)43
b Fw(BEGIN)f Fv(after)i(the)h(namelists)d(ha)m(v)m(e)k(b)s(een)e(read.)
78 b(The)45 b(v)-5 b(alues)44 b(from)f(ZN*I)p 3264 534
V 35 w(READ)g(and)0 654 y(*INIT)p 268 654 V 36 w(READ)22
b(are)g(passed)i(in)m(to)d(new)i(arra)m(ys)g(*INITGD)f(and)g(ZN*GD)f
(suc)m(h)j(that,)g(for)e(an)g(index)g(IN,)0 775 y(*INITGD\(IN+1\)=INIT)
p 1018 775 V 36 w(READ\(IN\))29 b(and)g(ZN*GD\(IN+1\)=ZN*I)p
2675 775 V 33 w(READ\(IN\).)g(ZN*GD\(1\))e(is)0 895 y(then)k(set)g(to)f
(a)g(large)f(negativ)m(e)h(v)-5 b(alue)30 b(\(VER)-8
b(YLO)m(W)31 b(=)f(-1.0e5\))f(and)h(*INITGD\(1\))g(is)g(set)h(equal)f
(to)0 1016 y(*INITGD\(2\).)41 b(F)-8 b(or)27 b(arra)m(y)h(elemen)m(ts)g
(ab)s(o)m(v)m(e)h(the)f(highest)g(sp)s(eci\014ed)h(ZN*I)p
2800 1016 V 35 w(READ,)e(ZN*GD\(IN\))g(is)0 1136 y(set)22
b(a)g(large)f(heigh)m(t)g(v)-5 b(alue)21 b(\(VER)-8 b(YHIGH)22
b(=)g(ZZTOP)f(+)h(1.0e7\))f(and)h(*INITGD\(IN\))g(to)f(*INITGD\(IN-)0
1256 y(1\).)47 b(An)34 b(example)g(of)f(this)h(is)f(sho)m(wn)j(b)s(elo)
m(w)d(in)h(T)-8 b(able)33 b(2.)48 b(This)34 b(pro)s(cedure)h
(simpli\014es)d(the)i(v)m(ertical)0 1377 y(in)m(terp)s(olation)39
b(whic)m(h)k(follo)m(ws)d(and)i(constrains)g(the)h(initial)38
b(pro\014le)j(b)s(elo)m(w)h(the)g(lo)m(w)m(est)h(sp)s(eci\014ed)0
1497 y(v)-5 b(alue)32 b(and)h(ab)s(o)m(v)m(e)g(the)g(highest)g(sp)s
(eci\014ed)g(v)-5 b(alue)32 b(to)g(b)s(e)h(constan)m(t.)p
450 1629 2879 7 v 500 1713 a(Index)101 b(ZNUI)p 1085
1713 30 4 v 35 w(READ)f(UINIT)p 1792 1713 V 36 w(READ)188
b(ZNUGD)f(UINITGD)p 450 1756 2879 7 v 595 1840 a(1)388
b(10.0)535 b(0.0)353 b(VER)-8 b(YLO)m(W)269 b(0.0)595
1961 y(2)364 b(100.0)510 b(5.0)522 b(10.0)436 b(0.0)595
2081 y(3)364 b(500.0)486 b(10.0)472 b(100.0)412 b(5.0)595
2201 y(4)340 b(1000.0)485 b(8.0)497 b(500.0)388 b(10.0)595
2322 y(5)459 b(-)651 b(-)519 b(1000.0)387 b(8.0)595 2442
y(6)459 b(-)651 b(-)387 b(VER)-8 b(YHIGH)257 b(8.0)p
450 2485 V 192 2753 a(T)-8 b(able)32 b(2:)44 b(Example)32
b(of)g(ho)m(w)h(an)f(initial)d(pro\014le)j(arra)m(y)h(is)f(pro)s
(cessed)i(in)e Fw(PREPGRID)p Fv(.)146 2980 y(The)43 b(v)m(ertical)f(in)
m(terp)s(olation)d(to)j(the)h(mo)s(del)d(grid,)k(ZN,)e(is)f(carried)h
(out)g(b)m(y)h(subroutine)g Fw(IN-)0 3100 y(TERPIN)36
b Fv(whic)m(h)j(is)f(called)f(from)g(subroutine)h Fw(SET1D)p
Fv(.)g(Note)h(that)f(the)h(in)m(terp)s(olation)c(has)k(to)0
3221 y(w)m(ait)32 b(un)m(til)f Fw(SET1D)i Fv(as)f(ZN)h(is)f(not)g
(constructed)i(un)m(til)e(that)g(routine.)0 3627 y Fp(3.3)135
b(Setting)46 b(Reference)g(Pro\014les)0 3932 y Fv(An)28
b(imp)s(ortan)m(t)e(part)i(of)g(the)g(initialization)23
b(pro)s(cess)29 b(is)f(the)g(setting)g(up)g(of)g(v)-5
b(arious)27 b(v)m(ertical)g(pro\014les)0 4053 y(of)39
b(reference)h(p)s(oten)m(tial)e(temp)s(erature)h(\(THREF\),)g
(reference)i(pressure)g(o)m(v)m(er)f(densit)m(y)g(\(PREFN\))0
4173 y(and)27 b(densit)m(y)h(\(RHO)e(and)h(RHON\).)g(These)i(are)e(set)
g(up)g(from)f(subroutine)h Fw(SET1D)g Fv(whic)m(h)g(is)g(called)0
4293 y(from)k Fw(BEGIN)p Fv(,)h(for)g(b)s(oth)g(c)m(hain)g(and)h(setup)
h(runs,)f(after)g(the)g(reading)e(of)h(the)h(namelists.)146
4534 y(If)49 b(the)g(sim)m(ulation)c(is)j(anelastic)g(\(IANELP=1\))h
(then)g(THREF)f(is)g(set,)54 b(using)48 b(input)g(from)0
4655 y(namelist)22 b(THPR)m(OF,)i(as)f(a)h(piecewise)g(linear)e
(pro\014le)h(analogously)e(to)j(the)g(initial)19 b(pro\014les)24
b(discussed)0 4775 y(ab)s(o)m(v)m(e.)58 b(Giv)m(en)37
b(THREF)h(it)e(is)h(p)s(ossible)f(to)h(calculate)f(a)h(consisten)m(t)h
(PREFN)f(and)h(RHON)f(using)0 4895 y(the)44 b(univ)m(ersal)f(gas)g(la)m
(w)f(and)i(h)m(ydrostatic)f(appro)m(ximation.)73 b(This)44
b(is)e(sho)m(wn)j(in)d(Section)h(2.2)g(of)0 5016 y(the)d(Scien)m
(ti\014c)h(Do)s(cumen)m(tation)d(\(Gra)m(y)i(et)g(al)f(2001\).)65
b(The)41 b(resulting)e(di\013eren)m(tial)f(equation)i(for)0
5136 y(pressure)c(with)e(resp)s(ect)h(to)f Fn(z)39 b
Fv(in)33 b(terms)h(of)g(THREF)h(is)e(in)m(tegrated)h(do)m(wn)m(w)m
(ards)j(o)m(v)m(er)e(t)m(w)m(o)g(passes.)0 5256 y(F)-8
b(or)41 b(the)h(\014rst)g(pass,)j(it)40 b(is)h(assumed)h(the)g
(pressure)i(of)d(the)h(domain)e(top)h(\(PTOP\))i(is)e(zero.)71
b(The)0 5377 y(resulting)38 b(pro\014le)h(is)g(adjusted)i(dep)s(ending)
e(on)h(the)f(c)m(hoice)h(of)f(IADJANELP)i(and)e(another)h(pass)0
5497 y(p)s(erformed.)64 b(Densit)m(y)40 b(is)f(then)h(computed)f(from)g
(the)h(h)m(ydrostatic)f(relation.)63 b(This)40 b(pro)s(cedure)g(is)0
5618 y(carried)32 b(out)h(in)e Fw(SET)-9 b(ANEL)p Fv(.)146
5858 y(A)30 b(similar)c(pro)s(cedure)k(is)f(emplo)m(y)m(ed)h(for)f(the)
g(Boussinesq)i(sim)m(ulation)c(\(IANELP=0\))j(in)e Fw(SET-)1865
6107 y Fv(9)p eop
%%Page: 10 13
10 12 bop 0 52 a Fw(PREF)p Fv(.)22 b(The)h(main)e(exception)i(is)f
(that)g(densit)m(y)h(is)f(not)g(calculated)g(as)h(it)e(is)h(assumed)h
(to)f(b)s(e)h(constan)m(t)0 173 y(with)32 b(heigh)m(t)h(for)f(a)g
(Boussinesq)i(run.)0 582 y Fp(3.4)135 b(Ph)l(ysical)46
b(P)l(arameters)0 887 y Fv(The)36 b(v)-5 b(alues)35 b(of)f(ph)m
(ysical,)i(grid-dep)s(enden)m(t)f(and)g(parametrization)d(constan)m(ts)
37 b(whic)m(h)e(are)g(used)h(in)0 1008 y(the)42 b(mo)s(del)e(in)m
(tegration)g(are)i(set)h(up)f(in)f(the)h(Initialization)c(phase.)72
b(A)41 b(n)m(um)m(b)s(er)i(of)e(mo)s(del)f(v)-5 b(ari-)0
1128 y(ables)33 b(ha)m(v)m(e)h(their)f(v)-5 b(alues)33
b(de\014ned)h(through)f(namelists)f(and)h(are)g(passed)i(b)s(et)m(w)m
(een)g(c)m(hain)e(run)g(jobs)0 1248 y(through)c(the)h(mo)s(del)e(dump.)
42 b(Eac)m(h)30 b(of)f(these,)i(ho)m(w)m(ev)m(er,)i(has)d(a)f(default)f
(v)-5 b(alue)29 b(whic)m(h)h(is)f(prescrib)s(ed)0 1369
y(in)h Fw(BLOCKD)m(A)-9 b(T)g(A)p Fv(.)28 b(Univ)m(ersal)i(ph)m(ysical)
h(constan)m(ts)g(are)g(prescrib)s(ed)g(as)g(parameter)f(statemen)m(ts)0
1489 y(in)e(the)i(PHYSCON)g(common)e(blo)s(c)m(k.)42
b(This)29 b(prev)m(en)m(ts)j(these)e(v)-5 b(alues)29
b(b)s(eing)g(acciden)m(tly)g(c)m(hanged)h(in)0 1609 y(the)h(co)s(de.)43
b(These)33 b(are)d(sp)s(eci\014c)i(heat)e(at)h(constan)m(t)g(pressure,)
i(CP=1005)16 b(Jkg)2910 1573 y Fi(\000)p Fs(1)3005 1609
y Fv(K)3081 1573 y Fi(\000)p Fs(1)3175 1609 y Fv(,)31
b(univ)m(ersal)f(gas)0 1730 y(constan)m(t,)41 b(R=287.04)16
b(Jkg)1014 1694 y Fi(\000)p Fs(1)1107 1730 y Fv(K)1183
1694 y Fi(\000)p Fs(1)1278 1730 y Fv(,)40 b(ratio)c(of)i(molecular)f(w)
m(eigh)m(ts)i(of)f(air)f(and)h(w)m(ater)i(v)-5 b(ap)s(our,)39
b(RA-)0 1850 y(TIO)p 187 1850 30 4 v 36 w(MOL)p 449 1850
V 35 w(WTS=1.608,)31 b(acceleration)e(due)i(to)f(gra)m(vit)m(y)-8
b(,)31 b(G=9.81)16 b(ms)2703 1814 y Fi(\000)p Fs(2)2796
1850 y Fv(,)31 b(laten)m(t)f(heat)g(of)g(v)-5 b(ap)s(our-)0
1971 y(ization,)37 b(RL)-11 b(V)g(AP=2.501e6)16 b(Jkg)1233
1934 y Fi(\000)p Fs(1)1327 1971 y Fv(,)39 b(and)e(laten)m(t)g(heat)g
(of)g(sublimation,)e(RLSUB=2.834e6)16 b(Jkg)3658 1934
y Fi(\000)p Fs(1)3752 1971 y Fv(.)0 2091 y(Man)m(y)45
b(other)g(v)-5 b(ariables)43 b(are)h(assigned)h(or)f(calculated)f(at)h
(the)h(b)s(eginning)d(of)i(eac)m(h)i(job)e(through)0
2211 y(subroutines)33 b(called)f(from)f Fw(BEGIN)p Fv(.)146
2452 y(The)47 b(functions)f(describing)g(the)h(LEM's)g(subgrid)f(mo)s
(del)e(are)i(de\014ned)i(using)e(a)f(n)m(um)m(b)s(er)i(of)0
2573 y(prescrib)s(ed)h(constan)m(ts)h(i.e.)f(SUBA,)g(SUBB)g(etc.)89
b(These)50 b(are)e(set)g(in)f(routine)g Fw(SETSG)h Fv(called)0
2693 y(from)33 b Fw(BEGIN)p Fv(.)h(This)g(ensures)j(that)d(acceptable)h
(v)-5 b(alues)34 b(for)g(these)i(constan)m(ts)g(are)f(presen)m(t)h(in)e
(all)0 2813 y(sim)m(ulations,)c(unless)k(that)e(part)g(of)g(the)h(co)s
(de)g(is)f(c)m(hanged.)146 3054 y(The)f(three-phase)g(microph)m(ysics)f
(sc)m(heme)h(uses)g(in)m(tegrations)e(o)m(v)m(er)h(assumed)h(particle)d
(size)i(dis-)0 3174 y(tributions)39 b(whic)m(h)i(result)g(in)e
(computationally)f(consuming)h(gamma)g(functions)h(and)h(double)f(in-)0
3295 y(tegrals)h(\(see)i(Section)e(6.1.1)g(of)g(the)h(Scien)m(ti\014c)g
(Do)s(cumen)m(tation,)g(Gra)m(y)g(et)g(al)e(2001\).)70
b(Ho)m(w)m(ev)m(er,)0 3415 y(these)33 b(are)f(generally)f(functions)g
(of)h(prescrib)s(ed)g(constan)m(ts)h(whic)m(h)g(describ)s(e)f(the)g
(prop)s(erties)g(of)f(the)0 3536 y(mo)s(delled)k(w)m(ater)k(sp)s(ecies)
f(and)g(so)f(need)i(only)e(b)s(e)g(calculated)g(once)h(p)s(er)g(job.)57
b(This)38 b(is)f(p)s(erformed)0 3656 y(in)h(the)h(subroutine)f
Fw(MICR)m(OSET)g Fv(whic)m(h)h(is)f(called)g(from)f Fw(BEGIN)p
Fv(.)g(The)j(gamma)c(function)i(is)0 3776 y(calculated)33
b(b)m(y)h(function)g Fw(GAMMAFUNC)f Fv(and)h(the)g(double)g(in)m
(tegral)e(b)m(y)j(function)e Fw(GA)m(USS-)0 3897 y(FUNC)p
Fv(.)146 4138 y(When)f(surface)f(\015uxes)h(are)f(sp)s(eci\014ed)g
(\(ISCBCP=1\))h(a)e(lo)s(ok-up)f(table)h(is)g(used)h(to)f(calculate)g
Fn(u)3741 4153 y Fi(\003)0 4258 y Fv(from)24 b(the)i(Monin-Obukho)m(v)g
(relations)e(for)h(the)h(con)m(v)m(ectiv)m(e)i(case)f(\(see)f(Section)g
(4.1)f(in)f(the)i(Scien)m(ti\014c)0 4378 y(Do)s(cumen)m(tation,)31
b(Gra)m(y)i(et)g(al)f(2001\).)43 b(This)33 b(lo)s(ok-up)f(table)g(is)g
(created)i(at)f(the)g(b)s(eginning)e(of)i(eac)m(h)0 4499
y(job)f(through)h(the)g(subroutine)g Fw(SETLOOK)f Fv(whic)m(h)i(is)e
(called)f(from)g Fw(SET1D)p Fv(.)146 4739 y(A)47 b(n)m(um)m(b)s(er)g
(of)f(other)h(constan)m(ts)g(and)g(v)-5 b(ariables)45
b(are)i(de\014ned)h(in)d Fw(SET1D)p Fv(.)i(These)h(include)0
4860 y(the)41 b(v)m(ertical)f(grid,)i(and)f(functions)g(thereof)g(used)
h(in)e(the)h(v)m(ertical)f(discretization)g(of)g(the)h(mo)s(del)0
4980 y(equations;)35 b(horizon)m(tal)d(grid)h(dep)s(enden)m(t)j
(functions)d(and)h(v)-5 b(ariables)33 b(used)i(in)e(the)h(pressure)i
(solv)m(er,)0 5101 y(bac)m(kscatter)26 b(routines)f(and)f(the)h
(horizon)m(tal)e(discretization)g(of)h(mo)s(del)f(equations;)k(buo)m(y)
m(ancy)g(co)s(e\016-)0 5221 y(cien)m(ts)d(and)f(mixing)e(lengths;)26
b(geostrophic)d(winds)g(\(when)h(baro)s(clinic)d(shear)j(sp)s
(eci\014ed\);)j(Exner-t)m(yp)s(e)0 5341 y(functions)35
b(to)g(con)m(v)m(ert)i(b)s(et)m(w)m(een)g(p)s(oten)m(tial)d(temp)s
(erature)h(and)g(absolute)g(temp)s(erature;)i(damping)0
5462 y(la)m(y)m(er)e(co)s(e\016cien)m(ts;)j(constan)m(ts)f(used)f(in)e
(the)i(surface)g(b)s(oundary)g(condition;)f(and)g(threshold)g(func-)0
5582 y(tions)d(for)g(the)h(w)m(arm)f(rain)g(parametrizations.)1841
6107 y(10)p eop
%%Page: 11 14
11 13 bop 0 52 a Fp(3.5)135 b(Allo)t(cation)0 358 y Fv(One)48
b(tec)m(hnique)h(used)g(in)e(the)h(initialization)43
b(phase)48 b(of)g(the)g(LEM)g(for)f(a)h(n)m(um)m(b)s(er)g(of)f
(di\013eren)m(t)0 478 y(applications)27 b(is)i(allo)s(cation,)e(and)j
(the)f(pro)s(cedure)i(will)c(b)s(e)j(describ)s(ed)g(here.)43
b(Certain)29 b(arra)m(ys)h(in)f(the)0 598 y(LEM)37 b(con)m(tain)f(a)g
(n)m(um)m(b)s(er)h(of)f(di\013eren)m(t)h(quan)m(tities)f(whic)m(h)h
(are)f(generally)g(treated)h(similarly)-8 b(,)33 b(but)0
719 y(ha)m(v)m(e)38 b(di\013eren)m(t)f(applications)d(in)i(some)h
(parts)g(of)f(the)h(co)s(de.)56 b(Examples)37 b(include)f(the)h(Q)f(v)
-5 b(ariable,)0 839 y(whic)m(h)25 b(ma)m(y)f(represen)m(t)i(an)m(y)f(n)
m(um)m(b)s(er)f(of)g(di\013eren)m(t)h(w)m(ater)g(sp)s(ecies,)h(the)f
(diagnostic)e(arra)m(ys)i(DGNEW)0 959 y(and)31 b(DGA)-11
b(V)29 b(whic)m(h)i(use)h(a)e(separate)h(elemen)m(t)f(to)g(represen)m
(t)j(eac)m(h)e(diagnostic,)f(and)g(the)h(timeseries)0
1080 y(arra)m(y)45 b(SER)h(whic)m(h)f(holds)g(all)e(the)j(di\013eren)m
(t)f(timeseries.)81 b(F)-8 b(or)44 b(the)i(diagnostic)e(and)h
(timeseries)0 1200 y(arra)m(ys)k(eac)m(h)g(diagnostic)e(requires)i(a)f
(di\013eren)m(t)g(calculation,)i(whilst)d(iden)m(tifying)g(the)h
(di\013eren)m(t)0 1321 y(w)m(ater)33 b(sp)s(ecies)h(in)e(the)h(Q)f
(arra)m(y)h(is)f(essen)m(tial)g(for)g(the)h(microph)m(ysics)g
(parametrizations.)146 1561 y(T)-8 b(o)39 b(iden)m(tify)g(the)g
(separate)h(elemen)m(ts)f(of)f(the)i(arra)m(ys,)h(in)m(teger)d(v)-5
b(ariables)38 b(are)h(assigned)g(index)0 1682 y(v)-5
b(alues.)40 b(F)-8 b(or)23 b(example,)h(IQV)f(will)e(b)s(e)j(the)f
(index)h(of)e(Q)h(whic)m(h)h(corresp)s(onds)g(to)f(w)m(ater)h(v)-5
b(ap)s(our)23 b(mixing)0 1802 y(ratio.)39 b(These)25
b(v)-5 b(alues)23 b(could)f(b)s(e)i(hardwired,)h(but)e(this)g(limits)d
(the)j(\015exibilit)m(y)f(of)g(the)i(co)s(de)f(dep)s(ending)0
1923 y(on)j(the)h(c)m(hoice)g(of)f(w)m(ater)h(sp)s
(ecies/diagnostics/timeseries.)40 b(T)-8 b(o)26 b(retain)g(this)g
(\015exibilit)m(y)f(these)i(index)0 2043 y(v)-5 b(ariables)33
b(are)i(allo)s(cated)d(at)i(the)h(b)s(eginning)e(of)i(eac)m(h)g(job)f
(using)g(the)h Fw(ALLOCA)-9 b(TE)34 b Fv(subroutine.)0
2163 y(This)41 b(is)f(a)g(short)h(utilit)m(y)d(routine)i(whic)m(h)i
(assigns)e(the)h(index)g(\(N\))g(to)f(a)g(coun)m(ter)i(v)-5
b(alue)40 b(\(NEXT\))0 2284 y(and)47 b(incremen)m(ts)h(the)g(coun)m
(ter)g(b)m(y)g(the)g(n)m(um)m(b)s(er)g(of)f(elemen)m(ts)g(allo)s(cated)
f(\(M\).)h Fw(ALLOCA)-9 b(TE)0 2404 y Fv(in)42 b(turn)h(is)g(called)f
(from)g(the)h(allo)s(cation)c(routines,)46 b(with)d(one)g(call)e(to)i
Fw(ALLOCA)-9 b(TE)42 b Fv(for)h(eac)m(h)0 2524 y(index)d(to)g(b)s(e)f
(allo)s(cated.)64 b(Q)39 b(v)-5 b(ariable)38 b(indices)i(are)g(allo)s
(cated)d(in)i Fw(ALLOCQS)p Fv(,)i(the)f(diagnostics)0
2645 y(in)32 b Fw(ALLOCDGS)i Fv(and)g(the)f(timeseries)g(in)f
Fw(INTIMSER)p Fv(.)g(These)j(three)f(routines)f(are)h(all)d(called)0
2765 y(from)g Fw(SET1D)p Fv(.)146 3006 y(It)40 b(should)g(b)s(e)g
(noted,)j(that)c(although)g(this)h(pro)s(cedure)h(main)m(tains)d
(\015exibilit)m(y)-8 b(,)40 b(extreme)g(care)0 3126 y(m)m(ust)g(b)s(e)g
(tak)m(en)h(if)e(the)h(n)m(um)m(b)s(ers)h(of)f(Q)f(v)-5
b(ariables)39 b(or)h(diagnostics)f(are)h(to)f(b)s(e)h(c)m(hanged)h(b)s
(et)m(w)m(een)0 3247 y(jobs)33 b(in)f(a)g(c)m(hain.)0
3700 y Fx(4)161 b(In)l(tegration)0 4039 y Fv(In)m(tegration)41
b(of)g(the)h(mo)s(del)e(equations)i(is)f(carried)g(out)g(through)h
(subroutine)g Fw(NNSTEPS)p Fv(,)e(the)0 4160 y(structure)j(of)f(whic)m
(h)h(is)f(sho)m(wn)h(in)f(Figs.)f(4)h(and)g(5.)72 b Fw(NNSTEPS)41
b Fv(is)h(dominated)f(b)m(y)i(t)m(w)m(o)g(main)0 4280
y(lo)s(ops:)67 b(an)44 b(outer)h(lo)s(op)e(o)m(v)m(er)j(the)f(n)m(um)m
(b)s(er)g(of)f(timesteps)h(\(NN\),)g(and)f(an)h(inner)f(lo)s(op)f(o)m
(v)m(er)j(the)0 4400 y(n)m(um)m(b)s(er)33 b(of)f(v)m(ertical)g(slices)g
(on)g(the)h(PE)g(\(I)s(IPEP\).)h(Within)d(this)h(inner)g(lo)s(op)f(the)
i(source)h(terms)e(for)0 4521 y(the)i(prognostic)e(v)-5
b(ariables)32 b(on)i(eac)m(h)g(slice)e(are)h(calculated)g(\(calls)f(to)
h Fw(D)m(YNVIS)p Fv(,)f(and)h Fw(BCKSCT)0 4641 y Fv(if)39
b(bac)m(kscatter)j(activ)-5 b(ated\))39 b(along)g(with)g(the)i(source)g
(term)e(for)h(the)g(pressure)i(equation)e(\(calls)f(to)0
4762 y Fw(DIVERR)f Fv(and)i Fw(PSR)m(CE)p Fv(\))e(and)i(diagnostics)f
(\(calls)g(to)g Fw(RESDGS)h Fv(and)g Fw(SUBDGS)p Fv(\).)g(A)m(t)g(the)0
4882 y(end)h(of)e(the)h(inner)g(lo)s(op)e(the)j(prognostic)e(\014elds)h
(are)g(incremen)m(ted)h(in)e(time)f(through)i(subroutine)0
5002 y Fw(STEPFLDS)p Fv(.)g(Once)h(all)d(the)i(slices)g(ha)m(v)m(e)h(b)
s(een)g(in)m(tegrated)f(and)g(the)g(inner)g(lo)s(op)f(is)g(complete,)0
5123 y(the)46 b(horizon)m(tal)d(means)i(of)g(the)h(v)-5
b(ariables)44 b(can)h(b)s(e)h(calculated)e(\()p Fw(CALCBAR)g
Fv(or)h Fw(CBAR2D)p Fv(\))0 5243 y(along)31 b(with)i(the)g(CFL)f
(condition)g(\()p Fw(CVELGAL2)p Fv(\).)43 b(The)34 b(pressure)g(is)f
(calculated)e(diagnostically)0 5364 y(through)41 b(subroutine)h
Fw(POISSON)f Fv(and)h(the)f(v)m(elo)s(cit)m(y)h(\014elds)f(stepp)s(ed)i
(with)e(the)h(pressure)h(term)0 5484 y(in)h Fw(PSTEP)f
Fv(whic)m(h)h(completes)g(the)h(in)m(tegration)e(of)h(all)e(prognostic)
h(v)-5 b(ariables.)78 b(A)m(t)44 b(this)g(stage)0 5604
y(the)c(time-lev)m(els)e(of)h(the)g(prognostic)g(v)-5
b(ariables)38 b(can)i(b)s(e)g(sw)m(app)s(ed)h(and)e(time-smo)s(othed)f
(through)0 5725 y Fw(SW)-12 b(APSMTH)p Fv(.)29 b(\(Both)h
Fw(PSTEP)f Fv(and)h Fw(SW)-12 b(APSMTH)29 b Fv(are)i(called)e(within)g
(an)h(additional)d(lo)s(op)0 5845 y(o)m(v)m(er)37 b(I)s(IPEP)-8
b(.\))38 b(The)f(\014nal)e(part)h(of)g(the)g(NN)h(lo)s(op)e(completes)h
(the)g(calculation)e(of)i(the)g(diagnostics)1841 6107
y(11)p eop
%%Page: 12 15
12 14 bop 0 52 a Fv(\()p Fw(GR)m(OUPDGS)p Fv(\))39 b(and)g(timeseries)g
(\()p Fw(TIMSER)p Fv(\).)f(On)h(completion)f(of)g(the)i(NN)f(lo)s(op,)h
(the)f(CFL)0 173 y(condition)30 b(is)i(c)m(hec)m(k)m(ed)j(and)d(the)g
(timestep)f(up)s(dated.)44 b(Finally)-8 b(,)30 b(the)i(mo)s(del)e(time)
g(is)i(c)m(hec)m(k)m(ed)j(to)c(see)0 293 y(if)g(a)i(diagnostic)e(dump)h
(or)h(run)f(termination)e(is)j(required.)0 702 y Fp(4.1)135
b(Indexing)45 b(of)h(the)f(I-Lo)t(op)0 1007 y Fv(T)-8
b(o)33 b(in)m(tegrate)g(the)g Fn(@)5 b(=@)g(x)35 b Fv(terms)e(in)f(the)
i(mo)s(del)d(equations,)i(data)g(v)-5 b(alues)33 b(on)g(slices)g(to)f
(adjacen)m(t)i(to)0 1128 y(the)27 b(curren)m(t)g(slice)f(are)h
(required.)42 b(The)27 b Fn(@)5 b(=@)g(x)28 b Fv(deriv)-5
b(ativ)m(e)26 b(of)g(VIS)h(and)g(DIFF,)e(whic)m(h)i(are)f(calculated)0
1248 y(in)40 b Fw(CALCVIS)p Fv(,)g(are)h(required)g(to)f(calculate)f
(the)i(viscous)h(and)e(di\013usiv)m(e)h(source)h(terms)e(for)g(the)0
1369 y(prognostic)e(v)-5 b(ariables.)62 b(Th)m(us,)42
b(the)d(calculation)e(the)i(source)h(term)e(on)h(slice)f(I)h(requires)h
(VIS)f(and)0 1489 y(DIFF)34 b(on)g(slices)h(I-1,I)g(and)f(I+1.)50
b(These)37 b(v)-5 b(alues)35 b(are)g(made)f(a)m(v)-5
b(ailable)32 b(b)m(y)k(calling)c Fw(CALCVIS)i Fv(in)0
1609 y(the)42 b(same)e(I-lo)s(op)g(as)h Fw(D)m(YNVIS)f
Fv(but)h(calculating)e(VIS)i(and)h(DIFF)e(for)g(the)i(subsequen)m(t)i
(\(I+1\))0 1730 y(v)m(ertical)30 b(slice.)42 b(This)31
b(do)s(es)g(necessitate)h(t)m(w)m(o)g(extra)f(calls)e(for)h
Fw(CALCVIS)h Fv(in)e(the)j(I-lo)s(op,)d(and)i(this)0
1850 y(is)38 b(ac)m(hiev)m(ed)h(b)m(y)g(lo)s(oping)d(b)s(et)m(w)m(een)k
(-1)d(and)i(I)s(IPEP)-8 b(,)39 b(but)f(only)g(calling)d(the)k(other)f
(subroutines)h(in)0 1971 y(the)33 b(lo)s(op)e(for)h(I)p
Fn(>)p Fv(0.)43 b(This)33 b(pro)s(cedure)h(is)e(illustrated)e(in)i(T)-8
b(able)32 b(3)h(b)s(elo)m(w.)2779 1934 y Fs(1)p 135 2112
3510 7 v 185 2197 a Fv(Lo)s(op)f(coun)m(ter)101 b(Slice)31
b(VIS)i(and)g(DIFF)99 b(Slice)31 b(source)j(term)99 b(VIS,)33
b(DIFF)f(slices)g(input)450 2317 y(I)507 b(calculated)32
b(on)324 b(calculated)32 b(on)384 b(to)32 b Fw(D)m(YNVIS)p
135 2360 V 427 2444 a Fv(-1)741 b(0)847 b(-)914 b(-)443
2564 y(0)758 b(1)847 b(-)914 b(-)443 2685 y(1)758 b(2)839
b(1)790 b(0,)32 b(1,)h(2)443 2805 y(2)758 b(3)839 b(2)790
b(1,)32 b(2,)h(3)427 2925 y(...)726 b(...)806 b(...)867
b(...)450 3046 y(I)709 b(I+1)790 b(I)715 b(I-1,)32 b(I,)h(I+1)p
135 3089 V 0 3357 a(T)-8 b(able)42 b(3:)63 b(Calculation)40
b(of)i(VIS)h(and)f(DIFF)g(within)f(the)i Fw(NNSTEPS)e
Fv(I-lo)s(op)g(in)g(case)j(with)e(no)0 3477 y(bac)m(kscatter)146
3694 y(The)36 b(lo)s(op)d(has)i(to)g(b)s(e)g(extended)h(further)f(when)
h(bac)m(kscatter)h(is)d(used.)51 b(The)36 b(bac)m(kscatter)g(rou-)0
3815 y(tines)e(require)g(DIS)g(\(the)g(bac)m(kscattered)j(energy\),)e
(whic)m(h)f(is)g(calculated)f(from)f(the)j(viscous)g(terms)0
3935 y(in)40 b Fw(CALCVIS)p Fv(.)g(Ho)m(w)m(ev)m(er,)k(to)c(calculate)g
(the)h(bac)m(kscatter)h(source)f(term)f(on)h(slice)e(I,)i(\014v)m(e)h
(slices)0 4055 y(of)36 b(DIS)g(are)h(required)f(from)g(I-2)f(to)h(I+2.)
55 b(No)m(w,)38 b Fw(CALCVIS)e Fv(has)h(to)f(calculate)f(VIS,)i(DIFF)e
(and)0 4176 y(DIS)29 b(for)g(the)h(I+2)g(slice)e(during)h(the)h(I-lo)s
(op)e(and)h(m)m(ust)h(b)s(e)g(called)e(an)i(additional)c(four)j(times)g
(to)g(the)0 4296 y(other)35 b(routines)g(in)g(the)g(lo)s(op.)50
b(The)36 b(I-lo)s(op)d(ranges)i(from)f(-3)h(to)f(I)s(IPEP)j(and)e(the)g
(calculations)e(are)0 4417 y(illustrated)e(in)h(T)-8
b(able)32 b(4)h(b)s(elo)m(w.)44 b(Note)33 b(that)g(four)f(v)m(ertical)g
(slices)h(of)f(VIS)i(and)f(DIFF)e(no)m(w)j(need)g(to)0
4537 y(b)s(e)f(stored.)146 4778 y(The)38 b(viscous)f(source)g(terms)g
(are)f(calculated)g(using)g(data)g(from)f(the)i(previous)g(time)e(lev)m
(el)h(\(Z*)0 4898 y(\014elds\).)43 b(Because)32 b(of)d(this)h(the)h(Z*)
e(\014elds)i(are)f(required)g(at)g(I-1)g(for)f(the)i(source)g(term)f
(calculation)e(on)0 5018 y(the)36 b(I)f(slice.)50 b(Hence,)37
b(the)f(\014elds)f(are)g(only)g(stepp)s(ed)h(forw)m(ard)g(in)e(time)g
(once)h(the)h(I+2)f(term)f(source)0 5139 y(term)26 b(has)h(b)s(een)g
(calculated.)41 b(Th)m(us,)29 b Fw(STEPFLDS)e Fv(steps)h(the)e(I-2)g
(slice)g(during)g(the)h(I-lo)s(op,)f(except)0 5259 y(for)32
b(the)h(last)f(lo)s(op)f(when)j(all)c(remaining)g(slices)j(are)f(stepp)
s(ed.)146 5500 y(In)41 b(an)f(attempt)f(to)g(simplify)f(the)i(calls)f
(to)h Fw(CALCVIS)p Fv(,)f Fw(D)m(YNVIS)g Fv(etc)h(in)g(the)g(I-lo)s(op)
e(\(al-)p 0 5568 1512 4 v 112 5629 a Fh(1)149 5659 y
Fg(This)30 b(could)e(b)r(e)i(ac)n(hiev)n(ed)e(b)n(y)h(calling)f
Ff(CALCVIS)i Fg(in)g(a)e(separate)g(I-lo)r(op)g(and)h(storing)f(all)h
(the)g(v)-5 b(alues)29 b(of)g(VIS)0 5759 y(and)e(DIFF)h(to)f(b)r(e)h
(input)g(in)n(to)f Ff(D)m(YNVIS)h Fg(for)f(the)h(calculation)e(of)i
(the)f(source)f(terms.)37 b(Ho)n(w)n(ev)n(er,)25 b(only)i(three)g
(slices)0 5858 y(of)h(VIS)g(and)f(DIFF)h(are)f(required)g(at)g(an)n(y)g
(one)g(time)h(so)f(this)h(w)n(ould)f(b)r(e)h(an)g(unnecessary)e(memory)
g(o)n(v)n(erhead.)1841 6107 y Fv(12)p eop
%%Page: 13 16
13 15 bop 1061 -263 a Fk(')p 1061 -77 4 23 v 1061 91
a(&)1770 -263 y($)p 1770 -77 V 1770 91 a(\045)p 1229
91 377 4 v 1229 -263 V 1153 -53 a Fw(NNSTEPS)p 1416 149
4 71 v 236 115 1182 4 v 235 586 4 473 v -45 690 a Fq(Lo)s(op)30
b(o)m(v)m(er)i(NN)49 831 y(timesteps)p 235 5629 4 4725
v 236 5629 a Fo(?)p 1060 149 716 4 v 1060 432 4 284 v
1772 432 V 1060 435 716 4 v 1124 324 a Fw(SETINDEX)p
1416 503 4 71 v 1890 292 237 4 v 2044 290 a Fo(-)2244
278 y Fv(Sets)i(the)f(v)m(ertical)e(slice)h(indices)h(for)2244
362 y(bac)m(kscatter,)i(viscosit)m(y)e(and)f(source)i(terms)p
1060 503 716 4 v 1060 786 4 284 v 1772 786 V 1060 789
716 4 v 1124 679 a Fw(SETMOIST)p 1416 857 4 71 v 1890
646 237 4 v 2044 644 a Fo(-)2244 622 y Fv(Set)f(up)g(saturation)f(arra)
m(ys)h(for)f(the)2244 726 y(moist)f(Ric)m(hardson)i(n)m(um)m(b)s(er)g
(calculation)p 1060 857 716 4 v 1060 1141 4 284 v 1772
1141 V 1060 1144 716 4 v 1195 1033 a Fw(XWRAP)p 1416
1212 4 71 v 1890 1001 237 4 v 2044 999 a Fo(-)2244 977
y Fv(Set)g(up)g(the)g(x-direction)e(halo)s(es)2244 1071
y(i.e)h(slices)h(I=0,-1,I)s(IPEP+1)f(etc.)p 1060 1212
716 4 v 1060 1495 4 284 v 1772 1495 V 1060 1498 716 4
v 1224 1387 a Fw(CHGLS)p 1416 1566 4 71 v 1890 1355 237
4 v 2044 1353 a Fo(-)2244 1378 y Fv(Up)s(date)h(the)g(large-scale)e
(forcing)p 591 1532 827 4 v 589 3349 4 1819 v 589 5487
V 591 5489 827 4 v 393 3431 a Fq(Lo)s(op)f(o)m(v)m(er)327
3582 y(v)m(ertical)h(slices)p 1060 1566 716 4 v 1060
1849 4 284 v 1772 1849 V 1060 1852 716 4 v 1096 1742
a Fw(SETINDEX2)p 1416 1920 4 71 v 1890 1709 237 4 v 2044
1707 a Fo(-)2244 1695 y Fv(Sets)j(the)f(v)m(ertical)e(slice)h(indices)
2244 1780 y(for)g(the)h(prognostic)f(v)-5 b(ariables)p
1060 1920 716 4 v 1060 2204 4 284 v 1772 2204 V 1060
2207 716 4 v 1156 2025 a Fw(SETFLUX)1089 2167 y Fv(&)p
Fw(CHGLOOK)p 1416 2275 4 71 v 1890 2064 237 4 v 2044
2062 a Fo(-)2244 2040 y Fv(Up)s(date)33 b(surface)g(\015ux)h(and)e(lo)s
(ok-up)2244 2134 y(table)g(if)f(\015uxes)k(time-v)-5
b(arying)p 1060 2275 716 4 v 1060 2558 4 284 v 1772 2558
V 1060 2561 716 4 v 1166 2450 a Fw(CALCVIS)p 1416 2629
4 71 v 1890 2418 237 4 v 2044 2416 a Fo(-)2244 2394 y
Fv(Calculate)32 b(the)h(viscosit)m(y)g(\(VIS\))2244 2488
y(and)g(di\013usion)e(\(DIFF\))p 1060 2629 716 4 v 1060
2912 4 284 v 1772 2912 V 1060 2915 716 4 v 1195 2805
a Fw(D)m(YNVIS)p 1416 2983 4 71 v 1890 2772 237 4 v 2044
2770 a Fo(-)2244 2701 y Fv(Calculate)h(the)h(adv)m(ection,)g(viscous,)
2244 2796 y(buo)m(y)m(ancy)-8 b(,)35 b(damping)c(and)h(diabatic)2244
2890 y(source)i(terms)e(for)g(prognostic)g(v)-5 b(ariables)p
1060 2983 716 4 v 1060 3267 4 284 v 1772 3267 V 1060
3270 716 4 v 1090 3159 a Fw(BCKSCT)32 b Fv(etc.)p 1416
3338 4 71 v 1890 3127 237 4 v 2044 3125 a Fo(-)2244 3112
y Fv(Calculate)g(the)h(Bac)m(kscatter)h(source)2244 3197
y(terms)f(for)f(prognostic)g(v)-5 b(ariables)p 1060 3338
716 4 v 1060 3621 4 284 v 1772 3621 V 1060 3624 716 4
v 1191 3443 a Fw(DIVERR)1176 3585 y Fv(&)33 b Fw(PSR)m(CE)p
1416 3692 4 71 v 1890 3481 237 4 v 2044 3479 a Fo(-)2244
3467 y Fv(Calculate)f(the)h(source)g(term)f(for)g(the)2244
3551 y(P)m(oisson-lik)m(e)g(pressure)i(equation)p 1060
3692 716 4 v 1060 3975 4 284 v 1772 3975 V 1060 3978
716 4 v 1122 3868 a Fw(CLASSCOL)p 1416 4046 4 71 v 1890
3835 237 4 v 2044 3833 a Fo(-)2244 3821 y Fv(Determine)e(the)h(column)e
(classi\014cation)2244 3906 y(for)h(conditional)e(diagnostics)p
1060 4046 716 4 v 1060 4330 4 284 v 1772 4330 V 1060
4333 716 4 v 1189 4222 a Fw(RESDGS)p 1416 4401 4 71 v
1890 4190 237 4 v 2044 4188 a Fo(-)2244 4175 y Fv(Calculate)i(the)h
(resolv)m(ed)g(and)2244 4260 y(conditionally)d(sampled)i(diagnostics)p
1060 4401 716 4 v 1060 4684 4 284 v 1772 4684 V 1060
4687 716 4 v 1185 4576 a Fw(SUBDGS)p 1416 4755 4 71 v
1890 4544 237 4 v 2044 4542 a Fo(-)2244 4567 y Fv(Calculate)g(the)h
(subgrid)f(diagnostics)p 1060 4755 716 4 v 1060 5038
4 284 v 1772 5038 V 1060 5041 716 4 v 1129 4931 a Fw(STEPFLDS)p
1416 5109 4 71 v 1890 4898 237 4 v 2044 4896 a Fo(-)2244
4827 y Fv(Step)h(all)e(prognostic)h(v)-5 b(ariables)2244
4931 y(with)32 b(the)h(calculated)f(source)i(terms)2244
5016 y(Calculate)e(lo)s(cal)e(v)m(elcoit)m(y)j(maxima)p
1060 5109 716 4 v 1060 5393 4 284 v 1772 5393 V 1060
5396 716 4 v 1152 5285 a Fw(REINDEX)p 1416 5629 4 237
v 1417 5629 a Fo(?)p 1890 5253 237 4 v 2043 5251 a(-)2244
5229 y Fv(Incremen)m(t)h(the)f(bac)m(kscatter,)h(viscosit)m(y)2244
5333 y(and)f(source)g(term)f(slice)g(indices)934 5832
y(Figure)f(4:)43 b(Structure)34 b(of)e(subroutine)h(NNSTEPS)1841
6107 y(13)p eop
%%Page: 14 17
14 16 bop 1416 28 4 237 v 1417 28 a Fo(?)p 235 429 4
638 v -45 570 a Fq(Lo)s(op)30 b(o)m(v)m(er)i(NN)49 687
y(timesteps)p 235 3890 4 3107 v 236 3892 1182 4 v 1060
28 716 4 v 1060 311 4 284 v 1772 311 V 1060 314 716 4
v 1136 204 a Fw(CALCBAR)p 1416 382 4 71 v 1890 171 237
4 v 2044 169 a Fo(-)2244 157 y Fv(Calculate)g(horizon)m(tal)f(mean)h
(of)2244 242 y(eac)m(h)i(prognostic)e(v)-5 b(ariables)p
1060 382 716 4 v 1060 665 4 284 v 1772 665 V 1060 668
716 4 v 1116 558 a Fw(CVELGAL2)p 1416 736 4 71 v 1890
525 237 4 v 2044 523 a Fo(-)2244 501 y Fv(Complete)32
b(determination)f(of)h(v)m(elo)s(cit)m(y)2244 606 y(maxima)e(for)i(CFL)
h(calculation)p 1060 736 716 4 v 1060 1020 4 284 v 1772
1020 V 1060 1023 716 4 v 1168 912 a Fw(POISSON)p 1416
1091 4 71 v 1890 880 237 4 v 2044 878 a Fo(-)2244 856
y Fv(Calculate)f(the)h(p)s(erturbation)2244 937 y(pressure)p
591 1057 827 4 v 589 1457 4 402 v 589 2118 V 591 2120
827 4 v 393 1538 a Fq(Lo)s(op)d(o)m(v)m(er)327 1689 y(v)m(ertical)h
(slices)p 1060 1091 716 4 v 1060 1374 4 284 v 1772 1374
V 1060 1377 716 4 v 1234 1267 a Fw(PSTEP)p 1416 1445
4 71 v 1890 1234 237 4 v 2044 1232 a Fo(-)2244 1220 y
Fv(Incremen)m(t)j(the)f(momen)m(tum)e(\014elds)2244 1305
y(with)h(the)h(pressure)i(term)p 1060 1445 716 4 v 1060
1728 4 284 v 1772 1728 V 1060 1731 716 4 v 1261 1621
a Fw(PDGS)p 1416 1799 4 71 v 1890 1588 237 4 v 2044 1586
a Fo(-)2244 1612 y Fv(Calculate)d(pressure)i(diagnostics)p
1060 1799 716 4 v 1060 2083 4 284 v 1772 2083 V 1060
2086 716 4 v 1087 1975 a Fw(SW)-12 b(APSMTH)p 1416 2154
4 71 v 1890 1943 237 4 v 2044 1941 a Fo(-)2244 1919 y
Fv(Smo)s(oth)31 b(prognostic)i(v)-5 b(ariables)31 b(b)s(et)m(w)m(een)
2244 2013 y(time-lev)m(els)g(and)i(sw)m(ap)g(ZX)g(and)f(X)h(v)-5
b(ariables)p 1060 2154 716 4 v 1060 2437 4 284 v 1772
2437 V 1060 2440 716 4 v 1091 2330 a Fw(GR)m(OUPDGS)p
1416 2508 4 71 v 1890 2297 237 4 v 2044 2295 a Fo(-)2244
2273 y Fv(Sum)32 b(the)h(diagnostics)f(across)h(all)2244
2354 y(pro)s(cessors)p 1060 2508 716 4 v 1060 2791 4
284 v 1772 2791 V 1060 2794 716 4 v 1195 2684 a Fw(TIMSER)p
1416 2862 4 71 v 1890 2651 237 4 v 2044 2649 a Fo(-)2244
2675 y Fv(Calculate)f(the)h(timeseries)f(diagnostics)p
1060 2862 716 4 v 1060 3146 4 284 v 1772 3146 V 1060
3149 716 4 v 1162 3038 a Fw(TESTCFL)p 1416 3217 4 71
v 1890 3006 237 4 v 2044 3004 a Fo(-)2244 2991 y Fv(T)-8
b(est)34 b(the)f(CFL)f(condition)f(and)i(determine)2244
3075 y(a)f(new)i(timestep)e(as)h(appropriate)p 1060 3217
716 4 v 1060 3500 4 284 v 1772 3500 V 1060 3503 716 4
v 1086 3381 a Fq(Up)s(date)d(timestep)p 1416 3571 4 71
v 1060 3571 716 4 v 1060 3854 4 284 v 1772 3854 V 1060
3857 716 4 v 1151 3700 a Fw(MAKING-)1193 3794 y(MO)m(VIES)p
1416 3925 4 71 v 1890 3714 237 4 v 2044 3712 a Fo(-)2244
3738 y Fv(Output)j(animation)d(\014le)p 1060 3925 716
4 v 1060 4209 4 284 v 1772 4209 V 1060 4212 716 4 v 1252
4101 a Fw(A)-12 b(VDG)p 1416 4280 4 71 v 1890 4069 237
4 v 2044 4067 a Fo(-)2244 4045 y Fv(Add)33 b(new)h(diagnostics)d(to)i
(the)2244 4138 y(running)f(a)m(v)m(erages)p 1060 4280
716 4 v 1060 4563 4 284 v 1772 4563 V 1060 4566 716 4
v 1122 4456 a Fw(TESTTIME)p 1416 4634 4 71 v 1890 4423
237 4 v 2044 4421 a Fo(-)2244 4399 y Fv(Chec)m(k)j(time)c(and)i(return)
g(appropriate)e(\015ag)2244 4494 y(for)h(diagnostic)f(dump,)i(end)g
(run)g(etc.)p 1060 4634 716 4 v 1060 4917 4 284 v 1772
4917 V 1060 4920 716 4 v 1236 4810 a Fw(EXXIT)p 1416
5036 4 119 v 1890 4777 237 4 v 2044 4775 a Fo(-)2244
4753 y Fv(If)g(appropriate)e(\015ag)i(from)e(TESTTIME)2244
4858 y(then)i(terminate)f(run)1061 5049 y Fk(')p 1061
5236 4 23 v 1061 5403 a(&)1770 5049 y($)p 1770 5236 V
1770 5403 a(\045)p 1229 5403 377 4 v 1229 5049 V 1208
5140 a Fv(Return)h(to)1232 5259 y Fw(BEGIN)1202 5353
y(SST)-9 b(AR)g(T)674 5829 y Fv(Figure)31 b(5:)43 b(Structure)34
b(of)e(subroutine)h(NNSTEPS)h(\(con)m(tin)m(ued\))1841
6107 y(14)p eop
%%Page: 15 18
15 17 bop 229 -41 3322 7 v 330 44 a Fv(Lo)s(op)253 b(Slice)31
b(VIS,)203 b(Slice)32 b(source)153 b(VIS,)33 b(DIFF)356
b(DIS)33 b(slices)279 164 y(coun)m(ter)101 b(DIFF)31
b(and)i(DIS)105 b(term)32 b(calcu-)147 b(slices)33 b(input)381
b(input)32 b(to)420 285 y(I)270 b(calculated)32 b(on)187
b(-lated)31 b(on)157 b(to)32 b Fw(D)m(YNVIS)277 b(BCKSCT)p
229 327 V 397 412 a Fv(-3)488 b(-1)600 b(-)595 b(-)761
b(-)397 532 y(-2)504 b(0)617 b(-)595 b(-)761 b(-)397
652 y(-1)504 b(1)617 b(-)595 b(-)761 b(-)413 773 y(0)521
b(2)617 b(-)595 b(-)761 b(-)413 893 y(1)521 b(3)609 b(1)470
b(0,)33 b(1,)f(2)404 b(-1,)32 b(0,)g(1,)h(2,)f(3)413
1013 y(2)521 b(4)609 b(2)470 b(1,)33 b(2,)f(3)420 b(0,)33
b(1,)f(2,)g(3,)h(4)397 1134 y(...)489 b(...)577 b(...)547
b(...)713 b(...)420 1254 y(I)472 b(I+2)561 b(I)395 b(I-1,)32
b(I,)h(I+1)165 b(I-2,)32 b(I-1,)g(I,)h(I+1,)g(I+2)p 229
1297 V 0 1565 a(T)-8 b(able)26 b(4:)40 b(Calculation)23
b(of)j(VIS,)h(DIFF)e(and)h(DIS)g(within)f(the)h Fw(NNSTEPS)f
Fv(I-lo)s(op)f(when)j(bac)m(kscat-)0 1686 y(ter)33 b(is)f(switc)m(hed)i
(on.)0 1951 y(though)25 b(at)g(the)h(loss)f(of)g(some)g(transparency\))
i(a)e(system)h(of)f(slice)f(indices)h(has)h(b)s(een)g(used)g(to)f(iden)
m(tify)0 2072 y(the)33 b(v)m(ertical)f(slices)g(for)g(the)i(mo)s(del)c
(v)-5 b(ariables.)43 b(Di\013eren)m(t)32 b(indices)g(ha)m(v)m(e)i(to)f
(b)s(e)f(used)i(for)e(the)h(prog-)0 2192 y(nostic)g(v)-5
b(ariables,)33 b(source)h(terms,)g(VIS)f(and)h(DIFF,)e(and)i(DIS)f(as)h
(di\013eren)m(t)f(n)m(um)m(b)s(ers)h(of)f(slices)g(are)0
2313 y(held)38 b(for)g(eac)m(h)h(set)g(of)f(v)-5 b(ariables,)39
b(and)f(di\013eren)m(t)h(indices)f(need)h(to)f(b)s(e)h(used)g(for)f
(the)h Fw(CALCVIS)0 2433 y Fv(call)31 b(as)i(these)g(are)g(dep)s(enden)
m(t)i(on)d(whether)i(bac)m(kscatter)g(is)e(switc)m(hed)i(on)f(\(IBSCA)
-8 b(TP=1\).)146 2674 y(The)35 b(prognostic)f(v)-5 b(ariables)33
b(are)h(indexed)h(using)e(IM2,)i(IM1,)g(I0,)g(IP1)f(and)g(IP2)h
(corresp)s(onding)0 2794 y(to)25 b(I-2,)h(I-1,)g(I,)f(I+1)g(and)g(I+2)f
(resp)s(ectiv)m(ely)i(in)f(the)g(calls)f(to)g Fw(D)m(YNVIS)p
Fv(,)g Fw(DIVERR)p Fv(,)f Fw(STEPFLDS)0 2915 y Fv(and)35
b Fw(RESDGS)p Fv(.)g(In)h(the)g(calls)e(to)h Fw(CALCVIS)f
Fv(and)i Fw(SUBDGS)f Fv(they)i(are)e(indexed)h(using)f(IP)-8
b(A,)0 3035 y(IPB)51 b(and)g(IPC.)g(In)g(the)g(absence)h(of)e(bac)m
(kscatter)i(IP)-8 b(A=I0,)55 b(IPB=IP1)d(and)e(IPC=IP2;)61
b(with)0 3155 y(bac)m(kscatter)34 b(IP)-8 b(A=IP1,)34
b(IPB=IP2)f(and)g(IPC=IP3\(=I+3\).)146 3396 y(The)g(source)g(term)e(v)
-5 b(ariables)31 b(are)h(indexed)h(using)e(ISI0,)i(ISIM1)f(and)g(ISIM2)
h(corresp)s(onding)f(to)0 3516 y(I,)h(I-1)g(and)g(I-2)f(resp)s(ectiv)m
(ely)i(in)e(the)i(calls)d(to)i Fw(D)m(YNVIS)p Fv(,)f
Fw(BCKSCT)p Fv(,)g Fw(PSR)m(CE)p Fv(,)g Fw(STEPFLDS)0
3637 y Fv(and)h(the)g(diagnostic)e(routines.)146 3878
y(The)43 b(VIS)g(and)g(DIFF)e(v)-5 b(ariables)41 b(are)h(indexed)h
(using)f(IVISIM1,)k(IVISI0)c(and)h(IVISIP1)g(cor-)0 3998
y(resp)s(onding)48 b(to)g(I-1,)k(I)d(and)f(I+1)g(resp)s(ectiv)m(ely)i
(for)e(the)g(call)f(to)h Fw(D)m(YNVIS)p Fv(.)f(F)-8 b(or)48
b(the)h(calls)e(to)0 4118 y Fw(CALCVIS)d Fv(and)g Fw(SUBDGS)h
Fv(they)g(are)f(indexed)h(b)m(y)g(IVISIP)-8 b(A.)46 b(IVISIP)-8
b(A=IVISIP1)46 b(without)0 4239 y(bac)m(kscatter;)34
b(with)f(bac)m(kscatter)h(on)f(IVISIP)-8 b(A=IVISIP1+1.)146
4479 y(DIS,)24 b(DIST)f(and)h(DISQ)f(are)g(indexed)h(b)m(y)g(IDISIM2,)i
(IDISIM1,)g(IDISI0,)f(IDISIP1)f(and)f(IDISIP2)0 4600
y(corresp)s(onding)32 b(to)h(I-2,)f(I-1,)g(I,)h(I+1)f(and)h(I+2)f(resp)
s(ectiv)m(ely)-8 b(.)146 4841 y(The)40 b(prognostic)d(v)-5
b(ariables)37 b(are)h(dimensioned)g(o)m(v)m(er)h(all)d(v)m(ertical)i
(slices)g(\(I)s(IPEP\))h(and)g(so)f(the)0 4961 y(n)m(umerical)28
b(v)-5 b(alue)30 b(of)f(IM2)h(can)g(b)s(e)g(assigned)h(directly)e(to)g
(I-2,)h(and)g(so)g(forth.)42 b(This)31 b(is)e(p)s(erformed)g(in)0
5081 y(subroutine)k Fw(SETINDEX2)e Fv(called)g(at)h(the)h(b)s(eginning)
e(of)i(the)g(I-lo)s(op.)146 5322 y(F)-8 b(or)38 b(the)g(source)h
(terms,)h(VIS,)f(DIFF)e(and)h(DIS)g(a)g(di\013eren)m(t)g(pro)s(cedure)h
(is)f(used.)61 b(T)-8 b(o)38 b(restrict)0 5443 y(memory)28
b(usage)h(these)h(are)f(only)f(dimensioned)g(b)m(y)i(the)f(maxim)m(um)e
(n)m(um)m(b)s(er)i(of)f(v)m(ertical)g(slices)h(that)0
5563 y(need)36 b(to)e(b)s(e)h(held)g(at)f(an)m(y)i(one)f(time.)48
b(When)36 b(the)f(information)d(in)i(one)h(slice)f(is)g(no)h(longer)f
(needed)0 5683 y(it)k(is)h(o)m(v)m(erwritten)i(with)d(information)f
(from)h(the)i(new)g(slice.)63 b(This)40 b(is)e(ac)m(hiev)m(ed)j(b)m(y)f
(rotating)e(the)0 5804 y(indices)30 b(at)g(the)h(end)h(of)e(eac)m(h)h
(pass)h(of)e(the)h(I-lo)s(op.)41 b(F)-8 b(or)30 b(example,)g(the)h(new)
h(ISI0)f(will)d(b)s(e)j(set)g(to)f(the)1841 6107 y(15)p
eop
%%Page: 16 19
16 18 bop 0 52 a Fv(old)34 b(ISIM2,)j(the)e(new)h(ISIM1)g(to)e(the)i
(old)e(ISI0)h(and)h(the)f(new)h(ISIM2)g(to)f(the)g(old)f(ISIM1.)52
b(This)35 b(is)0 173 y(p)s(erformed)f(in)g Fw(REINDEX)p
Fv(.)e(The)k(indices)e(are)h(initialised)c(in)j(subroutine)h
Fw(SETINDEX)e Fv(called)0 293 y(b)s(efore)g(the)g(start)f(of)g(the)h
(I-lo)s(op.)146 534 y(It)e(is)f(clear)g(that)h(as)g(VIS,)g(DIFF)e(and)i
(DIS)f(are)h(calculated)f(for)g(I=-1)g(and)h(I=0)f(that)g(additional)0
654 y(slices)f(are)h(needed)h(to)f(the)g(I)s(IPEP)h(slices)e(in)m
(tegrated)h(on)f(the)h(slice.)42 b(These)32 b(extra)e(slices)f(are)h
(kno)m(wn)0 775 y(as)36 b(halo)s(es)f(and)h(their)f(v)-5
b(alues)36 b(are)g(assigned)g(in)f Fw(XWRAP)p Fv(.)f(F)-8
b(or)35 b(an)g(MPP)i(run)f(these)h(v)-5 b(alues)36 b(will)0
895 y(b)s(e)29 b(tak)m(en)g(from)f(other)g(PEs)i(using)f(message)g
(passing)f(routines;)i(for)e(a)g(single)g(PE)h(run)g(these)h(will)c(b)s
(e)0 1016 y(determined)36 b(b)m(y)h(applying)e(wrap)h(around)h(b)s
(oundary)f(conditions.)53 b(So,)38 b(the)e(prognostic)g(v)-5
b(ariables)0 1136 y(are)38 b(dimensioned)e(\(-1:I)s(IPEP+2\),)j(except)
h(in)c(the)j(presence)g(of)e(bac)m(kscatter)j(when)f(they)f(are)g(di-)0
1256 y(mensioned)31 b(\(-2:I)s(IPEP+3\),)h(or)f(in)g(2-D)f(when)i(the)g
(dimension)e(is)h(1.)43 b(These)33 b(are)e(calculated)f(in)h(the)0
1377 y(parameter)h(statemen)m(ts)i(for)e(IDIMMINP)i(and)e(IDIMMAXP)-8
b(.)0 1786 y Fp(4.2)135 b(Calculation)47 b(of)e(Viscosit)l(y)0
2091 y Fv(The)30 b(viscosit)m(y)f(and)g(di\013usion)e(co)s(e\016cien)m
(ts,)k(VIS)e(and)g(DIFF,)f(along)f(with)i(the)g(bac)m(kscatter)h
(energy)0 2211 y(drain,)36 b(DIS,)g(are)g(calculated)f(through)h(the)g
(subroutine)h Fw(CALCVIS)e Fv(called)g(from)g Fw(NNSTEPS)p
Fv(.)0 2332 y(Figure)c(6)g(sho)m(ws)j(a)e(sc)m(hematic)g(structure)h
(of)e(the)h(routine.)43 b Fw(CALCVIS)32 b Fv(just)g(calls)e(the)j(t)m
(w)m(o)f(other)0 2452 y(subroutines)h(whic)m(h)g(calculate)f(the)h
(viscosit)m(y)-8 b(,)33 b Fw(LO)m(WERBC)e Fv(and)i Fw(SMA)m(G)p
Fv(.)146 2693 y Fw(LO)m(WERBC)e Fv(calculates)g(the)h(near)g(surface)h
(v)-5 b(alues)31 b(of)g(VIS)i(and)e(DIFF)g(whic)m(h)h(will)e(result)h
(in)0 2813 y(the)37 b(correct)h(subgrid)e(transp)s(ort)h(for)f(the)i(c)
m(hoice)f(of)f(surface)i(b)s(oundary)f(condition.)55
b(The)38 b(surface)0 2934 y(b)s(oundary)33 b(condition)e(is)i(con)m
(trolled)e(b)m(y)j(the)f(parameter)f(ISCBCP)-8 b(.)34
b(If)f(ISCBCP=1)h(then)f(the)g(sur-)0 3054 y(face)f(heat)g(\015uxes)h
(themselv)m(es)h(are)d(prescrib)s(ed;)i(if)e(ISCBCP=2)i(then)f(the)h
(surface)f(temp)s(erature)g(is)0 3174 y(prescrib)s(ed.)60
b(Both)38 b(c)m(hoices)h(m)m(ust)f(obtain)f(a)h(v)-5
b(alue)37 b(for)g Fn(u)2215 3189 y Fi(\003)2292 3174
y Fv(\(square)i(ro)s(ot)e(of)h(the)g(surface)h(stress\),)0
3295 y(represen)m(ted)45 b(b)m(y)e(the)f(v)-5 b(ariable)40
b(USTR)j(in)e(the)i(mo)s(del,)g(whic)m(h)f(is)g(found)g(from)f
(Monin-Obukho)m(v)0 3415 y(similarit)m(y)31 b(theory)k(as)f(describ)s
(ed)i(in)d(Section)h(4.1)g(of)g(the)h(Scien)m(ti\014c)f(Do)s(cumen)m
(tation)f(\(Gra)m(y)h(et)h(al)0 3536 y(2001\).)63 b(There)41
b(are)e(di\013eren)m(t)h(Monin-Obukho)m(v)g(expressions)h(for)e(stable)
h(and)f(con)m(v)m(ectiv)m(e)j(cases.)0 3656 y(FBUO)m(Y)f(is)g(the)g
(surface)h(buo)m(y)m(ancy)h(\015ux)f(calculated)e(in)h
Fw(SET1D)p Fv(;)f(a)h(p)s(ositiv)m(e)g(v)-5 b(alue)40
b(implies)f(a)0 3776 y(con)m(v)m(ectiv)m(e)c(regime,)c(a)h(negativ)m(e)
h(v)-5 b(alue)32 b(a)h(stable)f(one.)146 4017 y(The)i(stable)f(and)h
(neutral)e(cases)j(for)d(the)i(prescrib)s(ed)g(surface)g(\015ux)g(are)f
(relativ)m(ely)f(straigh)m(tfor-)0 4138 y(w)m(ard)27
b(expressions)h(and)f(these)g(are)g(calculated)e(in-line)f(in)i
Fw(LO)m(WERBC)p Fv(.)f(Ho)m(w)m(ev)m(er,)30 b(for)c(the)h(stable)0
4258 y(case)h(ro)s(ots)f(do)g(not)g(exist)h(for)e(the)i(Monin-Obukho)m
(v)g(expression)g(if)e(FBUO)m(Y)h(is)g(less)h(than)f(a)g(critical)0
4378 y(heat)36 b(\015ux.)55 b(In)36 b(this)g(situation)e(VIS)j(and)f
(DIFF)f(are)h(set)h(equal)e(to)h(zero.)54 b(The)37 b(expression)h(for)d
(the)0 4499 y(con)m(v)m(ectiv)m(e)29 b(case)e(needs)i(to)d(b)s(e)h
(solv)m(ed)g(iterativ)m(ely)-8 b(,)27 b(but)f(to)h(a)m(v)m(oid)f(rep)s
(eating)g(an)h(exp)s(ensiv)m(e)h(calcula-)0 4619 y(tion)f(a)h(lo)s
(ok-up)e(table)i(is)f(used.)43 b(The)29 b(lo)s(ok-up)e(table)g(is)h
(set)h(up)f(through)g(subroutine)g Fw(SETLOOK)p Fv(,)0
4739 y(called)42 b(from)g Fw(SET1D)p Fv(,)i(and)f(ma)m(y)g(b)s(e)h(up)s
(dated)g(using)f(the)h(call)e(to)h(subroutine)g Fw(CHGLOOK)p
Fv(,)0 4860 y(called)29 b(from)h Fw(NNSTEPS)p Fv(,)f(if)g(time-v)-5
b(arying)28 b(heat)j(\015uxes)h(are)f(used.)44 b(The)31
b(v)-5 b(alues)31 b(for)f(USTR)h(for)f(a)0 4980 y(giv)m(en)24
b(near)h(surface)g(wind)f(sp)s(eed)i(\(VEL\))e(are)h(retriev)m(ed)g(b)m
(y)g(a)f(call)f(to)h Fw(LOOK)g Fv(from)f Fw(LO)m(WERBC)p
Fv(.)146 5221 y(When)46 b(the)e(surface)i(temp)s(erature)e(is)g
(prescrib)s(ed)h(b)s(oth)f(USTR)h(and)f Fn(\022)2923
5236 y Fe(v)r Fi(\003)3044 5221 y Fv(\(where)i Fm(\000)p
Fn(u)3509 5236 y Fi(\003)3548 5221 y Fn(\022)3593 5236
y Fe(v)r Fi(\003)3714 5221 y Fv(is)0 5341 y(the)37 b(up)m(w)m(ard)i
(virtual)c(p)s(oten)m(tial)g(temp)s(erature)i(\015ux\))h(need)g(to)e(b)
s(e)i(found,)g(and)f(this)g(is)f(p)s(erformed)0 5462
y(through)26 b(subroutine)g Fw(MOSTBC)g Fv(called)f(from)g
Fw(LO)m(WERBC)p Fv(.)f(The)j(imp)s(ortan)m(t)d(inputs)i(are)g(VEL)0
5582 y(and)e(DTHV)p 478 5582 30 4 v 36 w(SURF)g(-)f(the)i(di\013erence)
g(in)f Fn(\022)1590 5597 y Fe(v)1655 5582 y Fv(b)s(et)m(w)m(een)j(the)d
(\014rst)h(mo)s(del)e(lev)m(el)h(and)g(the)h(surface)g(v)-5
b(alue.)0 5702 y(As)28 b(b)s(efore,)h(the)f(stable)g(case)g(can)g(b)s
(e)g(calculated)f(directly)g(from)g(the)h(Monin-Obukho)m(v)g
(expression,)0 5823 y(whilst)33 b(the)i(con)m(v)m(ectiv)m(e)h(case)f(m)
m(ust)f(b)s(e)h(solv)m(ed)f(iterativ)m(ely)-8 b(.)47
b(In)34 b Fw(MOSTBC)h Fv(an)f(iteration)e(is)h(used)1841
6107 y(16)p eop
%%Page: 17 20
17 19 bop 353 481 a Fk(')p 353 691 4 46 v 353 859 a(&)1061
481 y($)p 1061 691 V 1061 859 a(\045)p 520 859 377 4
v 520 481 V 457 702 a Fw(CALCVIS)p 707 1141 4 284 v 351
1141 716 4 v 351 1495 4 355 v 1063 1495 V 351 1498 716
4 v 622 1246 a Fv(Call)418 1411 y Fw(LO)m(WERBC)p 707
1849 4 355 v 351 1849 716 4 v 351 2204 4 355 v 1063 2204
V 351 2207 716 4 v 622 1955 a Fv(Call)540 2120 y Fw(SMA)m(G)p
707 2487 4 284 v 353 2501 a Fk(')p 353 2687 4 23 v 353
2855 a(&)1061 2501 y($)p 1061 2687 V 1061 2855 a(\045)p
520 2855 377 4 v 520 2501 V 499 2616 a Fv(Return)33 b(to)445
2805 y Fw(NNSTEPS)p 1063 1331 237 4 v 1217 1329 a Fo(-)p
1296 1141 716 4 v 1296 1495 4 355 v 2008 1495 V 1296
1498 716 4 v 1325 1267 a Fq(Calculate)d(VIS)g(&)1334
1408 y(DIFF)i(at)f(surface)p 2008 1331 237 4 v 2244 1330
a Fo(\000)2327 1247 y(\000)2410 1164 y(\000)2445 1129
y(\000)2244 1413 y(@)2327 1496 y(@)2410 1579 y(@)2445
1613 y(@)2728 1330 y(@)2645 1247 y(@)2562 1164 y(@)2528
1129 y(@)2728 1413 y(\000)2645 1496 y(\000)2562 1579
y(\000)2528 1613 y(\000)2305 1364 y Fv(ISCBCP)k(?)p 2526
1046 4 142 v 2526 1731 4 119 v 2170 550 716 4 v 2170
904 4 355 v 2882 904 V 2170 907 716 4 v 2455 652 a Fq(Use)2204
747 y(Monin-Obukho)m(v)2265 833 y(lo)s(ok-up)29 b(table)p
2882 741 119 4 v 2997 550 716 4 v 2997 904 4 355 v 3709
904 V 2997 907 716 4 v 3268 679 a Fv(Call)3193 821 y
Fw(LOOK)p 2170 1731 V 2170 2086 4 355 v 2882 2086 V 2170
2089 716 4 v 2212 1825 a Fq(Iterativ)m(ely)h(solv)m(e)2204
1928 y(Monin-Obukho)m(v)2358 2023 y(relations)p 2882
1922 119 4 v 2997 1731 716 4 v 2997 2086 4 355 v 3709
2086 V 2997 2089 716 4 v 3268 1860 a Fv(Call)3109 2002
y Fw(MOSTBC)2598 1063 y Fj(ISCBCP=1:)e(\014xed)21 b(surface)g(\015uxes)
2598 1626 y(ISCBCP=2:)28 b(\014xed)21 b(surface)g(temp)r(erature)p
1063 2040 237 4 v 1216 2038 a Fo(-)p 1296 1849 716 4
v 1296 2204 4 355 v 2008 2204 V 1296 2207 716 4 v 1325
1952 a Fq(Calculate)30 b(VIS)g(&)1306 2061 y(DIFF)h(throughout)1429
2164 y(rest)g(of)f(slice)p 1652 2322 4 119 v 1296 2322
716 4 v 1296 2676 4 355 v 2008 2676 V 1296 2679 716 4
v 1362 2424 a(Calculate)g(half-)1371 2533 y(squared)g(strain)1439
2628 y(rate)h(\(SSQ\))p 1652 2794 4 119 v 1296 2794 716
4 v 1296 3149 4 355 v 2008 3149 V 1296 3152 716 4 v 1452
2897 a(Calculate)1432 3015 y(Ric)m(hardson)1493 3109
y(Num)m(b)s(er)p 1652 3267 4 119 v 2126 2985 237 4 v
2280 2983 a Fo(-)2480 2961 y Fv(Call)g Fw(MOISTRI\(2\))h
Fv(to)2480 3065 y(calculate)g(Ri)f(if)h(moist)p 1296
3267 716 4 v 1296 3621 4 355 v 2008 3621 V 1296 3624
716 4 v 1567 3372 a(Call)1449 3537 y Fw(SETFRI)p 1652
3739 4 119 v 2126 3457 237 4 v 2280 3455 a Fo(-)2480
3443 y Fv(Calculates)g(VIS)h(&)g(DIFF)2480 3537 y(from)f(Ric)m(hardson)
g(Num)m(b)s(er)p 1296 3739 716 4 v 1296 4093 4 355 v
2008 4093 V 1296 4096 716 4 v 1321 3833 a Fq(Calculate)e(energy)1513
3960 y(loss)f(for)1421 4054 y(Bac)m(kscatter)363 5124
y Fv(Figure)j(6:)43 b(Structures)34 b(of)e(subroutines)h(CALCVIS,)i(LO)
m(WERBC)e(and)g(SMA)m(G)1841 6107 y(17)p eop
%%Page: 18 21
18 20 bop 0 52 a Fv(rather)26 b(than)g(a)f(lo)s(ok-up)f(table.)41
b(Another)26 b(di\013erence)h(in)e(the)h(pro)s(cedure)g(in)f
Fw(MOSTBC)h Fv(is)g(that)f(the)0 173 y(indices)37 b(for)f(the)i
(stable,)g(neutral)f(and)g(con)m(v)m(ectiv)m(e)i(p)s(oin)m(ts)e(are)g
(determined)g(at)g(the)g(b)s(eginning)f(of)0 293 y(the)c(routine)g(and)
g(then)g(all)e(the)i(p)s(oin)m(ts)g(for)f(the)h(di\013eren)m(t)h(cases)
g(are)f(treated)g(together)g(b)m(y)h(lo)s(oping)0 414
y(o)m(v)m(er)27 b(the)f(indices)g(stored)g(in)f(JINDST)-8
b(AB,)26 b(JINDNEUT)h(and)f(JINDUNST)h(for)e(the)h(stable,)h(neutral)0
534 y(and)33 b(con)m(v)m(ectiv)m(e)h(p)s(oin)m(ts,)f(resp)s(ectiv)m
(ely)-8 b(.)146 775 y(The)26 b(VIS)f(and)f(DIFF)f(v)-5
b(alues)25 b(for)f(the)g(rest)h(of)f(the)h(mo)s(del)e(domain)g(are)h
(calculated)g(in)f(subroutine)0 895 y Fw(SMA)m(G)28 b
Fv(called)e(from)g Fw(CALCVIS)p Fv(.)h(As)h(describ)s(ed)h(in)e
(Section)g(3.1)g(of)g(the)h(Scien)m(ti\014c)g(Do)s(cumen)m(ta-)0
1016 y(tion)j(\(Gra)m(y)g(et)h(al)e(2001\),)h(VIS)h(and)g(DIFF)f(are)g
(determined)h(b)m(y)h(the)f(pro)s(duct)f(of)h(the)g(half-squared)0
1136 y(strain)40 b(rate)g(\(SSQ\))g(with)g(a)g(function)g(of)g(the)g
(Ric)m(hardson)h(Num)m(b)s(er)f(\(RI\).)g(As)h(sho)m(wn)g(in)f(Fig.)f
(6)0 1256 y(the)34 b(\014rst)g(step)h(of)e Fw(SMA)m(G)h
Fv(is)f(to)g(calculate)g(SSQ.)h(This)g(requires)g(v)-5
b(alues)34 b(for)f(U,)h(V)f(and)h(W)g(whic)m(h)0 1377
y(are)i(passed)i(through)f(from)e Fw(NNSTEPS)g Fv(via)h(the)h
Fw(CALCVIS)f Fv(call.)53 b(As)37 b(viscosit)m(y)g(acts)g(on)f(the)0
1497 y Fn(t)13 b Fm(\000)g Fv(1)28 b(time)f(lev)m(el)h(for)f(a)h(cen)m
(tred)i(step)f(there)f(are)g(separate)h(calls,)f(with)g(di\013eren)m(t)
g(argumen)m(t)g(lists,)g(to)0 1617 y Fw(CALCVIS)e Fv(in)f
Fw(NNSTEPS)g Fv(dep)s(ending)h(on)g(whether)h(a)f(forw)m(ard)g(or)g
(cen)m(tred)i(step)f(in)m(tegration)d(is)0 1738 y(required.)43
b(The)31 b(next)f(stage)g(in)f Fw(SMA)m(G)h Fv(is)f(to)h(calculate)e
(RI.)i(F)-8 b(or)29 b(the)h(dry)g(case)h(this)e(is)h(simply)e(the)0
1858 y(v)m(ertical)e(buo)m(y)m(ancy)j(gradien)m(t)e(divided)f(b)m(y)i
(the)f(squared)i(strain)d(rate)h(\(SSQ\))g(and)g(this)g(is)f(p)s
(erformed)0 1979 y(in-line.)40 b(Determining)27 b(RI)i(in)g(the)h
(presence)i(of)d(moisture)f(is)h(somewhat)h(more)f(complicated)e(as)j
(the)0 2099 y(impact)j(of)g(phase)i(c)m(hanges)h(need)f(to)e(b)s(e)i
(considered.)49 b(This)34 b(is)f(calculated)g(using)h(the)h
(subroutines)0 2219 y Fw(MOISTRI)f Fv(or)h Fw(MOISTRI2)f
Fv(whic)m(h)h(o\013er)g(alterativ)m(e)e(calculations)g(for)h(the)h
(moist)e(Ric)m(hardson)0 2340 y(Num)m(b)s(er.)63 b Fw(MOISTRI)39
b Fv(calculates)f(RI)h(based)h(on)f(conserv)-5 b(ation)39
b(of)f(liquid)f(w)m(ater)j(static)e(energy)0 2460 y(up)s(on)27
b(lifting)c(a)j(parcel)g(\(IMOISTRIP=1\))i(whilst)e Fw(MOISTRI2)g
Fv(considers)h(the)g(p)s(ossibilit)m(y)e(of)h(dry)0 2580
y(air)31 b(mixing)g(in)m(to)h(the)h(parcel)f(\(IMOISTRIP=2\).)146
2821 y(Once)40 b(RI)f(is)f(calculated)g(then)i(the)f(Ric)m(hardson)g
(Num)m(b)s(er)g(dep)s(enden)m(t)i(functions)e(can)g(b)s(e)g(de-)0
2942 y(termined.)80 b(These)47 b(functions)e(are)g(fairly)e(simple,)j
(as)g(sho)m(wn)g(in)e(Section)h(3.3)g(of)f(the)h(Scien)m(ti\014c)0
3062 y(Do)s(cumen)m(tation)26 b(\(Gra)m(y)i(et)g(al)f(2001\),)h(and)g
(are)g(assigned)g(to)g(VIS)g(and)g(DIFF)f(in)g(subroutine)h
Fw(SET-)0 3182 y(FRI)35 b Fv(called)f(from)g Fw(SMA)m(G)p
Fv(.)h(The)h(calculation)d(of)i(VIS)g(and)g(DIFF)g(is)f(completed)h(in)
f Fw(SMA)m(G)i Fv(b)m(y)0 3303 y(m)m(ultiplying)27 b(VIS)j(and)g(DIFF)f
(b)m(y)h(the)h(strain)e(rate)h(\(square)h(ro)s(ot)e(of)g(SSQ\))h(and)g
(the)g(mixing)e(length)0 3423 y(squared)34 b(\(ELAMR)p
766 3423 30 4 v 36 w(SQ,)e(assigned)h(in)f Fw(SET1D)p
Fv(\).)146 3664 y(The)37 b(\014nal)d(section)h(of)g Fw(SMA)m(G)g
Fv(calculates)g(the)h(viscous)g(drain)e(for)h(the)h(bac)m(kscatter)h
(routines)0 3784 y(\(DIS\))32 b(from)e(VIS)j(and)f(DIFF,)f(and)h(using)
g(TH)g(and)g(Q)g(for)f(the)i(scalar)e(drains)h(\(DIST)g(and)g(DISQ\).)
146 4025 y(F)-8 b(or)21 b(the)h(2-D)f(and)h(1-D)e(cases)j(a)f
(simpli\014ed)d(v)m(ersion)k(of)e Fw(SMA)m(G)h Fv(is)f(used,)k
(subroutines)e Fw(SMA)m(G2D)0 4145 y Fv(and)33 b Fw(SMA)m(G1D)f
Fv(resp)s(ectiv)m(ely)-8 b(.)0 4555 y Fp(4.3)135 b(Dynamics)0
4860 y Fv(All)26 b(con)m(tributions)i(to)f(the)i(source)g(terms,)g(bar)
e(the)i(pressure)h(gradien)m(t)d(term)h(and)g(bac)m(kscatter,)i(are)0
4980 y(calculated)c(in)f(subroutines)j(called)d(from)g
Fw(D)m(YNVIS)p Fv(,)g(the)i(structure)h(of)e(whic)m(h)h(is)f(sho)m(wn)i
(in)e(Fig.)f(7.)0 5101 y(This)36 b(section)g(considers)h(the)f(dynamic)
f(con)m(tributions,)h(namely)f(adv)m(ection,)i(viscosit)m
(y/di\013usion,)0 5221 y(buo)m(y)m(ancy)-8 b(,)43 b(Coriolis,)38
b(baro)s(clinicit)m(y)e(and)k(damping.)61 b(These)41
b(are)e(all)e(calculated)h(in)g(the)i(routines)0 5341
y Fw(UVWSR)m(CE)p Fv(,)45 b Fw(THSOUR)m(CE)g Fv(and)h
Fw(QSOUR)m(CE)f Fv(for)g(v)-5 b(ariables)45 b(U,V)h(and)g(W,)g(TH)h
(and)f(Q)0 5462 y(resp)s(ectiv)m(ely)-8 b(.)56 b(Dep)s(ending)37
b(on)f(whether)i(forw)m(ard)f(or)f(cen)m(tred)i(stepping)f(is)f(used,)j
(di\013eren)m(t)d(time-)0 5582 y(lev)m(els)23 b(need)i(to)e(b)s(e)g
(passed)i(to)e(these)i(routines)e(through)g(the)h(argumen)m(ts)g(list,)
f(so)h(sev)m(eral)g(conditional)0 5702 y(calls)31 b(for)h(eac)m(h)i
(routine)e(are)g(made)h(from)e Fw(D)m(YNVIS)p Fv(.)1841
6107 y(18)p eop
%%Page: 19 22
19 21 bop 943 241 a Fk(')p 943 452 4 46 v 943 619 a(&)1652
241 y($)p 1652 452 V 1652 619 a(\045)p 1111 619 377 4
v 1111 241 V 1077 463 a Fw(D)m(YNVIS)p 1298 854 4 237
v 942 854 716 4 v 942 1208 4 355 v 1654 1208 V 942 1211
716 4 v 1212 959 a Fv(Call)1007 1124 y Fw(UVWSR)m(CE)p
1298 1445 4 237 v 1654 1045 237 4 v 1808 1043 a Fo(-)p
942 1445 716 4 v 942 1799 4 355 v 1654 1799 V 942 1802
716 4 v 1212 1550 a Fv(Call)983 1715 y Fw(THSOUR)m(CE)p
1298 2035 4 237 v 1654 1635 237 4 v 1808 1633 a Fo(-)p
942 2035 716 4 v 942 2389 4 355 v 1654 2389 V 942 2392
716 4 v 1212 2141 a Fv(Call)968 2305 y Fw(RADIA)-9 b(TION)p
1298 2626 4 237 v 709 2202 237 4 v 709 2200 a Fo(\033)p
-3 2035 716 4 v -3 2389 4 355 v 709 2389 V -3 2392 716
4 v 268 2141 a Fv(Call)83 2305 y Fw(RAD)p 345 2305 34
4 v 40 w(LEM)p 353 2626 4 237 v 354 2626 a Fo(?)p -3
2626 716 4 v -3 2980 4 355 v 709 2980 V -3 2983 716 4
v 69 2719 a Fq(Set)30 b(up)f(pro\014les)124 2893 y(for)h(ES)g(co)s(de)p
353 3216 4 237 v -3 3216 716 4 v -3 3570 4 355 v 709
3570 V -3 3573 716 4 v 97 3319 a(Call)f(ES)h(co)s(de)185
3437 y(in)m(terface)195 3554 y(routines)p 353 3807 4
237 v -3 3807 716 4 v -3 4161 4 355 v 709 4161 V -3 4164
716 4 v 89 3909 a(Calculate)g(the)47 4027 y(radiation)f(\015uxes)61
4145 y(and)h(tendencies)p 942 2626 V 942 2980 4 355 v
1654 2980 V 942 2983 716 4 v 1212 2731 a Fv(Call)1023
2886 y Fw(QSOUR)m(CE)p 1298 3216 4 237 v 1654 2793 237
4 v 1808 2791 a Fo(-)p 1886 972 716 4 v 1886 3098 4 2126
v 2598 3098 V 1886 3101 716 4 v 1913 1042 a Fq(Calculate)g(U,V,W)1913
1137 y(TH)h(&)f(Q)g(source)1913 1236 y(terms)1913 1358
y(1.)41 b(Adv)m(ection)1913 1490 y(2.)g(Viscosit)m(y)-8
b(,)2035 1594 y(di\013usion)1913 1736 y(3.)41 b(Coriolis)1913
1822 y(\(UVWSR)m(CE\))1913 1963 y(4.)g(Buo)m(y)m(ancy)1913
2058 y(\(UVWSR)m(CE\))1913 2200 y(5.)g(Baro)s(clinicit)m(y)1913
2294 y(\(THSOUR)m(CE\))1913 2435 y(6.)g(Damping)1913
2577 y(7.)g(Large-scale)2035 2672 y(forcing)1913 2813
y(8.)g(P)m(ositivit)m(y)2035 2917 y(c)m(hec)m(k)1913
3003 y(\(QSOUR)m(CE\))p 2598 1328 237 4 v 2831 1161 716
4 v 2831 1515 4 355 v 3543 1515 V 2831 1518 716 4 v 3102
1267 a Fv(Call)2921 1361 y Fw(TVDUVW)2917 1455 y(TVDSCAL)p
3187 1752 4 237 v 3189 1752 a Fo(?)p 2831 1752 716 4
v 2831 2106 4 355 v 3543 2106 V 2831 2109 716 4 v 3102
1857 a Fv(Call)2967 2022 y Fw(UL)-9 b(TFLX)2864 1003
y Fq(F)h(or)31 b(UL)-8 b(TIMA)g(TE)2844 1098 y(adv)m(ection)31
b(sc)m(heme)p 942 3216 V 942 3570 4 355 v 1654 3570 V
942 3573 716 4 v 1212 3322 a Fv(Call)1032 3487 y Fw(LA)-9
b(THEA)g(T)p 1298 3807 4 237 v 1772 3407 237 4 v 1926
3405 a Fo(-)2126 3383 y Fv(Calculate)32 b(the)h(condensation)f(of)g
(liquid)2126 3477 y(w)m(ater)h(and)g(asso)s(ciated)f(heating)p
942 3807 716 4 v 942 4161 4 355 v 1654 4161 V 942 4164
716 4 v 1212 3912 a(Call)947 4077 y Fw(MICR)m(OPHYS)p
1298 4397 4 237 v 1654 3997 355 4 v 1926 3995 a Fo(-)2008
3996 y(\000)2091 3913 y(\000)2174 3830 y(\000)2208 3795
y(\000)2008 4079 y(@)2091 4162 y(@)2174 4245 y(@)2208
4279 y(@)2492 3996 y(@)2409 3913 y(@)2326 3830 y(@)2291
3795 y(@)2492 4079 y(\000)2409 4162 y(\000)2326 4245
y(\000)2291 4279 y(\000)2075 4030 y Fv(IRAINP)h(?)p 2290
4397 4 119 v 1934 4397 716 4 v 1934 4752 4 355 v 2646
4752 V 1934 4755 716 4 v 2205 4503 a(Call)2054 4668 y
Fw(MICR)m(O)m(X)p 2764 4588 237 4 v 2918 4586 a Fo(-)3118
4517 y Fv(Calculate)f(three-phase)3118 4611 y(microph)m(ysics)h(con)m
(v)m(ersion)3118 4711 y(rates)2362 4343 y Fj(IRAINP=10)p
2575 3997 378 4 v 2598 3940 a(IRAINP)p Fd(<)p Fj(10)p
2949 3807 716 4 v 2949 4161 4 355 v 3661 4161 V 2949
4164 716 4 v 2995 3933 a Fq(Calculate)d(w)m(arm)3007
4026 y(rain)f(con)m(v)m(ersion)3229 4118 y(rate)943 4399
y Fk(')p 943 4609 4 46 v 943 4777 a(&)1652 4399 y($)p
1652 4609 V 1652 4777 a(\045)p 1111 4777 377 4 v 1111
4399 V 1090 4549 a Fv(Return)k(to)1035 4691 y Fw(NNSTEPS)0
5191 y Fv(Figure)45 b(7:)69 b(Structures)47 b(of)e(subroutines)i(D)m
(YNVIS,)f(UVWSR)m(CE,)h(THSOUR)m(CE,)g(QSOUR)m(CE,)0
5312 y(RADIA)-8 b(TION)33 b(and)f(MICR)m(OPHYS)1841 6107
y(19)p eop
%%Page: 20 23
20 22 bop 146 52 a Fv(The)26 b(structures)h(of)d Fw(UVWSR)m(CE)p
Fv(,)g Fw(THSOUR)m(CE)g Fv(and)h Fw(QSOUR)m(CE)g Fv(are)g(straigh)m
(tforw)m(ard.)0 173 y(In)k Fw(UVWSR)m(CE)f Fv(the)h(adv)m(ection)h
(incremen)m(ts)f(are)g(calculated)f(and)h(assigned)h(to)e(the)i(SU,)f
(SV)g(and)0 293 y(SW)j(source)g(terms,)f(whic)m(h)h(are)f(then)h
(incremen)m(ted)f(with)g(the)h(viscosit)m(y)f(source)i(terms.)42
b(The)33 b(com-)0 414 y(p)s(onen)m(ts)38 b(of)f(the)h(the)g(subgrid)f
(stress)i(tensor)f(\()p Fn(\034)1832 429 y Fe(ij)1893
414 y Fv(\))f(are)g(calculated)g(separately)g(\(T)-8
b(A)m(U11,)39 b(T)-8 b(A)m(U12)0 534 y(etc\))38 b(and)g(their)g
(gradien)m(t)f(determined)h(to)f(giv)m(e)h(the)g(\014nal)f(source)i
(term.)59 b(Next,)40 b(SU)e(and)g(SV)g(are)0 654 y(incremen)m(ted)j
(with)f(the)h(Coriolis)d(term,)j(and)g(SW)g(is)f(incremen)m(ted)g(b)m
(y)i(the)e(buo)m(y)m(ancy)-8 b(.)69 b(Finally)-8 b(,)0
775 y(the)28 b(damping)e(la)m(y)m(er)i(terms)f(are)h(calculated,)f
(large-scale)f(adv)m(ectiv)m(e)j(terms)f(added)g(and)g(the)g(surface)0
895 y(b)s(oundary)36 b(conditions)f(satis\014ed.)54 b(In)37
b Fw(THSOUR)m(CE)e Fv(adv)m(ection)h(is)f(again)g(calculated)g
(\014rst,)i(but)0 1016 y(this)k(also)g(includes)g(the)h(v)m(ertical)f
(adv)m(ection)h(of)f(the)h(basic)g(state)g(\(as)f(TH)h(is)f(p)s(oten)m
(tial)f(temp)s(er-)0 1136 y(ature)e(p)s(erturbation\))g(and)g(the)h
(adv)m(ection)g(of)e(an)m(y)i(mean)f(baro)s(clinicit)m(y)-8
b(.)58 b(The)39 b(di\013usion)e(term)h(is)0 1256 y(calculated)31
b(next,)h(with,)g(again,)e(a)i(separate)g(term)f(for)g(the)h
(di\013usion)f(of)g(the)h(reference)h(state,)f(and,)0
1377 y(\014nally)-8 b(,)29 b(damping)f(and)h(large-scale)f(forcing.)42
b(The)30 b(same)g(pro)s(cedure)g(is)f(follo)m(w)m(ed)g(for)g
Fw(QSOUR)m(CE)0 1497 y Fv(except)h(that)e(there)h(are)f(no)g(basic)h
(states)g(or)f(baro)s(clinicit)m(y)d(to)j(adv)m(ect)i(and)e(the)h
(calculation)d(of)i(eac)m(h)0 1617 y(term)40 b(is)g(lo)s(op)s(ed)f(o)m
(v)m(er)i(NQP)-8 b(.)41 b(F)-8 b(or)39 b(eac)m(h)i(subroutine)g(the)g
(discretizations)e(are)h(in-line)e(and)i(fairly)0 1738
y(ob)m(vious.)k(The)33 b(exception)f(is)g(when)h(UL)-8
b(TIMA)g(TE)34 b(adv)m(ection)e(is)g(selected)h(whic)m(h)f(requires)h
(calls)e(to)0 1858 y(separate)i(subroutines)h(to)e(calculate)f(the)i
(adv)m(ectiv)m(e)h(tendency)-8 b(.)146 2099 y(The)30
b(UL)-8 b(TIMA)g(TE)31 b(adv)m(ection)e(is)g(calculated)f(in)g(the)h
(calls)f(to)h Fw(TVDSCAL)f Fv(and)h Fw(TVDUVW)0 2219
y Fv(for)22 b(scalars)h(and)g(v)m(elo)s(cities)f(resp)s(ectiv)m(ely)-8
b(.)41 b(The)24 b(o)m(v)m(erall)e(pro)s(cedure)i(for)e(the)h(UL)-8
b(TIMA)g(TE)25 b(adv)m(ection)0 2340 y(is)47 b(to)g(calculate)f(face)i
(v)-5 b(alues)47 b(of)g(the)h(adv)m(ected)h(quan)m(tit)m(y)-8
b(,)52 b(limit)43 b(these)49 b(face)f(v)-5 b(alues)47
b(to)g(ensure)0 2460 y(p)s(ositivit)m(y)22 b(preserv)-5
b(ation)24 b(and)g(then)g(to)g(di\013eren)m(tiate)f(these)i(face)f(v)-5
b(alues)24 b(to)f(calculate)g(the)h(adv)m(ectiv)m(e)0
2580 y(tendency)k(term.)40 b(F)-8 b(or)25 b(b)s(oth)g(scalars)h(and)g
(v)m(elo)s(cities)e(these)j(face)f(v)-5 b(alues)25 b(are)h(calculated)f
(and)g(limited)0 2701 y(in)k(the)i(routine)f Fw(UL)-9
b(TFLX)30 b Fv(and)g(are)h(returned)g(as)f(FFLXL)g(\()p
Fn(y)t Fv(-direction\),)e(FFLXB)h(\()p Fn(z)t Fv(-direction\))0
2821 y(and)36 b(FLXI)f(\()p Fn(x)p Fv(-direction\).)52
b(These)38 b(are)e(then)g(di\013eren)m(tiated)f(in)g
Fw(TVDSCAL)h Fv(and)f Fw(TVDUVW)0 2942 y Fv(to)30 b(calculate)f(the)i
(source)g(terms.)43 b(Ho)m(w)m(ev)m(er,)33 b(there)e(is)f(further)h
(complication)c(in)i Fw(TVDUVW)h Fv(due)0 3062 y(to)i(the)h(staggering)
e(of)h(the)h(mo)s(del)d(grid.)43 b Fw(UL)-9 b(TFLX)32
b Fv(assumes)i(that)e(the)g(adv)m(ecting)h(v)m(elo)s(cities)e(are)0
3182 y(on)c(the)h(half)f(p)s(oin)m(ts)g(b)s(et)m(w)m(een)i(the)f(p)s
(oin)m(ts)g(holding)d(the)j(adv)m(ected)i(\014eld.)41
b(Therefore,)30 b(the)e(adv)m(ecting)0 3303 y(v)m(elo)s(cities)i(ha)m
(v)m(e)i(to)e(b)s(e)h(in)m(terp)s(olated)e(on)m(to)h(the)h(half)f(p)s
(oin)m(ts)g(b)s(et)m(w)m(een)j(the)e(v)m(elo)s(cit)m(y)f(p)s(oin)m(ts.)
43 b(These)0 3423 y(adv)m(ecting)33 b(v)m(elo)s(cities)f(are)g(termed)h
(UE,)g(VE)g(and)f(WE)i(in)d Fw(TVDUVW)p Fv(.)146 3664
y(A)m(t)40 b(the)h(end)f(of)f Fw(QSOUR)m(CE)h Fv(there)g(is)f(a)h(p)s
(ositivit)m(y)e(c)m(hec)m(k)k(on)e(the)g(mixing)d(ratio)i(Q)g
(\014elds.)0 3784 y(The)f(UL)-8 b(TIMA)g(TE)38 b(adv)m(ection)g(is)e
(only)g(p)s(ositivit)m(y-preserving)g(do)m(wn)i(to)e(the)h(lev)m(el)g
(of)f(div)m(ergence)0 3905 y(error)j(in)f(the)h(mo)s(del)f(and)h(as)g
(w)m(ater)h(mixing)c(ratios)i(can)i(b)s(e)f(v)m(ery)h(small,)e(it)g(is)
h(p)s(ossible)f(for)h(tin)m(y)0 4025 y(negativ)m(e)d(mixing)e(ratios)h
(to)h(result)g(from)f(the)h(adv)m(ection)h(calls.)53
b(This)36 b(is)g(a)m(v)m(oided)g(b)m(y)h(c)m(hec)m(king)h(if)0
4145 y(the)33 b(source)h(term)e(will)e(result)i(in)g(negativ)m(e)h
(mixing)d(ratios)i(and)h(scaling)e(do)m(wn)i(as)g(appropriate.)146
4386 y(F)-8 b(or)41 b(the)g(2-D)f(and)h(1-D)f(cases)i(simpli\014ed)d(v)
m(ersions)j(of)e Fw(UVWSR)m(CE)p Fv(,)g Fw(THSOUR)m(CE)g
Fv(and)0 4507 y Fw(QSOUR)m(CE)k Fv(are)h(used.)81 b(These)47
b(are)d Fw(UVW2D)p Fv(,)g Fw(TH2D)h Fv(and)f Fw(Q2D)h
Fv(for)f(the)h(2-D)f(case)h(and)0 4627 y Fw(UVW1D)p Fv(,)28
b Fw(TH1D)h Fv(and)g Fw(Q1D)g Fv(for)f(the)h(1-D)f(case.)43
b(2-D)28 b(v)m(ersions)i(of)e(the)h(UL)-8 b(TIMA)g(TE)31
b(adv)m(ection)0 4747 y(exits)i(in)f Fw(TVDSC2D)p Fv(,)g
Fw(TVDUVW2D)f Fv(and)i Fw(UL)-9 b(TF2D)p Fv(.)0 5157
y Fp(4.4)135 b(Radiation)0 5462 y Fv(Subroutine)33 b
Fw(RADIA)-9 b(TION)30 b Fv(is)j(called)e(from)h Fw(D)m(YNVIS)f
Fv(and)i(con)m(trols)g(the)g(call)e(for)h(the)h(LEM's)0
5582 y(radiation)h(co)s(de.)53 b(The)37 b(radiation)c(is)j(not)f
(necessarily)i(called)e(ev)m(ery)i(timestep)f(and)g(can)g(b)s(e)g
(called)0 5702 y(at)j(a)h(constan)m(t)g(time)e(in)m(terv)-5
b(al.)63 b Fw(RADIA)-9 b(TION)38 b Fv(determines)h(whether)i(that)f
(criteria)e(has)i(b)s(een)0 5823 y(met)f(and,)j(if)c(so,)k(the)e
(subroutine)g Fw(RAD)p 1607 5823 34 4 v 39 w(LEM)g Fv(is)f(called,)h
(whic)m(h)h(will)c(calculate)h(a)i(new)g(radia-)1841
6107 y(20)p eop
%%Page: 21 24
21 23 bop 0 52 a Fv(tiv)m(e)41 b(tendency)-8 b(,)45 b(STHRAD.)d(STHRAD)
f(is)g(stored)g(from)f(timestep)h(to)g(timestep)f(so,)k(if)c(it)g(is)h
(not)0 173 y(recalculated,)32 b(STH)h(can)g(b)s(e)g(incremen)m(ted)g
(with)f(the)h(most)f(recen)m(t)i(v)-5 b(alue.)146 414
y(The)38 b(purp)s(ose)f(of)g Fw(RAD)p 1099 414 34 4 v
39 w(LEM)g Fv(is)f(to)h(construct)g(appropriate)f(pro\014les)h(for)f
(passing)h(through)0 534 y(to)28 b(the)h(radiation)d(sc)m(heme)j(and)f
(then)h(to)f(pass)h(the)g(outputs)g(in)m(to)e(the)i(radiation)d
(diagnostic)h(arra)m(ys.)0 654 y(The)34 b(routine)f(has)g(b)s(een)h
(written)f(sp)s(eci\014cally)f(with)h(the)h(in)m(ten)m(tion)e(of)h
(using)g(the)g(Edw)m(ards-Slingo)0 775 y(\(E-S\))k(radiation)e(sc)m
(heme)k(in)e(the)h(LEM,)g(although)e(only)h(small)e(alterations)h
(should)h(b)s(e)h(required)0 895 y(to)f(in)m(terface)g(with)f(an)m(y)i
(other)f(radiation)e(sc)m(heme.)58 b(E-S)37 b(sp)s(eci\014c)h(calls)d
(and)j(common)d(blo)s(c)m(ks)i(are)0 1016 y(protected)27
b(b)m(y)g(*IF)f(DEF)g(up)s(date)g(directiv)m(es)h(so,)g(unless)g(the)g
(*DEF)e(ESRAD)h(directiv)m(e)h(is)e(selected,)0 1136
y(they)g(will)c(b)s(e)k(remo)m(v)m(ed)f(from)f(the)h(co)s(de)h(at)e
(the)i(pre-compiler)d(stage.)40 b(This)24 b(is)g(to)f(prev)m(en)m(t)j
(additional)0 1256 y(compilation)j(time)i(as)i(the)g(E-S)g(co)s(de)g
(is)f(rather)g(extensiv)m(e.)146 1497 y(Firstly)-8 b(,)38
b(lo)s(cal)d(v)-5 b(ariables)37 b(are)h(set)g(up)g(for)f(the)i(temp)s
(erature)e(pro\014le)h(and)f(eac)m(h)i(w)m(ater)g(sp)s(ecies)0
1617 y(used)g(in)d(the)i(radiation)d(sc)m(heme.)59 b(W)-8
b(ater)38 b(mixing)d(ratios)h(are)i(con)m(v)m(erted)h(to)e(sp)s
(eci\014c)h(h)m(umidities,)0 1738 y(whic)m(h)j(is)f(the)g(required)h
(input)f(for)g(the)h(E-S)f(sc)m(heme.)68 b(The)41 b(mo)s(del)e
(pro\014les)h(are)h(then)f(extended)0 1858 y(with)f(a)g(McClattc)m(hey)
i(dataset)f(to)f(include)f(stratospheric)i(v)-5 b(alues,)41
b(and)e(a)h(climatological)33 b(ozone)0 1979 y(pro\014le.)40
b(This)22 b(is)h(carried)f(out)g(b)m(y)i(the)f(call)e(to)h
Fw(MER)m(GE)p 2104 1979 V 39 w(D)m(A)-9 b(T)g(A)p Fv(.)21
b(The)j(default)e Fw(MER)m(GE)p 3436 1979 V 39 w(D)m(A)-9
b(T)g(A)0 2099 y Fv(con)m(tains)46 b(a)h(tropical)d(pro\014le,)50
b(but)c(this)h(can)f(b)s(e)h(replaced)g(for)f(an)m(y)h(other)f(region)g
(if)f(necessary)0 2219 y(\(e.g.)87 b(sub-tropics\).)g(Next,)51
b(the)c(surface)h(temp)s(erature)f(is)g(determined.)86
b(F)-8 b(or)46 b(the)i(prescrib)s(ed)0 2340 y(surface)42
b(temp)s(erature)f(b)s(oundary)h(condition)e(\(ISCBCP=2\))i(this)f(is)g
(trivial.)67 b(Ho)m(w)m(ev)m(er,)46 b(surface)0 2460
y(temp)s(erature)25 b(is)f(a)h(diagnostic)e(when)j(heat)g(\015uxes)g
(are)f(prescrib)s(ed)h(and)f(is)f(not)h(necessarily)g(realistic.)0
2580 y(Therefore,)33 b(the)e(surface)i(temp)s(erature)e(is)g(tak)m(en)h
(to)f(b)s(e)g(the)h(lo)m(w)m(est)g(mo)s(del)d(air)i(temp)s(erature.)43
b(The)0 2701 y(\014nal)28 b(calculations)g(are)h(for)g(the)h(solar)e
(zenith)h(angle,)g(dep)s(enden)m(t)i(on)f(the)f(time,)g(date)g(and)h
(latitude,)0 2821 y(and)49 b(the)g(alb)s(edo,)i(if)d(the)h(option)e
(for)i(using)f(a)g(sea)h(alb)s(edo)f(v)-5 b(arying)48
b(with)g(solar)g(zenith)g(angle)0 2942 y(\(V)-11 b(AR)p
251 2942 30 4 v 35 w(ALB=.TR)m(UE.\))34 b(is)e(selected.)146
3182 y(The)j(E-S)f(co)s(de)g(is)f(called)f(through)i(the)g(routines)g
Fw(RAD)p 2314 3182 34 4 v 39 w(INTERF)-12 b(A)m(CE)p
3014 3182 V 38 w(SW)34 b Fv(and)g Fw(RAD)p 3710 3182
V 39 w(-)0 3303 y(INTERF)-12 b(A)m(CE)p 668 3303 V 38
w(L)g(W)p Fv(.)36 b(The)i(E-S)f(co)s(de)h(also)e(requires)h(some)g(sp)s
(ectral)g(data.)56 b(The)38 b(names)f(of)f(the)0 3423
y(sp)s(ectral)25 b(\014les)h(are)f(de\014ned)i(in)e(v)-5
b(ariables)24 b(SPECFSW)j(and)f(SPECFL)-11 b(W,)26 b(read)g(in)f
(through)g(namelist)0 3544 y(RADCNTL.)46 b(These)g(are)g(read)f(in)f(b)
m(y)i(routines)f Fw(RAD)p 2189 3544 V 40 w(SW)p 2407
3544 V 40 w(SPEC)f Fv(and)i Fw(RAD)p 3243 3544 V 39 w(L)-12
b(W)p 3453 3544 V 40 w(SPEC)0 3664 y Fv(whic)m(h)37 b(are)f(only)g
(called)f(b)m(y)j(the)e(\014rst)h(run)g(of)f Fw(RAD)p
2023 3664 V 39 w(LEM)h Fv(in)e(a)i(job)f(\(from)f Fw(SET1D)h
Fv(and)g(iden-)0 3784 y(ti\014ed)42 b(b)m(y)h(the)f(argumen)m(t)g
(ISETUP)h(b)s(eing)f(assigned)g(to)g(1.)71 b(No)42 b(heating)f(terms)h
(are)g(calculated)0 3905 y(on)34 b(this)f(pass\).)48
b(The)34 b(in)m(terface)g(routines)g(e\013ectiv)m(ely)g(assign)f(all)f
(the)i(LEM)g(data)g(in)m(to)f(the)h(correct)0 4025 y(form)39
b(for)h(the)h(appropriate)e(argumen)m(t)h(lists)g(and)g(common)f(blo)s
(c)m(ks)i(and)g(call)d(the)j(E-S)f(routines.)0 4145 y(Do)s(cumen)m
(tation)31 b(of)h(the)h(E-S)g(radiation)d(sc)m(heme)k(can)f(b)s(e)f
(found)h(in)f(Ingram)g(et)g(al)g(\(1997\).)0 4555 y Fp(4.5)135
b(Microph)l(ysics)0 4860 y Fv(Diabatic)23 b(source)k(terms)e(due)h(to)f
(phase)h(c)m(hanges)h(of)e(w)m(ater)h(are)g(computed)f(in)g
(subroutines)h Fw(LA)-9 b(TH-)0 4980 y(EA)g(T)29 b Fv(and)h
Fw(MICR)m(OPHYS)p Fv(,)g(b)s(oth)g(called)f(from)g Fw(D)m(YNVIS)p
Fv(.)g Fw(LA)-9 b(THEA)g(T)28 b Fv(calculates)i(the)h(rate)0
5101 y(of)44 b(liquid)f(w)m(ater)i(pro)s(duction)f(due)h(to)f
(condensation.)80 b(This)45 b(is)f(curren)m(tly)h(a)g(prognostic)f
(appli-)0 5221 y(cation)d(of)h(the)g(diagnostic)f(form)m(ulation)e
(used)k(in)e(all)f(previous)i(v)m(ersions)h(of)f(the)g(LEM,)h(that)f
(is,)0 5341 y(sup)s(ersaturation)g(results)h(in)e(excess)k(v)-5
b(ap)s(our)42 b(condensing)h(instan)m(tly)f(to)g(liquid)e(w)m(ater.)74
b(F)-8 b(or)41 b(the)0 5462 y(giv)m(en)33 b(temp)s(erature,)g
(pressure,)i(and)e(the)g(liquid)e(and)i(v)-5 b(ap)s(our)32
b(mixing)f(ratios)h(a)g(new)i(liquid)d(w)m(ater)0 5582
y(mixing)e(ratio)h(is)h(calculated)g(\(QLNEW\).)g(The)i(original)28
b(v)-5 b(alue)31 b(\(QLOLD\))f(is)h(subtracted)i(and)e(the)0
5702 y(tendency)h(\(DQLDT\))c(calculated)h(b)m(y)h(dividing)e(b)m(y)i
(the)g(timestep)f(\(*RDT\).)g(This)h(is)f(a)g(pro)m(visional)0
5823 y(treatmen)m(t)24 b(of)g(liquid)e(w)m(ater)j(condensation)f
(whilst)g(a)g(more)f(sophisticated)h(prognostic)g(liquid)e(w)m(ater)
1841 6107 y(21)p eop
%%Page: 22 25
22 24 bop 0 52 a Fv(parametrization)30 b(is)i(dev)m(elop)s(ed.)146
293 y(Precipitation)37 b(and)h(h)m(ydrometeor)h(con)m(v)m(ersion)h
(rates)e(are)h(calculated)e(from)g(subroutine)i Fw(MI-)0
414 y(CR)m(OPHYS)p Fv(.)26 b(The)i(w)m(arm)f(rain)f(parametrizations)f
(are)i(treated)g(within)f Fw(MICR)m(OPHYS)g Fv(whilst)0
534 y(the)38 b(three-phase)h(parametrizations)d(\(IRAINP=10\))i(are)g
(calculated)e(in)h(the)i(call)d(to)h(subroutine)0 654
y Fw(MICR)m(O)m(X)p Fv(.)g(The)i(basic)f(structure)i(of)e(b)s(oth)f
(microph)m(ysics)i(approac)m(hes)g(are)f(the)h(same,)g(in)f(that)0
775 y(the)c(\015ux)g(of)f(the)h(h)m(ydrometeors)h(falling)30
b(at)j(their)g(terminal)e(v)m(elo)s(cit)m(y)i(\(QDO)m(WNFLUX\))g(is)g
(calcu-)0 895 y(lated)f(\014rst)g(and)h(then)g(the)f(v)m(ertical)g
(gradien)m(t)g(added)g(to)g(the)h(source)g(term)f(for)g(that)g(h)m
(ydrometeor.)0 1016 y(The)43 b(second)g(stage)f(is)g(to)f(calculate)g
(the)i(con)m(v)m(ersion)g(rates)f(b)s(et)m(w)m(een)i(eac)m(h)f(w)m
(ater)g(sp)s(ecies.)72 b(F)-8 b(or)0 1136 y Fw(MICR)m(OPHYS)28
b Fv(this)g(is)h(simple)f(as)h(with)g(only)f(v)-5 b(ap)s(our,)30
b(rain)e(and)h(cloud,)g(only)g(ev)-5 b(ap)s(oration,)28
b(au-)0 1256 y(to)s(con)m(v)m(ersion)j(and)f(collection)d(terms)j(need)
h(to)f(b)s(e)g(parametrized.)42 b(F)-8 b(or)29 b(the)h(ev)-5
b(ap)s(oration)29 b(term)g(the)0 1377 y(saturation)35
b(de\014cit)h(\(QWSDEF\))g(is)g(required;)i(this)e(is)g(calculated)f
(using)h(the)g(saturation)g(mixing)0 1497 y(ratio)31
b(\(QSA)-8 b(TPW\))33 b(calculated)e(in)g Fw(LA)-9 b(THEA)g(T)31
b Fv(and)h(passed)h(through)g(common)d(blo)s(c)m(k)i(MOIST.)146
1738 y(Subroutine)38 b Fw(MICR)m(O)m(X)f Fv(is)g(somewhat)g(more)g
(complicated)f(and)i(is)f(the)h(longest)f(subroutine)0
1858 y(in)26 b(the)i(LEM)g(in)e(terms)i(of)e(lines)h(of)f(co)s(de.)43
b(P)m(art)27 b(of)g(the)g(complexit)m(y)g(comes)g(from)f(the)i(large)e
(n)m(um)m(b)s(er)0 1979 y(of)k(p)s(ossible)f(con)m(v)m(ersion)j(terms)e
(and)h(also)e(from)g(the)i(di\013eren)m(t)f(options)g(that)g(are)g(p)s
(ossible)g(for)g(eac)m(h)0 2099 y(com)m(bination)25 b(of)h(parameters,)
i(i.e.)e(using)g(n)m(um)m(b)s(er)h(concen)m(trations)g(along)f(with)g
(mixing)e(ratios.)41 b(As)0 2219 y(with)36 b Fw(MICR)m(OPHYS)f
Fv(the)i(fall)e(rate)h(of)g(the)h(h)m(ydrometeors)h(is)e(calculated)g
(\014rst.)56 b(T)-8 b(o)36 b(a)m(v)m(oid)h(un-)0 2340
y(necessary)30 b(calculations)25 b(the)i(microph)m(ysics)g(terms)h(are)
f(only)f(calculated)h(where)h(condensate)h(exists)0 2460
y(or)f(v)-5 b(ap)s(our)28 b(is)g(sup)s(ersaturated)h(with)f(resp)s
(ect.)43 b(P)m(oin)m(t)m(wise)29 b(v)-5 b(alues)28 b(of)g(the)h(h)m
(ydrometeors)g(and)f(other)0 2580 y(v)-5 b(alues,)29
b(suc)m(h)i(as)d(temp)s(erature)h(and)g(saturation)e(mixing)g(ratios,)h
(are)h(assigned)g(to)f(v)-5 b(ariables)28 b(QLJK)0 2701
y(etc)41 b(whic)m(h)g(are)f(used)i(in)e(the)g(follo)m(wing)e
(calculations.)65 b(The)41 b(next)h(section)e(of)g(the)h(co)s(de)g
(concen-)0 2821 y(trates)33 b(with)e(calculating)f(the)j(con)m(v)m
(ersion)g(rates)g(in)e(accordance)i(with)f(the)h(expressions)h(describ)
s(ed)0 2942 y(in)c(Sections)i(6.3)e(to)h(6.6)f(of)h(the)g(Scien)m
(ti\014c)g(Do)s(cumen)m(tation)f(\(Gra)m(y)g(et)i(al)d(2001\).)42
b(Eac)m(h)32 b(con)m(v)m(ersion)0 3062 y(rate)d(is)g(assigned)h(to)f(a)
f(v)-5 b(ariable)28 b(suc)m(h)j(as)e(PSA)m(CI)i(\(sno)m(w)f(collection)
e(of)g(ice\))h(whic)m(h)h(corresp)s(onds)h(to)0 3182
y(the)k(naming)f(con)m(v)m(en)m(tion)i(describ)s(ed)g(in)e(Section)h
(6.1.2)f(of)h(the)g(Scien)m(ti\014c)g(Do)s(cumen)m(tation)f(\(Gra)m(y)0
3303 y(et)f(al)e(2001\))h(and)g(is)h(a)f(1-D)f(arra)m(y)i(o)m(v)m(er)g
(J.)146 3544 y(Once)39 b(all)e(the)i(con)m(v)m(ersion)g(terms)g(ha)m(v)
m(e)g(b)s(een)g(calculated)f(a)g(p)s(ositivit)m(y)f(c)m(hec)m(k)k(is)d
(carried)g(out)0 3664 y(for)31 b(eac)m(h)i(w)m(ater)f(sp)s(ecies)h
(mixing)c(ratio.)42 b(This)32 b(sums)g(the)g(sink)g(terms)f(for)g(eac)m
(h)i(sp)s(ecies)g(and)e(if)g(this)0 3784 y(exceeds)43
b(the)e(lo)s(cal)e(mixing)f(ratio)i(the)h(sink)g(terms)f(are)h
(appropriately)e(scaled.)68 b(The)42 b(individual)0 3905
y(con)m(v)m(ersion)29 b(rates)g(are)g(then)f(added)h(to)f(a)g(microph)m
(ysics)h(source)g(term)f(v)-5 b(ariable,)27 b(again)g(a)h(1-D)f(arra)m
(y)0 4025 y(o)m(v)m(er)j(J,)f(for)g(eac)m(h)h(w)m(ater)f(sp)s(ecies,)i
(named)e(DQV,)g(DQL,)f(DQR)g(etc.)43 b(These)31 b(are)e(then)h(added)f
(to)g(the)0 4145 y(source)34 b(term)e(arra)m(ys,)h(SQ.)146
4386 y(All)i(these)j(microph)m(ysics)f(source)g(terms)g(are)g
(calculated)e(sequen)m(tially)i(to)f(the)h(dynamics)f(and)0
4507 y(radiation)h(source)j(terms.)63 b(That)40 b(is,)g(they)g
(calculate)e(the)i(con)m(v)m(ersion)g(and)f(phase)h(c)m(hange)h(terms)0
4627 y(based)28 b(on)e(the)i(curren)m(t)g(\014elds)f(plus)f(the)i
(source)f(term)g(calculated)e(to)i(that)f(p)s(oin)m(t.)41
b(In)27 b(principle,)g(this)0 4747 y(means)35 b(that)g(the)g(con)m(v)m
(ersion)i(terms)e(kno)m(w)h(ab)s(out)e(the)i(adv)m(ection)f(and)g
(falling)d(of)j(w)m(ater)g(sp)s(ecies,)0 4868 y(and)e(temp)s(erature)f
(c)m(hanges)i(due)f(to)g(radiation)d(b)s(efore)j(they)g(are)g
(determined.)0 5277 y Fp(4.6)135 b(Bac)l(kscatter)0 5582
y Fv(Unlik)m(e)33 b(the)h(other)g(routines)f(whic)m(h)h(calculate)e
(the)i(source)h(terms)e(whic)m(h)h(are)g(called)e(from)g
Fw(D)m(YN-)0 5702 y(VIS)p Fv(,)21 b(the)i(bac)m(kscatter)g(routines)f
(are)g(called)e(direct)i(from)e Fw(NNSTEPS)p Fv(.)h(There)i(are)e
(three)i(bac)m(kscat-)0 5823 y(ter)52 b(routines)g(in)f(total:)80
b Fw(BCKSCT)51 b Fv(whic)m(h)h(calculates)f(the)h(bac)m(kscatter)i(on)e
(U,)g(V)f(and)h(W;)1841 6107 y(22)p eop
%%Page: 23 26
23 25 bop 0 52 a Fw(BCTSCT)32 b Fv(whic)m(h)g(calculates)g(the)g(bac)m
(kscatter)i(on)e(TH;)g(and)g Fw(BCQSCT)g Fv(whic)m(h)h(calculates)e
(the)0 173 y(bac)m(kscatter)44 b(on)e(Q.)g(The)h(primary)e(input)g(is)h
(DIS)g(for)f Fw(BCKSCT)p Fv(,)h(DIST)g(for)g Fw(BCTSCT)f
Fv(and)0 293 y(DISQ)h(for)f Fw(BCQSCT)h Fv(where)h(DIS,)f(DIST)g(and)g
(DISQ)g(are)g(the)g(dissipated)g(energy)h(that)e(is)h(to)0
414 y(b)s(e)h(bac)m(kscattered)i(to)e(the)g(resolv)m(ed)h(scale)f(for)f
(v)m(elo)s(cit)m(y)-8 b(,)45 b(TH)f(and)e(Q)h(\014elds)g(resp)s(ectiv)m
(ely)-8 b(.)76 b(The)0 534 y(purp)s(ose)36 b(of)f(the)h(bac)m(kscatter)
i(routines)d(is)g(to)h(calculate)e(the)i(source)h(term,)e(whic)m(h)i
(is)e(determined)0 654 y(b)m(y)e(taking)f(the)h(curl)f(\(or)f(div)m
(ergence)j(for)e(scalars\))g(of)g(a)g(v)m(ector,)i Fn(\036)p
2446 687 58 4 v -1 w Fv(,)f(de\014ned)h(as)e(the)h(square)h(ro)s(ot)d
(of)0 775 y(the)38 b(bac)m(kscattered)h(energy)g(m)m(ultiplied)34
b(b)m(y)k(a)f(random)f(n)m(um)m(b)s(er)i(v)m(ector)g(\(see)g(Section)f
(3.4)g(of)g(the)0 895 y(Scien)m(ti\014c)c(Do)s(cumen)m(tation,)e(Gra)m
(y)h(et)h(al)e(2001\).)146 1136 y(Eac)m(h)g(comp)s(onen)m(t)e(of)g
Fn(\036)p 989 1169 V 29 w Fv(is)f(calculated)h(using)g(the)g
(subroutine)h Fw(GETRAN)p Fv(.)e(The)i(main)d(inputs)0
1256 y(to)43 b Fw(GETRAN)f Fv(are)i(the)g(bac)m(kscattered)i(energy)f
(\(DIS\))e(on)g(the)i(I-1,)g(I)f(and)g(I+1)f(slice,)j(lo)s(cally)0
1377 y(called)34 b(BCM,)j(BC)f(and)g(BCP)g(resp)s(ectiv)m(ely)-8
b(,)37 b(and)f(the)g(main)e(output)h(is)g(lo)s(cally)e(named)j(ARRA)-8
b(Y,)0 1497 y(whic)m(h)30 b(represen)m(ts)j(the)d(comp)s(onen)m(t)f(of)
h Fn(\036)p 1502 1530 V -1 w Fv(.)43 b(Although)29 b(the)h(calculation)
e(of)h Fn(\036)p 2821 1530 V 29 w Fv(is)h(straigh)m(tforw)m(ard,)f(it)0
1617 y(is)35 b(then)h(\014ltered)f(in)g(three)h(directions.)51
b(This)36 b(requires)g(three)g(slices)g(of)e Fn(\036)p
2733 1650 V 36 w Fv(at)h(an)m(y)h(one)f(time,)g(so)h(to)0
1738 y(a)m(v)m(oid)25 b(costly)g(recalculation,)g(comp)s(onen)m(ts)g
(of)g Fn(\036)p 1751 1770 V 25 w Fv(on)g(previous)g(slices)g(are)g
(stored)h(in)e(VPOT)i(for)e(later)0 1858 y(usage.)43
b(VPOT)31 b(is)f(additionally)d(dimensioned)j(b)m(y)h(the)g(n)m(um)m(b)
s(er)f(of)g(comp)s(onen)m(ts)h(and)f(the)h(n)m(um)m(b)s(er)0
1979 y(of)k(\014elds.)53 b(The)37 b(argumen)m(ts)f(ICOMP)h(and)f
(IFIELD)f(to)h Fw(GETRAN)e Fv(determine)h(the)h(comp)s(onen)m(t)0
2099 y(of)c(VPOT)h(\(1=)p Fn(x)p Fv(,)g(2=)p Fn(y)t Fv(,)e(3=)p
Fn(z)t Fv(\))i(and)g(the)g(\014eld)f(\(1=v)m(elo)s(cit)m(y)-8
b(,)32 b(2=TH,)h(3+=Q\))f(resp)s(ectiv)m(ely)-8 b(.)146
2340 y(In)43 b Fw(BCKSCT)f Fv(there)h(are)f(\014v)m(e)h(calls)e(to)h
Fw(GETRAN)f Fv(to)h(calculate)f(PHYM)i(\()p Fn(y)t Fv(-comp)s(onen)m(t)
0 2460 y(of)g Fn(\036)p 122 2493 V 44 w Fv(on)h(I-1\),)i(PHZM)e(\()p
Fn(z)t Fv(-comp)s(onen)m(t)g(of)g Fn(\036)p 1684 2493
V 43 w Fv(on)g(I-1\),)i(PHX)e(\()p Fn(x)p Fv(-comp)s(onen)m(t)g(of)g
Fn(\036)p 3175 2493 V 43 w Fv(on)g(I\),)g(PHY)0 2580
y(\()p Fn(y)t Fv(-comp)s(onen)m(t)34 b(of)h Fn(\036)p
737 2613 V 35 w Fv(on)h(I\))f(and)h(PHZ)f(\()p Fn(z)t
Fv(-comp)s(onen)m(t)h(of)f Fn(\036)p 2240 2613 V 35 w
Fv(on)g(I\).)h(These)h(are)f(used)g(to)g(calculate)0
2701 y(the)e(curl)f(of)f Fn(\036)p 476 2734 V 33 w Fv(and)i(hence)h
(the)e(bac)m(kscatter)j(con)m(tribution)c(to)h(SU,)g(SV)h(and)f(SW.)h
(F)-8 b(or)33 b Fw(BCTSCT)0 2821 y Fv(and)g Fw(BCQSCT)h
Fv(PHXM,)g(PHX,)g(PHY)g(and)g(PHZ)f(are)h(calculated)e(b)m(y)i(calls)f
(to)g Fw(GETRAN)e Fv(and)0 2942 y(STH)i(and)f(SQ)g(determined)g(from)f
(the)i(div)m(ergence)g(of)f Fn(\036)p 2075 2974 V Fv(.)43
b(PHXM)33 b(is)f(only)f(calculated)g(on)h(the)h(\014rst)0
3062 y(slice;)f(subsequen)m(tly)-8 b(,)35 b(it)d(is)g(assigned)h(to)f
(PHX)h(at)f(the)h(end)h(of)e(the)h(previous)g(slice.)146
3303 y(The)45 b(sets)g(of)e(random)g(n)m(um)m(b)s(ers)i(used)g(in)e
Fw(GETRAN)f Fv(to)i(calculate)e Fn(\036)p 2902 3335 V
44 w Fv(are)i(determined)f(in)0 3423 y Fw(SETRAN)31 b
Fv(whic)m(h)i(is)f(called)g(from)f Fw(NNSTEPS)g Fv(at)i(the)g(b)s
(eginning)e(of)h(eac)m(h)h(new)h(step.)0 3832 y Fp(4.7)135
b(Pressure)45 b(Solv)l(er)0 4138 y Fv(The)29 b(pressure)g(gradien)m(t)f
(term)f(is)g(calculated)g(separately)h(to)f(the)h(other)g(momen)m(tum)f
(source)h(terms.)0 4258 y(The)f(pressure)h(is)d(calculated)h
(diagnostically)d(b)m(y)k(taking)e(the)h(div)m(ergence)i(of)d(the)i
(momen)m(tum)d(equa-)0 4378 y(tion)33 b(and)h(enforcing)g(the)g
(anelastic)f(incompressibilit)m(y)e(condition.)47 b(This)34
b(leads)g(to)f(a)h(P)m(oisson-lik)m(e)0 4499 y(elliptical)22
b(equation)k(for)f(P)h(\(see)h(Section)f(2.3)g(of)f(the)i(Scien)m
(ti\014c)f(Do)s(cumen)m(tation,)f(Gra)m(y)h(et)h(al)d(2001\).)0
4619 y(This)35 b(means)g(that)g(the)g(righ)m(t-hand)f(side)h(of)f(the)h
(P)m(oisson)h(equation,)f(whic)m(h)g(is)g(referred)g(to)g(as)g(the)0
4739 y(pressure)d(source,)g(consists)e(of)g(the)h(gradien)m(t)e(of)h
(the)g(other)g(momen)m(tum)f(source)i(terms)f(and)g(the)h(di-)0
4860 y(v)m(ergence)i(error.)43 b(The)32 b(pressure)h(source)f(is)f
(calculated)f(in)g(subroutines)i Fw(DIVERR)d Fv(and)j
Fw(PSR)m(CE)0 4980 y Fv(called)g(from)h Fw(NNSTEPS)f
Fv(in)h(the)h(I-lo)s(op.)45 b Fw(DIVERR)32 b Fv(calculates)h(the)h(div)
m(ergence)h(error,)f(whilst)0 5101 y Fw(PSR)m(CE)40 b
Fv(calculates)h(the)h(gradien)m(t)g(of)f(SU,)h(SV)g(and)f(SW.)h(This)g
(requires)h(SU)e(on)h(the)g(I-1)f(slice)0 5221 y(\(SUM1\),)c(and)e(for)
h(the)g(I=1)f(slice)g(this)g(calculation)e(is)j(only)f(partially)e
(completed.)52 b(In)36 b(b)s(oth)f(rou-)0 5341 y(tines)e(the)g
(pressure)h(source)g(is)e(assigned)h(to)f(v)-5 b(ariable)31
b(P)i(held)f(in)g(common)f(blo)s(c)m(k)h(PRESSURE.)146
5582 y(The)g(P)m(oisson-lik)m(e)e(equation)h(for)f(pressure)j(is)d
(solv)m(ed)h(in)f(subroutine)i Fw(POISSON)e Fv(called)g(from)0
5702 y Fw(NNSTEPS)23 b Fv(outside)h(the)h(I)f(lo)s(op.)39
b(A)25 b(sc)m(hematic)f(diagram)e(of)i(the)g(routine's)h(structure)g
(is)f(sho)m(wn)h(in)0 5823 y(Fig.)e(8.)41 b(The)25 b(principle)e(of)h
(solution)g(is)g(v)m(ery)i(simple,)e(although)g(the)h(actual)f(pro)s
(cedure)h(is)f(somewhat)1841 6107 y(23)p eop
%%Page: 24 27
24 26 bop 1179 -45 a Fk(')p 1179 165 4 46 v 1179 332
a(&)1888 -45 y($)p 1888 165 V 1888 332 a(\045)p 1347
332 377 4 v 1347 -45 V 1286 176 a Fw(POISSON)p 1534 543
4 213 v 1178 543 716 4 v 1178 898 4 355 v 1890 898 V
1178 901 716 4 v 1346 637 a Fq(Complete)1234 743 y(pressure)29
b(source)1321 858 y(calculation)p 1534 1134 4 237 v 1178
1134 716 4 v 1178 1488 4 355 v 1890 1488 V 1178 1491
716 4 v 1449 1239 a Fv(Call)1309 1404 y Fw(FF)-12 b(ANAL)p
1534 1724 4 237 v 2008 1325 237 4 v 2162 1323 a Fo(-)2362
1310 y Fv(Horizon)m(tal)31 b(fourier)h(transform)f(-)2362
1395 y(P)i(transp)s(osed)h(in)m(to)d(PT)p 1178 1724 716
4 v 1178 2079 4 355 v 1890 2079 V 1178 2082 716 4 v 1309
1865 a Fq(T)-8 b(ridiagonal)1272 1992 y(Solv)m(er)30
b(on)g(PT)p 1534 2315 4 237 v 1178 2315 716 4 v 1178
2669 4 355 v 1890 2669 V 1178 2672 716 4 v 1449 2421
a Fv(Call)1265 2585 y Fw(FFSYNTH)p 1534 2906 4 237 v
2008 2506 237 4 v 2162 2504 a Fo(-)2362 2491 y Fv(Horizon)m(tal)h
(fourier)h(transform)f(-)2362 2576 y(PT)j(transp)s(osed)f(bac)m(k)h(in)
m(to)e(P)1179 2907 y Fk(')p 1179 3117 4 46 v 1179 3285
a(&)1888 2907 y($)p 1888 3117 V 1888 3285 a(\045)p 1347
3285 377 4 v 1347 2907 V 1326 3034 a Fv(Return)h(to)1271
3176 y Fw(NNSTEPS)900 3700 y Fv(Figure)e(8:)43 b(Structure)34
b(of)e(subroutine)h Fw(POISSON)p Fv(.)0 3985 y(more)d(complicated.)41
b(The)31 b(calculation)d(of)i(the)g(I=1)h(slice)e(of)h(the)h(pressure)h
(source)f(is)f(completed)g(at)0 4105 y(the)38 b(b)s(eginning)d(of)i
Fw(POISSON)g Fv(b)m(y)h(passing)f(the)h(SUM1)g(term)f(from)f(the)h
(appropriate)g(PE.)h(The)0 4225 y(pressure)28 b(source)f(is)e(then)i(F)
-8 b(ourier)25 b(transformed)g(in)g(b)s(oth)h Fn(x)g
Fv(and)g Fn(y)j Fv(directions)d(through)g(the)g(routine)0
4346 y Fw(FF)-12 b(ANAL)p Fv(.)28 b Fw(FF)-12 b(ANAL)27
b Fv(arranges)h(the)g(data)g(accordingly)f(for)g(the)h(transform)f
(routines.)42 b(The)29 b(fast)0 4466 y(F)-8 b(ourier)42
b(transforms)h(\(\013ts\))g(are)g(computed)g(in)g(SCFFT)g(\(t3e)g
(only\))g(or)f Fw(F)m(OURIER)h Fv(\(p)s(ortable)0 4586
y(mo)s(del\).)146 4827 y(The)27 b Fn(y)t Fv(-direction)c(F)-8
b(ourier)25 b(transform)f(is)h(conducted)j(\014rst)e(along)e(eac)m(h)j
(v)m(ertical)e(slice.)40 b(Ho)m(w)m(ev)m(er,)0 4948 y(to)25
b(p)s(erform)e(the)j Fn(x)p Fv(-direction)d(F)-8 b(ourier)24
b(transform)g(all)f(the)i(I-slices)f(need)i(to)f(b)s(e)g(together)g(on)
g(one)g(PE.)0 5068 y(T)-8 b(o)25 b(main)m(tain)e(parallel)g(co)s(de)i
(at)g(this)g(p)s(oin)m(t,)h(the)g(data)e(in)h(P)g(is)g(rearranged)h(so)
f(that)g(it)f(is)h(partitioned)0 5188 y(in)m(to)39 b(J-slices)f(of)h
(the)h Fn(x)p Fv(-)p Fn(z)k Fv(plane.)63 b(This)39 b(is)g(p)s(erformed)
g(using)g(subroutine)g Fw(TRANSPOSE)f Fv(and)0 5309 y(the)f(full)d
(details)i(of)f(this)h(pro)s(cedure)i(is)e(discussed)i(under)f(MPP)g
(issues)h(in)d(Section)i(6.)54 b(This)37 b(data)0 5429
y(is)48 b(said)g(to)g(b)s(e)h(transp)s(osed,)54 b(and)48
b(is)h(stored)g(in)f(arra)m(y)g(PT)i(whic)m(h)f(is)f(dimensioned)g
(\(I,K,J\))g(as)0 5550 y(opp)s(osed)27 b(to)g(the)g(usual)f(\(J,K,I\))h
(for)g(P)-8 b(.)27 b(PT)g(can)g(then)g(b)s(e)g(F)-8 b(ourier)26
b(transformed)g(in)g(the)i Fn(x)p Fv(-direction.)0 5670
y(The)47 b(exception)g(is)e(in)g(the)i(2-D)d(case.)85
b(Then)47 b(there)g(is)e(no)h(need)h(to)f(transp)s(ose)h(the)f(data,)j
(but)0 5790 y(the)42 b(F)-8 b(ourier-transformed)40 b(data)i(in)f(P)i
(needs)g(to)f(b)s(e)g(assigned)h(to)e(PT.)i(No)m(w,)i(PT)e(is)f
(e\013ectiv)m(ely)1841 6107 y(24)p eop
%%Page: 25 28
25 27 bop 0 52 a Fv(dimensioned)43 b(\(I,K,1\),)j(where)f(the)f(I)g
(refers)g(to)g(the)g Fn(y)t Fv(-direction)d(rather)j(than)f(the)i
Fn(x)p Fv(-direction.)0 173 y(This)39 b(is)e(ac)m(hiev)m(ed)j(b)m(y)f
(using)f(in)m(teger)h(arithmetic)d(on)i(the)h(parameters)f(whic)m(h)h
(de\014ne)h(the)e(size)h(of)0 293 y(PT)33 b(\(IMINP)-8
b(,)34 b(IMAXP)-8 b(,)34 b(JJPEMINP)-8 b(,)34 b(JJPEMAXP\).)146
534 y(The)c(tridiagonal)c(solv)m(er)j(algorithm)d(is)j(then)h(carried)e
(out)h(on)g(PT)h(in)e Fw(POISSON)p Fv(.)h(This)h(solv)m(es)0
654 y(the)c(ordinary)e(v)m(ertical)g(di\013eren)m(tial)g(equation)h
(\(sho)m(wn)h(in)e(Section)h(2.3)g(of)g(the)g(Scien)m(ti\014c)h(Do)s
(cumen-)0 775 y(tation,)31 b(Gra)m(y)h(et)h(al)e(2001\),)g(resulting)g
(in)h(PT)h(con)m(taining)e(the)h(\014nal)g(pressure)i(\014eld)e(in)f(w)
m(a)m(v)m(espace.)146 1016 y(Finally)-8 b(,)38 b(the)h(rev)m(erse)i(F)
-8 b(ourier)37 b(transform)h(is)g(p)s(erformed)g(in)g
Fw(FFSYNTH)p Fv(.)h(The)h Fn(x)p Fv(-direction)0 1136
y(transform)25 b(is)g(p)s(erformed)g(\014rst)h(on)f(PT,)i(then)f(PT)g
(is)f(transp)s(osed)i(bac)m(k)g(in)m(to)d(P)-8 b(,)26
b(and)g(the)g Fn(y)t Fv(-direction)0 1256 y(transform)37
b(carried)h(out)g(on)g(P)-8 b(.)39 b(This)f(completes)g(the)h
(calculation)c(of)j(pressure.)62 b(It)39 b(is)e(imp)s(ortan)m(t)0
1377 y(to)30 b(note)h(that)g(the)g(\014nal)f(pressure)j(v)-5
b(ariable,)29 b(P)-8 b(,)31 b(is)f(the)h(ratio)f(of)g(the)h(pressure)i
(p)s(erturbation)d(to)g(the)0 1497 y(densit)m(y)d(\()p
Fn(p)417 1461 y Fi(0)440 1497 y Fn(=\032)539 1512 y Fe(s)576
1497 y Fv(\).)41 b(This)27 b(m)m(ust)f(b)s(e)h(remem)m(b)s(ered)f(when)
h(p)s(ost-pro)s(cessing)f(an)m(y)h(pressure)h(diagnostics.)0
1906 y Fp(4.8)135 b(Large-Scale)46 b(Adv)l(ection)f(and)g(F)-11
b(orcing)0 2211 y Fv(Large-scale)26 b(adv)m(ection)h(or)f(forcing)f
(terms)i(can)g(b)s(e)f(applied)g(to)g(the)h(prognostic)f(\014elds.)42
b(This)26 b(can)h(b)s(e)0 2332 y(done)j(b)s(oth)f(b)m(y)h(sp)s
(ecifying)f(a)g(v)m(ertical)g(v)m(elo)s(cit)m(y)-8 b(,)30
b(WSUBS,)g(whic)m(h)g(adv)m(ects)h(the)f(mean)f(\014elds)g(in)g(the)0
2452 y(v)m(ertical,)c(and)e(b)m(y)i(sp)s(ecifying)e(a)g(horizon)m
(tally)f(homogeneous)h(forcing)g(term)g(\(SULS,)h(SVLS,)g(STHLS)0
2573 y(or)k(SQLS\))f(whic)m(h)i(can)f(represen)m(t)i(a)d(large-scale)g
(adv)m(ection)h(term)f(and/or)h(an)m(y)g(other)g(forcing,)g(suc)m(h)0
2693 y(as)36 b(radiation.)50 b(The)36 b(v)m(ertical)f(adv)m(ection)g
(due)i(to)e(WSUBS,)h(and)g(the)f(addition)f(of)h(the)h(large-scale)0
2813 y(forcing)28 b(term)g(to)g(the)h(source)h(term,)f(o)s(ccurs)g(in)f
(the)h(routines)g Fw(UVWSR)m(CE)p Fv(,)f Fw(THSOUR)m(CE)f
Fv(and)0 2934 y Fw(QSOUR)m(CE)33 b Fv(etc,)h(but)f(the)h(sp)s
(eci\014cation)e(of)h(WSUBS)h(and)f(SULS)g(etc)h(o)s(ccurs)g(elsewhere)
h(in)d(the)0 3054 y(mo)s(del.)146 3295 y(WSUBS)42 b(is)f(sp)s
(eci\014ed)h(in)e(the)i(routine)e Fw(SETLS)h Fv(called)f(from)g
Fw(SET1D)h Fv(if)f(ISUBP=1.)70 b(The)0 3415 y(co)s(de)39
b(in)g Fw(SETLS)g Fv(needs)i(to)d(b)s(e)i(c)m(hanged)g(b)m(y)g(the)f
(user)h(to)f(sp)s(ecify)h(WSUBS.)g(A)f(negativ)m(e)g(v)-5
b(alue)0 3536 y(of)30 b(WSUBS)h(implies)d(descen)m(t,)33
b(or)d(subsidence,)j(and)d(a)h(p)s(ositiv)m(e)e(v)-5
b(alue)30 b(implies)e(large-scale)h(ascen)m(t.)0 3656
y(The)44 b(forcing)e(terms)g(SULS)i(etc)f(are)g(sp)s(eci\014ed)h(in)e
Fw(SETLS)h Fv(if)f(IF)m(OR)m(CEP=1,)k(and)d(the)g(default)0
3776 y(is)f(to)g(read)g(the)h(v)-5 b(alues)42 b(in)g(from)f(an)h
(external)h(\014le,)h Fl(F)-7 b(or)i(c)g(e.dat)p Fv(.)72
b(The)43 b(external)f(\014le)g(can)h(also)e(b)s(e)0 3897
y(used)35 b(to)e(set)h(time-v)-5 b(arying)31 b(v)-5 b(alues)33
b(of)g(forcing,)g(if)f(ITMF)m(ORP=1.)47 b(This)34 b(option)e(presen)m
(ts)k(a)d(more)0 4017 y(\015exible)c(approac)m(h)h(to)f(the)h(forcing,)
g(as)f(the)h(input)f(forcing)g(pro\014les)g(can)h(b)s(e)g(on)f(a)g
(di\013eren)m(t)h(v)m(ertical)0 4138 y(grid)38 b(to)h(the)h(mo)s(del)d
(run.)64 b(The)40 b(forcing)e(pro\014les)h(are)g(read)h(in)e(as)h(SULS)
p 2807 4138 30 4 v 36 w(READ,)g(SVLS)p 3437 4138 V 36
w(READ,)0 4258 y(STHLS)p 318 4258 V 36 w(READ)48 b(and)g(SQLS)p
1138 4258 V 36 w(READ)g(sp)s(eci\014ed)h(at)e(times)h(giv)m(en)g(b)m(y)
h(TIMF)m(OR)g(and)f(on)g(lev)m(els)0 4378 y(F)m(ORLEVS.)32
b(In)m(teger)g(switc)m(hes)h(IF)m(OR)m(U,)f(F)m(OR)-11
b(V,)32 b(F)m(OR)-8 b(TH)31 b(and)h(IF)m(OR)m(Q)f(are)h(also)e(read)i
(in)f(whic)m(h)0 4499 y(indicate)42 b(whether)i(there)g(is)e(forcing)g
(data)h(for)f(the)i(\014eld)e(\(0\),)k(the)d(forcing)f(data)g(is)h(a)f
(tendency)0 4619 y(\(1\))f(or)g(a)f(pro\014le)h(to)g(relax)g(to)f(on)h
(a)g(timescale)f(giv)m(en)h(b)m(y)h(F)m(OR)-8 b(TIMSC)43
b(\(2\).)68 b(SULS)p 3298 4619 V 36 w(READ)41 b(etc)0
4739 y(are)i(in)m(terp)s(olated)f(on)m(to)h(the)g(mo)s(del)f(v)m
(ertical)g(grid)g(in)g(subroutine)h Fw(F)m(ORINTER)p
Fv(,)f(called)g(from)0 4860 y Fw(SETLS)p Fv(,)g(whic)m(h)f(accommo)s
(dates)g(b)s(oth)g(pressure)i(and)e(heigh)m(t)g(lev)m(els,)j(and)d(the)
h(output)f(is)g(held)0 4980 y(in)e(SULS)p 369 4980 V
35 w(TV)h(etc.)65 b(The)41 b(actual)d(v)-5 b(alues)39
b(of)g(forcing,)i(SULS)f(etc,)h(are)f(calculated)e(eac)m(h)j(timestep)0
5101 y(b)m(y)34 b(in)m(terp)s(olation)c(in)j(routine)f
Fw(CHGLS)p Fv(,)i(called)e(b)m(y)h Fw(NNSTEPS)p Fv(,)f(or)h(relaxation)
f(to)g(the)i(desired)0 5221 y(pro\014le,)e(if)g(IF)m(OR*=2.)42
b(The)34 b(forcings)e(are)g(also)g(c)m(hanged)i(from)d(da)m(y)2580
5185 y Fi(\000)p Fs(1)2708 5221 y Fv(to)h(s)2865 5185
y Fi(\000)p Fs(1)2992 5221 y Fv(in)g(this)g(routine.)1841
6107 y(25)p eop
%%Page: 26 29
26 28 bop 0 52 a Fp(4.9)135 b(Stepping,)46 b(Sw)l(apping)f(and)f
(Time-smo)t(othing)0 358 y Fv(Once)36 b(the)g(source)h(\014elds)f(are)f
(calculated)g(at)g(the)h(end)g(of)g(eac)m(h)g(pass)g(of)g(the)g(I-lo)s
(op)d(the)j(\014elds)g(can)0 478 y(b)s(e)c(incremen)m(ted.)43
b(This)32 b(is)f(done)h(through)f(the)h(routine)f Fw(STEPFLDS)h
Fv(called)e(from)h Fw(NNSTEPS)0 598 y Fv(within)26 b(the)h(I-lo)s(op.)
40 b(As)27 b(discussed)i(previously)-8 b(,)28 b Fw(STEPFLDS)f
Fv(actually)f(incremen)m(ts)h(the)g(\014elds)h(on)0 719
y(the)i(I-2)f(slice)f(as)i(the)g(previous)g(timestep)f(\014elds)g(\(Z*)
g(\014elds\))h(on)f(the)h(I-1)f(slice)g(are)g(still)e(required)j(for)0
839 y(the)h(calculation)d(of)i(viscosit)m(y)-8 b(.)44
b(On)30 b(the)h(\014nal)f(slice)g(of)g(the)h(lo)s(op)e(all)g(remaining)
f(slices)i(are)h(stepp)s(ed.)0 959 y(New)i(time-lev)m(el)e(\014elds)i
(are)f(assigned)h(to)f(the)h(Z*)f(\014elds.)146 1200
y(The)45 b(v)m(elo)s(cit)m(y)e(\014elds,)k(U,)d(V)g(and)g(W)f(are)h
(stepp)s(ed)h(in)e(calls)f(to)i Fw(STEPGAL)f Fv(for)g(U)h(and)f(V)0
1321 y(and)35 b Fw(STEPW)g Fv(for)f(W)i(from)e Fw(STEPFLDS)p
Fv(.)h Fw(STEPGAL)g Fv(adds)h(the)f(Galilean)e(transformation)0
1441 y(\(UGAL)24 b(and)g(V)m(GAL\))g(bac)m(k)h(in)m(to)e(the)h(new)h
(time-lev)m(el)d(\014elds.)41 b(This)24 b(had)g(previously)g(b)s(een)h
(remo)m(v)m(ed)0 1561 y(from)31 b(the)h(U)g(and)g(V)g(\014elds)h(for)e
(the)h(calculation)e(of)i(the)g(source)h(terms.)43 b(This)32
b(is)g(not)g(necessary)i(for)0 1682 y(W)f(in)f Fw(STEPW)p
Fv(.)f(After)i(the)g(call)e(to)h Fw(STEPFLDS)h Fv(ZU,)f(ZV)h(and)f(ZW)h
(represen)m(t)h(the)f(next)h(time)0 1802 y(lev)m(el)d(for)f(U,)i(V)f
(and)g(W)g(except)i(that)e(they)h(do)f(not)g(include)f(the)i(pressure)h
(gradien)m(t)d(term.)43 b(This)31 b(is)0 1923 y(added)h(to)f(ZU,)g(ZV)g
(and)g(ZW)g(in)g(the)g(call)f(to)h Fw(PSTEP)f Fv(from)g
Fw(NNSTEPS)p Fv(.)g(The)i(scalar)f(\014elds)g(are)0 2043
y(fully)g(stepp)s(ed)j(b)m(y)g(calls)d(to)h Fw(STEP)g
Fv(from)f Fw(STEPFLDS)p Fv(.)146 2284 y(All)40 b(the)i(step)g(routines)
f(can)h(p)s(erform)e(a)h(forw)m(ard)g(step)h(or)f(cen)m(tred)i(step)f
(dep)s(ending)g(on)f(the)0 2404 y(argumen)m(t)35 b(IF)m(ORSTEP)-8
b(.)36 b(Ho)m(w)m(ev)m(er,)j(the)c(LEM)h(can)g(use)g(an)f(option,)g
(when)h(scalars)f(are)h(adv)m(ected)0 2524 y(b)m(y)44
b(UL)-8 b(TIMA)g(TE,)45 b(to)d(forw)m(ard)h(step)h(the)g(scalars)f(but)
g(use)h(cen)m(tred)g(di\013erence)g(on)f(momen)m(tum.)0
2645 y(This)27 b(is)g(con)m(trolled)f(b)m(y)j(the)e(parameter)g(IF)m
(ORSCALP)h(and)f(so)h(this)f(p)s(ossibilit)m(y)e(is)i(accommo)s(dated)0
2765 y(for)32 b(in)g(routine)g Fw(STEP)p Fv(.)146 3006
y(Tw)m(o)c(metho)s(ds)f(of)g(time-smo)s(othing)c(are)k(supp)s(orted)h
(in)e(the)i(co)s(de.)42 b(The)28 b(simplest)e(\(ISMTH=2\))0
3126 y(exc)m(hanges)37 b(a)e(small)e(fraction)h(b)s(et)m(w)m(een)j
(time-lev)m(els)c(t+1)i(and)g(t)g(in)f(subroutine)h Fw(SW)-12
b(APSMTH)p Fv(.)0 3247 y(The)42 b(alternativ)m(e)f(Rob)s(ert)g
(\014lter)g(\(ISMTH=1\))h(uses)g(the)g(t+1,)h(t)f(and)f(t-1)f(time-lev)
m(els.)69 b(F)-8 b(or)40 b(the)0 3367 y(scalar)f(\014elds)g(this)g(is)f
(ac)m(hiev)m(ed)j(b)m(y)f(doing)e(a)h(partial)e(smo)s(othing)g(b)s
(efore)i(the)h(calls)e(to)h Fw(STEP)f Fv(in)0 3488 y
Fw(STEPFLDS)h Fv(and)g(then)g(completing)e(the)i(pro)s(cedure)h(in)e
Fw(SW)-12 b(APSMTH)p Fv(.)37 b(Ho)m(w)m(ev)m(er,)43 b(b)s(ecause)0
3608 y(the)35 b(v)m(elo)s(cit)m(y)e(\014elds)i(are)f(not)g(fully)f
(stepp)s(ed)i(at)f Fw(STEPFLDS)p Fv(,)g(as)h(they)g(still)c(a)m(w)m
(ait)j(the)h(pressure)0 3728 y(gradien)m(t)j(term,)i(the)f(t-1)f(time)f
(lev)m(el)h(is)g(sa)m(v)m(ed)i(in)e(the)h(arra)m(ys)h(SA)-11
b(VU,)39 b(SA)-11 b(VV)39 b(etc)g(and)g(stored)g(in)0
3849 y(common)31 b(blo)s(c)m(k)i(RFIL)-8 b(T)32 b(b)s(efore)h(b)s(eing)
f(used)h(in)f Fw(SW)-12 b(APSMTH)p Fv(.)146 4089 y(The)40
b(other)f(purp)s(ose)h(of)f(subroutine)g Fw(SW)-12 b(APSMTH)38
b Fv(is)h(to)f(sw)m(ap)i(the)g(\014elds)f(with)g(their)f(Z*)0
4210 y(coun)m(terparts)e(so)g(that)f(the)g(t+1)g(time)f(lev)m(el)g(is)h
(no)m(w)h(held)f(in)f(the)i(standard)f(\014eld)g(and)g(the)h(t)f(time)0
4330 y(lev)m(el)42 b(in)f(the)i(Z*)f(\014eld.)72 b(This)43
b(is)f(ac)m(hiev)m(ed)h(within)e(the)i(time-smo)s(othing)c(algorithms.)
70 b(T)-8 b(able)42 b(5)0 4451 y(illustrates)36 b(the)i(time-lev)m(els)
e(that)h(the)h(v)-5 b(ariables)37 b(are)g(at)h(during)f(the)h
Fw(NNSTEPS)e Fv(routine.)58 b(So,)0 4571 y(on)35 b(b)s(eginning)e(the)j
(next)g(timestep)e(the)i(standard)f(\014eld)g(holds)g(the)g
Fn(t)g Fv(v)-5 b(alue)34 b(and)i(the)f(Z*)f(\014eld)h(the)0
4691 y Fn(t)22 b Fm(\000)h Fv(1)32 b(v)-5 b(alue.)p 1217
4823 1345 7 v 1267 4907 a(After)33 b(Subroutine)144 b(U)160
b(ZU)p 1217 4950 V 1406 5034 a Fw(D)m(YNVIS)299 b Fv(t)183
b(t-1)1339 5154 y Fw(STEPFLDS)235 b Fv(t)162 b(t+1)1297
5275 y Fw(SW)-12 b(APSMTH)129 b Fv(t+1)161 b(t)p 1217
5317 V 0 5586 a(T)-8 b(able)36 b(5:)51 b(Time)36 b(lev)m(els)g(of)g
(the)h(U)g(and)f(ZU)g(v)-5 b(ariables)35 b(after)i(k)m(ey)h(subroutine)
e(calls)f(in)h(subroutine)0 5706 y Fw(NNSTEPS)1841 6107
y Fv(26)p eop
%%Page: 27 30
27 29 bop 0 52 a Fp(4.10)136 b(Numerics)0 358 y Fv(The)34
b(n)m(umerical)d(stabilit)m(y)g(of)h(the)i(mo)s(del)d(is)h(main)m
(tained)f(b)m(y)j(k)m(eeping)f(the)g(viscous)h(and)f(adv)m(ectiv)m(e)0
478 y(Couran)m(t)d(n)m(um)m(b)s(ers)h(of)e(the)h(mo)s(del,)f(CVIS)i
(and)f(CVEL)g(resp)s(ectiv)m(ely)-8 b(,)32 b(b)s(elo)m(w)d(user)i(sp)s
(eci\014ed)g(target)0 598 y(v)-5 b(alues,)50 b(CVISMAX)d(and)g
(CVELMAX.)g(This)g(is)e(ac)m(hiev)m(ed)j(b)m(y)f(v)-5
b(arying)45 b(the)i(timestep,)i(DTM.)0 719 y(The)c(test)g(for)e(the)h
(Couran)m(t)h(n)m(um)m(b)s(er)f(is)g(carried)f(out)h(in)f(subroutine)h
Fw(TESTCFL)h Fv(at)e(the)i(end)0 839 y(of)i(the)h(N-lo)s(op)e(in)h
Fw(NNSTEPS)f Fv(\(see)j(Fig.)d(5\).)89 b(A)48 b(normalized)d(Couran)m
(t)j(n)m(um)m(b)s(er,)k(CFLNO,)0 959 y(is)42 b(calculated)f(b)m(y)i
(summing)d(the)j(ratios)e(CVIS/CVISMAX)k(and)d(CVEL/CVELMAX.)i(A)f(new)
0 1080 y(timestep,)32 b(DTMNEW,)i(is)e(then)h(calculated)f(b)m(y)h
(dividing)e(DTM)i(b)m(y)g(CFLNO.)146 1321 y(CVIS)26 b(is)e(partially)e
(calculated)i(in)g Fw(SMA)m(G)h Fv(b)m(y)h(determining)d(the)i(maxim)m
(um)d(of)i(VIS)i(and)f(DIFF)0 1441 y(divided)36 b(b)m(y)h(the)g(sum)f
(of)g(the)h(squares)h(of)e(the)g(grid)g(spacing)g(o)m(v)m(er)h(the)g
(en)m(tire)f(domain.)53 b(The)38 b Fn(x)p Fv(,)f Fn(y)0
1561 y Fv(and)42 b Fn(z)k Fv(comp)s(onen)m(ts)c(of)g(CVEL)g(\(CVELX,)h
(CVEL)-8 b(Y)43 b(and)e(CVELZ\))i(are)e(calculated)g(separately)0
1682 y(using)47 b(the)h(maxim)m(um)e(v)m(elo)s(cit)m(y)h(in)g(the)h
(domain.)87 b(The)48 b(maxim)m(um)e(v)m(elo)s(cit)m(y)h(on)h(eac)m(h)g
(slice)f(is)0 1802 y(calculated)31 b(in)f(routine)h Fw(CVELGAL)g
Fv(whic)m(h)h(is)f(called)g(at)g(the)h(b)s(eginning)e(of)h
Fw(STEPFLDS)p Fv(.)h(The)0 1923 y(maxim)m(um)f(v)m(ertical)i(v)m(elo)s
(cit)m(y)h(can)g(b)s(e)g(found)g(on)g(a)f(step)i(b)m(y)f(step)h(basis)f
(so)g(CVELZ)g(is)f(calculated)0 2043 y(there.)52 b(Ho)m(w)m(ev)m(er,)38
b(for)c(the)h(horizon)m(tal)f(v)m(elo)s(cit)m(y)h(the)g(maxim)m(um)e
(cannot)i(b)s(e)g(calculated)f(un)m(til)g(the)0 2163
y(new)43 b(Galilean)38 b(transformation)i(v)m(elo)s(cities,)j(UGAL)f
(and)f(V)m(GAL,)h(are)g(determined.)71 b(These)43 b(are)0
2284 y(the)37 b(mean)g(of)f(the)i(domain)d(maxim)m(um)g(and)i(minim)m
(um)d(v)m(elo)s(cities.)55 b(This)37 b(minimises)e(the)i(largest)0
2404 y(horizon)m(tal)k(v)m(elo)s(cit)m(y)i(p)s(erturbation)f(and)h(so)g
(p)s(ermits)f(the)h(largest)g(timestep.)74 b(This)43
b(calculation)0 2524 y(is)d(p)s(erformed)f(in)g(routine)h
Fw(CVELGAL2)g Fv(whic)m(h)g(is)g(called)f(from)g Fw(NNSTEPS)f
Fv(in)i(the)g(N-lo)s(op,)0 2645 y(and)46 b(CVELX)g(and)g(CVEL)-8
b(Y)46 b(are)g(determined,)j(along)44 b(with)h(the)h(domain)e(maxim)m
(um)f(of)j(CVIS)0 2765 y(and)38 b(CVELZ)g(\(if)f(m)m(ulti-pro)s
(cessors)f(are)i(used\).)60 b(The)39 b(CVIS)g(and)f(CVEL)g
(calculations)e(are)i(then)0 2886 y(completed)32 b(in)g
Fw(TESTCFL)p Fv(.)146 3126 y(The)h(up)s(dating)f(of)f(DTM)i(o)s(ccurs)g
(in-line)d(in)h Fw(NNSTEPS)p Fv(.)g(If)h(DTMNEW)i(is)d(less)i(than)f
(DTM)0 3247 y(then)42 b(DTM)g(is)f(immediately)d(set)k(to)f(DTMNEW.)i
(If)e(DTMNEW)h(is)f(greater)h(than)f(DTM)h(then)0 3367
y(DTM)32 b(is)g(increased)h(slo)m(wly)f(to)m(w)m(ards)h(DTMNEW)g(b)m(y)
g(a)f(factor)f(of)h(1+RINCMAX)h(eac)m(h)g(timestep)0
3488 y(un)m(til)38 b(DTMNEW)h(is)g(reac)m(hed.)63 b(DTM)39
b(is)f(also)g(limited)e(b)m(y)k(a)e(user)i(sp)s(eci\014ed)g(maxim)m
(um,)e(DTM-)0 3608 y(MAX,)e(and)g(a)g(minim)m(um,)d(DTMMIN.)j(IF)g
(DTMNEW)h(falls)c(b)s(elo)m(w)j(DTMMIN)h(then)f(the)g(run)g(is)0
3728 y(terminated)28 b(b)m(y)j(a)e(call)e(to)i Fw(EXXIT)f
Fv(with)h(an)g(error)g(co)s(de)h(of)f(12.)41 b Fw(TESTCFL)30
b Fv(is)f(only)g(called)f(once)0 3849 y(ev)m(ery)34 b(NN)f(steps.)0
4302 y Fx(5)161 b(Outputs)0 4641 y Fv(LEM)46 b(output)g(can)f(b)s(e)h
(classi\014ed)f(in)m(to)g(four)g(t)m(yp)s(es:)70 b(run)46
b(time)e(information)e(whic)m(h)k(is)f(written)0 4762
y(to)39 b(either)f(standard)i(out,)g(or)f(the)g(\014le)g
Fl(run)p 1648 4762 30 4 v 36 w(info)p Fv(;)j(run)d(status)h
(information,)d(whic)m(h)j(is)e(written)h(to)0 4882 y(the)47
b(message)g(\014le,)j Fl(mesg)p Fv(;)j(mo)s(del)45 b(dumps)i(\014les,)j
Fl(\014le)-5 b(a)46 b Fv(and)h Fl(\014leb)p Fv(;)53 b(and)47
b(mo)s(del)e(diagnostic)g(\014les,)0 5002 y Fl(runXXXX.dgYYY)p
Fv(.)146 5243 y(V)-8 b(arious)33 b(output)h(is)f(written)h(to)f
(standard)h(out)g(during)f(the)h(execution)g(of)f(the)h(co)s(de)g
(including)0 5364 y(some)27 b(of)g(the)h(set-up)g(information)c(and)k
(the)g(progress)g(of)f(the)h(mo)s(del)d(in)m(tegration)h(in)h(terms)g
(of)g(steps)0 5484 y(completed,)45 b(the)e(Couran)m(t)g(n)m(um)m(b)s
(ers)h(and)f(the)g(curren)m(t)h(timestep.)73 b(Div)m(ergence)44
b(error)e(can)h(also)0 5604 y(b)s(e)d(prin)m(ted)g(out)f(if)g
(required.)65 b(Details)38 b(of)h(the)i(mo)s(del)d(parameters)h(and)h
(namelist)e(v)-5 b(ariables)38 b(are)0 5725 y(written)32
b(to)h Fl(run)p 615 5725 V 36 w(info)f Fv(during)g(the)h(set-up)g(job.)
1841 6107 y(27)p eop
%%Page: 28 31
28 30 bop 146 52 a Fv(The)36 b(message)f(\014le)f(has,)i(at)e(an)m(y)h
(time,)f(one)h(of)f(\014v)m(e)i(messages.)50 b(\\F)-11
b(AILSAFE")35 b(indicates)f(that)0 173 y(the)44 b(co)s(de)h(is)e
(curren)m(tly)i(running;)k(\\READ)m(Y)44 b(TO)g(CONTINUE")h(means)f
(that)g(the)g(job)g(in)f(the)0 293 y(c)m(hain)24 b(has)h(b)s(een)g
(completed;)h(\\LA)-8 b(TER)25 b(CONTINUA)-8 b(TION)26
b(POSSIBLE")f(means)f(that)g(the)h(c)m(hain)0 414 y(has)41
b(completed)g(successfully;)47 b(\\ABNORMAL)41 b(TERMINA)-8
b(TION)43 b(BECA)m(USE)g(ISTOPU=")f(is)0 534 y(written)26
b(when)g(an)g(error)g(is)f(detected)i(in)e(the)h(co)s(de)g(whic)m(h)h
(prev)m(en)m(ts)h(it)c(running;)k(\\CONTR)m(OLLED)0 654
y(STOP)35 b(BECA)m(USE)i(ISTOPU=")e(indicates)f(an)g(error)g(whic)m(h)h
(do)s(es)g(not)g(necessarily)g(prev)m(en)m(t)h(the)0
775 y(co)s(de)29 b(re-running)f(and)g(a)g(mo)s(del)f(dump)h(is)g(pro)s
(duced.)43 b(More)29 b(detail)e(of)h(the)h(error)f(messages)h(will)d(b)
s(e)0 895 y(describ)s(ed)34 b(in)e(Section)h(5.9.)44
b(The)34 b(user)g(can)f(edit)g(the)g(message)h(\014le)e(at)h(an)m(y)h
(stage,)f(and)g(b)m(y)h(writing)0 1016 y(\\NO)42 b(PR)m(OBLEM)i(BUT)f
(STOP")g(the)g(curren)m(t)h(in)m(tegration)d(will)f(b)s(e)j(brough)m(t)
g(to)f(a)h(con)m(trolled)0 1136 y(halt.)146 1377 y(The)31
b(mo)s(del)c(dumps)j(are)f(pro)s(duced)h(b)m(y)g(the)g(subroutine)f
Fw(DUMP)g Fv(or)g Fw(NEWDUMP)p Fv(.)g(An)g(op-)0 1497
y(tion)21 b(can)h(b)s(e)g(selected)g(so)g(that)g(the)g(mo)s(del)e
(dumps)i(alternately)f(to)g Fl(\014le)-5 b(a)21 b Fv(and)h
Fl(\014leb)f Fv(\(ITW)m(OFILEP=1\).)0 1617 y(This)39
b(prev)m(en)m(ts)i(total)c(loss)h(of)g(data)g(should)h(there)g(b)s(e)g
(a)f(mac)m(hine)g(crash)h(or)g(CPU)g(limit)c(reac)m(hed)0
1738 y(whilst)h(writing)g(out)h(the)h(mo)s(del)e(dump.)57
b(Ho)m(w)m(ev)m(er,)41 b(this)c(do)s(es)h(ha)m(v)m(e)g(a)f(p)s(enalt)m
(y)g(of)g(doubling)f(the)0 1858 y(disk)h(space)h(memory)d(requiremen)m
(t)i(for)f(the)i(run.)56 b(The)37 b(mo)s(del)e(dumps)i(are)g(discussed)
h(further)f(in)0 1979 y(Section)32 b(5.8.)146 2219 y(The)f(diagnostics)
e(\014le)g(is)g(written)h(out)g(in)e(subroutine)i Fw(DIA)m(G)f
Fv(whic)m(h)i(is)e(called)f(from)h Fw(EXXIT)p Fv(.)0
2340 y(This)37 b(ma)m(y)f(b)s(e)g(called)f(in)h(sev)m(eral)h
(circumstances)g(dep)s(ending)g(on)f(user)h(c)m(hoices:)52
b(after)36 b(ev)m(ery)j(job,)0 2460 y(at)d(certain)g(sp)s(eci\014ed)h
(times,)g(at)f(the)h(end)g(of)f(the)g(c)m(hain)h(or)f(at)g(a)g(con)m
(trolled)f(mo)s(del)g(termination.)0 2580 y(Subroutine)i
Fw(TESTTIME)f Fv(called)g(from)g Fw(NNSTEPS)g Fv(c)m(hec)m(ks)k(the)d
(mo)s(del)e(time)h(against)g(TIM-)0 2701 y(PDG)e(etc)h(input)f(through)
g(the)h(TIMENML)h(namelist)d(and)i(if)e(diagnostics)g(are)i(required)g
(the)g(\015ag)0 2821 y(ITIMPDG)j(is)g(set)h(equal)e(to)h(1.)59
b(If)38 b(ITIMPDG=1)g(\(along)f(with)g(other)h(conditional)e(statemen)m
(ts\))0 2942 y(then)d Fw(DIA)m(G)f Fv(is)g(called)f(from)h
Fw(EXXIT)p Fv(.)146 3182 y(The)i(diagnostics)d(\014le)h(is)g
(structured)i(in)e(t)m(w)m(o)h(parts.)44 b(The)33 b(\014rst)g(part)f
(is)g(an)h(unformatted)e(c)m(har-)0 3303 y(acter)f(string,)g(kno)m(wn)h
(as)f(the)g(header,)h(whic)m(h)f(con)m(tains)g(the)g(sizes)h(and)e
(names)h(of)f(all)f(the)i(follo)m(wing)0 3423 y(diagnostics.)41
b(The)28 b(second)g(part)f(are)g(the)g(diagnostics)f(themselv)m(es,)k
(written)d(as)g(unformatted)f(\014xed)0 3544 y(length)31
b(records)i(in)d(exactly)i(the)g(same)g(order)g(as)f(in)g(the)h
(header.)44 b(By)32 b(coun)m(ting)f(along)g(the)h(header,)0
3664 y(the)k(desired)f(diagnostic)f(can)i(then)f(b)s(e)h(directly)e
(accessed)k(from)c(the)h(dataset)h(b)m(y)g(the)f(diagnostics)0
3784 y(reading)24 b(program.)39 b(The)25 b(header)g(is)f(written)g(out)
g(using)g(utilit)m(y)e(routines)i Fw(WR)-9 b(TCHA)23
b Fv(and)h Fw(WR)-9 b(T-)0 3905 y(NUM)39 b Fv(and)g(follo)m(ws)e(the)j
(basic)e(rules)h(outlined)f(in)g(T)-8 b(able)38 b(6)h(b)s(elo)m(w.)62
b(The)40 b(headers)g(for)e(2-D)f(and)0 4025 y(3-D)30
b(\014eld)g(diagnostics)g(are)h(written)g(b)m(y)h Fw(WR)-9
b(T2DHEAD)28 b Fv(and)j Fw(WR)-9 b(T3DHEAD)28 b Fv(resp)s(ectiv)m(ely)
-8 b(.)p 291 4152 3198 7 v 341 4236 a(Header)33 b(Characters)101
b(Meaning)p 291 4279 V 341 4363 a(60ZN)663 b(1-D)31 b(diagnostic)g(of)i
(ZN,)f(length)g(60)341 4483 y(60,60U2D[K=2])219 b(2-D)31
b(diagnostic)g(of)i(U)f(on)h(lev)m(el)f(2,)g(size)h(60)p
Fm(\002)p Fv(60)341 4604 y(60,60,60W)446 b(3-D)31 b(diagnostic)g(of)i
(W,)f(size)h(60)p Fm(\002)p Fv(60)p Fm(\002)p Fv(60)341
4724 y(60X,Y,Z)536 b(1-D)31 b(diagnostics)h(of)g(X,)h(Y)f(and)h(Z)f
(all)f(of)h(length)g(60)341 4845 y(&)818 b(End)33 b(of)f(header)i
(phrase,)f(next)h(diagnostic)d(written)h(in)m(to)1235
4965 y(un\014nished)i(record)341 5085 y(.)867 b(End)33
b(of)f(header)i(phrase,)f(next)h(diagnostic)d(starts)i(in)f(new)1235
5206 y(record)341 5326 y(:)867 b(End)33 b(of)f(header)p
291 5369 V 30 5637 a(T)-8 b(able)32 b(6:)43 b(The)34
b(meanings)d(of)h(the)h(c)m(haracters)h(used)g(in)e(the)h(header)g
(part)f(of)h(the)g(diagnostics)e(\014le.)146 5858 y(F)-8
b(ollo)m(wing)33 b(completion)h(of)h(the)h(header,)h(data)e(is)g
(written)h(out)f(using)h(the)g(follo)m(wing)c(routines:)1841
6107 y(28)p eop
%%Page: 29 32
29 31 bop 0 52 a Fw(W)m(OUT1D)41 b Fv(for)f(1-D)f(arra)m(y)-8
b(,)43 b Fw(W)m(OUT2D)e Fv(for)f(a)g(2-D)g(\014eld,)i
Fw(W)m(OUT3D)f Fv(for)f(a)g(3-D)g(\014eld)g(and)0 173
y Fw(W)m(OUTSURF)30 b Fv(for)g(a)g(2-D)e(surface)j(in)f(the)g
Fn(x)p Fv(-)p Fn(y)j Fv(plane,)d(suc)m(h)i(as)e(precipitation)e(or)i
(surface)h(\015uxes.)0 293 y(These)45 b(are)e(con)m(trol)f(routines)i
(and)f(the)g(actual)g(writing)e(of)i(data,)i(in)e(the)g(form)f(of)h
(\014xed)h(length)0 414 y(records,)30 b(to)e(the)g(diagnostics)g
(\014le)f(is)h(carried)g(out)f(b)m(y)i Fw(WR)-9 b(TFB)p
Fv(.)28 b Fw(WR)-9 b(TFB)27 b Fv(requires)i(input)e(of)h(the)0
534 y(data)40 b(\(R4IN\),)g(an)g(arra)m(y)g(one)g(record)h(length)e
(long)g(\(R4)h(in)f Fw(WR)-9 b(TFB)39 b Fv(but)h(BLK)g(outside\),)i
(the)0 654 y(record)30 b(length)f(\(IREC)h(in)f Fw(WR)-9
b(TFB)p Fv(,)28 b(LENBLK)i(outside\),)g(the)g(p)s(oin)m(t)e(at)i(whic)m
(h)g(to)f(start)g(writing)0 775 y(if)h(an)h(incomplete)f(record)i
(\(IST)-8 b(AR)g(T\))32 b(and)f(a)g(\015ag)g(\(IFEND=1\))g(to)g
(\014nish)g(writing)f(an)h(incomplete)0 895 y(record)39
b(if)e(required.)62 b(The)39 b(length)f(of)g(R4IN)g(is)g(NEL)-8
b(TS.)40 b(Firstly)-8 b(,)38 b(the)h(n)m(um)m(b)s(er)g(of)f(records)h
(to)f(b)s(e)0 1016 y(\014lled)32 b(\(NRECS\))i(is)e(calculated,)h
(taking)f(in)m(to)g(accoun)m(t)i(an)m(y)g(incomplete)e(records.)45
b(Then,)35 b(lo)s(oping)0 1136 y(o)m(v)m(er)h(NRECS,)g(and)g(from)e
(IST)-8 b(AR)g(T)36 b(to)e(IREC,)i(the)g(data)f(is)f(assigned)i(from)e
(R4IN)h(to)g(R4.)50 b(R4)35 b(is)0 1256 y(assigned)28
b(to)f(a)g(single)g(precision)g(arra)m(y)-8 b(,)28 b(R4SNGL,)f(whic)m
(h)h(is)f(written)h(out.)41 b(Once)29 b(all)c(the)j(complete)0
1377 y(records)34 b(ha)m(v)m(e)g(b)s(een)g(written)f(out)f(in)g(this)h
(w)m(a)m(y)-8 b(,)34 b(the)f(incomplete)f(record)h(is)g(written)g(and)g
(IST)-8 b(AR)g(T)0 1497 y(set)46 b(to)e(its)g(new)i(v)-5
b(alue.)80 b(The)45 b(incomplete)f(record)h(is)f(not)h(written)g(out)f
(un)m(til)g(the)h(next)h(call)d(to)0 1617 y Fw(WR)-9
b(TFB)p Fv(.)32 b(Mean)m(while,)h(the)g(data)f(for)g(that)g(record)h
(is)f(stored)h(in)f(BLK.)146 1858 y(F)-8 b(urther)28
b(discussion)h(of)e(these)j(diagnostic)c(routines)i(and)h(the)f(mec)m
(hanisms)g(for)f(calculating)f(the)0 1979 y(data)32 b(is)g(describ)s
(ed)i(in)d(the)i(follo)m(wing)d(sections.)0 2388 y Fp(5.1)135
b(Instan)l(taneous)46 b(Diagnostics)0 2693 y Fv(Mo)s(del)35
b(\014elds)h(and)f(other)h(deriv)m(ed)g(quan)m(tities)g(can)g(b)s(e)f
(output)h(in)f(the)h(diagnostic)e(\014le)h(with)g(their)0
2813 y(instan)m(taneous)29 b(v)-5 b(alue)27 b(at)g(the)i(diagnostic)d
(time.)41 b(The)29 b(\015ag)e(to)h(output)g(the)g(mo)s(del)f(\014eld)g
(diagnostics)0 2934 y(is)f(IDGX,)f(where)j(X)e(is)g(the)g(v)-5
b(ariable)25 b(name)h(\(e.g.)41 b(IDGU\),)26 b(input)g(through)g
(namelist)e(DIA)m(GNOST.)0 3054 y(If)32 b(IDGX=1)g(only)g(1-D)f
(pro\014les)i(of)f(the)h(horizon)m(tal)e(a)m(v)m(erage)i(will)d(b)s(e)j
(output;)g(if)e(IDGX=2)h(then)h(a)0 3174 y(series)28
b(of)g(2-D)e(slices)h(as)h(sp)s(eci\014ed)h(in)e(the)h(arra)m(ys)g
(XTEST,)i(YTEST)f(and)f(ZTEST)g(in)f(DIA)m(GNOST)0 3295
y(will)k(b)s(e)i(output;)h(if)e(IDGX=3)g(then)h(the)h(full)d(3-D)h
(\014eld)h(is)f(output.)45 b(F)-8 b(or)33 b(IDGX=1)f(the)h(horizon)m
(tal)0 3415 y(mean)k(calculated)g(in)g(the)h(mo)s(del)e(\(OLZUBAR)h
(etc\))h(is)f(written)h(out)f(using)g Fw(W)m(OUT1D)p
Fv(,)h(whic)m(h)0 3536 y(con)m(tains)30 b(a)h(single)e(call)f(to)i
Fw(WR)-9 b(TFB)p Fv(.)30 b Fw(W)m(OUT2D)g Fv(on)g(the)h(other)g(hand)f
(needs)i(to)e(write)h(out)f(2-D)0 3656 y(slices)39 b(from)g(the)h(mo)s
(del)e(\014elds)h(in)g(an)m(y)i(of)e(the)h Fn(x)p Fv(-)p
Fn(z)t Fv(,)i Fn(y)t Fv(-)p Fn(z)h Fv(or)c Fn(x)p Fv(-)p
Fn(y)k Fv(planes,)e(and)f(this)f(is)g(p)s(erformed)0
3776 y(b)m(y)46 b(calls)e(to)h Fw(WR)-9 b(TXZ)p Fv(,)45
b Fw(WR)-9 b(TYZ)44 b Fv(and)h Fw(WR)-9 b(TXY)p Fv(,)44
b(resp)s(ectiv)m(ely)-8 b(.)83 b(The)46 b Fn(y)t Fv(-)p
Fn(z)j Fv(plane)c(is)f(fairly)0 3897 y(trivial,)37 b(as)h(this)g(is)f
(the)i(orien)m(tation)d(of)i(slices)g(stored)g(in)g(the)g(mo)s(del,)g
(and)g(the)h(problem)e(reduces)0 4017 y(to)46 b(iden)m(tifying)f(whic)m
(h)i(slice)f(\(on)g(whic)m(h)h(PE\))g(is)f(required)h(and)f(then)h
(writing)e(it)g(out)i(through)0 4138 y Fw(WR)-9 b(TFB)p
Fv(.)36 b(W)-8 b(riting)34 b(out)j Fn(x)p Fv(-)p Fn(z)k
Fv(planes)36 b(,in)g Fw(WR)-9 b(TXZ)p Fv(,)36 b(is)g(more)g
(complicated)f(as)i(not)f(only)g(is)g(the)0 4258 y(data)f(distributed)g
(on)g(all)e(PEs,)k(but)e(needs)i(rearranging)d(so)h(that)g
Fn(x)h Fv(is)f(the)g(\014rst)h(dimension)e(\(it)g(is)0
4378 y(normally)39 b(the)j(third)f(dimension)f(in)h(the)h(mo)s(del)e
(\014eld)i(v)-5 b(ariables\).)69 b(The)42 b(data)g(is)f(transferred)h
(in)0 4499 y(stages)30 b(to)g(an)f(arra)m(y)h(TEMP)h(whic)m(h)f(is)g
(written)f(out)h(through)f Fw(WR)-9 b(TFB)p Fv(.)29 b(W)-8
b(riting)28 b(out)h(horizon)m(tal)0 4619 y(\()p Fn(x)p
Fv(-)p Fn(z)t Fv(\))35 b(slices,)f(in)g Fw(WR)-9 b(TXY)p
Fv(,)32 b(faces)j(a)f(similar)d(problem)h(but)j(no)m(w)g(a)f(single)f
(temp)s(orary)g Fn(x)p Fv(-)p Fn(y)k Fv(arra)m(y)0 4739
y(cannot)43 b(b)s(e)g(used)g(as)g(this)g(ma)m(y)f(cause)i(memory)e
(problems)f(for)i(v)m(ery)h(large)d(runs.)75 b(Instead,)46
b(the)0 4860 y(data)37 b(is)f(rearranged)h(in)m(to)f(I)s(IP*JJPEP)j(c)m
(h)m(uc)m(ks)h(and)d(then)g(written)g(out)g(b)m(y)h Fw(WR)-9
b(TFB)36 b Fv(a)g(section)0 4980 y(at)30 b(a)h(time.)41
b(More)31 b(details)f(of)g(the)h(MPP)h(asp)s(ects)g(of)e(these)i
(diagnostics)e(routines)h(are)g(describ)s(ed)g(in)0 5101
y(Section)g(6.2.)43 b(3-D)29 b(\014elds)j(are)f(written)g(out)g(in)f
Fw(W)m(OUT3D)h Fv(b)m(y)h(calling)c Fw(WR)-9 b(TXY)30
b Fv(in)g(a)h(lo)s(op)e(o)m(v)m(er)0 5221 y(K.)36 b(Because)i(the)f(Q)f
(\014elds)g(are)h(dimensioned)e(\(J,K,IQ,I\),)i(where)g(IQ)g(represen)m
(ts)i(the)d(n)m(um)m(b)s(er)h(of)0 5341 y(the)31 b(Q)g(\014eld,)g(they)
h(need)g(to)f(b)s(e)g(pro)s(cessed)i(b)s(efore)e(passing)g(to)f(the)i
Fw(W)m(OUT2D)f Fv(and)g Fw(W)m(OUT3D)0 5462 y Fv(routines.)45
b(This)34 b(is)e(done)i(b)m(y)g(passing)f(the)h(relev)-5
b(an)m(t)33 b(part)g(of)g(Q)f(to)h(another)h(arra)m(y)-8
b(,)33 b(FIELD,)g(whic)m(h)0 5582 y(stores)d(the)f(\014eld)f(to)g(b)s
(e)h(output,)h(b)s(efore)e(these)i(calls.)41 b(In)29
b Fw(W)m(OUT2D)g Fv(and)f Fw(W)m(OUT3D)h Fv(the)g(input)0
5702 y(\014eld)j(\(FIN\))f(is)g(assigned)h(to)g(FIELD,)f(but)h(in)f
(the)h(case)h(with)e(the)h(Q)g(\014elds)g(a)f(\015ag,)h(L)p
3217 5702 30 4 v 35 w(INFIELD,)g(is)0 5823 y(set)h(to)g(true)f(so)h
(that)g(that)f(assignmen)m(t)g(is)g(skipp)s(ed.)1841
6107 y(29)p eop
%%Page: 30 33
30 32 bop 146 52 a Fv(Sev)m(eral)36 b(other)e(instan)m(taneous)i
(\014elds)f(deriv)m(ed)g(from)f(mo)s(del)f(\014elds)i(can)g(b)s(e)g
(output.)50 b(Fields)34 b(of)0 173 y(p)s(oten)m(tial)e(v)m(orticit)m(y)
i(\(PV\))g(can)g(b)s(e)h(calculated)e(in)g Fw(W)m(OUTPV)p
Fv(,)g(assigned)h(to)g(FIELD,)g(and)g(then)0 293 y(written)28
b(out)g(via)g(calls)f(to)h(either)g Fw(W)m(OUT2D)h Fv(or)f
Fw(W)m(OUT3D)p Fv(.)g(Single)f(2-D)g(horizon)m(tal)g(\014elds)h(can)0
414 y(b)s(e)34 b(output)f(using)g(the)h(routine)f Fw(W)m(OUTSURF)p
Fv(.)h(Options)f(include)g(precipitation,)f(w)m(ater)i(paths,)0
534 y(top)i(and)g(b)s(ottom)e(of)h(the)h(atmosphere)g(radiativ)m(e)f
(\015uxes)j(and)d(surface)i(heat)f(\015uxes.)55 b(The)37
b(surface)0 654 y(heat)28 b(\015uxes)i(are)f(recalculated)e(in)h
Fw(DIA)m(G)f Fv(b)m(y)j(storing)d(the)i(di\013usivit)m(y)e(at)h(the)h
(surface)g(in)f(the)g(arra)m(y)0 775 y(DIFF)p 244 775
30 4 v 34 w(DG.)37 b Fw(W)m(OUTSURF)g Fv(writes)h(the)g(input)f
(\014eld)g(in)m(to)g(FIELD,)g(assigns)h(halo)s(es)f(if)f(required)0
895 y(and)d(then)g(writes)g(out)f(via)g(a)g Fw(WR)-9
b(TXY)31 b Fv(call.)146 1136 y(Instan)m(taneous)50 b(v)-5
b(alues)47 b(of)h(the)g(conditionally-sampled)c(diagnostics)i(are)i
(also)f(written)h(out)0 1256 y(direct)37 b(from)e Fw(DIA)m(G)h
Fv(b)m(y)i(calls)e(to)g Fw(W)m(OUT1D)p Fv(.)h(These)i(are)e(useful)g
(in)f(budget)h(calculations)e(and)0 1377 y(are)44 b(distinguished)e
(from)h(the)h(usual)f(time-a)m(v)m(eraged)g(conditionally-sampled)d
(diagnostics)i(b)m(y)j(a)0 1497 y(pre\014x)34 b(of)e(the)h(letter)f(I.)
0 1906 y Fp(5.2)135 b(Time-Av)l(eraged)46 b(Diagnostics)0
2211 y Fv(Domain)38 b(a)m(v)m(eraged)j(v)m(ertical)f(pro\014les)g(of)g
(v)-5 b(arious)40 b(quan)m(tities)g(can)h(also)e(b)s(e)i(a)m(v)m
(eraged)g(o)m(v)m(er)h(time.)0 2332 y(This)22 b(is)f(particularly)f
(useful)i(for)f(remo)m(ving)g(timestep-to-timestep)e(v)-5
b(ariabilit)m(y)19 b(in)i(quasi-equilibrium)0 2452 y(studies.)45
b(These)35 b(time-a)m(v)m(eraged)d(pro\014les)h(are)g(a)g(ma)5
b(jor)32 b(comp)s(onen)m(t)h(of)f(the)h(diagnostic)f(output)h(of)0
2573 y(the)i(LEM.)h(They)g(are)f(con)m(trolled)f(b)m(y)i(the)f(v)-5
b(ariable)33 b(IDGA)-11 b(V)35 b(in)f(namelist)f(DIA)m(GNOST,)i(and)g
(are)0 2693 y(reset)f(after)e(eac)m(h)h(TIMRDG)g(v)-5
b(alue)32 b(in)g(the)h(TIMENML)h(namelist.)146 2934 y(The)45
b(time-a)m(v)m(eraging)c(w)m(orks)k(b)m(y)f(calculating)d(instan)m
(taneous)j(diagnostic)e(v)-5 b(alues)43 b(ev)m(ery)i(NN)0
3054 y(steps,)35 b(assigning)d(them)h(to)g(DGNEW)g(and)g(then)h(adding)
e(these)j(to)d(a)h(running)g(a)m(v)m(erage)h(of)f(the)h(di-)0
3174 y(agnostics,)24 b(DGA)-11 b(V.)22 b(Eac)m(h)h(diagnostic)e(o)s
(ccupies)i(space)h(in)d(DGNEW)h(and)h(DGA)-11 b(V)21
b(indexed)j(b)m(y)f(a)f(dif-)0 3295 y(feren)m(t)j(v)-5
b(ariable)22 b(for)h(eac)m(h)i(diagnostic.)39 b(These)26
b(v)-5 b(ariables)23 b(are)g(held)h(in)f(common)g(blo)s(c)m(k)g(DGCNT)h
(and)0 3415 y(ha)m(v)m(e)31 b(index)e(v)-5 b(alues)29
b(determined)g(b)m(y)h(calls)e(to)h Fw(ALLOCA)-9 b(TE)29
b Fv(in)f(subroutine)i Fw(ALLOCDGS)f Fv(\(see)0 3536
y(Section)h(3.5\).)42 b(The)31 b(name)f(of)g(the)g(diagnostic)f(is)g
(assigned)i(to)f(the)g(c)m(haracter)h(arra)m(y)-8 b(,)31
b(CHA)-11 b(V,)31 b(again)0 3656 y(b)m(y)40 b(using)g(the)f(allo)s
(cated)f(index.)64 b(The)41 b(diagnostics)d(are)i(calculated)e(and)i
(assigned)g(to)f(DGNEW)0 3776 y(in)e(subroutines)i Fw(RESDGS)p
Fv(,)e Fw(SUBDGS)h Fv(and)g Fw(PDGS)g Fv(called)f(from)f
Fw(NNSTEPS)p Fv(.)h Fw(RESDGS)0 3897 y Fv(nominally)d(calculates)j
(diagnostics)f(of)h(the)g(resolv)m(ed)i(\014elds,)f Fw(SUBDGS)g
Fv(calculates)e(diagnostics)0 4017 y(of)d(the)g(subgrid)g(mo)s(del)e
(and)i Fw(PDGS)g Fv(calculates)f(diagnostics)g(in)m(v)m(olving)g
(pressure)j(and,)e(hence,)i(is)0 4138 y(called)e(after)h
Fw(POISSON)f Fv(\(see)i(Figs.)f(4)f(and)h(5\).)48 b(These)36
b(three)f(diagnostic)d(subroutines)j(are)f(only)0 4258
y(called)f(when)j(on)e(the)h(last)e(pass)i(of)f(the)h(N-lo)s(op)e(in)g
Fw(NNSTEPS)p Fv(.)g(DGNEW)h(is)g(initialised)d(at)j(the)0
4378 y(b)s(eginning)27 b(of)g(the)i(I-lo)s(op)d(b)m(y)j(the)f(call)e
(to)i Fw(INDGNEW)p Fv(.)e(Note)j(that)e Fw(RESDGS)h Fv(and)g
Fw(SUBDGS)0 4499 y Fv(are)j(only)f(called)g(for)h(the)g(I=1)g(to)f(I)s
(IPEP)j(p)s(ortion)c(of)i(the)g(I-lo)s(op.)41 b(The)32
b(v)-5 b(alues)31 b(from)f(DGNEW)g(are)0 4619 y(then)g(incremen)m(ted)g
(to)f(DGA)-11 b(V)29 b(in)g(subroutine)g Fw(A)-12 b(VDG)29
b Fv(called)f(righ)m(t)g(at)i(the)f(end)i(of)e Fw(NNSTEPS)p
Fv(.)0 4739 y(DGA)-11 b(V)32 b(is)g(a)h(running)f(a)m(v)m(erage,)i(so)f
(is)f(incremen)m(ted)h(b)m(y)h(m)m(ultiplying)29 b(the)k(old)f(v)-5
b(alue)32 b(of)g(DGA)-11 b(V)33 b(b)m(y)0 4860 y(the)c(time)e(since)h
(the)h(diagnostics)f(w)m(ere)h(last)f(reset)h(\(TIMEA)-11
b(V\))30 b(and)e(incremen)m(ting)g(with)g(DGNEW)0 4980
y(m)m(ultiplied)d(b)m(y)k(the)g(time)d(since)j(the)g(last)e(a)m(v)m
(eraging)h(\(TIMEDG\))g(then)h(dividing)d(b)m(y)j(the)g(total)e(new)0
5101 y(a)m(v)m(eraging)41 b(time)e(\(TIMEA)-11 b(V+TIMEDG\).)43
b(TIMEA)-11 b(V)42 b(is)f(incremen)m(ted)g(at)g(the)g(end)g(of)g
Fw(A)-12 b(VDG)p Fv(.)0 5221 y(DGA)h(V)42 b(is)g(reset)h(to)f(zero)h
(in)e(subroutine)i Fw(INDGA)-12 b(V)p Fv(.)41 b(This)h(is)g(called)f
(from)g Fw(SST)-9 b(AR)g(T)42 b Fv(to)g(ini-)0 5341 y(tialise)29
b(the)i(diagnostics)g(and)g(also)f(from)g Fw(RETRIEVE)e
Fv(when)33 b(ITIMRDG,)e(the)g(\015ag)g(to)g(reset)h(the)0
5462 y(diagnostics,)27 b(is)g(set)h(to)e(1.)42 b(This)27
b(is)f(raised)h(in)g Fw(TESTTIME)f Fv(if)g(appropriate,)h(i.e.)g(if)f
(TIME)i(exceeds)0 5582 y(a)k(TIMRDG)h(v)-5 b(alue.)146
5823 y(The)34 b(user)f(can)g(add)g(their)f(o)m(wn)h(time-a)m(v)m
(eraged)f(diagnostic.)1841 6107 y(30)p eop
%%Page: 31 34
31 33 bop 119 52 a Fv(1.)49 b(Select)41 b(a)f(unique)h(index)f(v)-5
b(ariable)39 b(\(NYOURNAME)i(for)f(this)g(example\))g(and)g(add)h(to)f
(the)244 173 y(declarations)31 b(and)i(main)e(b)s(o)s(dy)h(of)h(common)
e(blo)s(c)m(k)h(DGCNT.)119 376 y(2.)49 b(Add)36 b(a)f(call)e(to)i
Fw(ALLOCA)-9 b(TE)34 b Fv(for)h(NYOURNAME)h(in)f(subroutine)g
Fw(ALLOCDGS)p Fv(.)h(As-)244 497 y(sign)c(CHA)-11 b(V\(NYOURNAME\))34
b(to)f(the)g(name)f(of)g(the)h(diagnostic.)119 700 y(3.)49
b(Insert)27 b(in)f Fw(RESDGS)p Fv(,)g Fw(SUBDGS)h Fv(or)f
Fw(PDGS)h Fv(as)f(appropriate)g(relev)-5 b(an)m(t)27
b(co)s(de)f(to)h(calculate)244 820 y(y)m(our)22 b(diagnostic,)h(suc)m
(h)g(as)f(DGNEW\(K,NYOURNAME\)=DGNEW\(K,NYOURNAME\))244
941 y(+)32 b(whatev)m(er.)146 1265 y(The)39 b(size)g(of)e(arra)m(ys)i
(DGNEW)f(and)g(DGA)-11 b(V)38 b(is)g(dimensioned)f(b)m(y)i(NDGSP)-8
b(.)38 b(This)g(parameter)0 1385 y(ma)m(y)27 b(ha)m(v)m(e)h(to)f(b)s(e)
g(increased)h(dep)s(ending)f(on)g(the)g(n)m(um)m(b)s(ers)h(of)f
(diagnostics)f(selected/added.)43 b(There)0 1505 y(is)37
b(a)f(trap)h(in)f Fw(ALLOCDGS)i Fv(whic)m(h)f(will)e(call)g
Fw(EXXIT)h Fv(but)h(also)f(output)h(the)h(correct)g(v)-5
b(alue)36 b(of)0 1626 y(NDGSP)c(to)g(use)i(if)d(the)i(original)d(v)-5
b(alue)32 b(is)g(to)s(o)g(small.)0 2035 y Fp(5.3)135
b(Conditionally)47 b(Sampled)e(Diagnostics)0 2340 y Fv(A)36
b(signi\014can)m(t)g(subset)i(of)e(the)h(time-a)m(v)m(eraged)f
(diagnostics)f(can)i(also)e(b)s(e)i(conditionally)c(sampled.)0
2460 y(Rather)28 b(than)f(a)m(v)m(erages)i(o)m(v)m(er)g(the)f(whole)g
(horizon)m(tal)e(domain,)h(they)h(are)g(a)m(v)m(erages)h(only)e(o)m(v)m
(er)i(those)0 2581 y(p)s(oin)m(ts)38 b(whic)m(h)h(satisfy)g(certain)f
(criteria,)h(for)f(example,)h(ascending)g(and)g(p)s(ositiv)m(ely)e(buo)
m(y)m(an)m(t.)63 b(In)0 2701 y(addition,)24 b(the)g(diagnostics)f(can)i
(b)s(e)f(a)m(v)m(eraged)h(o)m(v)m(er)g(sp)s(eci\014c)f(columns)g(whic)m
(h)g(satisfy)g(some)g(criteria,)0 2822 y(and)42 b(these)h(diagnostics)e
(are)g(referred)i(to)e(as)h(column)f(classi\014ed.)71
b(Both)41 b(conditionally)e(sampled)0 2942 y(and)f(column)g
(classi\014ed)g(diagnostics)f(are)h(activ)-5 b(ated)38
b(b)m(y)h(setting)f(the)h(parameter)f(IDGDEEP=1;)0 3062
y(for)46 b(column)f(classi\014ed)i(diagnostics)f(additionally)d
(ICLASSP=1.)87 b(The)47 b(n)m(um)m(b)s(er)g(of)f(partitions)0
3183 y(requested)51 b(for)d(b)s(oth)h(t)m(yp)s(es)h(of)e(conditional)f
(diagnostics)g(are)i(input)g(b)m(y)g(the)h(user)f(in)f(v)-5
b(ariable)0 3303 y(NUPDO)m(WN)39 b(in)e(namelist)f(DIA)m(GNOST,)i(with)
g(CUPDO)m(WN\(1:NUPDO)m(WN\))h(con)m(taining)e(the)0
3424 y(three)c(letter)e(iden)m(ti\014ers)h(of)g(eac)m(h)h(partition)c
(supp)s(orted.)45 b(These)33 b(are)f(de\014ned)i(in)d(Section)h(4.1.14)
f(of)0 3544 y(the)i(User)g(Do)s(cumen)m(tation)e(\(Gra)m(y)i(and)f(P)m
(etc)m(h)j(2001\).)146 3785 y(The)26 b(conditionally)21
b(sampled)j(diagnostics)g(are)h(calculated)e(in)h Fw(RESDGS)p
Fv(.)g(These)j(are)d(assigned)0 3905 y(to)38 b(DGNEW)h(in)e(the)i(same)
g(w)m(a)m(y)h(as)e(the)h(time-a)m(v)m(eraged)f(diagnostics,)i(using)e
(indices)g(de\014ned)i(in)0 4025 y(DGCNT.)33 b(As)g(a)f(general)g
(rule,)h(indices)f(for)g(the)h(conditional)d(diagnostics)i(b)s(egin)g
(LX.)h(Eac)m(h)g(index)0 4146 y(is)i(allo)s(cated)f(with)i(NUPDO)m(WN)g
(spaces)i(in)d(DGNEW)g(and)h(DGA)-11 b(V)35 b(in)g(routine)h
Fw(ALLOCDGS)p Fv(,)0 4266 y(except)43 b(for)e(diagnostics)f(asso)s
(ciated)h(with)g(Q)g(\014elds)h(whic)m(h)g(require)f(NQP*NUPDO)m(WN)h
(space.)0 4387 y(As)d(there)f(are)g(up)m(w)m(ards)i(of)e(thirt)m(y)g
(diagnostics)f(that)h(can)g(b)s(e)g(conditionally)d(sampled,)k(and)f(o)
m(v)m(er)0 4507 y(t)m(w)m(en)m(t)m(y-\014v)m(e)c(default)29
b(partitions,)g(the)i(n)m(um)m(b)s(er)g(of)e(diagnostics)h(can)g(quic)m
(kly)h(increase,)g(and)f(it)g(ma)m(y)0 4627 y(often)j(b)s(e)f
(necessary)j(to)e(increase)g(NDGSP)-8 b(.)146 4868 y(The)25
b(partitioning)20 b(is)j(carried)f(out)i(in)e Fw(RESDGS)p
Fv(.)h(Firstly)-8 b(,)24 b(the)g(partitions)d(selected)k(b)m(y)f(the)g
(user)0 4988 y(are)g(iden)m(ti\014ed)g(b)m(y)i(setting)e(logical)d
(arra)m(ys)k(for)e(eac)m(h)i(partition.)39 b(F)-8 b(or)24
b(eac)m(h)h(mo)s(del)d(p)s(oin)m(t,)k(the)e(v)-5 b(arious)0
5109 y(quan)m(tities)36 b(whic)m(h)h(are)g(used)g(to)f(de\014ne)i(the)f
(partitions)d(are)j(calculated)e(are)i(assigned)f(to)h(scalars.)0
5229 y(Then)27 b(the)e(logical)e(v)-5 b(ariable,)25 b(L)p
1159 5229 30 4 v 35 w(UPD)m(WN,)h(is)f(assigned)g(dep)s(ending)h(on)f
(whic)m(h)h(partitions)e(are)h(b)s(eing)0 5350 y(used)h(and)f(whether)h
(the)f(mo)s(del)e(p)s(oin)m(t)h(satis\014es)i(the)f(conditions)f(for)g
(that)g(partition.)39 b(If)25 b(L)p 3366 5350 V 35 w(UPD)m(WN)0
5470 y(for)41 b(that)g(partition)e(is)h(true)i(the)g(DGNEW)e(v)-5
b(alues)42 b(are)f(appropriately)f(incremen)m(ted.)69
b(Pressure)0 5590 y(gradien)m(t)29 b(diagnostics)g(are)h(calculated)f
(in)h Fw(PDGS)p Fv(.)f(Rather)h(than)g(determine)g(the)g(partitions)e
(for)i(a)0 5711 y(second)j(time)c(in)i Fw(PDGS)g Fv(the)h(v)-5
b(alues)31 b(of)g(L)p 1624 5711 V 35 w(UPD)m(WN)g(are)h(stored)g(in)e
(the)i(four)f(dimensional)d(arra)m(y)-8 b(,)0 5831 y(L)p
67 5831 V 35 w(UPD)m(WN4D)33 b(and)f(passed)i(to)e Fw(PDGS)h
Fv(via)f(common)f(blo)s(c)m(k)h(DGSTORE.)1841 6107 y(31)p
eop
%%Page: 32 35
32 34 bop 146 52 a Fv(The)44 b(partitions)e(for)g(the)i
(column-classi\014ed)d(diagnostics)h(are)h(determined)g(using)g(the)g
(arra)m(y)0 173 y(ICLASS.)48 b(This)f(con)m(tains)g(in)m(teger)g(v)-5
b(alues)47 b(for)g(eac)m(h)h(mo)s(del)d(column)h(iden)m(tifying)g(the)h
(column-)0 293 y(classi\014cation.)79 b(These)46 b(are)f(determined)g
(in)f(subroutine)h Fw(CLASSCOL)g Fv(whic)m(h)h(is)e(called)g(from)0
414 y Fw(NNSTEPS)27 b Fv(just)h(b)s(efore)g Fw(RESDGS)p
Fv(.)g Fw(CLASSCOL)h Fv(de\014nes)h(columns)d(as)h(con)m(v)m(ectiv)m(e)
i(or)e(strat-)0 534 y(iform)g(based)i(on)g(an)g(algorithm)c(deriv)m(ed)
31 b(b)m(y)g(Steiner)e(et)h(al)f(\(1995\))g(for)g(use)i(with)e(2)16
b(km)29 b(radar)h(data.)0 654 y(F)-8 b(or)30 b(the)h(algorithm)d(to)j
(b)s(e)g(applied)f(correctly)h(the)g(\014eld)g(of)f(surface)i
(precipitation)d(rate,)i(PRECIP)-8 b(,)0 775 y(has)25
b(to)g(b)s(e)g(a)m(v)m(eraged)h(on)m(to)e(a)h(2)16 b(km)24
b(radar)h(grid.)39 b(This)25 b(is)g(calculated)f(and)g(assigned)h(to)g
(PR)p 3368 775 30 4 v 35 w(RAD.)f(T)-8 b(o)0 895 y(determine)25
b(con)m(v)m(ectiv)m(e)j(columns)c(a)h(bac)m(kground)i(precipitation)c
(rate)i(for)g(the)h(radar)e(grid,)i(based)h(on)0 1016
y(the)d(mean)f(of)g(all)e(other)j(precipitating)d(p)s(oin)m(ts)j
(within)e(an)h(11)16 b(km)23 b(radius,)i(m)m(ust)f(b)s(e)g(calculated.)
39 b(This)0 1136 y(bac)m(kground)33 b(v)-5 b(alue)31
b(is)g(calculated)g(and)h(stored)g(in)f(PR)p 2071 1136
V 35 w(B.)h(Once)g(this)g(is)f(ac)m(hiev)m(ed,)i(the)f(\014rst)h(set)f
(of)0 1256 y(con)m(v)m(ectiv)m(e)i(columns)e(can)g(b)s(e)h(determined.)
43 b(Ho)m(w)m(ev)m(er,)35 b(for)c(eac)m(h)i(con)m(v)m(ectiv)m(e)i
(column)c(determined)0 1377 y(b)m(y)j(this)f(metho)s(d)f(all)f(adjacen)
m(t)j(columns)f(within)f(a)g(sp)s(eci\014ed)i(radius)f(\(stored)h(in)e
(CONRAD)p 3554 1377 V 35 w(V)-11 b(AL)0 1497 y(dep)s(ending)31
b(on)g(the)h(precipitation)d(rate,)j(CONRAD)p 2013 1497
V 35 w(THRES\))f(will)e(also)i(b)s(e)g(con)m(v)m(ectiv)m(e.)45
b(Finally)-8 b(,)0 1617 y(all)36 b(this)j(data)f(has)h(to)f(b)s(e)h
(passed)h(bac)m(k)f(from)f(the)h(2)16 b(km)38 b(radar)g(grid)g(to)g
(the)h(mo)s(del)e(grid.)60 b(Other)0 1738 y(column-classi\014cations)36
b(are)j(easier)g(to)g(determine,)h(based)g(on)f(liquid)e(w)m(ater)i(or)
g(ice)f(w)m(ater)i(paths)0 1858 y(for)32 b(shallo)m(w)g(cum)m(ulus)g
(or)h(trailing)c(an)m(vils)j(resp)s(ectiv)m(ely)-8 b(.)0
2267 y Fp(5.4)135 b(Microph)l(ysics)45 b(and)g(Radiation)h(Diagnostics)
0 2573 y Fv(There)38 b(are)f(a)f(n)m(um)m(b)s(er)i(of)e(time-a)m(v)m
(eraged)g(diagnostics)g(whic)m(h)h(are)g(sp)s(eci\014c)h(to)e(the)i
(microph)m(ysics)0 2693 y(and)h(radiation)d(sc)m(hemes.)64
b(If)39 b(the)g(parameter)g(ILA)-8 b(TENTDGP)39 b(is)g(set)g(equal)g
(to)f(1)h(then)g(the)h(mi-)0 2813 y(croph)m(ysics)k(tendency)g(terms)e
(are)g(output.)72 b(These)44 b(are)e(stored)h(in)e(DQ)p
2787 2813 V 35 w(DT,)h(for)g(the)g(net)h(w)m(ater)0 2934
y(sp)s(ecies)e(c)m(hanges)h(due)f(to)e(the)i(microph)m(ysics,)h(and)f
(DTH)p 2228 2934 V 35 w(DT)f(for)f(the)i(net)g(heating)e(rates;)45
b(b)s(oth)0 3054 y(arra)m(ys)f(are)f(held)g(in)g(common)f(blo)s(c)m(k)h
(DGSTORE.)g(They)i(are)e(calculated)f(in)h Fw(LA)-9 b(THEA)g(T)41
b Fv(for)0 3174 y(the)30 b(liquid)d(w)m(ater)j(condensation)g(term)e
(and)i Fw(LA)-9 b(TENTDG)28 b Fv(called)g(from)g Fw(MICR)m(O)m(X)g
Fv(for)h(all)e(the)0 3295 y(other)44 b(microph)m(ysics)g(con)m(v)m
(ersions)i(rates.)78 b(When)45 b(the)f(w)m(arm)g(rain)f
(parametrizations)e(are)j(used)0 3415 y(the)34 b(calculation)d(is)i(p)s
(erformed)g(in)g Fw(WLA)-9 b(TENTDG)31 b Fv(called)i(from)f
Fw(MICR)m(OPHYS)p Fv(.)g(Hydrom-)0 3536 y(eteor)i(fall)d(rates)i(can)h
(also)e(b)s(e)i(calculated)e(for)h(the)g(three-phase)i(microph)m(ysics)
e(sc)m(heme;)i(these)f(are)0 3656 y(stored)28 b(in)e(arra)m(y)h(F)-11
b(ALLQ)26 b(in)h(common)e(blo)s(c)m(k)i(DGSTORE)g(and)g(calculated)f
(in)g(calls)g(to)g(subroutine)0 3776 y Fw(PRECDIA)m(G)k
Fv(for)i(eac)m(h)i(h)m(ydrometeor)f(in)f(the)h(routine)f
Fw(MICR)m(O)m(X)p Fv(.)146 4017 y(When)43 b(the)f(column)f
(classi\014cation)f(is)i(switc)m(hed)h(on)f(\(ICLASSP=1\))g(useful)g
(2-D)f(diagnostic)0 4138 y(\014elds)i(are)g(calculated.)74
b(These)45 b(include)d(surface)i(precipitation)d(rate)i(\(PRECIP\),)i
(liquid)c(w)m(ater)0 4258 y(path)28 b(\(L)-11 b(WP\),)29
b(ice)e(w)m(ater)i(path)f(\(IWP\))h(and)f(cloud)g(top)f(heigh)m(t)h
(\(CTHEIGHT\))i(all)c(stored)i(in)g(com-)0 4378 y(mon)41
b(blo)s(c)m(k)g(CLASSY.)i(L)-11 b(WP)j(,)42 b(IWP)h(and)e(CTHEIGHT)i
(are)f(all)e(calculated)g(in)h(the)h(subroutine)0 4499
y Fw(CLASSSET)g Fv(whic)m(h)h(is)f(called)f(from)g(the)h(routine)g
Fw(PRECDIA)m(GSET)p Fv(.)e Fw(PRECDIA)m(GSET)0 4619 y
Fv(is)i(called)g(from)f Fw(MICR)m(O)m(X)h Fv(and)g(initialises)e(the)j
(F)-11 b(ALLQ)42 b(arra)m(ys.)74 b(PRECIP)44 b(is)f(just)g(the)g(sum)0
4739 y(of)34 b(eac)m(h)h(F)-11 b(ALLQ)35 b(at)f(the)h(nearest)g(mo)s
(del)e(lev)m(el)h(to)g(the)h(surface)g(and)g(is)f(calculated)f(in)h
(subroutine)0 4860 y Fw(CLASSPRECIP)22 b Fv(whic)m(h)i(is)f(called)f
(from)g Fw(PRECDIA)m(G)p Fv(.)f(Although)i(used)h(for)f(the)h(column)e
(clas-)0 4980 y(si\014cation,)27 b(instan)m(taneous)i(\014elds)e(of)g
(PRECIP)-8 b(,)29 b(IWP)-8 b(,)29 b(L)-11 b(WP)28 b(and)f(CTHEIGHT)i
(can)f(all)e(b)s(e)h(output)0 5101 y(from)36 b Fw(DIA)m(G)g
Fv(b)m(y)h(calls)f(to)g Fw(W)m(OUTSURF)h Fv(if)f(the)h(DIA)m(GNOST)g
(namelist)e(v)-5 b(ariable)35 b(IEXDG)i(is)0 5221 y(set)29
b(equal)f(to)f(1.)42 b(The)29 b(sum)f(of)f(surface)i(precipitation)d
(for)h(eac)m(h)i(h)m(ydrometeor)g(is)e(stored)i(in)e(v)-5
b(ariable)0 5341 y(PUDDLE.)40 b(PUDDLE)h(is)f(calculated)f(in)h
Fw(MICR)m(OPHYS)f Fv(or)h Fw(MICR)m(O)m(X)g Fv(dep)s(ending)h(on)f(the)
0 5462 y(microph)m(ysics)31 b(c)m(hoice)h(can)g(b)s(e)g(output)f(to)g
(the)h(diagnostics)f(\014le)g(if)f(IDGPD=1)g(in)h Fw(DIA)m(G)g
Fv(through)0 5582 y(a)f(call)e(to)i Fw(W)m(OUTPD)p Fv(.)g(This)g(is)g
(a)g(sp)s(ecialised)g(v)m(ersion)g(of)g Fw(W)m(OUTSURF)h
Fv(taking)e(in)m(to)h(accoun)m(t)0 5702 y(the)j(extra)g(indexing)f(of)g
(PUDDLE)g(with)h(the)g(h)m(ydrometeor)g(t)m(yp)s(e.)1841
6107 y(32)p eop
%%Page: 33 36
33 35 bop 146 52 a Fv(Radiation)37 b(diagnostics)i(can)g(b)s(e)h(activ)
-5 b(ated)38 b(b)m(y)j(setting)e(the)g(parameters)h(RAD)p
3244 52 30 4 v 34 w(DIA)m(GS)f(and)0 173 y(RAD)p 226
173 V 35 w(DIA)m(GS2.)69 b(Dep)s(ending)41 b(on)g(the)h(v)-5
b(alue)40 b(of)h(RAD)p 2136 173 V 35 w(DIA)m(GS)g(further)g(diagnostic)
f(\014elds)i(from)0 293 y(the)28 b(radiation)c(call)i(are)h(assigned)g
(in)g Fw(RAD)p 1656 293 34 4 v 39 w(LEM)p Fv(.)h(If)f(RAD)p
2308 293 30 4 v 34 w(DIA)m(GS=1)g(then)g(the)h(long-w)m(a)m(v)m(e)f
(and)0 414 y(short-w)m(a)m(v)m(e)33 b(heating)d(rates)i(are)f(stored)h
(separately)g(in)e(TWDRAD)h(and)g(SWDRAD)f(resp)s(ectiv)m(ely)-8
b(.)0 534 y(If)22 b(RAD)p 313 534 V 35 w(DIA)m(GS=2)f(then)i(2-D)e
(cross-sections)i(of)f(the)h(up)m(w)m(elling)e(and)h(do)m(wn)m(w)m
(elling)g(long-w)m(a)m(v)m(e)g(and)0 654 y(short-w)m(a)m(v)m(e)32
b(radiativ)m(e)d(\015uxes)j(at)e(the)h(surface)g(and)f(top)g(of)g(the)h
(atmosphere)f(\(toa\))g(are)g(calculated.)0 775 y(These)38
b(are)d(held)h(in)f(arra)m(ys)h(OLR)f(\(up)m(w)m(elling)g(longw)m(a)m
(v)m(e)h(at)g(toa\),)g(DSL)-11 b(W)35 b(\(do)m(wn)m(w)m(elling)h
(surface)0 895 y(longw)m(a)m(v)m(e\),)53 b(USL)-11 b(W)48
b(\(up)m(w)m(elling)f(surface)i(longw)m(a)m(v)m(e\),)k(DTSW)48
b(\(do)m(wn)m(w)m(elling)f(toa)h(short)m(w)m(a)m(v)m(e\),)0
1016 y(UTSW)c(\(up)m(w)m(elling)e(toa)g(short)m(w)m(a)m(v)m(e\),)49
b(DSSW)43 b(\(do)m(wn)m(w)m(elling)f(surface)i(short)m(w)m(a)m(v)m(e\))
i(and)d(USSW)0 1136 y(\(up)m(w)m(elling)32 b(surface)i(short)m(w)m(a)m
(v)m(e\).)48 b(Finally)-8 b(,)31 b(if)h(RAD)p 2000 1136
V 35 w(DIA)m(GS=3)h(then)g(the)h(full)e(up)m(w)m(elling,)g(do)m(wn-)0
1256 y(w)m(elling)24 b(and)h(net)h(\015uxes)h(are)f(stored)g(in)f
(TWFXUP)h(\(up)m(w)m(elling)e(longw)m(a)m(v)m(e\),)k(TWFXNT)e(\(net)g
(long-)0 1377 y(w)m(a)m(v)m(e\),)37 b(SWFXUP)e(\(up)m(w)m(elling)e
(short)m(w)m(a)m(v)m(e\),)k(SWFXDT)e(\(do)m(wn)m(w)m(elling)e(short)m
(w)m(a)m(v)m(e\),)38 b(SWFXNT)0 1497 y(\()46 b(net)h(short)m(w)m(a)m(v)
m(e\).)87 b(All)44 b(these)k(diagnostic)d(arra)m(ys)h(are)h(held)f(in)f
(common)g(blo)s(c)m(k)h(RAD)p 3484 1497 V 35 w(MOD.)0
1617 y(RAD)p 226 1617 V 35 w(DIA)m(GS)38 b(con)m(trols)h(the)g
(outputting)f(of)h(these)h(quan)m(tities)f(in)m(to)f(time-a)m(v)m
(eraged)g(diagnostics)0 1738 y(and)44 b(time-series,)i(whilst)d(RAD)p
1251 1738 V 34 w(DIA)m(GS2)h(con)m(trols)f(the)i(output)f(of)f(instan)m
(taneous)i(\014elds)f(from)0 1858 y Fw(DIA)m(G)p Fv(.)0
2265 y Fp(5.5)135 b(Timeseries)0 2570 y Fv(If)38 b(the)h(parameter)f
(ITSERP)h(is)f(set)h(equal)f(to)g(1)g(then)h(the)g(LEM)g(will)d(pro)s
(duce)j(timeseries)e(diag-)0 2690 y(nostics.)64 b(V)-8
b(ariables)39 b(asso)s(ciated)g(with)g(the)h(timeseries)f(diagnostics)f
(are)i(held)f(in)g(common)f(blo)s(c)m(k)0 2811 y(SERIES.)f(The)g
(timeseries)e(are)h(held)f(in)g(the)i(t)m(w)m(o-dimensional)c(arra)m(y)
j(SER;)g(the)h(\014rst)f(dimension)0 2931 y(represen)m(ts)27
b(the)e(n)m(um)m(b)s(er)g(of)f(times)g(\(NTIMP\))h(and)g(the)g(second)h
(dimension)d(the)i(maxim)m(um)d(n)m(um)m(b)s(er)0 3051
y(of)32 b(timeseries)g(\(NSERP\).)1029 3015 y Fs(2)146
3292 y Fv(The)e(timeseries)f(w)m(ork)g(in)g(a)f(similar)e(w)m(a)m(y)k
(to)f(the)g(time-a)m(v)m(eraged)g(diagnostics)f(with)g(eac)m(h)i(time-)
0 3413 y(series)46 b(b)s(eing)e(iden)m(ti\014ed)g(b)m(y)i(an)f(index)g
(v)-5 b(ariable)43 b(and)i(b)s(eing)g(allo)s(cated)d(an)j(index)g(v)-5
b(alue.)80 b(This)0 3533 y(allo)s(cation)41 b(pro)s(cess)46
b(tak)m(es)f(place)f(in)g(subroutine)h Fw(INTIMSER)e
Fv(called)g(from)g Fw(SET1D)p Fv(,)h(where)0 3653 y(the)37
b(names)g(of)g(the)g(timeseries,)h(CHTS,)g(are)f(set)h(and)f(SER)g
(initialised)c(to)k(zero.)57 b(The)38 b(timeseries)0
3774 y(themselv)m(es)c(are)e(calculated)f(in)h(routine)f
Fw(TIMSER)h Fv(called)f(ev)m(ery)j(NN)f(steps)h(from)d
Fw(NNSTEPS)p Fv(.)0 3894 y(Prop)s(erties)j(calculated)e(include)i
(domain)e(extremes,)j(means,)f(cloud)f(tops,)h(surface)h(and)f
(radiativ)m(e)0 4014 y(\015uxes.)54 b(One)36 b(timeseries,)g(b)m(y)h
(default)e(the)h(\014rst,)h(alw)m(a)m(ys)f(con)m(tains)g(the)g(time)e
(at)h(whic)m(h)h(the)g(other)0 4135 y(timeseries)j(are)h(calculated.)63
b(Man)m(y)41 b(of)e(the)h(timeseries)f(are)h(calculated)e(as)i(scalar)f
(v)-5 b(ariables)39 b(ini-)0 4255 y(tially)-8 b(,)35
b(whic)m(h)i(mak)m(es)g(it)e(easier)i(to)f(gather)g(the)h(information)c
(o)m(v)m(er)38 b(all)c(PEs)k(as)e(di\013eren)m(t)h(t)m(yp)s(es)h(of)0
4376 y(diagnostic)c(\(i.e.)i(maxima\))d(ma)m(y)j(require)g(di\013eren)m
(t)g(GCOM)g(calls.)52 b(SER)36 b(is)f(output)h(to)g(the)g(diag-)0
4496 y(nostics)j(\014le)f(b)m(y)i(a)e(call)f(to)h Fw(W)m(OUT1D)g
Fv(in)g Fw(DIA)m(G)p Fv(.)g(ITND)h(con)m(tains)f(the)h(index)g(in)f
(SER)h(of)f(the)0 4616 y(curren)m(t)c(timeslot,)c(and)j(only)f(v)-5
b(alues)33 b(of)f(SER)g(up)h(to)g(ITND)f(are)h(output)g(in)f(the)h
(diagnostics.)146 4857 y(The)h(user)f(can)g(add)g(their)f(o)m(wn)h
(timeseries)f(diagnostic:)119 5165 y(1.)49 b(Select)27
b(a)g(unique)h(index)f(v)-5 b(ariable)25 b(\(NTS)p 1766
5165 V 36 w(YOURNAME)j(for)f(this)f(example\))h(and)g(add)g(to)g(the)
244 5286 y(declarations)k(and)i(main)e(b)s(o)s(dy)h(of)h(common)e(blo)s
(c)m(k)h(SERIES.)119 5484 y(2.)49 b(Add)43 b(a)f(call)f(to)h
Fw(ALLOCA)-9 b(TE)42 b Fv(for)g(NTS)p 1893 5484 V 36
w(YOURNAME)h(in)f(subroutine)h Fw(INTIMSER)p Fv(.)244
5604 y(Assign)33 b(CHA)-11 b(V\(NTS)p 1076 5604 V 36
w(YOURNAME\))34 b(to)e(the)h(name)f(of)g(the)h(diagnostic.)p
0 5667 1512 4 v 112 5729 a Fh(2)149 5759 y Fg(Both)i(parameters)e
(NTIMP)h(and)g(NSERP)g(are)g(reduced)g(b)n(y)g(in)n(teger)g(arithmetic)
g(to)h(NTMP)f(and)h(NSRP)f(so)0 5858 y(that)28 b(the)g(size)f(of)h(SER)
f(is)h(minimised)g(when)f(timeseries)g(are)g(not)h(required.)1841
6107 y Fv(33)p eop
%%Page: 34 37
34 36 bop 119 52 a Fv(3.)49 b(Insert)41 b(in)f Fw(TIMSER)f
Fv(relev)-5 b(an)m(t)40 b(co)s(de)h(to)f(calculate)f(y)m(our)i
(diagnostic.)65 b(It)40 b(is)g(advisable)g(to)244 173
y(assign)d(this)h(to)f(a)g(lo)s(cal)f(scalar)h(\014rst,)i(and)f(then)g
(applying)f(an)m(y)h(message)g(passing)g(routines)244
293 y(to)32 b(that)g(scalar)g(b)s(efore)h(assigning)e(to)i(SER.)0
702 y Fp(5.6)135 b(Sp)t(ectra)45 b(Diagnostics)0 1008
y Fv(The)27 b(LEM)f(can)g(also)e(calculate)h(1-D)f(y-direction)g(sp)s
(ectra)j(of)e(U,)g(V,)h(W)g(and)g(TH.)g(This)f(is)h(con)m(trolled)0
1128 y(b)m(y)35 b(v)-5 b(ariable)33 b(IDGSP)i(in)e(the)i(DIA)m(GNOST)g
(namelist.)48 b(Again)33 b(a)i(similar)c(allo)s(cation)g(tec)m(hnique)
36 b(is)0 1248 y(used)g(to)e(the)h(time-a)m(v)m(eraged)e(diagnostics)h
(with)g(in)m(tegers)h(stored)g(in)f(common)f(blo)s(c)m(k)h(DGSPCNT)0
1369 y(represen)m(ting)29 b(indices)f(of)f(the)i(sp)s(ectra)g(arra)m
(ys)f(DGSPNEW)h(and)f(DGSP)-8 b(A)d(V.)28 b(Ho)m(w)m(ev)m(er,)j(eac)m
(h)e(sp)s(ec-)0 1489 y(tra)23 b(\014eld)h(can)g(b)s(e)g(calculated)f
(at)h(NSPLEVS)h(lev)m(els,)h(as)e(de\014ned)h(b)m(y)g(ZSP)f(through)g
(the)g(DIA)m(GNOST)0 1609 y(namelist.)41 b(The)32 b(ZSP)g(arra)m(y)f
(is)g(con)m(v)m(erted)i(to)e(an)g(arra)m(y)h(of)f(mo)s(del)e(lev)m
(els,)j(KSP)-8 b(,)32 b(in)e Fw(SETDIA)m(GS)p Fv(.)0
1730 y(Eac)m(h)39 b(sp)s(ectra)g(\014eld)f(is)g(allo)s(cated)e(NSPLEVS)
j(slots)f(in)f(routine)h Fw(ALLOCSP)p Fv(,)h(also)e(called)g(from)0
1850 y Fw(SETDIA)m(GS)p Fv(.)g(The)h(name)f(of)g(eac)m(h)i(sp)s(ectra)f
(diagnostic)e(is)h(stored)h(in)f(CHSP)-8 b(.)39 b(The)f(sp)s(ectra)g
(are)0 1971 y(calculated)43 b(in)g Fw(RESDGS)h Fv(and)g(assigned)g(to)f
(DGSPNEW.)i(F)-8 b(or)43 b(eac)m(h)i(w)m(a)m(v)m(en)m(um)m(b)s(er,)k
(NU,)44 b(the)0 2091 y(real)29 b(and)h(imaginary)e(part)i(of)f(the)i(F)
-8 b(ourier)29 b(in)m(tegral)f(is)i(calculated)f(and)h(assigned)h(to)f
(lo)s(cal)e(scalars,)0 2211 y(ANU,)c(BNU)h(etc,)h(whic)m(h)f(are)f
(then)g(squared)i(to)d(giv)m(e)h(the)h(sp)s(ectra)f(magnitude)f(in)g
(DGSPNEW.)i(The)0 2332 y(running)37 b(a)m(v)m(erage)i(is)e(calculated)g
(in)g Fw(A)-12 b(VDG)36 b Fv(and)i(assigned)g(to)f(DGSP)-8
b(A)d(V.)38 b(DGSP)-8 b(A)d(V)37 b(is)g(output)0 2452
y(b)m(y)c(a)g(call)e(to)h Fw(W)m(OUT1D)g Fv(in)g Fw(DIA)m(G)p
Fv(.)0 2861 y Fp(5.7)135 b(Animations)0 3166 y Fv(The)32
b(LEM)f(has)g(the)g(capabilit)m(y)e(to)i(pro)s(duce)g(diagnostic)f
(datasets)h(whic)m(h)h(can)f(b)s(e)g(used)h(to)e(displa)m(y)0
3287 y(animations)c(of)i(mo)s(del)f(\014elds.)42 b(This)29
b(has)g(b)s(een)g(designed)g(for)f(use)i(with)e(Vis5D)f(soft)m(w)m
(are,)k(although)0 3407 y(the)j(datasets)g(pro)s(duced)g(b)m(y)g(the)g
(LEM)g(could)f(b)s(e)h(p)s(ost-pro)s(cessed)g(for)f(most)g(animation)d
(soft)m(w)m(are)0 3528 y(pac)m(k)-5 b(ages.)146 3768
y(The)39 b(output)f(of)f(animation)e(\(or)i(mo)m(vie\))g(\014les)h(is)g
(con)m(trolled)e(b)m(y)j(the)f(parameter,)h(IMO)m(VIEP)-8
b(,)0 3889 y(and)50 b(the)f(v)-5 b(ariables)49 b(input)g(through)g
(namelist)f(MO)m(VD)m(A)-8 b(T)g(A.)50 b(These)h(are)f(\015ags)g(\(IMO)
m(VU)g(etc\))0 4009 y(whic)m(h)e(indicate)e(whic)m(h)i(\014elds)f(to)g
(output)g(to)g(the)h(mo)m(vie)e(\014les,)51 b(the)d(time)d(for)i(the)h
(\014rst)f(frame)0 4130 y(\(TIME)p 304 4130 30 4 v 36
w(MO)m(VIE\),)34 b(the)f(time)e(gap)i(b)s(eing)e(subsequen)m(t)36
b(frames)c(\(TIME)p 2722 4130 V 37 w(INC\))h(and)g(a)f(da)m(y)h(n)m(um)
m(b)s(er)0 4250 y(\(IST)-8 b(AR)g(TD)m(A)g(Y\))45 b(whic)m(h)g(is)f
(required)h(for)f(Vis5D.)f(The)j(diagnostic)d(\015ags)h(are)h(held)f
(in)g(common)0 4370 y(blo)s(c)m(k)32 b(MO)m(V)m(CNT,)j(whilst)d(other)h
(v)-5 b(ariables)31 b(are)h(k)m(ept)i(in)e(common)f(blo)s(c)m(k)i(MO)m
(VD)m(A)-8 b(T.)146 4611 y(There)25 b(are)f(t)m(w)m(o)h(streams)f(of)g
(output)g(for)f(the)h(mo)m(vie)g(\014les.)40 b(The)25
b(\014rst)f(is)g(the)g(output)g(of)g(the)g(mo)s(del)0
4731 y(\014elds)34 b(for)f(eac)m(h)h(frame.)46 b(This)34
b(is)f(p)s(erformed)g(in)g(subroutine)h Fw(MAKINGMO)m(VIES)e
Fv(called)h(from)0 4852 y Fw(NNSTEPS)h Fv(if)h(TIME)i(exceeds)h(TIME)p
1572 4852 V 36 w(MO)m(VIE.)f(The)f(\014rst)g(step)h(of)e
Fw(MAKINGMO)m(VIES)f Fv(is)0 4972 y(to)h(up)s(date)h(the)g(con)m(trol)f
(v)-5 b(ariables)34 b(for)h(the)h(\014le)g(output.)52
b(These)38 b(include)d(TIME)p 3103 4972 V 36 w(MO)m(VIE,)i(whic)m(h)0
5093 y(is)29 b(incremen)m(ted)h(to)f(the)g(time)f(of)h(the)h(next)g
(frame;)g(NFR)p 2144 5093 V 34 w(THISJOB,)h(whic)m(h)f(holds)f(the)g(n)
m(um)m(b)s(er)h(of)0 5213 y(frames)j(output)h(b)m(y)g(this)g(mo)s(del)d
(job;)j(and)g(RMO)m(VTIMES,)i(whic)m(h)e(holds)f(the)h(times)f(that)g
(frames)0 5333 y(ha)m(v)m(e)23 b(b)s(een)g(output)f(b)m(y)h(this)e
(job.)40 b(The)23 b(mo)s(del)d(\014elds)i(are)g(written)f(out)h(to)g(a)
f(di\013eren)m(t)h(\014le)g(for)f(eac)m(h)i(PE)0 5454
y(and)j(eac)m(h)h(mo)m(vie)e(frame.)40 b(F)-8 b(or)25
b(eac)m(h)i(\014eld)e(in)g(turn,)j(the)e(mo)s(del)e(data)i(is)f
(assigned)h(to)g(a)f(1-D)g(REAL*4)0 5574 y(arra)m(y)i(SLICEMO)m(V,)j
(and)d(this)g(is)g(written)g(out)g(to)g(the)g(unit)g(n)m(um)m(b)s(er)h
(for)e(that)h(PE)h(\(MYPEUNIT\).)0 5695 y(The)37 b(second)h(stream)e
(of)g(output)h(data)f(is)g(written)g(in)g(subroutine)h
Fw(MO)m(VIECNTL)e Fv(called)h(from)0 5815 y Fw(EXXIT)p
Fv(.)c(A)m(t)h(the)g(end)h(of)f(eac)m(h)g(job)g(details)f(of)h(the)g
(frames)g(are)g(written)g(out)f(to)h(unit)f(49.)45 b(This)33
b(is)1841 6107 y(34)p eop
%%Page: 35 38
35 37 bop 0 52 a Fv(a)32 b(con)m(trol)f(dataset)h(for)g(the)g(p)s
(ost-pro)s(cessing)g(soft)m(w)m(are,)i(and)e(con)m(tains)g(the)g(run)g
(n)m(um)m(b)s(er,)h(n)m(um)m(b)s(er)0 173 y(of)h(frames)h(in)f(the)h
(job,)g(n)m(um)m(b)s(er)g(of)g(v)-5 b(ariables,)34 b(the)h(v)-5
b(ariable)33 b(names,)j(the)f(da)m(ys)h(and)f(times)f(of)g(the)0
293 y(frames,)29 b(the)f(dimensions)f(of)g(the)i(data,)f(the)h(horizon)
m(tal)d(grid)h(spacing)h(and)g(the)g(v)m(ertical)f(grid.)41
b(Also)0 414 y(output)32 b(is)f(MO)m(VIEP)-8 b(AR)g(T)34
b(whic)m(h)e(iden)m(ti\014es)g(whic)m(h)g(section)g(of)f(the)h(mo)m
(vie)f(the)i(frames)e(comprise.)0 534 y(This)i(is)f(incremen)m(ted)h
(after)f(eac)m(h)i(con)m(trol)e(\014le)g(is)g(written)g(out.)146
775 y(The)d(p)s(ost-pro)s(cessing)g(of)e(the)i(mo)m(vie)e(\014les)i
(for)e(the)i(Vis5D)e(soft)m(w)m(are)i(is)f(not)g(trivial.)40
b(A)m(t)28 b(the)h(end)0 895 y(of)38 b(the)g(mo)s(del)f(job)h(the)g
(soft)m(w)m(are)h(is)f(called)f(whic)m(h)h(reads)h(in)f(the)g(\014les)g
(for)g(eac)m(h)h(of)f(the)g(PEs)h(and)0 1016 y(frames)27
b(and)g(reconstructs)i(it)e(in)f(a)h(Vis5D)f(format)g(\(the)h(5)g
(dimensions)g(b)s(eing)f(3)h(of)g(space,)i(time)d(and)0
1136 y(the)i(di\013eren)m(t)f(\014elds\).)42 b(Because)29
b(this)e(uses)h(soft)m(w)m(are)h(outside)e(of)g(the)g(LEM)h(it)e(is)h
(imp)s(ortan)m(t)e(to)i(note)0 1256 y(that)36 b(some)f(v)-5
b(alues,)37 b(suc)m(h)h(as)e(the)g(maxim)m(um)e(n)m(um)m(b)s(er)i(of)f
(v)-5 b(ariables,)36 b(are)g(necessarily)g(hardwired.)0
1377 y(Although)30 b(traps)i(are)f(in)f(place)h(to)g(ensure)i(the)f
(user)g(do)s(es)f(not)g(un)m(wittingly)f(cause)i(an)g(error)f(in)f(the)
0 1497 y(p)s(ost-pro)s(cessing)d(soft)m(w)m(are)i(b)m(y)f(erroneous)h
(namelist)c(input,)j(if)f(certain)g(animation)d(parameters)j(are)0
1617 y(c)m(hanged)39 b(errors)g(could)e(result.)60 b(These)40
b(are)e(NARR)-8 b(TIM,)39 b(MAXFRAMES)g(and)f(MAXV)-11
b(AR)39 b(and)0 1738 y(should)30 b(not)f(b)s(e)h(c)m(hanged)h(in)e(the)
h(LEM)h(without)e(corresp)s(onding)h(c)m(hanges)h(to)e(the)i(p)s
(ost-pro)s(cessing)0 1858 y(soft)m(w)m(are.)0 2267 y
Fp(5.8)135 b(Mo)t(del)45 b(Dumps)0 2573 y Fv(Data)d(su\016cien)m(t)i
(to)f(run)g(on)h(the)f(mo)s(del)f(from)f(a)i(giv)m(en)h(time)d(is)i
(output)g(in)m(to)g(the)g(\014les)g Fl(\014le)-5 b(a)43
b Fv(or)0 2693 y Fl(\014leb)p Fv(.)71 b(These)44 b(\014les)e(are)g(kno)
m(wn)i(as)e(mo)s(del)e(dumps.)72 b(Tw)m(o)43 b(\014les)g(are)f(used)h
(so)f(that)g(in)f(the)i(ev)m(en)m(t)0 2813 y(a)36 b(problem)f(during)h
(output)h(there)g(will)d(b)s(e)i(a)h(bac)m(k)g(up)g(mo)s(del)e(dump.)54
b(Computer)37 b(disk)f(memory)0 2934 y(can)45 b(b)s(e)g(sa)m(v)m(ed)h
(b)m(y)g(only)e(using)g Fl(\014le)-5 b(a)44 b Fv(through)h(setting)f
(ITW)m(OFILEP=0.)81 b(The)46 b(mo)s(del)d(dumps)0 3054
y(are)48 b(written)f(from)g(subroutine)h Fw(DUMP)f Fv(or)h
Fw(NEWDUMP)p Fv(,)e(the)i(c)m(hoice)h(dep)s(ending)e(on)h(the)0
3174 y(parameter)30 b(IEA)m(CHDUMPP)-8 b(.)33 b(If)e(IEA)m(CHDUMPP=0)i
(then)e Fw(DUMP)g Fv(writes)g(a)g(single)f(\014le)g(whic)m(h)0
3295 y(can)35 b(b)s(e)g(read)g(in)g(b)m(y)g(a)g(run)g(running)g(on)g
(an)f(arbritrary)g(n)m(um)m(b)s(er)i(of)e(PEs.)52 b(If)35
b(IEA)m(CHDUMPP=1)0 3415 y(then)30 b Fw(NEWDUMP)d Fv(is)i(called)e(and)
i(eac)m(h)h(PE)g(writes)f(its)f(o)m(wn)i(\014le.)42 b(This)29
b(can)g(only)f(b)s(e)h(read)g(in)g(b)m(y)0 3536 y(a)i(another)g(run)g
(running)f(on)h(the)h(same)e(n)m(um)m(b)s(er)i(of)e(PEs,)j(although)c
(is)i(faster)g(as)g(message)h(passing)0 3656 y(is)g(minimised.)146
3897 y(Both)25 b Fw(DUMP)f Fv(and)g Fw(NEWDUMP)f Fv(ha)m(v)m(e)j(the)e
(same)g(basic)h(structure.)42 b(Firstly)-8 b(,)24 b(the)h(dump)f
(\014le)0 4017 y(is)31 b(iden)m(ti\014ed)h(\()p Fl(\014le)-5
b(a)31 b Fv(or)g Fl(\014leb)p Fv(\))g(using)g(the)i(indicator,)d
(INDIC,)i(read)g(in)f(from)f Fl(\014lez)h Fv(at)h(the)g(b)s(eginning)0
4138 y(of)e(the)i(job,)f(and)g(the)g(\014le)g(op)s(ened.)43
b(Firstly)-8 b(,)30 b(the)h(parameters)g(used)h(in)e(the)i(mo)s(del)d
(are)i(written)g(out)0 4258 y(\(for)i(c)m(hec)m(king)h(when)h(the)f(mo)
s(del)d(dump)i(is)g(read)h(in)e(through)h Fw(RETRIEVE)e
Fv(or)i Fw(NEWRETR)p Fv(\).)0 4378 y(Secondly)-8 b(,)38
b(mo)s(del)c(v)-5 b(ariables)35 b(that)h(w)m(ere)h(input)f(through)g
(the)g(setup)h(namelists)e(and)h(those)h(whic)m(h)0 4499
y(de\014ne)31 b(the)f(state)g(of)f(the)h(run)g(\(e.g.)f(TIME\))i(are)f
(dump)s(ed.)42 b(These)32 b(are)d(follo)m(w)m(ed)g(b)m(y)h(the)g
(horizon)m(tal)0 4619 y(means,)i(saturation)f(and)i(radiation)c(data,)j
(and)g(the)h(diagnostic)e(arra)m(ys,)i(DGA)-11 b(V,)31
b(DGSP)-8 b(A)d(V,)32 b(SER)0 4739 y(and)h(CHTS.)146
4980 y(The)40 b(next)f(stage)g(is)f(to)h(write)f(out)g(the)h(mo)s(del)e
(\014elds.)62 b(In)39 b Fw(NEWDUMP)f Fv(the)h(\014elds)g(on)f(the)0
5101 y(lo)s(cal)g(PE)j(are)f(written)h(out)f(in)f(slice)h(order.)67
b(The)41 b(prognostic)f(\014elds,)j(U,)d(ZU,)g(V,)h(ZV,)f(W,)h(ZW,)0
5221 y(TH,)35 b(ZTH,)g(Q)g(and)g(ZQ)f(are)g(written)h(out)g(\014rst,)g
(and)g(then)h(follo)m(w)m(ed)d(b)m(y)j(diagnostic)d(\014elds,)j(whic)m
(h)0 5341 y(dep)s(end)f(on)e(parameter)g(c)m(hoices.)47
b(These)35 b(are)f(the)g(PUDDLE)f(\014elds,)h(then)g(the)g(radiation)d
(heating)0 5462 y(rates)42 b(and)h(\015ux)f(diagnostics,)i(and)e
(\014nally)f(the)h(column)f(classi\014cation)g(\014elds.)72
b(In)42 b Fw(DUMP)g Fv(the)0 5582 y(same)37 b(\014elds)g(are)g(again)f
(written)g(out)h(in)f(slice)h(order)g(but)g(this)g(time)e(for)i(the)g
(whole)g(domain)e(in)m(to)0 5702 y(one)e(\014le.)43 b(This)33
b(is)f(ac)m(hiev)m(ed)i(b)m(y)f(lo)s(oping)e(o)m(v)m(er)i(the)g(n)m(um)
m(b)s(er)g(of)f(PEs)i(and)f(eac)m(h)g(PE)h(writing)d(to)h(the)0
5823 y(mo)s(del)f(dump)h(in)g(turn.)1841 6107 y(35)p
eop
%%Page: 36 39
36 38 bop 146 52 a Fw(DUMP)29 b Fv(and)g Fw(NEWDUMP)e
Fv(are)i(called)e(from)g(subroutine)i Fw(EXXIT)p Fv(.)f(Dumps)g(are)g
(called)g(at)0 173 y(the)i(end)g(of)f(eac)m(h)h(job,)g(during)e(eac)m
(h)j(job)e(in)f(the)i(NNDUMP)g(lo)s(op)e(in)g Fw(LES)p
Fv(,)i(and)f(if)f(the)i(in)m(tegration)0 293 y(is)38
b(man)m(ually)f(stopp)s(ed.)63 b(A)39 b(dump)f(is)h(also)e(called)h(if)
g Fw(EXXIT)f Fv(is)h(called)g(from)f(a)i(an)f(error)h(whic)m(h)0
414 y(is)h(not)h(necessarily)h(fatal,)f(when)h(the)f(dump)g(ma)m(y)g
(pro)m(v)m(e)h(to)e(b)s(e)h(useful)g(for)g(diagnosis,)g(e.g.)69
b(the)0 534 y(timestep)32 b(b)s(ecoming)f(to)s(o)h(small.)146
775 y(Mo)s(del)38 b(dumps)g(are)g(read)g(in)f(through)g(the)i(routine)e
Fw(RETRIEVE)e Fv(or)i Fw(NEWRETR)p Fv(,)f(b)s(oth)0 895
y(called)27 b(from)g Fw(BEGIN)p Fv(.)f Fw(RETRIEVE)f
Fv(reads)k(in)e(a)h(single)f(\014le)h(mo)s(del)e(dump)i(written)g(b)m
(y)h Fw(DUMP)0 1016 y Fv(and)37 b Fw(NEWRETR)e Fv(reads)j(in)f(the)g(m)
m(ulti-\014le)e(dump)i(with)f(separate)i(\014les)g(for)e(eac)m(h)j(PE,)
f(written)0 1136 y(b)m(y)33 b Fw(NEWDUMP)p Fv(.)f(Both)g(routines)g
(necessarily)h(read)g(in)e(the)i(data)f(the)h(same)f(order)h(that)f(it)
g(w)m(as)0 1256 y(written)40 b(out.)67 b(Ho)m(w)m(ev)m(er,)44
b(after)c(the)h(mo)s(del)e(parameters)h(are)g(read)h(in)f(a)g(c)m(hec)m
(k)i(is)e(p)s(erformed)g(to)0 1377 y(ensure)32 b(that)e(there)h(are)f
(no)h(con\015icts)f(b)s(et)m(w)m(een)j(parameters)d(in)g(the)g(mo)s
(del)f(dump)h(and)h(the)f(run.)44 b(If)0 1497 y(so,)29
b(then)f(subroutine)g Fw(EXXIT)e Fv(is)i(called)e(with)h(an)h(error)f
(co)s(de)h(of)g(6.)41 b(If)28 b(the)g(user)h(wishes)f(to)g(c)m(hange)0
1617 y(parameters)39 b(b)s(et)m(w)m(een)h(a)f(mo)s(del)e(dump)h(and)h
(a)f(mo)s(del)f(run)i(these)h(traps)f(need)g(to)g(b)s(e)f(o)m(v)m
(erridden)0 1738 y(and)33 b(co)s(de)g(pro)m(vided)g(to)f(ensure)i(a)e
(smo)s(oth)g(transition.)146 1979 y(If)e(the)f(user)i(wishes)f(to)f
(add)g(additional)e(\014elds)i(to)g(the)h(mo)s(del)e(dump)h(then)h
(care)g(m)m(ust)f(b)s(e)g(tak)m(en)0 2099 y(to)37 b(insert)f(the)i(co)s
(de)f(for)f(the)i(writing)d(and)i(reading)f(of)h(the)g(data)g(in)f(the)
h(same)g(place)f(in)h(routines)0 2219 y Fw(DUMP)32 b
Fv(and)h Fw(NEWDUMP)f Fv(and)g Fw(RETRIEVE)e Fv(and)j
Fw(NEWRETR)p Fv(.)0 2629 y Fp(5.9)135 b(Error)46 b(Messages)f(and)g
(EXXIT)0 2934 y Fv(The)40 b(t)m(w)m(o)f(main)e(output)i(routines,)h
Fw(DIA)m(G)e Fv(and)h Fw(DUMP)f Fv(or)h Fw(NEWDUMP)p
Fv(,)e(are)i(called)f(from)0 3054 y(the)h(subroutine)f
Fw(EXXIT)p Fv(.)f Fw(EXXIT)g Fv(is)g(also)h(resp)s(onsible)g(for)f
(stopping)h(the)h(mo)s(del)d(at)i(the)h(end)0 3174 y(of)c(a)g(job)h(or)
f(c)m(hain,)h(or)g(when)g(an)g(error)f(has)h(b)s(een)h(detected.)54
b(The)36 b(\014v)m(e)h(tasks)g(that)e Fw(EXXIT)f Fv(can)0
3295 y(p)s(erform)h(are)g(con)m(trolled)g(b)m(y)i(lo)s(cal)c(logical)g
(v)-5 b(ariables)34 b(L)p 2146 3295 30 4 v 35 w(DUMP)i(\(for)f(a)g(mo)s
(del)g(dump\),)h(L)p 3494 3295 V 35 w(DIA)m(G)0 3415
y(\(for)i(a)h(diagnostic)e(dump\),)j(L)p 1164 3415 V
35 w(ENDJOB)f(\(to)f(end)i(a)e(job\),)i(L)p 2387 3415
V 35 w(ENDCHAIN)g(\(to)e(end)i(the)f(mo)s(del)0 3536
y(run\))30 b(and)h(L)p 469 3536 V 35 w(STOP)g(\(to)f(p)s(erform)f(an)h
(abnormal)e(stop\).)43 b(The)31 b(argumen)m(t)f(to)g
Fw(EXXIT)f Fv(is)g(ISTOPU)0 3656 y(and)k(the)g(logicals)d(are)i(set)i
(dep)s(ending)e(on)h(the)g(v)-5 b(alue)32 b(of)g(ISTOPU)i(as)e(sho)m
(wn)i(b)s(elo)m(w)f(in)e(T)-8 b(able)33 b(7.)146 3897
y(In)c(general,)g(ISTOPU)h(v)-5 b(alues)28 b(of)g(1)g(or)g(less)h(are)g
(normal,)e(whilst)h(v)-5 b(alues)28 b(of)g(2)g(or)g(ab)s(o)m(v)m(e)i
(indicate)0 4017 y(a)38 b(mo)s(del)f(error.)62 b(F)-8
b(or)37 b(error)i(co)s(des,)i(a)d(description)g(of)g(the)h(error)g(is)f
(written)g(in)g(the)h(message)g(\014le)0 4138 y(and)34
b(to)g(standard)h(out.)48 b(In)34 b(most)g(cases,)i(this)e(information)
d(is)j(su\016cien)m(t)h(for)f(the)g(user)h(to)f(iden)m(tify)0
4258 y(the)d(error)g(and)g(put)g(it)f(righ)m(t.)42 b(Occasionally)-8
b(,)30 b(an)g(error)h(o)s(ccurs)h(on)e(a)h(solitary)e(PE)j(and)f(in)f
(this)h(case)0 4378 y(L)p 67 4378 V 35 w(ALLPES)41 b(is)e(set)h(to)g
(call)e(the)i(GCOM)g(routine)f(\(GC)p 2156 4378 V 35
w(ABOR)-8 b(T\))40 b(whic)m(h)g(stops)h(all)d(PEs.)66
b(Most)0 4499 y(error)34 b(co)s(des)g(are)g(sp)s(eci\014c,)h(but)f
(ISTOPU=2)g(and)g(3)g(are)g(generic)f(for)h(the)g(general)f(error)h
(case)g(and)0 4619 y(the)40 b(single)f(PE)i(error)f(case,)j(resp)s
(ectiv)m(ely)-8 b(.)66 b(These)42 b(exist)e(so)h(that)e(users)j(can)e
(add)g(new)h Fw(EXXIT)0 4739 y Fv(calls)35 b(without)g(ha)m(ving)h(to)g
(necessarily)g(alter)g Fw(EXXIT)p Fv(.)e(ISTOPU=2)j(is)f(a)f(p)s
(ossible)h(condition)e(in)0 4860 y(the)g(mo)s(del)e(but)i(these)g
(calls)f(to)g Fw(EXXIT)p Fv(,)f(in)h Fw(THSOUR)m(CE)f
Fv(for)h(example,)g(should)h(not)f(usually)0 4980 y(b)s(e)g(called,)e
(as)i(the)g(error)f(should)h(b)s(e)g(trapp)s(ed)g(earlier)e(in)g(the)i
(co)s(de.)146 5221 y(The)49 b(actions)e(resulting)g(when)i(ISTOPU=-4)f
(are)g(conditional)d(up)s(on)j(the)g(con)m(ten)m(ts)i(of)d(the)0
5341 y(message)29 b(\014le.)42 b(If)29 b(the)g(message)h(\014le)e(has)h
(b)s(een)h(man)m(ually)d(altered)i(to)f(read)h(\\NO)g(PR)m(OBLEM)h(BUT)
0 5462 y(STOP")d(then)h(the)f(c)m(hain)g(will)d(end)k(normally)-8
b(.)39 b(If)26 b(the)i(message)f(\014le)f(reads)i(the)f(usual)g(\\F)-11
b(AILSAFE")0 5582 y(during)37 b(run)m(time)g(then)h(no)f(action)g(is)g
(tak)m(en.)59 b(In)38 b(an)m(y)h(other)e(ev)m(en)m(tualit)m(y)i(the)f
(run)f(is)g(terminated)0 5702 y(abnormally)30 b(with)i(a)h(mo)s(del)e
(dump.)1841 6107 y(36)p eop
%%Page: 37 40
37 39 bop 0 -32 3946 7 v -3 81 7 113 v 50 47 a Fq(ISTOPU)p
446 81 V 333 w(Called)p 1268 81 V 333 w(Meaning)p 2523
81 V 1423 w(Actions)p 3942 81 V -3 194 V 446 194 V 768
160 a(from)p 1268 194 V 2523 194 V 1624 w Fj(Dump)98
b(Diag)i(End)20 b(Job)99 b(End)20 b(Chain)99 b(Stop)p
3942 194 V 0 200 3946 7 v -3 313 7 113 v 187 279 a Fq(-4)p
446 313 V 504 w Fr(LES)p 1268 313 V 365 w Fq(Chec)m(k)31
b(for)f(man)m(ual)g(stop.)p 2523 313 V 381 w(P)810 b(P)p
3942 313 V 0 320 3946 7 v -3 433 7 113 v 187 399 a(-3)p
446 433 V 504 w Fr(LES)p 1268 433 V 365 w Fq(Mo)s(del)30
b(dump)f(only)-8 b(.)p 2523 433 V 580 w(Y)p 3942 433
V 0 439 3946 7 v -3 552 7 113 v 187 518 a(-2)p 446 552
V 352 w Fr(NNSTEPS)p 1268 552 V 214 w Fq(Diagnostics)31
b(only)-8 b(.)p 2523 552 V 874 w(Y)p 3942 552 V 0 559
3946 7 v -3 672 7 113 v 187 638 a(-1)p 446 672 V 504
w Fr(LES)p 1268 672 V 365 w Fq(End)30 b(of)g(job.)p 2523
672 V 857 w(Y)449 b(Y)p 3942 672 V 0 678 3946 7 v -3
791 7 113 v 202 757 a(0)p 446 791 V 519 w Fr(LES)p 1268
791 V 365 w Fq(End)30 b(of)g(job,)g(write)g(diagnostics)p
2523 791 V 158 w(Y)175 b(Y)206 b(Y)p 3942 791 V -3 904
V 446 904 V 614 870 a Fr(NNSTEPS)p 1268 904 V 2523 904
V 3942 904 V 0 911 3946 7 v -3 1024 7 113 v 202 990 a
Fq(1)p 446 1024 V 367 w Fr(NNSTEPS)p 1268 1024 V 214
w Fq(End)30 b(of)g(c)m(hain.)p 2523 1024 V 771 w(Y)175
b(Y)561 b(Y)p 3942 1024 V 0 1030 3946 7 v -3 1143 7 113
v 202 1110 a(2)p 446 1143 V 464 w(V)-8 b(arious)p 1268
1143 V 311 w(Generic)31 b(error)f(co)s(de.)p 2523 1143
V 1717 w(Y)p 3942 1143 V 0 1150 3946 7 v -3 1263 7 113
v 202 1229 a(3)p 446 1263 V 410 w(Not)i(called)p 1268
1263 V 256 w(Generic)f(sole)f(PE)g(error)p 2523 1263
V 1620 w(Y)p 3942 1263 V 0 1270 3946 7 v -3 1382 7 113
v 202 1349 a(4)p 446 1382 V 384 w Fr(MOSTBC)p 1268 1382
V 231 w Fq(Boundary)g(condition)f(error)p 2523 1382 V
1466 w(Y)p 3942 1382 V 0 1389 3946 7 v -3 1502 7 113
v 202 1468 a(5)p 446 1502 V 305 w Fr(CHKP)-9 b(ARMS)p
1268 1502 V 153 w Fq(P)m(arameter)32 b(con\015ict.)p
2523 1502 V 1722 w(Y)p 3942 1502 V 0 1509 3946 7 v -3
1622 7 113 v 202 1588 a(6)p 446 1622 V 336 w Fr(RETRIEVE)p
1268 1622 V 183 w Fq(P)m(arameter)g(con\015ict)e(in)p
2523 1622 V 1640 w(Y)p 3942 1622 V -3 1735 V 446 1735
V 582 1701 a Fr(NEWRETR)p 1268 1735 V 182 w Fq(mo)s(del)g(dump.)p
2523 1735 V 3942 1735 V 0 1741 3946 7 v -3 1854 7 113
v 202 1820 a(7)p 446 1854 V 440 w Fr(BEGIN)p 1268 1854
V 287 w Fq(Bad)h(v)-5 b(alue)30 b(of)g(namelist)p 2523
1854 V 1615 w(Y)p 3942 1854 V -3 1967 V 446 1967 V 695
1933 a Fr(SET1D)p 1268 1967 V 294 w Fq(v)-5 b(ariable.)p
2523 1967 V 3942 1967 V -3 2080 V 446 2080 V 593 2046
a Fr(SETDIA)m(GS)p 1268 2080 V 2523 2080 V 3942 2080
V 0 2087 3946 7 v -3 2199 7 113 v 202 2166 a Fq(8)p 446
2199 V 372 w Fr(SET)c(ANEL)p 1268 2199 V 218 w Fq(Negativ)m(e)33
b(pressure)c(calculated.)p 2523 2199 V 1323 w(Y)p 3942
2199 V -3 2312 V 446 2312 V 619 2278 a Fr(SETPREF)p 1268
2312 V 2523 2312 V 3942 2312 V 0 2319 3946 7 v -3 2432
7 113 v 202 2398 a Fq(9)p 446 2432 V 324 w Fr(ALLOCDGS)p
1268 2432 V 170 w Fq(Allo)s(cation)h(error.)p 2523 2432
V 1821 w(Y)p 3942 2432 V -3 2545 V 446 2545 V 616 2511
a Fr(ALLOCSP)p 1268 2545 V 2523 2545 V 3942 2545 V -3
2658 V 446 2658 V 613 2624 a(ALLOCQS)p 1268 2658 V 2523
2658 V 3942 2658 V -3 2771 V 446 2771 V 591 2737 a(INTIMSER)p
1268 2771 V 2523 2771 V 3942 2771 V 0 2777 3946 7 v -3
2890 7 113 v 179 2856 a Fq(10)p 446 2890 V 335 w Fr(WR)-9
b(TNUM)p 1268 2890 V 206 w Fq(Num)m(b)s(er)30 b(to)s(o)h(big)e(for)h
(header.)p 2523 2890 V 1390 w(Y)p 3942 2890 V 0 2897
3946 7 v -3 3010 7 113 v 179 2976 a(11)p 446 3010 V 230
w Fr(MER)m(GE)p 899 2976 32 4 v 38 w(D)m(A)-9 b(T)g(A)p
1268 3010 7 113 v 100 w Fq(Error)30 b(in)f(radiation)g(co)s(de.)p
2523 3010 V 1535 w(Y)p 3942 3010 V -3 3123 V 446 3123
V 527 3089 a Fr(RAD)p 770 3089 32 4 v 39 w(INT)p 1004
3089 V 36 w(L)-12 b(W)p 1268 3123 7 113 v 2523 3123 V
3942 3123 V -3 3236 V 446 3236 V 524 3202 a(RAD)p 767
3202 32 4 v 38 w(INT)p 1000 3202 V 37 w(SW)p 1268 3236
7 113 v 2523 3236 V 3942 3236 V 0 3242 3946 7 v -3 3355
7 113 v 179 3321 a Fq(12)p 446 3355 V 345 w Fr(NNSTEPS)p
1268 3355 V 214 w Fq(Timestep)30 b(b)s(elo)m(w)f(DTMMIN.)p
2523 3355 V 219 w(Y)175 b(Y)865 b(Y)p 3942 3355 V 0 3362
3946 7 v -3 3475 7 113 v 179 3441 a(13)p 446 3475 V 383
w Fr(TIMSER)p 1268 3475 V 252 w Fq(Limit)29 b(of)i(timeseries)e(reac)m
(hed.)p 2523 3475 V 205 w(Y)1108 b(Y)p 3942 3475 V 0
3481 3946 7 v -3 3594 7 113 v 179 3560 a(14)p 446 3594
V 431 w Fr(SETLS)p 1268 3594 V 300 w Fq(F)-8 b(orcing)31
b(v)-5 b(alues)30 b(out)g(of)h(range.)p 2523 3594 V 1376
w(Y)p 3942 3594 V 0 3601 3946 7 v 0 3869 a Fv(T)-8 b(able)36
b(7:)50 b(Meanings)36 b(and)g(actions)g(for)f(ISTOPU)j(argumen)m(t)d
(to)h Fw(EXXIT)p Fv(.)f(A)h(`Y')g(indicates)g(that)0
3990 y(the)d(action)f(o)s(ccurs,)h(a)f(`P')h(that)g(it)e(ma)m(y)i(o)s
(ccur)g(dep)s(ending)f(on)h(other)g(input.)0 4275 y Fx(6)161
b(P)l(arallel)57 b(Pro)t(cessing)c(Issues)0 4614 y Fv(The)25
b(construction)f(of)f(a)h(massiv)m(ely)g(parallel)d(pro)s(cessing)j
(\(MPP\))h(v)m(ersion)f(of)f(the)i(LEM)f(is)g(describ)s(ed)0
4735 y(b)m(y)33 b(Bro)m(wn)h(et)e(al)g(\(1997\).)42 b(Eac)m(h)33
b(PE)g(in)f(the)h(in)m(tegration)e(only)h(stores)h(part)f(of)g(the)h
(mo)s(del)e(domain)0 4855 y(in)41 b(its)h(o)m(wn)g(memory)-8
b(.)71 b(T)-8 b(o)42 b(access)i(other)e(parts)g(of)g(the)g(distributed)
g(memory)f(explicit)g(calls,)i(or)0 4975 y(\\message)34
b(passing",)h(has)f(to)g(b)s(e)g(used.)49 b(In)35 b(the)f(LEM,)h(GC)f
(\(Generalised)f(Comm)m(unication\))f(rou-)0 5096 y(tines)e(are)f(used)
i(for)e(passing)h(data)f(from)g(one)h(PE)g(to)g(another.)42
b(These)32 b(are)d(e\013ectiv)m(ely)i(an)e(in)m(terface)0
5216 y(to)k(the)h(mac)m(hine)e(message)i(passing)f(routines)g(\(on)g
(the)h(T3E)g(MPI)g(is)f(used\))h(and)f(are)h(do)s(cumen)m(ted)0
5336 y(b)m(y)e(Am)m(undsen)h(and)e(Sk)-12 b(\027)-61
b(alin)30 b(\(1996\).)42 b(A)31 b(brief)g(glossary)g(of)g(the)g(GC)g
(routines)h(used)g(in)e(the)i(LEM)g(is)0 5457 y(giv)m(en)h(in)f(the)h
(App)s(endix.)146 5698 y(The)38 b(c)m(hallenge)e(of)h(the)g(MPP)h(v)m
(ersion)f(is)g(to)f(maximise)f(parallel)f(calculations)h(and)i
(minimise)0 5818 y(message)k(passing,)i(through)d(an)h(e\016cien)m(t)g
(decomp)s(osition)e(of)h(the)h(domain.)66 b(Because)42
b(the)f(LEM)1841 6107 y(37)p eop
%%Page: 38 41
38 40 bop 0 52 a Fv(w)m(as)39 b(already)g(constructed)h(as)e(a)h
(series)g(of)f(v)m(ertical)g Fn(y)t Fv(-)p Fn(z)k Fv(slices)c(it)f(w)m
(as)j(decided)f(to)f(use)i(this)e(as)h(a)0 173 y(basis)32
b(for)f(the)h(domain)e(decomp)s(osition.)41 b(This)32
b(has)g(the)g(adv)-5 b(an)m(tage)31 b(of)h(minimising)27
b(the)32 b(impact)e(of)0 293 y(the)f(parallelization)24
b(on)29 b(most)f(of)g(the)h(in)m(tegration)e(part)h(of)h(the)g(co)s
(de.)42 b(An)29 b(illustration)c(of)k(ho)m(w)g(this)0
414 y(decomp)s(osition)i(w)m(orks)j(in)d(practice)i(is)f(sho)m(wn)i(in)
e(Fig.)f(9.)146 654 y(PEs)45 b(are)f(n)m(um)m(b)s(ered)g(from)e(0)h(to)
h(NPES-1,)i(where)f(the)f(lo)s(cal)d(PE)j(is)f(iden)m(ti\014ed)h(b)m(y)
g(MYPE,)0 775 y(and)g(the)h(adjacen)m(t)g(PEs)g(are)g(iden)m(ti\014ed)f
(b)m(y)h(the)f(v)-5 b(ariables)43 b(ILEFT)i(and)f(IRIGHT,)h(all)d(held)
i(in)0 895 y(common)31 b(blo)s(c)m(k)i(ME.)h(These)g(are)f(determined)g
(in)f Fw(LES)h Fv(b)m(y)h(assuming)e(that)g(the)i(mo)s(del)d(slices)h
(are)0 1016 y(arranged)38 b(from)f(1)h(to)f(I)s(IP)i(left)e(to)h(righ)m
(t.)59 b(Figure)37 b(9)h(sho)m(ws)i(that)e(IRIGHT)g(will)e(b)s(e)i
(generally)f(b)s(e)0 1136 y(MYPE+1)f(and)g(ILEFT)f(will)e(b)s(e)j
(MYPE-1.)52 b(If)35 b(I)h(giv)m(es)f(the)h(index)g(of)e(the)i(slice)f
(on)g(the)h(lo)s(cal)d(PE)0 1256 y(then)g(\(I+MYPE*I)s(IPEP\))i(giv)m
(es)e(the)g(slice)f(index)h(of)f(the)h(whole)f(domain.)146
1497 y(The)27 b(decomp)s(osition)d(m)m(ust)i(in)m(v)m(olv)m(e)g(the)h
(use)g(of)e(halo)s(es,)i(sho)m(wn)g(as)f(the)g(hashed)h(slices)f(in)f
(Fig.)g(9.)0 1617 y(These)41 b(con)m(tain)d(the)i(data)e(from)g(other)h
(PEs)h(whic)m(h)f(is)g(necessary)i(to)e(carry)g(out)g(the)g(in)m
(tegration)0 1738 y(on)30 b(the)g(lo)s(cal)e(PE.)i(F)-8
b(or)29 b(example,)h(a)g Fn(@)5 b(=@)g(x)32 b Fv(term)d(in)g(the)h(mo)s
(del)e(equations)j(will)c(necessitate)k(halo)s(es)0 1858
y(to)k(represen)m(t)j(the)e(0)f(and)h(I)s(IPEP+1)g(slices.)52
b(When)37 b(bac)m(kscatter)g(is)e(used,)i(three)g(slice)e(halo)s(es)f
(are)0 1979 y(required.)43 b(The)29 b(halo)s(es)e(are)i(passed)g(b)s
(et)m(w)m(een)i(PEs)e(in)e(the)i(subroutine)g Fw(XWRAP)d
Fv(whic)m(h)j(is)f(called)0 2099 y(from)f Fw(NNSTEPS)g
Fv(at)h(the)g(b)s(eginning)f(of)h(eac)m(h)h(new)g(timestep)f(\(see)h
(Fig.)e(4\).)41 b(The)30 b(data)d(for)h(all)e(the)0 2219
y(mo)s(del)46 b(\014elds)h(for)g(eac)m(h)h(halo)e(is)h(passed)h(in)f
(routines)g Fw(WRAPSEND)e Fv(and)i Fw(WRAPRECV)p Fv(.)0
2340 y Fw(WRAPSEND)h Fv(sends)j(the)g(data)e(from)g(the)h(appropriate)g
(slice)f(to)g(the)i(adjacen)m(t)f(pro)s(cessor,)0 2460
y(whilst)44 b Fw(WRAPRECV)e Fv(receiv)m(es)k(the)g(data.)79
b(In)45 b(these)h(routines)f(separate)h(GC)p 3209 2460
30 4 v 35 w(RSEND)e(and)0 2580 y(GC)p 153 2580 V 35 w(RRECV)31
b(routines)g(are)g(used)h(for)e(eac)m(h)i(mo)s(del)d(\014eld)i(\(U,)g
(ZU,)g(V,)g(ZV,)f(W,)h(ZW,)g(TH,)h(ZTH,)f(Q)0 2701 y(and)i(ZQ\).)f(F)-8
b(or)31 b(the)i(non-MPP)h(case)f(halo)s(es)f(are)h(de\014ned)h(using)e
(the)h Fw(EQUA)-9 b(TE)31 b Fv(call.)0 3110 y Fp(6.1)135
b(Pressure)45 b(Solv)l(er)0 3415 y Fv(Message)31 b(passing)f(is)g
(essen)m(tial)f(in)g(the)i(pressure)g(solv)m(er)g(routines)e(b)s
(ecause)j(of)d(the)h(need)h(to)f(F)-8 b(ourier)0 3536
y(transform)30 b(the)h(pressure)i(source)f(in)m(to)e(w)m(a)m(v)m(e)i
(space.)44 b(Although)30 b(the)i(data)e(is)g(partitioned)g(horizon-)0
3656 y(tally)36 b(b)s(et)m(w)m(een)k(the)e(PEs,)i(all)35
b(the)j(data)f(is)g(required)h(to)g(p)s(erform)e(a)h(2-D)g(fast)g(F)-8
b(ourier)36 b(transform)0 3776 y(\(\013t\).)73 b(Mac)m(hine)43
b(sp)s(eci\014c)g(utilit)m(y)e(routines)h(for)g(2-D)g(\013ts)h(exist)f
(on)h(the)g(T3E.)g(These)h(p)s(erform)e(a)0 3897 y(single)27
b(\013t)i(in)e(one)i(direction,)f(rearrange)h(the)g(data)f(so)h(that)f
(the)h Fn(x)p Fv(-)f(and)h Fn(y)t Fv(-directions)d(are)j(sw)m(app)s
(ed,)0 4017 y(p)s(erform)d(the)i(second)h(\013t)f(op)s(eration,)f(and)g
(return)i(the)e(data)h(to)f(its)g(original)d(p)s(osition.)40
b(Because)29 b(the)0 4138 y(pressure)h(solv)m(er)e(requires)g(t)m(w)m
(o)h(2-D)d(\013ts)i(\(con)m(v)m(erting)h(the)f(real)f(data)g(to)g(w)m
(a)m(v)m(espace)k(and)d(then)g(bac)m(k)0 4258 y(again\))36
b(the)j(shifting)d(of)i(data)g(bac)m(k)h(to)e(the)i(original)34
b(p)s(osition)j(is)g(a)h(redundan)m(t)h(time-consuming)0
4378 y(o)m(v)m(erhead)34 b(and)e(w)m(ould)f(restrict)h(the)h(p)s
(ortabilit)m(y)c(of)j(the)g(LEM.)h(Instead)g(the)f(2-D)f(\013t)h(is)f
(p)s(erformed)0 4499 y(explicitly)36 b(b)m(y)k(use)f(of)f(single)f
(\013ts)h(\(whic)m(h)h(are)f(not)g(necessarily)h(mac)m(hine)f(sp)s
(eci\014c\))h(and)f(message)0 4619 y(passing)33 b(using)f(only)g(one)h
(data)f(rearrangemen)m(t)g(p)s(er)h(transformation.)146
4860 y(The)49 b(decomp)s(osition)e(of)g(the)i(domain)d(in)m(to)i
Fn(y)t Fv(-)p Fn(z)j Fv(slices)d(mak)m(es)h(the)f Fn(y)t
Fv(-direction)e(\013t)i(trivial.)0 4980 y(T)-8 b(o)39
b(p)s(erform)f(the)i Fn(x)p Fv(-direction)e(\013t)h(the)h(data)f(m)m
(ust)g(b)s(e)h(rearranged)f(so)h(that)f(the)g(domain)f(can)h(b)s(e)0
5101 y(decomp)s(osed)46 b(in)m(to)f Fn(x)p Fv(-)p Fn(z)50
b Fv(slices,)f(as)d(illustrated)e(in)h(Fig.)f(10.)82
b(Not)46 b(only)f(do)s(es)h(data)f(need)i(to)e(b)s(e)0
5221 y(transferred)34 b(b)s(et)m(w)m(een)h(PEs)g(but,)e(in)g(order)g
(to)g(ensure)h(faster)g(\015oating)d(p)s(oin)m(t)i(arithmetic)e(and)i
(\013ts,)0 5341 y(the)i(order)h(of)e(the)i(pressure)h(arra)m(y)e(m)m
(ust)g(b)s(e)g(c)m(hanged.)52 b(Pressure)37 b(\(and)e(pressure)i
(source\))f(is)f(held)0 5462 y(in)30 b(an)i(arra)m(y)f(P\(J,K,I\).)h
(This)f(is)g(transp)s(osed)h(to)f(an)g(arra)m(y)h(PT\(I,K,J\))g(for)f
(the)g Fn(x)p Fv(-direction)f(\013t)h(and)0 5582 y(tridiagonal)26
b(calculation.)40 b(This)29 b(pro)s(cedure)h(is)e(p)s(erformed)h(b)s
(et)m(w)m(een)i(the)e Fn(y)j Fv(and)e Fn(x)f Fv(direction)f(\013ts)h
(in)0 5702 y Fw(FF)-12 b(ANAL)32 b Fv(as)h(describ)s(ed)g(b)s(elo)m(w.)
1841 6107 y(38)p eop
%%Page: 39 42
39 41 bop -2 1370 4 945 v 93 1370 V 187 1370 V 282 1370
V 376 1370 V 471 1370 V 565 1370 V 660 1370 V 754 1370
V 849 1370 V 943 1370 V 1038 1370 V 1132 1370 V 1227
1370 V 1321 1370 V 1416 1370 V 1510 1370 V 1605 1370
V 1699 1370 V 1794 1370 V 1888 1370 V 1983 1370 V 2077
1370 V 2172 1370 V 2266 1370 V 2361 1370 V 2455 1370
V 2550 1370 V 2644 1370 V 2738 1370 V 2833 1370 V 2927
1370 V 3022 1370 V 3116 1370 V 3211 1370 V 3305 1370
V 3400 1370 V 3494 1370 V 3589 1370 V 3683 1370 V 3778
1370 V 0 1370 a Fo(\000)11 1359 y(\000)0 1276 y(\000)11
1264 y(\000)0 1181 y(\000)11 1170 y(\000)0 1087 y(\000)11
1075 y(\000)0 992 y(\000)11 981 y(\000)0 898 y(\000)11
886 y(\000)0 803 y(\000)11 792 y(\000)0 709 y(\000)11
697 y(\000)0 614 y(\000)11 603 y(\000)0 520 y(\000)11
508 y(\000)106 1370 y(@)94 1359 y(@)106 1276 y(@)94 1264
y(@)106 1181 y(@)94 1170 y(@)106 1087 y(@)94 1075 y(@)106
992 y(@)94 981 y(@)106 898 y(@)94 886 y(@)106 803 y(@)94
792 y(@)106 709 y(@)94 697 y(@)106 614 y(@)94 603 y(@)106
520 y(@)94 508 y(@)3591 1370 y(\000)3602 1359 y(\000)3591
1276 y(\000)3602 1264 y(\000)3591 1181 y(\000)3602 1170
y(\000)3591 1087 y(\000)3602 1075 y(\000)3591 992 y(\000)3602
981 y(\000)3591 898 y(\000)3602 886 y(\000)3591 803 y(\000)3602
792 y(\000)3591 709 y(\000)3602 697 y(\000)3591 614 y(\000)3602
603 y(\000)3591 520 y(\000)3602 508 y(\000)3696 1370
y(@)3685 1359 y(@)3696 1276 y(@)3685 1264 y(@)3696 1181
y(@)3685 1170 y(@)3696 1087 y(@)3685 1075 y(@)3696 992
y(@)3685 981 y(@)3696 898 y(@)3685 886 y(@)3696 803 y(@)3685
792 y(@)3696 709 y(@)3685 697 y(@)3696 614 y(@)3685 603
y(@)3696 520 y(@)3685 508 y(@)p -2 3024 V 93 3024 V 187
3024 V 282 3024 V 376 3024 V 471 3024 V 565 3024 V 660
3024 V 754 3024 V 849 3024 V 943 3024 V 1038 3024 V 1132
3024 V 1227 3024 V 0 3024 a(\000)11 3012 y(\000)0 2929
y(\000)11 2918 y(\000)0 2835 y(\000)11 2823 y(\000)0
2740 y(\000)11 2729 y(\000)0 2646 y(\000)11 2634 y(\000)0
2551 y(\000)11 2540 y(\000)0 2457 y(\000)11 2445 y(\000)0
2362 y(\000)11 2351 y(\000)0 2268 y(\000)11 2256 y(\000)0
2173 y(\000)11 2162 y(\000)106 3024 y(@)94 3012 y(@)106
2929 y(@)94 2918 y(@)106 2835 y(@)94 2823 y(@)106 2740
y(@)94 2729 y(@)106 2646 y(@)94 2634 y(@)106 2551 y(@)94
2540 y(@)106 2457 y(@)94 2445 y(@)106 2362 y(@)94 2351
y(@)106 2268 y(@)94 2256 y(@)106 2173 y(@)94 2162 y(@)1039
3024 y(\000)1051 3012 y(\000)1039 2929 y(\000)1051 2918
y(\000)1039 2835 y(\000)1051 2823 y(\000)1039 2740 y(\000)1051
2729 y(\000)1039 2646 y(\000)1051 2634 y(\000)1039 2551
y(\000)1051 2540 y(\000)1039 2457 y(\000)1051 2445 y(\000)1039
2362 y(\000)1051 2351 y(\000)1039 2268 y(\000)1051 2256
y(\000)1039 2173 y(\000)1051 2162 y(\000)1145 3024 y(@)1134
3012 y(@)1145 2929 y(@)1134 2918 y(@)1145 2835 y(@)1134
2823 y(@)1145 2740 y(@)1134 2729 y(@)1145 2646 y(@)1134
2634 y(@)1145 2551 y(@)1134 2540 y(@)1145 2457 y(@)1134
2445 y(@)1145 2362 y(@)1134 2351 y(@)1145 2268 y(@)1134
2256 y(@)1145 2173 y(@)1134 2162 y(@)p 849 4441 V 943
4441 V 1038 4441 V 1132 4441 V 1227 4441 V 1321 4441
V 1416 4441 V 1510 4441 V 1605 4441 V 1699 4441 V 1794
4441 V 1888 4441 V 1983 4441 V 2077 4441 V 850 4441 a(\000)862
4430 y(\000)850 4347 y(\000)862 4335 y(\000)850 4252
y(\000)862 4241 y(\000)850 4158 y(\000)862 4146 y(\000)850
4063 y(\000)862 4052 y(\000)850 3969 y(\000)862 3957
y(\000)850 3874 y(\000)862 3863 y(\000)850 3780 y(\000)862
3768 y(\000)850 3685 y(\000)862 3674 y(\000)850 3591
y(\000)862 3579 y(\000)956 4441 y(@)945 4430 y(@)956
4347 y(@)945 4335 y(@)956 4252 y(@)945 4241 y(@)956 4158
y(@)945 4146 y(@)956 4063 y(@)945 4052 y(@)956 3969 y(@)945
3957 y(@)956 3874 y(@)945 3863 y(@)956 3780 y(@)945 3768
y(@)956 3685 y(@)945 3674 y(@)956 3591 y(@)945 3579 y(@)1890
4441 y(\000)1901 4430 y(\000)1890 4347 y(\000)1901 4335
y(\000)1890 4252 y(\000)1901 4241 y(\000)1890 4158 y(\000)1901
4146 y(\000)1890 4063 y(\000)1901 4052 y(\000)1890 3969
y(\000)1901 3957 y(\000)1890 3874 y(\000)1901 3863 y(\000)1890
3780 y(\000)1901 3768 y(\000)1890 3685 y(\000)1901 3674
y(\000)1890 3591 y(\000)1901 3579 y(\000)1996 4441 y(@)1984
4430 y(@)1996 4347 y(@)1984 4335 y(@)1996 4252 y(@)1984
4241 y(@)1996 4158 y(@)1984 4146 y(@)1996 4063 y(@)1984
4052 y(@)1996 3969 y(@)1984 3957 y(@)1996 3874 y(@)1984
3863 y(@)1996 3780 y(@)1984 3768 y(@)1996 3685 y(@)1984
3674 y(@)1996 3591 y(@)1984 3579 y(@)p 1699 3024 V 1794
3024 V 1888 3024 V 1983 3024 V 2077 3024 V 2172 3024
V 2266 3024 V 2361 3024 V 2455 3024 V 2550 3024 V 2644
3024 V 2738 3024 V 2833 3024 V 2927 3024 V 1701 3024
a(\000)1712 3012 y(\000)1701 2929 y(\000)1712 2918 y(\000)1701
2835 y(\000)1712 2823 y(\000)1701 2740 y(\000)1712 2729
y(\000)1701 2646 y(\000)1712 2634 y(\000)1701 2551 y(\000)1712
2540 y(\000)1701 2457 y(\000)1712 2445 y(\000)1701 2362
y(\000)1712 2351 y(\000)1701 2268 y(\000)1712 2256 y(\000)1701
2173 y(\000)1712 2162 y(\000)1807 3024 y(@)1795 3012
y(@)1807 2929 y(@)1795 2918 y(@)1807 2835 y(@)1795 2823
y(@)1807 2740 y(@)1795 2729 y(@)1807 2646 y(@)1795 2634
y(@)1807 2551 y(@)1795 2540 y(@)1807 2457 y(@)1795 2445
y(@)1807 2362 y(@)1795 2351 y(@)1807 2268 y(@)1795 2256
y(@)1807 2173 y(@)1795 2162 y(@)2740 3024 y(\000)2752
3012 y(\000)2740 2929 y(\000)2752 2918 y(\000)2740 2835
y(\000)2752 2823 y(\000)2740 2740 y(\000)2752 2729 y(\000)2740
2646 y(\000)2752 2634 y(\000)2740 2551 y(\000)2752 2540
y(\000)2740 2457 y(\000)2752 2445 y(\000)2740 2362 y(\000)2752
2351 y(\000)2740 2268 y(\000)2752 2256 y(\000)2740 2173
y(\000)2752 2162 y(\000)2846 3024 y(@)2835 3012 y(@)2846
2929 y(@)2835 2918 y(@)2846 2835 y(@)2835 2823 y(@)2846
2740 y(@)2835 2729 y(@)2846 2646 y(@)2835 2634 y(@)2846
2551 y(@)2835 2540 y(@)2846 2457 y(@)2835 2445 y(@)2846
2362 y(@)2835 2351 y(@)2846 2268 y(@)2835 2256 y(@)2846
2173 y(@)2835 2162 y(@)p 2550 4441 V 2644 4441 V 2738
4441 V 2833 4441 V 2927 4441 V 3022 4441 V 3116 4441
V 3211 4441 V 3305 4441 V 3400 4441 V 3494 4441 V 3589
4441 V 3683 4441 V 3778 4441 V 2551 4441 a(\000)2563
4430 y(\000)2551 4347 y(\000)2563 4335 y(\000)2551 4252
y(\000)2563 4241 y(\000)2551 4158 y(\000)2563 4146 y(\000)2551
4063 y(\000)2563 4052 y(\000)2551 3969 y(\000)2563 3957
y(\000)2551 3874 y(\000)2563 3863 y(\000)2551 3780 y(\000)2563
3768 y(\000)2551 3685 y(\000)2563 3674 y(\000)2551 3591
y(\000)2563 3579 y(\000)2657 4441 y(@)2646 4430 y(@)2657
4347 y(@)2646 4335 y(@)2657 4252 y(@)2646 4241 y(@)2657
4158 y(@)2646 4146 y(@)2657 4063 y(@)2646 4052 y(@)2657
3969 y(@)2646 3957 y(@)2657 3874 y(@)2646 3863 y(@)2657
3780 y(@)2646 3768 y(@)2657 3685 y(@)2646 3674 y(@)2657
3591 y(@)2646 3579 y(@)3591 4441 y(\000)3602 4430 y(\000)3591
4347 y(\000)3602 4335 y(\000)3591 4252 y(\000)3602 4241
y(\000)3591 4158 y(\000)3602 4146 y(\000)3591 4063 y(\000)3602
4052 y(\000)3591 3969 y(\000)3602 3957 y(\000)3591 3874
y(\000)3602 3863 y(\000)3591 3780 y(\000)3602 3768 y(\000)3591
3685 y(\000)3602 3674 y(\000)3591 3591 y(\000)3602 3579
y(\000)3696 4441 y(@)3685 4430 y(@)3696 4347 y(@)3685
4335 y(@)3696 4252 y(@)3685 4241 y(@)3696 4158 y(@)3685
4146 y(@)3696 4063 y(@)3685 4052 y(@)3696 3969 y(@)3685
3957 y(@)3696 3874 y(@)3685 3863 y(@)3696 3780 y(@)3685
3768 y(@)3696 3685 y(@)3685 3674 y(@)3696 3591 y(@)3685
3579 y(@)7 402 y Fv(-1)28 b(0)46 b(1)f(2)3119 b(I)s(IP)874
377 y(I)s(IP/4)564 b(2*I)s(IP/4)516 b(3*I)s(IP/4)1590
219 y(Single)32 b(PE)h(run)4 282 y Fc(z)p 41 282 1812
10 v 1812 w(}|)p 1927 282 V 1812 w({)p 46 496 4 71 v
47 496 a Fo(?)p 140 496 V 12 w(?)p 235 496 V 11 w(?)p
329 496 V 12 w(?)p 3542 496 V 3129 w(?)p 990 496 V -2634
w(?)p 1841 496 V 768 w(?)p 2691 496 V 767 w(?)212 2055
y Fv(1)45 b(2)501 b(I)s(IPEP)239 1884 y(PE)33 b(0)f(of)h(4)f(PE)h(run)
13 1936 y Fc(z)p 50 1936 527 10 v 527 w(}|)p 651 1936
V 527 w({)p 235 2150 4 71 v 236 2150 a Fo(?)p 329 2150
V 12 w(?)p 990 2150 V 578 w(?)1062 3473 y Fv(1)46 b(2)500
b(I)s(IPEP)1089 3302 y(PE)34 b(1)e(of)g(4)g(PE)h(run)863
3353 y Fc(z)p 900 3353 527 10 v 527 w(}|)p 1501 3353
V 527 w({)p 1085 3567 4 71 v 1087 3567 a Fo(?)p 1179
3567 V 11 w(?)p 1841 3567 V 579 w(?)1913 2055 y Fv(1)45
b(2)501 b(I)s(IPEP)1940 1884 y(PE)33 b(2)f(of)g(4)h(PE)g(run)1713
1936 y Fc(z)p 1750 1936 527 10 v 527 w(}|)p 2351 1936
V 527 w({)p 1935 2150 4 71 v 1937 2150 a Fo(?)p 2030
2150 V 11 w(?)p 2691 2150 V 579 w(?)2763 3473 y Fv(1)45
b(2)501 b(I)s(IPEP)2790 3302 y(PE)33 b(3)g(of)f(4)g(PE)h(run)2564
3353 y Fc(z)p 2601 3353 527 10 v 527 w(}|)p 3202 3353
V 527 w({)p 2786 3567 4 71 v 2787 3567 a Fo(?)p 2880
3567 V 12 w(?)p 3542 3567 V 578 w(?)p 2786 3567 V -839
w(?)p 2880 3567 V 12 w(?)p 3542 3567 V 578 w(?)0 43 y
Ft(\(a\))0 1696 y(\(b\))0 4881 y Fv(Figure)42 b(9:)63
b(Explanation)41 b(of)h(domain)f(decomp)s(osition.)72
b(\(a\))42 b(Illustration)f(of)h(a)g(single)g(pro)s(cessor)0
5001 y(run.)63 b(Slices)38 b(1)h(to)f(I)s(IP)h(are)g(stepp)s(ed,)j
(with)d(the)g(aid)f(of)g(halo)g(slices)h(\(sho)m(wn)h(\014lled\))d(-1,)
j(0,)g(I)s(IP+1)0 5121 y(and)35 b(I)s(IP+2.)50 b(Halo)34
b(slice)g(-1)g(is)g(a)h(cop)m(y)h(of)e(I)s(IP-1,)i(0)e(is)g(I)s(IP)-8
b(,)36 b(I)s(IP+1)f(is)f(1)g(and)h(I)s(IP+2)g(is)g(2)f(in)g(order)0
5242 y(to)g(enforce)g(p)s(erio)s(dicit)m(y)-8 b(.)46
b(\(b\))34 b(The)h(same)f(run,)g(no)m(w)h(p)s(erformed)e(on)h(4)g(PEs.)
49 b(Eac)m(h)34 b(PE)h(deals)f(with)0 5362 y(I)s(IPEP)c(\(=I)s(IP/4\))f
(slices,)g(with)g(a)f(double)h(halo)f(at)g(eac)m(h)i(side.)42
b(F)-8 b(or)29 b(example,)g(PE)g(2)g(steps)h(its)f(slices)0
5483 y(1)34 b(to)g(I)s(IPEP)h(\(slices)f(2*I)s(IP/4+1)f(to)h(3*I)s
(IP/4)f(of)h(the)g(single)f(pro)s(cessor)j(problem\).)46
b(It)35 b(obtains)e(its)0 5603 y(halo)g(slices)h(-1)g(and)g(0)g(b)m(y)i
(cop)m(ying)e(slices)g(I)s(IPEP-1)h(and)g(I)s(IPEP)g(from)e(PE)i(1,)g
(and)f(I)s(IPEP+1)h(and)0 5723 y(I)s(IPEP+2)e(b)m(y)g(cop)m(ying)g
(slices)f(1)g(and)g(2)g(from)f(PE)i(3.)44 b(The)33 b(external)f(halos)g
(\(slices)g(-1)f(and)i(0)f(of)g(PE)0 5844 y(0)e(and)h(I)s(IPEP+1)h(and)
f(I)s(IPEP+2)g(of)g(PE)g(4\))g(are)f(set)i(to)e(imp)s(ose)g(the)h(p)s
(erio)s(dicit)m(y)e(as)i(b)s(efore.)43 b(F)-8 b(rom)0
5964 y(Bro)m(wn)33 b(et)g(al)e(\(1997\).)1841 6107 y(39)p
eop
%%Page: 40 43
40 42 bop 146 52 a Fv(The)27 b(data)f(on)g(eac)m(h)h(PE)g(is)f(divided)
f(in)m(to)h(NPES)h(\\pac)m(k)m(ets")h(I)s(IPEP)f(b)m(y)g(JJPEP)g
(\(=JJP/NPES\))0 173 y(in)35 b(size.)52 b(This)35 b(data)g(is)g(transp)
s(osed)i(using)e(subroutine)g Fw(TRANSPOSE)f Fv(suc)m(h)j(that)e(the)h
(data)f(in)0 293 y(the)42 b Fn(x)g Fv(and)g Fn(y)i Fv(directions)d(are)
h(sw)m(app)s(ed,)k(and)41 b(this)h(is)f(held)g(in)g(the)h(arra)m(y)g(P)
-8 b(A)m(CKET.)43 b(Eac)m(h)g(PE)0 414 y(sends)29 b(the)g(pac)m(k)m(et)
g(to)e(the)h(appropriate)f(PE)i(as)f(illustrated)d(in)i(Fig.)g(10c.)41
b(The)29 b(algorithm)24 b(w)m(orks)30 b(b)m(y)0 534 y(lo)s(oping)e(o)m
(v)m(er)j(NPES)h(and,)f(if)e(the)i(lo)s(cal)d(PE)j(matc)m(hes)g(the)f
(lo)s(op)f(coun)m(ter,)j(then)f(that)f(PE)h(sends)h(its)0
654 y(pac)m(k)m(ets)i(to)e(the)h(other)g(PEs,)g(else)g(it)e(receiv)m
(es)j(pac)m(k)m(ets)h(from)c(PE)i(indicated)e(b)m(y)j(the)f(lo)s(op)d
(coun)m(ter.)0 775 y(Receiv)m(ed)i(pac)m(k)m(ets)h(are)e(placed)g
(directly)f(in)m(to)g(PT.)i(The)f Fn(x)p Fv(-direction)f(transform)g
(\(and)h(tridiagonal)0 895 y(solv)m(er\))26 b(can)g(then)h(b)s(e)f
(executed)i(up)s(on)e(PT.)h(The)g(in)m(v)m(erse)g(F)-8
b(ourier)25 b(transform)g(in)g Fw(FFSYNTH)h Fv(uses)0
1016 y(the)34 b(rev)m(erse)i(of)d(the)g(ab)s(o)m(v)m(e,)i(with)e(the)h
Fn(x)p Fv(-direction)e(transform)h(p)s(erformed)g(\014rst)h(on)f(PT,)i
(then)f(PT)0 1136 y(is)k(passed)i(to)e(P)-8 b(,)38 b(transp)s(osed)i
(to)d(the)i(original)c(decomp)s(osition,)j(and)h(the)g
Fn(y)t Fv(-direction)c(transform)0 1256 y(p)s(erformed.)0
1666 y Fp(6.2)135 b(Diagnostics)0 1971 y Fv(Diagnostic)45
b(output,)50 b(whether)e(it)e(b)s(e)h(mean)f(time-a)m(v)m(eraged)g
(pro\014les)h(or)f(instan)m(taneous)h(\014elds,)0 2091
y(requires)c(the)f(distributed)f(data)h(to)f(b)s(e)h(collected)f
(together)i(in)e(some)g(w)m(a)m(y)-8 b(.)73 b(When)42
b(writing)f(out)0 2211 y(instan)m(taneous)i(\014elds)f(in)g(an)g
Fn(x)p Fv(-plane)f(message)i(passing)f(is)g(required)h(to)e(construct)j
(the)e(output)0 2332 y(\014eld.)h(The)31 b(t)m(w)m(o)g(routines)f(that)
h(deal)e(with)h(the)h(message)g(passing)g(in)e(the)i(LEM)g(for)f(the)h
(diagnostic)0 2452 y(slices)46 b(are)g Fw(WR)-9 b(TXZ)45
b Fv(for)g(writing)g(out)h(a)f Fn(x)p Fv(-)p Fn(z)51
b Fv(slice)45 b(and)i Fw(WR)-9 b(TXY)44 b Fv(used)j(for)e(writing)g
(out)h(a)0 2573 y(horizon)m(tal)31 b(slice,)h(either)g(individually)-8
b(,)30 b(or)i(as)h(part)f(of)g(a)h(3-D)e(\014eld.)146
2813 y(The)k(message)g(passing)f(in)f Fw(WR)-9 b(TXZ)33
b Fv(is)h(relativ)m(ely)f(straigh)m(tforw)m(ard.)48 b(The)35
b(target)f Fn(x)p Fv(-)p Fn(z)k Fv(arra)m(y)0 2934 y(is)33
b(TEMP)i(on)e(PE)h(0)f(\(the)h(diagnostics)f(\014le)g(is)g(only)g
(written)g(out)g(through)g(PE)i(zero\).)46 b(Lo)s(cal)32
b(data)0 3054 y(is)27 b(assigned)h(directly)g(to)f(TEMP)-8
b(,)29 b(whilst)f(remote)f(data)g(is)h(passed)h(via)e(the)h(arra)m(y)g
(P)-8 b(A)m(CKET,)30 b(whic)m(h)0 3174 y(is)i(assigned)h(to)f(TEMP)h
(on)g(receipt.)43 b(An)33 b(extra)g(column)e(of)h(data)g(is)g(passed)h
(from)e(the)i(\014nal)f(PE)h(to)0 3295 y(add)g(an)f(I)s(IP+1)h(halo)e
(to)h(the)h(output)g(slice)f(\(the)h(I=0)f(halo)g(is)g(lo)s(cal)e(to)i
(PE)i(0\).)146 3536 y(The)h(situation)e(is)h(more)f(complicated)g(in)g
Fw(WR)-9 b(TXY)p Fv(,)33 b(as)h(an)g(en)m(tire)g(horizon)m(tal)f(slice)
g(ma)m(y)h(b)s(e)0 3656 y(to)s(o)40 b(large)f(to)i(hold)f(in)g(memory)g
(at)g(an)m(y)h(one)g(time,)h(and)f(the)g(data)f(needs)i(to)f(b)s(e)g
(ordered)g Fn(x)p Fv(-)p Fn(y)t Fv(-)p Fn(z)0 3776 y
Fv(rather)24 b(than)g(the)g Fn(y)t Fv(-)p Fn(z)t Fv(-)p
Fn(x)f Fv(as)i(with)e(the)h(mo)s(del)f(v)-5 b(ariables.)39
b(The)25 b(target)e(arra)m(y)h(is)g(TEMP)-8 b(,)25 b(dimensioned)0
3897 y(I)s(IP+2)39 b(b)m(y)g(JJPEP)h(\(including)c(I=0)i(and)h(I)s
(IP+1)g(halo)s(es\),)g(whic)m(h)g(needs)h(to)e(b)s(e)h(\014lled)e(b)m
(y)i(NPES)0 4017 y(pac)m(k)m(ets)46 b(of)e(data)f(\(in)g(P)-8
b(A)m(CKET\))46 b(I)s(IPEP)f(b)m(y)g(JJPEP)g(in)e(size.)78
b(There)45 b(is)f(a)f(double)h(lo)s(op)e(o)m(v)m(er)0
4138 y(NPES,)j(the)g(outer)f(one)g(for)g(the)h(\014lling)c(of)j(eac)m
(h)h(TEMP)-8 b(,)45 b(and)g(the)f(second)i(for)d(the)i(passing)f(of)0
4258 y(P)-8 b(A)m(CKET)32 b(from)d(the)i(other)f(PEs.)44
b(After)31 b(eac)m(h)g(pass)g(of)f(the)g(outer)h(lo)s(op)e(TEMP)i(is)f
(written)g(out)h(b)m(y)0 4378 y(call)c(to)h Fw(WR)-9
b(TFB)28 b Fv(and)g(the)h Fn(y)t Fv(-direction)d(o\013set)j(\(JOFF\))f
(is)g(incremen)m(ted)h(b)m(y)h(JJPEP)g(for)e(the)h(next)0
4499 y(pass.)45 b(The)34 b(added)g(complication)29 b(are)k(the)h(halo)s
(es)e(for)g(J=0)h(and)g(JJP+1.)44 b(These)35 b(are)e(written)g(out)0
4619 y(separately)g(at)f(the)h(b)s(eginning)e(and)i(end)g(of)f(the)h
(routine.)146 4860 y(The)23 b(mean)e(pro\014les)h(for)f(the)h(time-a)m
(v)m(eraged)f(diagnostics)g(are)h(calculated)f(separately)h(in)f(DGNEW)
0 4980 y(for)29 b(eac)m(h)i(PE.)f(A)m(t)g(the)h(end)f(of)f
Fw(NNSTEPS)g Fv(the)h(DGNEW)g(v)-5 b(alues)29 b(ha)m(v)m(e)i(to)f(b)s
(e)g(summed)f(together)0 5101 y(o)m(v)m(er)35 b(all)d(PEs.)49
b(This)34 b(is)g(p)s(erformed)f(in)g(a)h(call)e(to)i
Fw(GR)m(OUPDGS)f Fv(whic)m(h)i(calls)e(the)h(GC)p 3390
5101 30 4 v 35 w(RSUMR)0 5221 y(routine)29 b(on)g(DGNEW)h(and)f
(DGSPNEW.)h(It)g(is)f(p)s(ossible)f(for)h(DGNEW)h(to)f(b)s(e)h(larger)e
(than)h(MAX-)0 5341 y(COLL,)47 b(whic)m(h)g(the)g(maxim)m(um)e(size)i
(of)f(arra)m(y)h(that)f(can)h(b)s(e)g(treated)g(through)g(message)g
(pass-)0 5462 y(ing.)61 b(In)39 b(this)f(ev)m(en)m(tualit)m(y)-8
b(,)41 b(eac)m(h)e(individual)d(comp)s(onen)m(t)j(of)f(DGNEW)g(is)g
(summed)h(in)f(separate)0 5582 y(GC)p 153 5582 V 35 w(RSUMR)f(calls.)53
b(Means)37 b(are)f(also)g(required)g(in)g(the)g(time)f(series)i
(diagnostics)f(in)f Fw(TIMSER)p Fv(.)0 5702 y(Here,)42
b(eac)m(h)f(diagnostic)d(is)i(treated)g(as)g(a)f(separate)i(scalar)e
(and)h(the)g(domain)e(sum)i(of)f(the)h(scalar)0 5823
y(is)h(calculated)g(b)s(efore)h(b)s(eing)f(assigned)h(to)f(SER.)h(Some)
f(timeseries)g(domain)f(diagnostics)h(are)h(of)1841 6107
y(40)p eop
%%Page: 41 44
41 43 bop 709 1372 2126 4 v 707 1370 4 1418 v 2833 1370
V 709 -45 2126 4 v 709 3262 V 707 3260 4 1418 v 2833
3260 V 709 1844 2126 4 v 709 5151 V 707 5150 4 1418 v
2833 5150 V 709 3734 2126 4 v 1250 1370 4 1418 v 1770
1370 V 2290 1370 V 709 2907 2126 4 v 709 2553 V 709 2199
V 940 694 a Fw(0)464 b(1)487 b(2)464 b(3)1744 3127 y(0)1744
2772 y(1)1744 2418 y(2)1744 2064 y(3)672 1522 y Fl(X)672
3412 y(X)672 5302 y(X)554 1404 y(Y)554 3294 y(Y)554 5184
y(Y)p 827 1490 119 4 v 863 1488 a Fo(-)p 827 3380 V 862
3378 a(-)p 827 5269 V 862 5267 a(-)p 589 1252 4 119 v
591 1217 a(6)p 589 3142 V 591 3107 a(6)p 589 5032 V 591
4996 a(6)528 -140 y Fv(\(a\))526 1749 y(\(b\))531 3639
y(\(c\))775 3953 y Fw(0)p 921 3923 119 4 v 957 3921 a
Fo(-)1106 3953 y Fw(3)156 b(1)p 1465 3923 V 1501 3921
a Fo(-)1649 3953 y Fw(3)133 b(2)p 1984 3923 V 2020 3921
a Fo(-)2169 3953 y Fw(3)775 4308 y(0)p 921 4277 V 957
4275 a Fo(-)1106 4308 y Fw(2)156 b(1)p 1465 4277 V 1501
4275 a Fo(-)1649 4308 y Fw(2)676 b(3)p 2528 4277 V 2564
4275 a Fo(-)2712 4308 y Fw(2)775 4662 y(0)p 921 4632
V 957 4630 a Fo(-)1106 4662 y Fw(1)g(2)p 1984 4632 V
2020 4630 a Fo(-)2169 4662 y Fw(1)156 b(3)p 2528 4632
V 2564 4630 a Fo(-)2712 4662 y Fw(1)1318 5016 y(1)p 1465
4986 V 1501 4984 a Fo(-)1649 5016 y Fw(0)133 b(2)p 1984
4986 V 2020 4984 a Fo(-)2169 5016 y Fw(0)156 b(3)p 2528
4986 V 2564 4984 a Fo(-)2712 5016 y Fw(0)p 1250 5150
4 95 v 1250 4961 V 1250 4772 V 1250 4583 V 1250 4394
V 1250 4205 V 1250 4016 V 1250 3827 V 1770 5150 V 1770
4961 V 1770 4772 V 1770 4583 V 1770 4394 V 1770 4205
V 1770 4016 V 1770 3827 V 2313 5150 V 2313 4961 V 2313
4772 V 2313 4583 V 2313 4394 V 2313 4205 V 2313 4016
V 2313 3827 V 709 4797 142 4 v 992 4797 V 1276 4797 V
1559 4797 V 1843 4797 V 2126 4797 V 2409 4797 V 2693
4797 V 709 4443 V 992 4443 V 1276 4443 V 1559 4443 V
1843 4443 V 2126 4443 V 2409 4443 V 2693 4443 V 709 4088
V 992 4088 V 1276 4088 V 1559 4088 V 1843 4088 V 2126
4088 V 2409 4088 V 2693 4088 V 0 5518 a Fv(Figure)43
b(10:)66 b(Sc)m(hematic)44 b(diagram)d(of)j(the)g(arrangemen)m(t)g(of)f
(data)h(in)f(a)h(horizon)m(tal)e(slice)i(of)f(the)0 5639
y(mo)s(del)32 b(for)h(four)g(pro)s(cessors:)46 b(\(a\))33
b(standard)h(arrangemen)m(t)f(for)g Fn(x)p Fv(-direction)f(\013t;)h
(\(b\))h(arrangemen)m(t)0 5759 y(for)k Fn(y)t Fv(-direction)f(\013t;)42
b(\(c\))d(data)g(transfers)g(required)h(to)e(go)h(from)f(\(a\))g(to)h
(\(b\).)62 b(F)-8 b(rom)38 b(Bro)m(wn)h(et)h(al)0 5880
y(\(1997\).)1841 6107 y(41)p eop
%%Page: 42 45
42 44 bop 0 52 a Fv(maxima)27 b(and)i(minima)d(and)j(in)f(these)j
(situations)d(calls)g(to)h(GC)p 2371 52 30 4 v 35 w(RMAX)g(and)g(GC)p
3075 52 V 36 w(RMIN)g(are)g(used.)0 462 y Fp(6.3)135
b(Means)45 b(and)g(Extremes)0 767 y Fv(Domain)27 b(means)j(are)f
(required)h(for)f(the)h(damping)e(la)m(y)m(er)i(incremen)m(ts)g(and)g
(an)m(y)g(large-scale)e(v)m(ertical)0 887 y(adv)m(ection)h(terms.)42
b(The)29 b(answ)m(ers)h(for)e(an)g(iden)m(tical)f(in)m(tegration,)h
(but)g(run)h(on)f(a)g(di\013eren)m(t)h(n)m(um)m(b)s(ers)0
1008 y(of)34 b(PES,)h(w)m(ould)f(not)g(b)s(e)h(the)f(same)g(if)g(the)g
(horizon)m(tal)f(mean)h(calculation)d(w)m(ere)36 b(not)e(repro)s
(ducible)0 1128 y(for)27 b(an)g(arbitrary)f(n)m(um)m(b)s(er)i(of)e
(PEs.)43 b(This)27 b(is)g(ensured)i(in)d Fw(CALCBAR)g
Fv(b)m(y)i(setting)f(the)h(parameter)0 1248 y(IREPBARP=1.)82
b(Firstly)-8 b(,)48 b(the)d(means)h(are)f(calculated)f(for)h(eac)m(h)h
(v)m(ertical)f(slice)g(and)g(assigned)0 1369 y(to)35
b(arra)m(y)h(UBAR)-8 b(TMP)37 b(etc,)g(dimensioned)e(I)s(IPEP)i(b)m(y)g
(KKP)-8 b(.)35 b(If)h(IREPBARP=0)g(then)h(these)f(are)0
1489 y(just)44 b(summed)f(o)m(v)m(er)h(I)s(IPEP)h(in)m(to)e(UBAR)g
(etc.)77 b(These)45 b(are)e(then)h(summed)f(o)m(v)m(er)i(all)c(PEs.)77
b(F)-8 b(or)0 1609 y(the)31 b(repro)s(ducible)e(calculation)f(the)j
(routine)f(GCG)p 1945 1609 V 34 w(R)-11 b(VECSUMR)32
b(p)s(erforms)e(a)g(repro)s(ducible)g(sum)0 1730 y(assigning)40
b(the)h(sum)g(of)f(UBAR)-8 b(TMP)42 b(etc)g(on)f(all)e(PEs)j(in)m(to)e
(UBAR)h(etc.)69 b(The)42 b(means)f(are)g(then)0 1850
y(divided)30 b(b)m(y)i(the)f(n)m(um)m(b)s(er)h(of)e(p)s(oin)m(ts)g(and)
h(assigned)g(to)g(OLUBAR)g(etc)g(whic)m(h)g(are)g(the)h(v)-5
b(alues)30 b(used)0 1971 y(in)i(the)h(in)m(tegration.)146
2211 y(Domain)38 b(wide)i(maxim)m(um)e(v)m(elo)s(cities)h(are)i
(required)f(for)g(the)h(Couran)m(t)f(n)m(um)m(b)s(er)h(calculation.)0
2332 y(The)23 b(message)g(passing)f(part)g(of)f(this)h(calculation)e
(is)h(p)s(erformed)h(in)f Fw(CVELGAL2)p Fv(.)40 b(The)23
b(maxim)m(um)0 2452 y(and)29 b(minim)m(um)d(horizon)m(tal)i(v)m(elo)s
(cit)m(y)h(comp)s(onen)m(ts)h(for)e(the)i(whole)f(domain)e(are)j
(determined)f(using)0 2573 y(the)k(GC)p 321 2573 V 35
w(RMAX)g(and)f(GC)p 1032 2573 V 35 w(RMIN)h(calls.)42
b(Similarly)29 b(the)j(maxim)m(um)e(v)m(ertical)i(adv)m(ectiv)m(e)i
(Couran)m(t)0 2693 y(n)m(um)m(b)s(er)45 b(\(CVELZ\))g(and)g(the)g
(viscous)g(Couran)m(t)g(n)m(um)m(b)s(er)g(\(CVIS\))h(for)e(the)h(whole)
g(domain)d(are)0 2813 y(found)33 b(using)f(GC)p 682 2813
V 35 w(RMAX.)146 3054 y(Although)41 b(not)h(necessary)i(for)d(the)i(mo)
s(del)d(in)m(tegration,)i(it)f(is)g(sometimes)g(useful)h(to)f(output)0
3174 y(the)d(maxim)m(um)e(div)m(ergence)j(error)f(in)f(the)h(mo)s(del,)
f(plus)h(its)f(lo)s(cation,)g(and)h(this)g(is)f(p)s(erformed)g(in)0
3295 y Fw(POISSON)p Fv(.)22 b(The)h(lo)s(cal)d(maxim)m(um)g(div)m
(ergence)k(is)e(calculated)f(on)h(eac)m(h)h(PE)g(in)f(routine)f
Fw(DIVERR)0 3415 y Fv(and)27 b(stored)h(in)f(DIVMAX,)h(along)e(with)h
(its)f(co)s(ordinates)h(in)g(the)h(arra)m(y)f(ICOMAX.)i(The)f(maxim)m
(um)0 3536 y(div)m(ergence)34 b(is)d(found)i(b)m(y)g(p)s(erforming)d(a)
i(GC)p 1715 3536 V 35 w(RMAX)h(routine)f(on)g(DIVMAX.)h(The)g(PE)g(on)f
(whic)m(h)0 3656 y(this)h(maxim)m(um)d(is)j(lo)s(cated)f(is)g
(determined)h(b)m(y)h(seeing)f(if)f(the)h(global)e(maxim)m(um)f(equals)
j(the)h(lo)s(cal)0 3776 y(maxim)m(um)g(on)i(eac)m(h)h(PE.)f(If)g(it)f
(do)s(es,)j(then)e(it)f(is)h(that)g(PE's)h(v)-5 b(alues)36
b(of)f(ICOMAX)i(that)f(are)g(used)0 3897 y(to)c(sho)m(w)i(the)f(p)s
(osition)e(of)h(the)h(maxim)m(um)d(div)m(ergence)k(error.)0
4306 y Fp(6.4)135 b(2-D)45 b(P)l(arallel)i(Pro)t(cessing)0
4611 y Fv(The)27 b(domain)e(decomp)s(osition)g(at)h(V)-8
b(ersion)26 b(2.0)g(\(Bro)m(wn)h(et)g(al)e(1997\))g(only)h(allo)m(w)m
(ed)g(the)h(3-D)e(v)m(ersion)0 4731 y(of)46 b(the)g(mo)s(del)f(to)h
(run)h(massiv)m(ely)f(parallel.)81 b(Changes)48 b(ha)m(v)m(e)f(b)s(een)
g(made)f(so)h(that)f(at)g(V)-8 b(ersion)0 4852 y(2.3)41
b(the)h(LEM)g(can)f(b)s(e)h(run)f(massiv)m(ely)g(parallel)e(in)i(2-D)f
(as)h(w)m(ell.)69 b(This)42 b(necessarily)g(in)m(v)m(olv)m(es)g(a)0
4972 y(di\013eren)m(t)37 b(domain)e(decomp)s(osition,)h(and)h(some)g(c)
m(hanges)h(to)f(parts)g(of)f(the)i(co)s(de.)56 b(These)39
b(c)m(hanges)0 5093 y(are)44 b(protected)h(b)m(y)g(parameter)f
(statemen)m(ts)h(so)g(that)f(they)h(only)f(a\013ect)g(2-D)f(MPP)i
(runs.)79 b(This)0 5213 y(section)33 b(will)d(describ)s(e)j(some)g(of)f
(the)h(co)s(ding)e(issues)j(relev)-5 b(an)m(t)32 b(to)h(the)g(2-D)e
(MPP)j(co)s(de.)146 5454 y(Firstly)-8 b(,)44 b(when)f(running)f(MPP)i
(in)e(2-D)f(a)h(di\013eren)m(t)h(domain)e(decomp)s(osition)f(is)i
(used.)75 b(The)0 5574 y(v)m(ertical)28 b(slice)g(is)g(split)g(in)m(to)
g(NPES)h(sections)h(in)e(the)h Fn(y)t Fv(-direction.)40
b(T)-8 b(o)28 b(simplify)e(the)k(c)m(hanges)g(to)e(the)0
5695 y(co)s(de)37 b(eac)m(h)i(of)d(these)j(sections)e(con)m(tains)h
(JJP)f(n)m(um)m(b)s(er)h(of)f(columns,)g(so)h(that)f(the)g(whole)g
(domain)0 5815 y(con)m(tains)31 b(NPES)p Fm(\002)p Fv(JJP)i(\()d(=)h
(JJTOTP)h(\))f(columns.)42 b(This)31 b(is)f(sligh)m(tly)f(confusing)i
(in)f(the)h(con)m(text)h(of)1841 6107 y(42)p eop
%%Page: 43 46
43 45 bop 0 52 a Fv(the)39 b(nomenclature)f(for)g(the)h
Fn(x)p Fv(-direction)f(\(I)s(IP)h(and)f(I)s(IPEP\),)i(but)f(JJTOTP)h(b)
s(ecomes)f(the)g(total)0 173 y(n)m(um)m(b)s(er)d(of)g(columns)f(in)g
(the)i Fn(y)t Fv(-direction)c(for)j(all)e(runs,)j(2-D)e(and)h(3-D,)f
(and)h(is)f(used)j(throughout)0 293 y(the)k(mo)s(del)d(where)j
(appropriate.)69 b(This)41 b(decomp)s(osition)e(do)s(es)j(require)f(c)m
(hanges)i(to)d(the)i(routine)0 414 y Fw(WRAP)32 b Fv(whic)m(h)h
(enforces)h(the)g Fn(y)t Fv(-direction)c(b)s(oundary)k(conditions.)44
b(F)-8 b(or)32 b(the)h(2-D)f(MPP)i(case)g(the)0 534 y(halo)d(columns)h
(no)m(w)h(ha)m(v)m(e)h(to)f(b)s(e)f(passed)i(b)s(et)m(w)m(een)h
(adjacen)m(t)e(PEs)h(using)e(the)h(GCOM)g(routines.)146
775 y(The)41 b(next)h(ma)5 b(jor)39 b(c)m(hange)i(is)e(in)h(the)g
(pressure)j(solv)m(er.)66 b(Although)40 b(only)f(a)h
Fn(y)t Fv(-direction)e(\013t)i(is)0 895 y(required)g(the)g(data)f(in)g
(that)g(direction)g(is)g(distributed)g(and)h(so)f(needs)i(to)f(b)s(e)f
(collected)g(together)0 1016 y(for)45 b(the)h(in)m(tegration.)81
b(The)46 b(distributed)f(pressure)j(source,)i(P)-8 b(,)46
b(is)f(collected)g(together)h(in)e(arra)m(y)0 1136 y(PT,)f(whic)m(h)g
(is)f(dimensioned)g(b)m(y)h(JJTOTP)-8 b(,)43 b(through)g(a)f(call)f(to)
h(subroutine)g Fw(RECOMBINE)p Fv(.)0 1256 y(This)h(subroutine)g
(collects)f(a)h(distributed)f(arra)m(y)h(of)g(size)g(JJP)g(in)m(to)f(a)
h(full)e(domain)g(sized)i(arra)m(y)0 1377 y(of)c(size)h(JJTOTP)-8
b(.)41 b(The)g(\013t,)g(tridiagonal)c(solv)m(er)j(and)g(in)m(v)m(erse)h
(\013t)e(act)h(on)g(PT,)g(after)g(whic)m(h)g(it)f(is)0
1497 y(redistributed)46 b(bac)m(k)h(across)f(the)h(PEs)g(in)m(to)e
(arra)m(y)h(P)g(b)m(y)h(routine)e Fw(DISTRIB)p Fv(.)g(Note)h(that)g
(the)0 1617 y(pressure)34 b(solv)m(er)f(is)f(not)h(a)f(parallel)e
(calculation)g(for)i(an)h(MPP)g(2-D)f(run.)146 1858 y(Another)d(c)m
(hange)h(is)e(to)g(the)h(UL)-8 b(TIMA)g(TE)30 b(adv)m(ection)f(sc)m
(heme.)44 b(F)-8 b(ace)28 b(\015uxes)j(need)e(to)f(b)s(e)h(calcu-)0
1979 y(lated)h(on)i(the)f(J=0)g(column)f(for)h(the)g(J=1)g(in)m
(tegration)f(whic)m(h,)i(dep)s(ending)f(on)g(the)h(\015o)m(w)f
(direction,)0 2099 y(ma)m(y)c(require)g(J=-1)g(v)-5 b(alues.)41
b(Hence,)30 b(for)d(the)g(UL)-8 b(TIMA)g(TE)29 b(adv)m(ection)f
(routines)f(additional)d(halo)s(es)0 2219 y(need)k(to)f(b)s(e)h(set)g
(up)f(to)g(cater)h(for)e(this)h(ev)m(en)m(tualit)m(y)-8
b(.)42 b(This)28 b(requires)g(the)g(in)m(tro)s(duction)d(of)i(the)h
(arra)m(ys)0 2340 y(VHALO)j(and)f(ZFHALO)g(in)g Fw(TVDSC2D)g
Fv(and)h Fw(TVDUVW2D)e Fv(to)h(represen)m(t)j(the)e(J=-1)f(v)-5
b(alues)0 2460 y(of)39 b(the)h(v)m(elo)s(cit)m(y)f(and)g(adv)m(ected)j
(\014eld)d(resp)s(ectiv)m(ely)-8 b(,)42 b(whic)m(h)e(are)f(passed)i(to)
e(the)h(\015ux)g(calculation)0 2580 y(routine,)32 b Fw(UL)-9
b(TF2D)p Fv(.)146 2821 y(A)35 b(new)h(routine,)f Fw(CBAR2D)p
Fv(,)e(has)i(b)s(een)h(in)m(tro)s(duced)f(for)f(the)h(calculation)e(of)
h(the)h(horizon)m(tal)0 2942 y(means)k(for)f(MPP)i(2-D)d(as)i(it)f(is)h
(not)f(p)s(ossible)g(to)h(calculate)e(repro)s(ducible)i(means)f(o)m(v)m
(er)i(di\013eren)m(t)0 3062 y(n)m(um)m(b)s(er)e(of)f(PEs)h(in)f(2-D)f
(from)g(the)h(existing)g(logic)e(in)i Fw(CALCBAR)p Fv(.)f(The)i(mean)f
(calculation)e(is)0 3182 y(p)s(erformed)d(in)g(routine)g
Fw(CB2DCALC)g Fv(and)g(to)g(ensure)i(repro)s(ducibilit)m(y)d(the)i
(distributed)f(\014eld)g(is)0 3303 y(recom)m(bined)39
b(in)m(to)f(a)h(large)f(arra)m(y)h(ALL)-11 b(V)g(ALS)40
b(using)f Fw(RECOMBINE)e Fv(whic)m(h)i(is)g(then)h(summed)0
3423 y(from)31 b(J=1)i(to)f(JJTOTP)-8 b(.)146 3664 y(The)34
b(\014nal)f(ma)5 b(jor)31 b(c)m(hange)j(is)f(to)g(the)g(instan)m
(taneous)h(\014eld)e(diagnostics)h(in)f Fw(DIA)m(G)p
Fv(.)g(Again)g(the)0 3784 y(distributed)i(\014eld)h(is)f(recom)m(bined)
h(in)m(to)f(a)g(full)f(size)i(arra)m(y)g(b)m(y)h(use)g(of)e
Fw(RECOMBINE)p Fv(,)f(and)i(this)0 3905 y(full)c(domain)g(size)h(arra)m
(y)h(is)f(written)h(out)f(in)g(the)h(usual)f(w)m(a)m(y)-8
b(.)146 4145 y Fl(Note:)63 b(MPP)45 b(2-D)e(runs)h(with)f(di\013er)-5
b(ent)44 b(numb)-5 b(ers)43 b(of)g(PEs)h(may)g(not)g(b)-5
b(e)43 b(r)-5 b(epr)g(o)g(ducible)43 b(when)0 4266 y(using)33
b(c)-5 b(ertain)32 b(optimization)g(options.)44 b(This)32
b(is)g(due)h(to)g(the)g(di\013er)-5 b(ent)33 b(length)f(of)h(lo)-5
b(ops)32 b(\(J=1,JJP\))0 4386 y(and)42 b(the)h(imp)-5
b(act)42 b(this)h(has)f(on)g(the)h(way)g(the)f(c)-5 b(o)g(de)42
b(is)h(optimize)-5 b(d.)67 b(R)-5 b(epr)g(o)g(ducibility)43
b(for)f(di\013er)-5 b(ent)0 4507 y(numb)g(ers)34 b(of)h(PEs)g(c)-5
b(an)34 b(b)-5 b(e)35 b(obtaine)-5 b(d)34 b(by)h(running)f(without)h
(any)g(optimization.)0 4960 y Fx(7)161 b(Co)t(ding)53
b(Standards)0 5299 y Fv(In)40 b(dev)m(eloping)f(V)-8
b(ersion)40 b(2.3)f(of)g(the)h(mo)s(del)e(the)j(follo)m(wing)c(co)s
(ding)h(standards)j(ha)m(v)m(e)g(b)s(een)f(used.)0 5420
y(Retained)33 b(co)s(de)h(whic)m(h)h(did)e(not)g(conform)g(to)h(the)g
(standard)g(has)g(not)g(necessarily)g(b)s(een)g(c)m(hanged,)0
5540 y(ho)m(w)m(ev)m(er.)58 b(It)37 b(is)f(suggested)j(that)d(all)f
(future)i(co)s(de)g(dev)m(elopmen)m(t)g(k)m(eeps)i(to)d(this,)i(or)e
(an)h(up)s(dated,)0 5660 y(standard.)1841 6107 y(43)p
eop
%%Page: 44 47
44 46 bop 119 52 a Fv(1.)49 b(IMPLICIT)35 b(NONE)e(to)f(b)s(e)h(used)g
(at)g(all)d(times.)119 251 y(2.)49 b(Eac)m(h)32 b(program)e(or)i
(subprogram)f(should)g(con)m(tain)g(a)g(standard)h(header)g(blo)s(c)m
(k.)43 b(This)32 b(will)d(b)s(e)244 371 y(structured)34
b(as)f(follo)m(ws:)360 570 y Fm(\017)48 b Fv(SUBR)m(OUTINE)35
b(line.)360 726 y Fm(\017)48 b Fv(Description)32 b(of)g(subprogram.)360
883 y Fm(\017)48 b Fv(Metho)s(d)34 b(used,)f(if)f(applicable.)360
1040 y Fm(\017)48 b Fv(COMDECKS.)360 1197 y Fm(\017)g
Fv(Declaration)c(of)h(subroutine)i(argumen)m(ts,)i(using)d(the)g
(INTENT)h(statemen)m(t,)j(sub)s(di-)458 1317 y(vided)f(in)m(to)e(those)
i(whic)m(h)g(con)m(tain)f(a)f(v)-5 b(alue)48 b(whic)m(h)h(do)s(es)f
(not)g(c)m(hange)h(\(IN\),)g(those)458 1438 y(whic)m(h)31
b(con)m(tain)e(a)g(v)-5 b(alue)29 b(whic)m(h)i(do)s(es)f(c)m(hange)g
(\(INOUT\),)h(those)f(whic)m(h)g(ha)m(v)m(e)h(no)f(v)-5
b(alue)458 1558 y(on)38 b(input)g(but)g(a)g(v)-5 b(alue)37
b(on)h(output)g(\(OUT\).)g(These)i(should)e(b)s(e)g(ordered)h(as)f
(logicals,)458 1678 y(scalars)33 b(and)g(then)g(arra)m(ys)g(within)e
(this)i(order.)360 1835 y Fm(\017)48 b Fv(Declaration)c(of)i(lo)s(cal)e
(v)-5 b(ariables)44 b(in)i(the)g(order)g(parameters,)k(logicals,)d
(scalars)e(and)458 1956 y(arra)m(ys.)119 2154 y(3.)k(All)23
b(DO)i(lo)s(ops)f(shall)g(b)s(e)h(terminated)f(b)m(y)j(an)e(ENDDO;)f
(CONTINUE)j(should)e(NOT)h(b)s(e)f(used.)244 2274 y(An)33
b(inden)m(tation)e(of)h(t)m(w)m(o)i(columns)e(should)g(b)s(e)h(used)g
(within)f(DO)g(lo)s(ops)f(and)i(IF)f(blo)s(c)m(ks.)119
2473 y(4.)49 b(ENNDO)25 b(and)g(ENDIF)f(statemen)m(ts)i(should)f(b)s(e)
g(follo)m(w)m(ed)f(b)m(y)i(an)f(in-line)d(commen)m(t)i(indicated)244
2593 y(whic)m(h)45 b(lo)s(op/blo)s(c)m(k)e(is)h(b)s(eing)g(terminated)g
(if)g(not)g(immediately)e(ob)m(vious.)80 b(ENDDO)44 b(and)244
2713 y(ENDIF)32 b(should)h(b)s(e)f(written)h(as)g(one)g(w)m(ord.)119
2912 y(5.)49 b(V)-8 b(ariable)31 b(names)h(should)h(b)s(e)f
(meaningful.)119 3110 y(6.)49 b(Maxim)m(um)31 b(line)g(length)i(as)f
(in)g(F)m(OR)-8 b(TRAN77.)119 3309 y(7.)49 b(All)21 b(F)m(OR)-8
b(TRAN)23 b(k)m(eyw)m(ords)j(MUST)e(BE)g(written)f(in)f(upp)s(er)i
(case.)41 b(Use)24 b(lo)m(w)m(er/mixed)f(case)h(for)244
3429 y(v)-5 b(ariable)28 b(names)h(if)g(this)g(impro)m(v)m(es)g(clarit)
m(y)-8 b(.)42 b(If)29 b(a)g(v)-5 b(ariable)28 b(name)h(is)g(written)g
(in)g(lo)m(w)m(er/mixed)244 3549 y(case)k(this)g(should)f(b)s(e)h
(retained)f(throughout)h(the)g(program.)119 3748 y(8.)49
b(Use)33 b(blank)g(space)g(to)g(impro)m(v)m(e)f(readabilit)m(y)-8
b(.)119 3946 y(9.)49 b(No)32 b(F)m(ORMA)-8 b(T)33 b(statemen)m(ts:)45
b(use)33 b(c)m(haracter)h(strings)e(instead.)70 4144
y(10.)49 b(Commen)m(ts)32 b(to)h(b)s(e)f(iden)m(ti\014ed)h(b)m(y)g(!)44
b(rather)32 b(than)h(C)g(or)f(*.)70 4343 y(11.)49 b(Con)m(tin)m(uation)
32 b(lines)f(should)i(use)g(&)g(only)-8 b(.)70 4541 y(12.)49
b(One)38 b(space)g(only)f(should)g(b)s(e)h(used)g(b)s(et)m(w)m(een)i
(CALL)e(and)f(SUBR)m(OUTINE)i(k)m(eyw)m(ords)h(and)244
4661 y(the)33 b(routine)f(names,)h(but)f(a)m(v)m(oid)h(using)f(this)g
(syn)m(tax)i(in)e(commen)m(t)g(lines.)70 4860 y(13.)49
b(Calls)32 b(to)h(subroutines)h(should)f(ha)m(v)m(e)i(their)d(argumen)m
(ts)i(on)f(the)h(same)f(lines)f(as)h(they)i(app)s(ear)244
4980 y(in)d(the)h(subroutine)g(argumen)m(t)f(list.)70
5178 y(14.)49 b(V)-8 b(ariables)35 b(b)s(eginning)g(with)h(the)h
(letters)f(I,)h(J,)g(K)f(and)g(N)h(shall)e(b)s(e)i(INTEGERS)g(only)-8
b(.)55 b(Use)244 5299 y(in)m(tegers)28 b(b)s(eginning)f(with)g(N)h(to)g
(describ)s(e)h(a)e(v)-5 b(ariable)27 b(whic)m(h)h(holds)g(a)g(n)m(um)m
(b)s(er)g(of)f(something)244 5419 y(\(e.g.)43 b(n)m(um)m(b)s(er)33
b(of)e(PEs\).)45 b(V)-8 b(ariables)30 b(I,)j(J)f(and)g(K)g(should)f
(only)h(b)s(e)g(used)h(to)f(refer)g(to)g(the)g(x,)h(y)244
5540 y(and)g(z)f(grid)g(p)s(oin)m(ts)g(within)g(the)h(mo)s(del.)70
5738 y(15.)49 b(V)-8 b(ariables)38 b(b)s(eginning)g(L)p
1195 5738 30 4 v 75 w(shall)g(b)s(e)i(LOGICALS)g(only)-8
b(,)41 b(and)f(all)d(LOGICALS)j(shall)e(b)s(egin)244
5858 y(L)p 311 5858 V 35 w(.)1841 6107 y(44)p eop
%%Page: 45 48
45 47 bop 0 52 a Fx(References)3 313 y Fv(Am)m(undsen,)41
b(J.)f(and)f(Sk)-12 b(\027)-61 b(alin,)39 b(R.)g(\(1996\))f(GC)i
(User's)h(Guide,)f(Release)g(1.0.4,)h(SINTEF)f(Applied)179
433 y(Mathematics.)3 637 y(Bro)m(wn,)f(A.)f(R.,)i(Gra)m(y)-8
b(,)38 b(M.)g(E.)g(B.)h(and)f(MacV)-8 b(ean,)39 b(M.)f(K.)g(\(1997\))f
(Large-eddy)i(sim)m(ulation)c(on)j(a)179 757 y(parallel)30
b(computer)i Fl(Met)k(O)e(\(APR\))h(T)-7 b(urbulenc)i(e)34
b(and)h(Di\013usion)e(Note)j(No.240)3 961 y Fv(Derb)m(yshire,)c(S.)e
(H.,)i(Bro)m(wn,)f(A.)f(R.)h(and)f(Lo)s(c)m(k,)i(A.)e(P)-8
b(.)31 b(\(1994\))e(The)j(Meteorological)c(O\016ce)j(Large-)179
1081 y(Eddy)j(Sim)m(ulation)29 b(mo)s(del.)i Fl(Met)k(O)g(\(APR\))g(T)
-7 b(urbulenc)i(e)34 b(and)g(Di\013usion)g(Note)h(No.213)3
1284 y Fv(Gra)m(y)-8 b(,)40 b(M.)h(E.)f(B.)g(and)h(P)m(etc)m(h,)g(J.)g
(\(2001\))e(V)-8 b(ersion)40 b(2.3)f(of)h(the)g(Met)h(O\016ce)g(Large)f
(Eddy)h(Mo)s(del:)179 1405 y(P)m(art)33 b(I.)f(User)i(do)s(cumen)m
(tation.)e Fl(Met)j(O)g(\(APR\))g(T)-7 b(urbulenc)i(e)34
b(and)g(Di\013usion)g(Note)h(No.275)3 1608 y Fv(Gra)m(y)-8
b(,)39 b(M.)g(E.)g(B.,)h(P)m(etc)m(h,)h(J.,)f(Derb)m(yshire,)g(S.)e
(H.,)j(Bro)m(wn,)e(A.)g(R.,)h(Lo)s(c)m(k,)f(A.)g(P)-8
b(.,)41 b(Sw)m(ann,)e(H.)g(A.)179 1729 y(and)e(Bro)m(wn,)h(P)-8
b(.)37 b(R.)f(A.)i(\(2001\))d(V)-8 b(ersion)37 b(2.3)g(of)f(the)h(Met)h
(O\016ce)g(Large)e(Eddy)j(Mo)s(del:)51 b(P)m(art)179
1849 y(I)s(I.)32 b(Scien)m(ti\014c)h(do)s(cumen)m(tation.)f
Fl(Met)j(O)g(\(APR\))g(T)-7 b(urbulenc)i(e)34 b(and)g(Di\013usion)g
(Note)h(No.276)3 2052 y Fv(Ingram,)c(W.)h(J.,)f(W)-8
b(o)s(o)s(dw)m(ard,)32 b(S.)f(and)h(Edw)m(ards,)h(J.)f(M.)g(\(1997\))e
(Radiation.)f Fl(UM)35 b(Do)-5 b(cumentation)179 2173
y(Pap)g(er)34 b(No)h(23)p Fv(.)3 2376 y(Steiner,)26 b(M.,)h(Houze,)f
(R.)f(A.)h(and)f(Y)-8 b(uter,)26 b(S.)f(E.)h(\(1995\))e(Climatological)
c(c)m(haracterization)k(of)h(three-)179 2497 y(dimensional)d(storm)i
(structure)i(from)d(op)s(erational)f(radar)i(and)h(rain)f(gauge)g
(data.)g Fl(J.)k(Appl.)f(Me-)179 2617 y(te)-5 b(or.)p
Fv(,)32 b Fw(34)p Fv(,)h(1978{2007.)1841 6107 y(45)p
eop
%%Page: 46 49
46 48 bop 0 52 a Fx(A)161 b(Description)53 b(of)h(Main)h(V)-13
b(ariables)0 392 y Fv(Belo)m(w)35 b(are)g(the)h(names,)g(lo)s(cations)d
(\(i.e.)i(common)f(blo)s(c)m(k\),)i(dimensions)e(and)h(de\014nitions)g
(of)g(some)0 512 y(of)j(the)h(k)m(ey)h(v)-5 b(ariables)37
b(used)j(in)e(the)h(LEM.)g(Note)g(that)f(the)h(dimensions)f(quoted)h
(do)g(not)f(include)0 633 y(halo)s(es.)p 0 768 4277 7
v 112 847 a Fq(V)-8 b(ariable)232 b(Lo)s(cation)288 b(T)m(yp)s(e)437
b(Dimensions)318 b(De\014nition)p 0 888 V 211 967 a(I)s(IP)268
b(PRAMETR)119 b(P)m(arameter)546 b(-)532 b(T)-8 b(otal)31
b(n)m(um)m(b)s(er)e(of)i(p)s(oin)m(ts)e(in)g Fb(x)p Fq(-direction)199
1079 y(JJP)255 b(PRAMETR)119 b(P)m(arameter)546 b(-)532
b(Num)m(b)s(er)29 b(of)i(p)s(oin)m(ts)e(in)g Fb(y)s Fq(-direction)2724
1192 y(on)h(eac)m(h)i(PE)175 1305 y(KKP)231 b(PRAMETR)119
b(P)m(arameter)546 b(-)532 b(T)-8 b(otal)31 b(n)m(um)m(b)s(er)e(of)i(p)
s(oin)m(ts)e(in)g Fb(z)t Fq(-direction)150 1418 y(I)s(IPEP)205
b(PRAMETR)119 b(P)m(arameter)546 b(-)532 b(Num)m(b)s(er)29
b(of)i(v)m(ertical)f(slices)g(p)s(er)f(PE)98 1531 y(JJTOTP)153
b(PRAMETR)119 b(P)m(arameter)546 b(-)532 b(T)-8 b(otal)31
b(n)m(um)m(b)s(er)e(of)i(p)s(oin)m(ts)e(in)g Fb(y)s Fq(-direction)155
1644 y(NPES)212 b(PRAMETR)119 b(P)m(arameter)546 b(-)532
b(Num)m(b)s(er)29 b(of)i(PEs)176 1757 y(NQP)233 b(PRAMETR)119
b(P)m(arameter)546 b(-)532 b(Num)m(b)s(er)29 b(of)i(w)m(ater)g(sp)s
(ecies)f(\014elds)242 1870 y(U)372 b(FIELDS)178 b(Real)30
b(Arra)m(y)224 b(JJP)-8 b(,KKP)g(,I)s(IPEP)222 b Fb(x)p
Fq(-comp)s(onen)m(t)31 b(of)g(v)m(elo)s(cit)m(y)242 1983
y(V)372 b(FIELDS)178 b(Real)30 b(Arra)m(y)224 b(JJP)-8
b(,KKP)g(,I)s(IPEP)222 b Fb(y)s Fq(-comp)s(onen)m(t)31
b(of)f(v)m(elo)s(cit)m(y)230 2096 y(W)359 b(FIELDS)178
b(Real)30 b(Arra)m(y)224 b(JJP)-8 b(,KKP)g(,I)s(IPEP)222
b Fb(z)t Fq(-comp)s(onen)m(t)31 b(of)g(v)m(elo)s(cit)m(y)210
2209 y(TH)338 b(FIELDS)178 b(Real)30 b(Arra)m(y)224 b(JJP)-8
b(,KKP)g(,I)s(IPEP)222 b(P)m(oten)m(tial)31 b(temp)s(erature)f(p)s
(erturbation)241 2321 y(Q)370 b(FIELDS)178 b(Real)30
b(Arra)m(y)115 b(JJP)-8 b(,KKP)g(,NQP)g(,I)s(IPEP)113
b(W)-8 b(ater)32 b(sp)s(ecies/scalar)e(\014elds)215 2434
y(ZU)343 b(FIELDS)178 b(Real)30 b(Arra)m(y)224 b(JJP)-8
b(,KKP)g(,I)s(IPEP)222 b(U)31 b(on)f(previous/next)f(timestep)215
2547 y(ZV)343 b(FIELDS)178 b(Real)30 b(Arra)m(y)224 b(JJP)-8
b(,KKP)g(,I)s(IPEP)222 b(V)31 b(on)f(previous/next)f(timestep)202
2660 y(ZW)331 b(FIELDS)178 b(Real)30 b(Arra)m(y)224 b(JJP)-8
b(,KKP)g(,I)s(IPEP)222 b(W)31 b(on)f(previous/next)g(timestep)182
2773 y(ZTH)310 b(FIELDS)178 b(Real)30 b(Arra)m(y)224
b(JJP)-8 b(,KKP)g(,I)s(IPEP)222 b(TH)30 b(on)g(previous/next)g
(timestep)213 2886 y(ZQ)342 b(FIELDS)178 b(Real)30 b(Arra)m(y)115
b(JJP)-8 b(,KKP)g(,NQP)g(,I)s(IPEP)113 b(Q)30 b(on)g(previous/next)g
(timestep)217 2999 y(SU)303 b(SR)m(CFLDS)135 b(Real)30
b(Arra)m(y)261 b(JJP)-8 b(,KKP)g(,NSP)259 b(Source)30
b(term)h(for)f(U)217 3112 y(SV)303 b(SR)m(CFLDS)135 b(Real)30
b(Arra)m(y)261 b(JJP)-8 b(,KKP)g(,NSP)259 b(Source)30
b(term)h(for)f(V)204 3225 y(SW)291 b(SR)m(CFLDS)135 b(Real)30
b(Arra)m(y)261 b(JJP)-8 b(,KKP)g(,NSP)259 b(Source)30
b(term)h(for)f(W)184 3338 y(STH)270 b(SR)m(CFLDS)135
b(Real)30 b(Arra)m(y)261 b(JJP)-8 b(,KKP)g(,NSP)259 b(Source)30
b(term)h(for)f(TH)216 3451 y(SQ)301 b(SR)m(CFLDS)135
b(Real)30 b(Arra)m(y)151 b(JJP)-8 b(,KKP)g(,NQP)g(,NSP)151
b(Source)30 b(term)h(for)f(Q)79 3564 y(OLUBAR)207 b(MEANS)178
b(Real)30 b(Arra)m(y)446 b(KKP)f(Horizon)m(tal)31 b(mean)f(of)h(U)f(at)
h(t-1)84 3676 y(OL)-10 b(VBAR)212 b(MEANS)178 b(Real)30
b(Arra)m(y)446 b(KKP)f(Horizon)m(tal)31 b(mean)f(of)h(V)f(at)h(t-1)71
3789 y(OL)-10 b(WBAR)200 b(MEANS)178 b(Real)30 b(Arra)m(y)446
b(KKP)f(Horizon)m(tal)31 b(mean)f(of)h(W)f(at)i(t-1)50
3902 y(OL)-8 b(THBAR)178 b(MEANS)g(Real)30 b(Arra)m(y)446
b(KKP)f(Horizon)m(tal)31 b(mean)f(of)h(TH)f(at)h(t-1)78
4015 y(OLQBAR)205 b(MEANS)178 b(Real)30 b(Arra)m(y)337
b(KKP)-8 b(,NQP)336 b(Horizon)m(tal)31 b(mean)f(of)h(Q)f(at)h(t-1)201
4128 y(VIS)329 b(FIELDS)178 b(Real)30 b(Arra)m(y)210
b(JJP)-8 b(,KKP)g(,NVISP)209 b(Viscosit)m(y)30 b(co)s(e\016cien)m(t)166
4241 y(DIFF)296 b(FIELDS)178 b(Real)30 b(Arra)m(y)210
b(JJP)-8 b(,KKP)g(,NVISP)209 b(Di\013usion)29 b(co)s(e\016cien)m(t)246
4354 y(P)295 b(PRESSURE)98 b(Real)30 b(Arra)m(y)224 b(JJP)-8
b(,KKP)g(,I)s(IPEP)222 b(Pressure)29 b(\()p Fb(p)3171
4321 y Fi(0)3195 4354 y Fb(=\032)3287 4368 y Fe(s)3324
4354 y Fq(\),)i(pressure)e(source)200 4467 y(DIS)329
b(FIELDS)178 b(Real)30 b(Arra)m(y)209 b(JJP)-8 b(,KKP)g(,NDISP)209
b(Bac)m(kscattered)33 b(energy)e(for)f(momen)m(tum)167
4580 y(DIST)296 b(FIELDS)178 b(Real)30 b(Arra)m(y)209
b(JJP)-8 b(,KKP)g(,NDISP)209 b(Bac)m(kscattered)33 b(energy)e(for)f
(temp)s(erature)165 4693 y(DISQ)293 b(FIELDS)178 b(Real)30
b(Arra)m(y)100 b(JJP)-8 b(,KKP)g(,NQP)g(,NDISP)100 b(Bac)m(kscattered)
33 b(energy)e(for)f(Q)g(\014elds)115 4806 y(THREF)267
b(GRID1)202 b(Real)30 b(Arra)m(y)446 b(KKP)f(Reference)31
b(p)s(oten)m(tial)f(temp)s(erature)117 4918 y(PREFN)269
b(GRID1)202 b(Real)30 b(Arra)m(y)446 b(KKP)f(Reference)31
b(pressure)55 5035 y(PREFR)m(CP)207 b(GRID1)202 b(Real)30
b(Arra)m(y)446 b(KKP)f(Exner)30 b(function)f(\()p Fb(p)3428
5049 y Fs(0)3467 5035 y Fb(=p)p Fq(\))3593 5002 y Fs(\()3625
5035 y Fb(r)s(=cp)p Fq(\))139 5148 y(RHON)291 b(GRID1)202
b(Real)30 b(Arra)m(y)446 b(KKP)f(Densit)m(y)31 b(on)f(P-p)s(oin)m(ts)
174 5261 y(RHO)324 b(GRID1)202 b(Real)30 b(Arra)m(y)446
b(KKP)f(Densit)m(y)31 b(on)f(W-p)s(oin)m(ts)215 5374
y(ZN)365 b(GRID1)202 b(Real)30 b(Arra)m(y)446 b(KKP)f(Heigh)m(t)31
b(in)e(metres)i(on)f(P-p)s(oin)m(ts)249 5487 y(Z)399
b(GRID1)202 b(Real)30 b(Arra)m(y)446 b(KKP)f(Heigh)m(t)31
b(in)e(metres)i(on)f(W-p)s(oin)m(ts)p 0 5527 V 1841 6107
a Fv(46)p eop
%%Page: 47 50
47 49 bop 0 -41 4320 7 v 145 39 a Fq(V)-8 b(ariable)247
b(Lo)s(cation)270 b(T)m(yp)s(e)411 b(Dimensions)293 b(De\014nition)p
0 79 V 213 158 a(DZN)346 b(GRID1)184 b(Real)31 b(Arra)m(y)420
b(KKP)f(V)-8 b(ertical)30 b(grid)f(spacing)h(b)s(et)m(w)m(een)h(P-p)s
(oin)m(ts)247 271 y(DZ)380 b(GRID1)184 b(Real)31 b(Arra)m(y)420
b(KKP)f(V)-8 b(ertical)30 b(grid)f(spacing)h(b)s(et)m(w)m(een)h(W-p)s
(oin)m(ts)208 384 y(D)m(XX)289 b(P)-8 b(ARAMS)261 b(Real)637
b(-)507 b(Grid)29 b(spacing)g(in)g Fb(x)p Fq(-direction)h(\(m\))208
497 y(D)m(YY)289 b(P)-8 b(ARAMS)261 b(Real)637 b(-)507
b(Grid)29 b(spacing)g(in)g Fb(y)s Fq(-direction)g(\(m\))187
610 y(TIME)268 b(P)-8 b(ARAMS)261 b(Real)637 b(-)507
b(Mo)s(del)29 b(time)h(in)f(seconds)200 723 y(DTM)281
b(P)-8 b(ARAMS)261 b(Real)637 b(-)507 b(Timestep)201
836 y(CVIS)314 b(CFL)-10 b(VIS)294 b(Real)637 b(-)507
b(Viscous)29 b(Couran)m(t)i(n)m(um)m(b)s(er)183 948 y(CVEL)297
b(CFL)-10 b(VIS)294 b(Real)637 b(-)507 b(Adv)m(ectiv)m(e)31
b(Couran)m(t)g(n)m(um)m(b)s(er)274 1061 y(G)323 b(PHYSCON)112
b(P)m(arameter)520 b(-)507 b(Acceleration)30 b(due)g(to)h(gra)m(vit)m
(y)h(\(9.81ms)4124 1028 y Fi(\000)p Fs(2)4220 1061 y
Fq(\))245 1174 y(CP)295 b(PHYSCON)112 b(P)m(arameter)520
b(-)507 b(Sp)s(eci\014c)28 b(heat)j(of)g(air)e(at)j(constan)m(t)2703
1287 y(pressure)d(\(1005Jkg)3413 1254 y Fi(\000)p Fs(1)3509
1287 y Fq(\))276 1400 y(R)325 b(PHYSCON)112 b(P)m(arameter)520
b(-)507 b(Univ)m(ersal)29 b(gas)i(constan)m(t)h(\(287.05\))158
1513 y(RL)-10 b(V)g(AP)208 b(PHYSCON)112 b(P)m(arameter)520
b(-)507 b(Laten)m(t)31 b(heat)g(of)g(v)-5 b(ap)s(ourisation)2703
1626 y(\(2.501)p Fa(\002)p Fq(10)3104 1593 y Fs(6)3146
1626 y Fq(Jkg)3286 1593 y Fi(\000)p Fs(1)3380 1626 y
Fq(\))156 1739 y(RLSUB)205 b(PHYSCON)112 b(P)m(arameter)520
b(-)507 b(Laten)m(t)31 b(heat)g(of)g(sublimation)2703
1852 y(\(2.834)p Fa(\002)p Fq(10)3104 1819 y Fs(6)3146
1852 y Fq(Jkg)3286 1819 y Fi(\000)p Fs(1)3380 1852 y
Fq(\))99 1965 y(F)m(CORIOL)179 b(P)-8 b(ARAMS)261 b(Real)637
b(-)507 b(Coriolis)28 b(parameter)241 2078 y(CQ)321 b(P)-8
b(ARAMS)131 b(Real)31 b(Arra)m(y)421 b(NQP)g(Co)s(e\016cien)m(t)30
b(for)g(virtual)f(temp)s(erature)120 2190 y(THSURF)200
b(P)-8 b(ARAMS)261 b(Real)637 b(-)507 b(Surface)29 b(p)s(oten)m(tial)h
(temp)s(erature)86 2303 y(THVSURF)166 b(P)-8 b(ARAMS)261
b(Real)637 b(-)507 b(Surface)29 b(virtual)g(p)s(oten)m(tial)h(temp)s
(erature)151 2416 y(QSURF)232 b(P)-8 b(ARAMS)261 b(Real)637
b(-)507 b(Surface)29 b(v)-5 b(ap)s(our)30 b(mixing)e(ratio)51
2529 y(SHFLX)p 359 2529 28 4 v 33 w(SEN)131 b(P)-8 b(ARAMS)261
b(Real)637 b(-)507 b(Surface)29 b(sensible)g(heat)i(\015ux)e(\(Wm)3943
2496 y Fi(\000)p Fs(2)4038 2529 y Fq(\))50 2642 y(SHFLX)p
358 2642 V 33 w(LA)-8 b(T)130 b(P)-8 b(ARAMS)131 b(Real)31
b(Arra)m(y)421 b(NQP)g(Surface)29 b(laten)m(t)j(heat)f(\015ux)e(\(Wm)
3869 2609 y Fi(\000)p Fs(2)3964 2642 y Fq(\))223 2755
y(IQV)365 b(QCNT)270 b(In)m(teger)588 b(-)507 b(Q)30
b(Index)f(for)h(w)m(ater)h(v)-5 b(ap)s(our)30 b(mixing)e(ratio)229
2868 y(IQL)370 b(QCNT)270 b(In)m(teger)588 b(-)507 b(Q)30
b(Index)f(for)h(liquid)d(w)m(ater)k(mixing)e(ratio)224
2981 y(IQR)365 b(QCNT)270 b(In)m(teger)588 b(-)507 b(Q)30
b(Index)f(for)h(rain)f(mixing)g(ratio)232 3094 y(IQS)373
b(QCNT)270 b(In)m(teger)588 b(-)507 b(Q)30 b(Index)f(for)h(sno)m(w)g
(mixing)f(ratio)222 3207 y(IQG)363 b(QCNT)270 b(In)m(teger)588
b(-)507 b(Q)30 b(Index)f(for)h(graup)s(el)f(mixing)g(ratio)241
3320 y(IQI)382 b(QCNT)270 b(In)m(teger)588 b(-)507 b(Q)30
b(Index)f(for)h(ice)h(mixing)d(ratio)195 3432 y(IQNL)336
b(QCNT)270 b(In)m(teger)588 b(-)507 b(Q)30 b(Index)f(for)h(liquid)d(w)m
(ater)k(n)m(um)m(b)s(er)f(conc.)190 3545 y(IQNR)331 b(QCNT)270
b(In)m(teger)588 b(-)507 b(Q)30 b(Index)f(for)h(rain)f(n)m(um)m(b)s(er)
g(conc.)198 3658 y(IQNS)339 b(QCNT)270 b(In)m(teger)588
b(-)507 b(Q)30 b(Index)f(for)h(sno)m(w)g(n)m(um)m(b)s(er)g(conc.)188
3771 y(IQNG)329 b(QCNT)270 b(In)m(teger)588 b(-)507 b(Q)30
b(Index)f(for)h(graup)s(el)f(n)m(um)m(b)s(er)g(conc.)189
3884 y(IQV)m(G)331 b(QCNT)270 b(In)m(teger)588 b(-)507
b(Q)30 b(Index)f(for)h(graup)s(el)f(v)m(olume)223 3997
y(IQN)365 b(QCNT)270 b(In)m(teger)588 b(-)507 b(Q)30
b(Index)f(for)h(ice)h(n)m(um)m(b)s(er)e(conc.)127 4110
y(DGNEW)309 b(DGS)231 b(Real)31 b(Arra)m(y)250 b(KKP)-8
b(,NDGSP)251 b(Curren)m(t)29 b(timestep)h(diagnostics)176
4223 y(DGA)-10 b(V)357 b(DGS)231 b(Real)31 b(Arra)m(y)250
b(KKP)-8 b(,NDGSP)251 b(Time-a)m(v)m(eraged)31 b(diagnostics)71
4336 y(DGSPNEW)252 b(DGS)231 b(Real)31 b(Arra)m(y)99
b(JJTOTP/2,NSPECP)g(Curren)m(t)29 b(timestep)h(sp)s(ectra)123
4449 y(DGSP)-8 b(A)e(V)305 b(DGS)231 b(Real)31 b(Arra)m(y)99
b(JJTOTP/2,NSPECP)g(Time-a)m(v)m(eraged)31 b(sp)s(ectra)220
4562 y(SER)333 b(SERIES)162 b(Real)31 b(Arra)m(y)202
b(NTIMP)-8 b(,NSERP)202 b(Timeseries)172 4674 y(MYPE)375
b(ME)334 b(In)m(teger)588 b(-)507 b(Num)m(b)s(er)29 b(of)h(lo)s(cal)g
(PE)p 0 4715 4320 7 v 0 5093 a Fx(B)161 b(Alphab)t(etical)56
b(List)e(of)g(Common)d(Blo)t(c)l(ks)0 5433 y Fv(Belo)m(w)35
b(are)f(the)i(list)d(of)h(COMDECKS)i(in)e(the)h(LEM,)g(with)g(a)f
(brief)g(description)g(of)g(the)i(con)m(ten)m(ts.)0 5553
y(These)24 b(are)f(all)d(F)m(OR)-8 b(TRAN)22 b(common)f(blo)s(c)m(ks,)k
(with)d(the)h(exception)g(of)f(PRAMETR,)i(MICR)m(OPRM)0
5674 y(and)33 b(PHYSCON)g(whic)m(h)h(are)e(parameter)g(lists.)1841
6107 y(47)p eop
%%Page: 48 51
48 50 bop 146 52 a Fv(AD)m(VFLDS:)31 b(V)-8 b(alues)32
b(of)f(UL)-8 b(TIMA)g(TE)33 b(adv)m(ected)g(quan)m(tities)e(at)g(b)s
(ottom)g(faces)h(for)f(use)h(in)f(cal-)0 173 y(culation)g(of)h(v)m
(ertical)f(\015uxes)j(in)e Fw(RESDGS)p Fv(.)g(\(AD)m(V)p
1996 173 30 4 v 35 w(U,)h(AD)m(V)p 2382 173 V 35 w(V,)g(AD)m(V)p
2768 173 V 35 w(W,)f(AD)m(V)p 3180 173 V 36 w(TH,)h(AD)m(V)p
3637 173 V 35 w(Q\))146 414 y(CFL)-11 b(VIS:)24 b(V)-8
b(ariables)22 b(used)i(in)f(the)g(calculation)e(of)i(the)g(CFL)g
(criteria.)39 b(\(CVIS,)24 b(CVEL,)g(CVELX,)0 534 y(CVEL)-8
b(Y,)32 b(CVELZ,)h(CVISMAX,)g(CVELMAX,)g(ZUMAXX,)f(ZUMINN,)g(ZVMAXX,)g
(ZVMINN\))146 775 y(CLASSY:)k(Arra)m(ys)g(asso)s(ciated)f(with)g(the)h
(column)d(classi\014ed)i(diagnostics.)50 b(\(PRECIP)-8
b(,)37 b(L)-11 b(WP)j(,)0 895 y(IWP)g(,)33 b(ICLASS,)h(CTHEIGHT\))146
1136 y(D)m(AMP:)52 b(The)g(co)s(e\016cien)m(ts)f(and)g(heigh)m(ts)g
(for)g(the)g(damping)e(la)m(y)m(er.)98 b(\(DMPTIM,)52
b(HDMP)-8 b(,)0 1256 y(ZDMP)g(,)32 b(DMPCO,)i(DMPCOZ,)e(KDMPMIN\))146
1497 y(DGCHARS:)52 b(Arra)m(ys)h(of)f(c)m(haracter)h(strings)f(con)m
(taining)f(the)i(names)f(of)g(the)g(diagnostics.)0 1617
y(\(CHA)-11 b(V,)34 b(CHTS,)f(CHSP\))146 1858 y(DGCNT:)42
b(In)m(tegers)i(indicating)39 b(at)j(whic)m(h)g(index)h(in)e(the)h
(time-a)m(v)m(eraged)f(diagnostic)g(arra)m(ys)0 1979
y(eac)m(h)33 b(diagnostic)f(can)h(b)s(e)f(found.)146
2219 y(DGS:)39 b(Arra)m(ys)h(for)e(time-a)m(v)m(eraged)g(and)i(sp)s
(ectra)f(diagnostics.)62 b(\(DGNEW,)39 b(DGA)-11 b(V,)38
b(DGSP-)0 2340 y(NEW,)33 b(DGSP)-8 b(A)d(V,)33 b(OLDTIM\))146
2580 y(DGSPCNT:)k(In)m(tegers)h(indicating)c(at)i(whic)m(h)h(index)g
(in)f(the)h(sp)s(ectra)g(arra)m(ys)g(that)f(eac)m(h)h(diag-)0
2701 y(nostic)32 b(can)h(b)s(e)g(found.)146 2942 y(DGSTORE:)h(V)-8
b(arious)33 b(additional)e(v)-5 b(ariables)32 b(used)j(for)f(the)g
(conditionally)d(sampled)i(diagnos-)0 3062 y(tics.)48
b(\(L)p 327 3062 V 35 w(DODGS,)33 b(DTH)p 997 3062 V
36 w(DT,)h(DQ)p 1390 3062 V 34 w(DT,)h(F)-11 b(ALLQ,)34
b(PR)m(OCRA)-8 b(TE,)35 b(NUPDO)m(WN,)g(CUPDO)m(WN,)0
3182 y(L)p 67 3182 V 35 w(UPD)m(WN4D\))146 3423 y(DIA)m(GCNT:)f(Coun)m
(ter)f(for)f(eac)m(h)i(record)f(written)f(to)h(diagnostic)e(\014le.)43
b(\(IRECCNT\))146 3664 y(DIA)m(GS:)f(V)-8 b(ariables)41
b(whic)m(h)i(con)m(trol)e(the)i(lev)m(els)f(at)f(whic)m(h)i(to)f
(output)g(2-D)f(slices)h(of)f(instan-)0 3784 y(taneous)e(diagnostic)f
(\014elds)g(and)h(sp)s(ectra.)63 b(\(NITEST,)40 b(NJTEST,)g(NKTEST,)h
(ITEST,)f(JTEST,)0 3905 y(KTEST,)34 b(XTEST,)g(YTEST,)g(ZTEST,)g
(NSPLEVS,)g(KSP)-8 b(,)33 b(ZSP\))146 4145 y(FFT:)j(T)-8
b(ables)36 b(of)f(factors)g(and)h(trigonometric)d(functions)j(for)f
(the)h(T3E)g(sp)s(eci\014c)g(SCFFT)g(and)0 4266 y(CSFFT)d(fast-F)-8
b(ourier)31 b(transform)g(routines.)44 b(\(T)-8 b(ABLEX,)33
b(T)-8 b(ABLEY\))146 4507 y(FIELDS:)33 b(Mo)s(del)g(prognostic)g(and)g
(diagnostic)f(\014elds.)45 b(\(U,)34 b(ZU,)f(V,)g(ZV,)g(W,)g(ZW,)g(TH,)
h(ZTH,)0 4627 y(Q,)e(ZQ,)h(VIS,)g(DIFF,)e(DIS,)i(DIST,)g(DISQ\))146
4868 y(FLXBDG:)43 b(Arra)m(ys)h(used)g(for)f(the)h(calculation)d(of)h
(the)i(scalar)f(\015ux)h(budgets.)77 b(\(STH)p 3505 4868
V 35 w(AD)m(V,)0 4988 y(SQ)p 136 4988 V 35 w(AD)m(V,)33
b(STH)p 646 4988 V 36 w(DIFF,)e(SQ)p 1108 4988 V 36 w(DIFF,)g(SW)p
1594 4988 V 36 w(AD)m(V,)h(SW)p 2061 4988 V 36 w(VIS,)h(SW)p
2473 4988 V 36 w(BUO)m(Y,)g(SW)p 3011 4988 V 35 w(PRESS\))146
5229 y(F)m(OR)m(CING:)50 b(Arra)m(ys)g(and)f(scalar)g(v)-5
b(ariables)48 b(used)j(for)d(the)i(large-scale)e(adv)m(ectiv)m(e)i
(forcing.)0 5349 y(\(WSUBS,)28 b(F)m(OR)-8 b(TIMSC,)27
b(IF)m(OR)m(U,)g(IF)m(OR)-11 b(V,)27 b(IF)m(OR)-8 b(TH,)27
b(IF)m(OR)m(Q,)g(SULS,)g(SVLS,)h(STHLS,)f(SQLS,)0 5470
y(SULS)p 248 5470 V 36 w(TV,)33 b(SVLS)p 729 5470 V 35
w(TV,)h(STHLS)p 1280 5470 V 36 w(TV,)f(SQLS)p 1764 5470
V 35 w(TV,)g(NTMF)m(OR,)h(TIMF)m(OR\))146 5710 y(GRID1:)59
b(Arra)m(ys)42 b(describing)e(the)h(thermo)s(dynamic)e(reference)j
(state)g(and)e(the)i(v)m(ertical)e(grid)0 5831 y(and)33
b(scalars)f(de\014ning)h(the)g(horizon)m(tal)e(grid)g(spacing.)1841
6107 y(48)p eop
%%Page: 49 52
49 51 bop 146 52 a Fv(IDGS:)40 b(Switc)m(hes)h(con)m(trolling)d(the)j
(diagnostic)d(output.)67 b(\(IDGU,)39 b(IDGV,)h(IDGW,)g(IDGTH,)0
173 y(IDGQ,)21 b(IDGP)-8 b(,)21 b(IDGPV,)h(IDGA)-11 b(V,)21
b(IDGSP)-8 b(,)22 b(IDGPD,)e(IDGPD)p 2406 173 30 4 v
35 w(ALL,)h(IDGQMR)p 3108 173 V 35 w(ALL,)h(IDGQNC)p
3793 173 V 34 w(ALL,)0 293 y(IEXDG\))146 534 y(IP)-8
b(ARMS:)30 b(Run)g(con)m(trol)e(v)-5 b(ariables.)41 b(\(NSTEP)-8
b(,)31 b(NSMTH,)f(NR)m(UN,)g(ND)m(A)-8 b(TE,)30 b(NJOB,)f(INDIC,)0
654 y(NDGFILE,)j(ITND\))146 895 y(JBINF:)c(Names)g(of)g(\014les)f(used)
i(in)f(running)f(the)h(co)s(de.)42 b(\(FILEA,)29 b(FILEB,)f(FILEZ,)f
(MSGFILE\))146 1136 y(LBCFLDS:)40 b(Arra)m(ys)i(used)f(in)f(the)g
(calculation)e(of)i(the)h(lo)m(w)m(er)f(b)s(oundary)h(condition.)65
b(\(VEL,)0 1256 y(USTR,)33 b(DTHV)p 626 1256 V 36 w(SURF,)f(THVSTR\))
146 1497 y(LOCDIV:)22 b(V)-8 b(ariables)21 b(con)m(taining)f
(information)f(on)j(the)g(lo)s(cal)e(PE)j(maxim)m(um)c(div)m(ergence)k
(error.)0 1617 y(\(ICOMAX,)34 b(DIVMAX\))146 1858 y(ME:)45
b(V)-8 b(ariables)43 b(con)m(taining)f(information)f(for)i(the)i
(message)f(passing)g(routines.)78 b(\(NPR)m(OC,)0 1979
y(MYPE,)34 b(IRIGHT,)f(ILEFT,)g(GID,)f(MAXPT,)i(MAXPR)m(OC,)g(MAX)m
(COLL,)g(INF)m(O\))146 2219 y(MEANS:)41 b(Horizon)m(tal)e(means)h(of)f
(the)i(mo)s(del)d(prognostic)h(\014elds.)66 b(\(OLUBAR,)40
b(OLZUBAR,)0 2340 y(OL)-11 b(VBAR,)33 b(OLZVBAR,)f(OL)-8
b(THBAR,)33 b(OLZTHBAR,)f(OLQBAR,)h(OLZQBAR\))146 2580
y(MICR)m(OCOEF:)i(Co)s(e\016cien)m(ts)f(used)g(in)f(the)g(three-phase)i
(microph)m(ysics)e(calculations)e(in)h Fw(MI-)0 2701
y(CR)m(O)m(X)p Fv(.)g(\(PHYSCAL,)i(PHYS1D\))146 2942
y(MICR)m(OPRM:)e(V)-8 b(alues)31 b(set)g(as)f(parameters)h(for)e(the)i
(three-phase)h(microph)m(ysics)e(calculations.)146 3182
y(MINMAX:)h(Minim)m(um)26 b(and)j(maxim)m(um)d(v)m(elo)s(cities)i(used)
i(for)e(calculating)f(the)i(Galilean)d(trans-)0 3303
y(formation)44 b(and)i(CFL)g(criteria)f(in)h Fw(CVELGAL2)p
Fv(.)84 b(\(ZUMIN,)47 b(ZUMAX,)f(ZVMIN,)h(ZVMAX,)0 3423
y(ABSWMAX\))146 3664 y(MOIST:)h(Arra)m(ys)f(for)f(calculating)e
(saturation)h(mixing)g(ratios)g(using)h(a)g(T)-8 b(a)m(ylor)46
b(expansion.)0 3784 y(\(QSA)-8 b(T,)33 b(QSA)-8 b(TF)d(A)m(C,)34
b(TST)-8 b(ARPR,)34 b(DQSA)-8 b(TDT,)32 b(TREF,)h(QSA)-8
b(TPW\))146 4025 y(MO)m(V)m(CNT:)35 b(Switc)m(hes)f(to)e(determine)g
(whic)m(h)h(\014elds)g(to)f(output)h(as)g(animations.)146
4266 y(MO)m(VD)m(A)-8 b(T:)31 b(P)m(arameters,)g(arra)m(ys)f(and)g(v)-5
b(ariables)29 b(used)i(to)e(write)h(out)f(the)i(\014les)e(for)h(the)g
(anima-)0 4386 y(tion)i(soft)m(w)m(are.)146 4627 y(P)-8
b(ARAMS:)37 b(A)f(wide)g(selection)g(of)g(mo)s(del)e(v)-5
b(ariables)35 b(v)-5 b(arying)35 b(from)g(ph)m(ysical)h(v)-5
b(alues,)37 b(suc)m(h)g(as)0 4747 y(the)30 b(Coriolis)d(parameter)j
(and)f(surface)i(heat)f(\015uxes,)i(to)d(n)m(umerical)f(v)-5
b(alues)30 b(suc)m(h)h(as)f(timesteps)f(and)0 4868 y(horizon)m(tal)i
(grid)g(spacing.)146 5109 y(PHYSCON:)54 b(The)f(v)-5
b(alues)53 b(of)f(ph)m(ysical)g(constan)m(ts)i(as)f(parameter)e
(statemen)m(ts.)105 b(\(CP)-8 b(,)53 b(R,)0 5229 y(RA)-8
b(TIO)p 324 5229 V 35 w(MOL)p 585 5229 V 36 w(WTS,)44
b(G,)f(RL)-11 b(V)g(AP)j(,)44 b(RLSUB,)g(RL)-11 b(V)g(AP)p
2172 5229 V 36 w(ON)p 2357 5229 V 35 w(CP)j(,)44 b(RLSUB)p
2920 5229 V 35 w(ON)p 3104 5229 V 35 w(CP)-8 b(,)45 b(R)p
3411 5229 V 35 w(ON)p 3595 5229 V 35 w(CP)-8 b(,)0 5349
y(G)p 83 5349 V 35 w(ON)p 267 5349 V 35 w(2\))146 5590
y(PRAMETR:)36 b(P)m(arameters)f(used)h(for)e(the)i(con)m(trol)e(of)g
(mo)s(del)f(options)h(and)h(the)g(dimensioning)0 5710
y(of)d(arra)m(ys.)1841 6107 y(49)p eop
%%Page: 50 53
50 52 bop 146 52 a Fv(PRESSURE:)34 b(The)g(pressure)g(arra)m(y)-8
b(.)44 b(\(P\))146 293 y(PR)m(OFILES:)34 b(Arra)m(ys)f(used)h(to)e
(determine)g(the)h(pro\014les)g(for)f(the)h(initial)c(conditions.)146
534 y(QCNT:)38 b(Indices)g(for)f(the)h(Q)f(\014eld)g(represen)m(ting)h
(di\013eren)m(t)f(w)m(ater)h(sp)s(ecies.)58 b(\(NQMAX,)38
b(IQV,)0 654 y(IQL,)33 b(IQR,)f(IQS,)h(IQG,)f(IQI,)h(IQN,)g(IQNG,)f
(IQNS,)h(IQNR,)g(IQV)m(G,)f(IQNL\))146 895 y(RAD)p 372
895 30 4 v 35 w(MOD:)g(Arra)m(ys)i(and)e(v)-5 b(ariables)32
b(used)h(for)g(the)g(radiation)d(co)s(de.)146 1136 y(RAIN:)j(Arra)m(ys)
g(used)h(for)e(the)h(w)m(arm)f(rain)f(microph)m(ysics)i(calculations)d
(in)i Fw(MPHYS)g Fv(and)g(the)0 1256 y(PUDDLE)g(arra)m(y)-8
b(.)44 b(\(QTHRESH,)33 b(EXPZ)p 1586 1256 V 36 w(ON)p
1771 1256 V 35 w(SCL,)g(ABL)-8 b(TEMP)g(,)34 b(PUDDLE\))146
1497 y(RAND:)e(V)-8 b(ariables)31 b(asso)s(ciated)h(with)g(the)g
(random)g(n)m(um)m(b)s(er)g(v)m(ector)h(used)h(in)d(the)i(Bac)m
(kscatter)0 1617 y(routines.)146 1858 y(RFIL)-8 b(T:)46
b(Arra)m(ys)h(at)e(additional)e(time-lev)m(els)h(that)h(need)i(to)e(b)s
(e)h(stored)g(for)f(the)h(use)h(of)e(the)0 1979 y(Rob)s(ert)32
b(time-\014lter.)41 b(\(SA)-11 b(V)m(OLUBAR,)34 b(SA)-11
b(V)m(OL)g(VBAR,)33 b(SA)-11 b(VU,)34 b(SA)-11 b(VV,)33
b(SA)-11 b(VW\))146 2219 y(SERIES:)34 b(Timeseries)e(arra)m(y)h(and)g
(indices.)146 2460 y(SR)m(CFLDS:)f(The)g(source)g(terms)f(for)g(the)g
(mo)s(del)f(prognostic)g(v)-5 b(ariables.)42 b(\(SU,)32
b(SV,)f(SW,)h(STH,)0 2580 y(SQ\))146 2821 y(STORE:)39
b(Storage)f(of)f(p)s(oten)m(tials)g(used)j(in)d(the)h(Bac)m(kscatter)i
(routines)e(on)g(I-1)g(slice)f(to)h(a)m(v)m(oid)0 2942
y(recalculation.)j(\(PHXM,)34 b(PHYM,)g(PHZM,)f(PHXM)p
2029 2942 V 36 w(Q\))146 3182 y(SUBMOD:)g(Subgrid)f(mo)s(del)f(constan)
m(ts.)146 3423 y(SUVWS:)k(Horizon)m(tal)e(mean)h(arra)m(ys)g(used)i(to)
d(calculate)g(the)i(TKE)g(tendency)h(term)e(for)f(diag-)0
3544 y(nostics.)44 b(\(SUS,)33 b(SVS,)g(USUS,)g(VSVS,)g(WSWS,)h(UW)-11
b(A,)33 b(UWB,)g(VW)-11 b(A,)33 b(VWB,)h(RESTKE\))146
3784 y(T)-8 b(ABLE:)34 b(Information)c(for)i(the)h(surface)h(b)s
(oundary)f(condition)e(lo)s(ok-up)g(tables.)146 4025
y(T)-8 b(A)m(U:)44 b(Comp)s(onen)m(ts)f(of)f(the)i(viscous)f(source)h
(terms)f(required)g(for)f(diagnostic)f(calculations.)0
4145 y(\(T)-8 b(A)m(U11,)33 b(T)-8 b(A)m(U22,)33 b(T)-8
b(A)m(U33,)33 b(T)-8 b(A)m(U12,)33 b(T)-8 b(A)m(U13,)33
b(T)-8 b(A)m(U23\))146 4386 y(TFLXSA)d(V:)32 b(Storage)e(of)g(the)h
(I+1)g(face)g(v)-5 b(alues)30 b(for)g(the)h(UL)-8 b(TIMA)g(TE)32
b(adv)m(ection,)g(to)e(a)m(v)m(oid)h(re-)0 4507 y(calculation)19
b(of)j(\015uxes)h(in)e Fw(UL)-9 b(TFLX)p Fv(.)22 b(\(TFLXIP1,)j
(QFLXIP1,)f(UFLXIP1,)g(VFLXIP1,)g(WFLXIP1\))146 4747
y(TIMES:)49 b(Arra)m(ys)e(con)m(trolling)d(the)k(time-dep)s(enden)m(t)e
(asp)s(ects)i(of)e(the)i(in)m(tegration,)g(suc)m(h)g(as)0
4868 y(diagnostic)31 b(times)h(and)h(time-v)-5 b(arying)30
b(heat)i(\015uxes.)146 5109 y(VISFLDS:)42 b(2-D)e(\014elds)i(used)g(in)
f(the)h(calculation)d(of)i(VIS)h(and)g(DIFF)e(and)i(the)g(bac)m
(kscatter)0 5229 y(energy)34 b(in)d Fw(SMA)m(G)p Fv(.)i(\(SSQ,)g(RI,)g
(CVISS,)g(ELAMR)p 1985 5229 V 36 w(SQ\))146 5470 y(W)m(ORK:)g(W)-8
b(orkspace.)45 b(\(WRK\))1841 6107 y(50)p eop
%%Page: 51 54
51 53 bop 0 52 a Fx(C)161 b(Alphab)t(etical)56 b(List)e(of)f
(Subroutines)0 421 y Fp(PR)l(OGRAM)44 b(LES)0 726 y Fw(Called)36
b(b)m(y:)113 b Fv(-)0 846 y Fw(Calls:)e Fv(BEGIN,)33
b(NNSTEPS,)h(EXXIT)146 1087 y(The)e(main)d(program)g(of)h(the)h(LEM.)g
(The)g(structure)h(is)e(sho)m(wn)i(in)e(Fig.)f(2.)42
b(F)-8 b(or)30 b(m)m(ulti-pro)s(cessor)0 1208 y(runs,)53
b(the)c(GCOM)g(calling)d(routines)i(are)h(initialized,)g(through)f(the)
h(GC)p 2921 1208 30 4 v 35 w(INIT)h(call,)g(and)f(the)0
1328 y(adjacen)m(t)44 b(pro)s(cessors,)k(IRIGHT)c(and)g(ILEFT,)g(for)f
(eac)m(h)i(PE,)f(de\014ned.)78 b Fw(BEGIN)42 b Fv(is)h(called)g(to)0
1448 y(read)e(in)e(the)i(namelists)e(and)h(mo)s(del)f(dump,)j(or)e(to)g
(initialise)d(the)j(prognostic)g(\014elds)h(if)e(a)h(set-up)0
1569 y(job.)76 b(Lo)s(oping)41 b(o)m(v)m(er)k(NNDUMP)f(and)f(NNDIA)m
(G,)g Fw(NNSTEPS)g Fv(is)f(called,)j(follo)m(w)m(ed)e(b)m(y)h(a)f(call)
0 1689 y(to)f Fw(EXXIT)g Fv(with)g(ISTOPU=-4)h(to)g(c)m(hec)m(k)i(for)d
(a)h(man)m(ual)e(stop.)75 b(After)43 b(eac)m(h)g(NNDIA)m(G)g(lo)s(op,)0
1809 y Fw(EXXIT)37 b Fv(is)h(called)g(with)g(ISTOPU=-3)h(to)f(p)s
(erform)g(a)g(mo)s(del)f(dump.)62 b(The)39 b(\014nal)f
Fw(EXXIT)f Fv(call)0 1930 y(uses)d(ISTOPU=0)f(or)g(-1)e(dep)s(ending)i
(on)g(whether)h(a)e(diagnostics)g(dump)g(is)g(required.)0
2339 y Fp(ALLOCA)-11 b(TE)0 2644 y Fw(Called)36 b(b)m(y:)113
b Fv(ALLOCDGS,)32 b(ALLOCSP)-8 b(,)34 b(ALLOCQS,)f(INTIMSER)0
2765 y Fw(Calls:)111 b Fv(-)146 3005 y(Utilit)m(y)31
b(routine)h(for)g(incremen)m(ting)g(the)h(allo)s(cation)c(of)j(arra)m
(y)h(space)h(to)e(diagnostic)f(indices.)43 b(N)0 3126
y(is)38 b(the)g(arra)m(y)h(index,)h(M)e(is)g(the)h(n)m(um)m(b)s(er)f
(of)g(spaces)i(to)e(b)s(e)g(allo)s(cated,)g(NEXT)h(is)f(the)g(next)h
(arra)m(y)0 3246 y(index.)0 3655 y Fp(ALLOCDGS)0 3960
y Fw(Called)d(b)m(y:)113 b Fv(SET1D)0 4081 y Fw(Calls:)e
Fv(ALLOCA)-8 b(TE,)34 b(NAMEDIA)m(GS,)f(EXXIT)146 4322
y(Allo)s(cates)21 b(the)h(arra)m(y)g(space)h(in)e(DGNEW)g(and)h(DGA)-11
b(V)21 b(for)g(the)h(time-a)m(v)m(eraged)f(and)h(conditionally-)0
4442 y(sampled)34 b(diagnostic)f(pro\014les)i(de\014ned)h(in)d(common)h
(blo)s(c)m(k)g(DGCNT.)h(The)g(routine)f(consists)i(of)e(a)0
4562 y(succession)i(of)d(calls)g(to)h Fw(ALLOCA)-9 b(TE)33
b Fv(and)i(assignmen)m(ts)f(of)g(CHA)-11 b(V,)35 b(the)f(c)m(haracter)h
(arra)m(y)g(con-)0 4683 y(taining)21 b(the)i(diagnostic)f(names.)40
b(NEXT)24 b(holds)f(the)h(v)-5 b(alue)22 b(of)g(the)i(arra)m(y)f(index)
g(as)g(it)f(is)h(incremen)m(ted)0 4803 y(in)e(eac)m(h)i
Fw(ALLOCA)-9 b(TE)21 b Fv(call.)38 b Fw(NAMEDIA)m(GS)21
b Fv(is)g(called)g(for)g(eac)m(h)i(of)e(the)i(conditionally-sampled)0
4924 y(diagnostics)36 b(whic)m(h)h(simpli\014es)e(the)i(assignmen)m(t)g
(of)f(CHA)-11 b(V,)38 b(as)e(eac)m(h)i(conditionally-sampled)33
b(di-)0 5044 y(agnostic)f(has)h(NUPDO)m(WN)g(partitions.)146
5285 y(The)24 b Fw(EXXIT)d Fv(call)g(is)i(for)f(an)h(allo)s(cation)c
(error)j(\(ISTOPU=9\))i(due)f(to)g(the)g(n)m(um)m(b)s(er)g(of)f(allo)s
(cated)0 5405 y(diagnostics)32 b(exceeding)h(NDGSP)-8
b(.)1841 6107 y(51)p eop
%%Page: 52 55
52 54 bop 0 52 a Fp(ALLOCSP)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(SETDIA)m(GS)0 478 y Fw(Calls:)e Fv(ALLOCA)-8 b(TE,)34
b(EXXIT)146 719 y(Allo)s(cates)40 b(the)i(arra)m(y)g(space)g(in)f
(DGSPNEW)h(and)f(DGSP)-8 b(A)d(V)41 b(for)g(the)h(sp)s(ectra)g
(diagnostics.)0 839 y(Consists)28 b(of)f(four)g Fw(ALLOCA)-9
b(TE)27 b Fv(calls)f(for)h(eac)m(h)h(sp)s(ectra)g(follo)m(w)m(ed)f(b)m
(y)h(the)g(assignmen)m(t)f(of)g(CHSP)-8 b(.)0 959 y(NEXT)47
b(holds)e(the)h(v)-5 b(alue)45 b(of)g(the)h(arra)m(y)g(index)f(as)h(it)
f(is)g(incremen)m(ted)h(in)f(eac)m(h)h Fw(ALLOCA)-9 b(TE)0
1080 y Fv(call.)49 b(Eac)m(h)36 b(sp)s(ectra)g(\014eld)f(has)g(NSPLEVS)
i(lev)m(els,)f(so)f(the)g(assignmen)m(t)g(of)g(CHSP)h(is)f(lo)s(op)s
(ed)e(o)m(v)m(er)0 1200 y(NSPLEVS)h(with)e(KSP)-8 b(,)33
b(the)g(sp)s(ectra)g(lev)m(el,)f(written)h(in)m(to)f(the)h(c)m
(haracter)g(string.)146 1441 y(The)24 b Fw(EXXIT)d Fv(call)g(is)i(for)f
(an)h(allo)s(cation)c(error)j(\(ISTOPU=9\))i(due)f(to)g(the)g(n)m(um)m
(b)s(er)g(of)f(allo)s(cated)0 1561 y(sp)s(ectra)33 b(exceeding)h
(NSPECP)-8 b(.)0 1971 y Fp(ALLOCQS)0 2276 y Fw(Called)36
b(b)m(y:)113 b Fv(SET1D)0 2396 y Fw(Calls:)e Fv(ALLOCA)-8
b(TE,)34 b(EXXIT)146 2637 y(Allo)s(cates)40 b(the)g(indices)h(for)f
(all)e(Q)j(\014eld)f(arra)m(ys)h(to)f(represen)m(t)j(di\013eren)m(t)e
(w)m(ater)g(sp)s(ecies.)68 b(De-)0 2757 y(p)s(ending)39
b(on)g(the)h(c)m(hoice)g(of)f(the)h(h)m(ydrometeor)g(parameters)f
(IRAINP)-8 b(,)40 b(ISNO)m(WP)-8 b(,)41 b(ICECLP)g(etc)0
2878 y(indices)h(IQR,)h(IQS,)g(IQI)g(etc)g(are)g(assigned)g(through)g
Fw(ALLOCA)-9 b(TE)42 b Fv(calls.)72 b(F)-8 b(or)42 b(mixing)f(ratio)0
2998 y(v)-5 b(ariables)29 b(the)h(virtual)e(temp)s(erature)i(co)s
(e\016cien)m(t,)h(CQ,)g(is)e(also)g(assigned.)43 b(NEXT)31
b(holds)f(the)g(v)-5 b(alue)0 3118 y(of)32 b(the)h(arra)m(y)g(index)g
(as)f(it)g(is)g(incremen)m(ted)h(in)f(eac)m(h)h Fw(ALLOCA)-9
b(TE)32 b Fv(call.)146 3359 y(The)24 b Fw(EXXIT)d Fv(call)g(is)i(for)f
(an)h(allo)s(cation)c(error)j(\(ISTOPU=9\))i(due)f(to)g(the)g(n)m(um)m
(b)s(er)g(of)f(allo)s(cated)0 3480 y(Q)32 b(\014elds)h(exceeding)h(NQP)
-8 b(.)0 3889 y Fp(A)-15 b(VDG)0 4194 y Fw(Called)36
b(b)m(y:)113 b Fv(NNSTEPS)0 4314 y Fw(Calls:)e Fv(-)146
4555 y(Calculates)41 b(the)g(running)f(a)m(v)m(erage)i(of)e(the)i
(time-a)m(v)m(eraged)e(and)h(sp)s(ectra)g(diagnostics.)68
b(Both)0 4675 y(DGA)-11 b(V)32 b(and)h(DGSP)-8 b(A)d(V)32
b(are)h(calculated)e(in)h(the)h(same)g(w)m(a)m(y)-8 b(,)33
b(namely)-8 b(,)32 b(as)42 4999 y(DGA)-11 b(V)32 b(=)g(\(TIMEA)-11
b(V*DGA)g(V)34 b(+)e(RNHPTS*TIMEDG*DGNEW\)/\(TIMEA)-11
b(V+TIMEDG\))0 5323 y(where)31 b(TIMEA)-11 b(V)31 b(is)d(the)i(total)e
(a)m(v)m(eraging)h(time,)g(TIMEDG)g(is)g(the)h(time)e(since)i(the)f
(last)g(a)m(v)m(eraging)0 5443 y(and)22 b(RNHPTS)i(is)d(the)i(recipro)s
(cal)e(of)h(the)g(n)m(um)m(b)s(er)h(of)f(horizon)m(tal)e(grid)i(p)s
(oin)m(ts.)39 b(Note)23 b(that)f(DGNEW)0 5564 y(and)44
b(DGSPNEW)g(are)g(also)f(horizon)m(tally)f(a)m(v)m(eraged)j(here)g(to)s
(o.)76 b(TIMEA)-11 b(V)46 b(is)d(incremen)m(ted)i(b)m(y)0
5684 y(TIMEDG)33 b(for)f(the)h(next)g Fw(A)-12 b(VDG)32
b Fv(call.)1841 6107 y(52)p eop
%%Page: 53 56
53 55 bop 0 52 a Fp(BCKSCT)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(NNSTEPS)0 478 y Fw(Calls:)e Fv(GETRAN,)33 b(EQUA)-8
b(TE,)34 b(WRAP)146 719 y(Calculates)i(the)h(bac)m(kscatter)i(comp)s
(onen)m(t)d(of)h(the)g(v)m(elo)s(cit)m(y)f(source)i(terms.)55
b(The)38 b(bac)m(kscatter)0 839 y(is)h(calculated)g(as)h(the)h(curl)e
(of)g(a)h(v)m(ector)h(\014eld,)g Fn(\036)p 1832 872 58
4 v Fv(,)h(whic)m(h)e(is)f(de\014ned)j(as)e(the)g(square)h(ro)s(ot)e
(of)g(the)0 959 y(bac)m(kscattered)24 b(energy)f(m)m(ultiplied)c(b)m(y)
k(a)e(v)m(ector)i(of)f(random)f(n)m(um)m(b)s(ers.)40
b(The)23 b(bac)m(kscattered)h(energy)0 1080 y(for)41
b(momen)m(tum)e(is)i(held)g(in)f(the)i(arra)m(y)f(DIS)g(whic)m(h)g(is)g
(passed)i(through)e(to)f Fw(BCKSCT)h Fv(b)m(y)h(the)0
1200 y(argumen)m(t)j(list)e(as)i(DISMM)h(\(DIS)e(on)h(I-2\),)j(DISM)d
(\(I-1\),)i(DIS)e(\(I\),)g(DISP)g(\(I+1\))g(and)g(DISPP)0
1321 y(\(I+2\).)e(The)33 b(v)m(ector,)g Fn(\036)p 825
1353 V Fv(,)f(is)g(de\014ned)i(as)e(PHX)h(for)e(the)i
Fn(x)p Fv(-comp)s(onen)m(t,)f(PHY)h(for)e(the)i Fn(y)t
Fv(-comp)s(onen)m(t)0 1441 y(and)45 b(PHZ)g(for)f(the)h
Fn(z)t Fv(-comp)s(onen)m(t.)80 b(I-1)44 b(v)-5 b(alues)45
b(are)f(stored)i(in)d(arra)m(ys)j(PHYM)f(and)g(PHZM)g(in)0
1561 y(common)31 b(blo)s(c)m(k)i(STORE.)146 1802 y(F)-8
b(or)36 b(the)g(I=1)g(v)m(ertical)g(slice)f(PHYM,)j(PHZM,)e(PHX,)h(PHY)
g(and)f(PHZ)h(are)f(all)e(calculated)h(in)0 1923 y(calls)28
b(to)h Fw(GETRAN)p Fv(.)f(This)h(requires)h(the)f(bac)m(kscatter)i
(energy)g(on)e(the)g(I-1,)h(I)f(and)g(I+1)g(slices,)h(but)0
2043 y(a)m(v)m(eraged)42 b(so)f(that)f(the)h Fn(\036)p
935 2076 V 40 w Fv(comp)s(onen)m(ts)g(are)g(in)f(the)h(righ)m(t)f(p)s
(ositions)f(with)h(resp)s(ect)i(to)e(the)h(grid.)0 2163
y(Th)m(us,)30 b(for)d(eac)m(h)h Fw(GETRAN)e Fv(call)g(DISUM,)i(DISU)f
(and)h(DISUP)g(are)f(calculated)g(represen)m(ting)h(the)0
2284 y(bac)m(kscattered)47 b(energy)f(at)f(e\013ectiv)m(ely)g(slices)g
(I-1,)i(I)e(and)g(I+1)g(for)f(the)h(relev)-5 b(an)m(t)45
b Fn(\036)p 3211 2316 V 44 w Fv(comp)s(onen)m(t)0 2404
y(calculation.)90 b(If)49 b(I)g(is)f(not)h(1)f(then)i(only)e(PHX,)i
(PHY)f(and)g(PHZ)g(are)g(calculated)e(b)m(y)j(calls)e(to)0
2524 y Fw(GETRAN)p Fv(.)38 b(In)i(these)h(cases)g(only)e(DISUP)h(needs)
i(to)d(b)s(e)h(recalculated)f(as)h(DISUM)g(and)g(DISU)0
2645 y(are)33 b(stored)g(from)e(the)i(previous)g(slice)f(in)g
Fw(GETRAN)p Fv(.)146 2886 y(F)-8 b(ollo)m(wing)33 b(the)i(calculation)e
(of)i Fn(\036)p 1367 2918 V 35 w Fv(the)g(bac)m(kscatter)i(incremen)m
(ts)f(to)f(SU,)g(SV)h(and)f(SW)h(can)f(b)s(e)0 3006 y(determined)24
b(and)h(assigned)g(through)g(curl)f(discretizations.)40
b(Finally)-8 b(,)23 b(PHY)i(and)g(PHZ)g(are)f(assigned)0
3126 y(to)32 b(PHYM)h(and)f(PHZM)g(b)m(y)h(calls)e(to)h
Fw(EQUA)-9 b(TE)30 b Fv(so)j(that)e(they)i(do)f(not)g(need)h(to)f(b)s
(e)g(recalculated)0 3247 y(in)g(the)h(routine)f(for)g(the)h(next)g(v)m
(ertical)f(slice.)0 3656 y Fp(BCQSCT)0 3961 y Fw(Called)k(b)m(y:)113
b Fv(NNSTEPS)0 4081 y Fw(Calls:)e Fv(GETRAN,)33 b(EQUA)-8
b(TE)146 4322 y(Calculates)23 b(the)g(bac)m(kscatter)h(comp)s(onen)m(t)
f(for)f(the)h(Q)g(\014eld)f(source)i(terms.)40 b(A)23
b(similar)d(pro)s(cedure)0 4443 y(to)40 b Fw(BCKSCT)f
Fv(is)g(adopted)i(except)g(that)f(the)g(div)m(ergence)i(of)d(the)h(v)m
(ector,)j Fn(\036)p 2937 4475 V Fv(,)f(is)d(required.)67
b(The)0 4563 y(bac)m(kscatter)35 b(energy)-8 b(,)35 b(DISQ,)e(is)g
(passed)i(to)e(the)h(routine)f(as)h(DISQMM,)g(DISQM,)f(DISQ,)g(DISQP)0
4683 y(and)45 b(DISQPP)h(for)e(the)i(I-2,)h(I-1,)h(I,)d(I+1)g(and)g
(I+2)g(slices)g(resp)s(ectiv)m(ely)-8 b(,)49 b(and)d(the)f(lo)s(cal)e
(arra)m(ys)0 4804 y(DISQUM,)d(DISQU)f(and)g(DISQUP)h(con)m(tain)f(the)h
(bac)m(kscattered)i(energy)e(a)m(v)m(eraged)h(on)m(to)e(the)h(I-)0
4924 y(1,)g(I)f(and)g(I+1)g(slices)g(with)f(resp)s(ect)i(to)f(the)g
(relev)-5 b(an)m(t)39 b(comp)s(onen)m(t)g(of)f Fn(\036)p
2707 4957 V Fv(.)62 b(PHX,)40 b(PHY)f(and)g(PHZ)0 5045
y(con)m(tain)32 b(the)i(three)f(comp)s(onen)m(ts)g(of)g
Fn(\036)p 1411 5077 V 32 w Fv(as)g(in)f Fw(BCKSCT)p Fv(,)g(and)h(PHXM)p
2761 5045 30 4 v 36 w(Q)g(con)m(tains)g(the)g(I-1)f(slice)0
5165 y Fn(x)p Fv(-comp)s(onen)m(t)h(of)f Fn(\036)p 698
5198 58 4 v -1 w Fv(.)146 5406 y(F)-8 b(or)39 b(the)g(I=1)g(v)m
(ertical)g(slice)f(DISQUM,)h(DISQU)g(and)h(DISQUP)f(are)g(determined)g
(and)g(used)0 5526 y(to)30 b(calculate)g(PHX,)i(PHY,)f(PHZ)g(and)g
(PHXM)p 1788 5526 30 4 v 36 w(Q)g(in)f(calls)f(to)i Fw(GETRAN)p
Fv(.)e(F)-8 b(or)30 b(other)h(slices)g(only)0 5646 y(PHX,)44
b(PHY,)h(PHZ)e(and)h(DISQUP)g(are)g(calculated.)75 b(The)45
b(bac)m(kscatter)g(incremen)m(t)f(to)f(the)h(SQ)0 5767
y(term)33 b(is)h(determined)f(b)m(y)i(a)f(discretization)e(of)i(the)g
(grad)g(op)s(erator.)46 b(Finally)-8 b(,)32 b(PHX)i(is)g(assigned)g(to)
1841 6107 y(53)p eop
%%Page: 54 57
54 56 bop 0 52 a Fv(PHXM)p 307 52 30 4 v 36 w(Q)31 b(b)m(y)i(an)e
Fw(EQUA)-9 b(TE)30 b Fv(call,)g(so)i(that)f(the)h(I-1)f(v)-5
b(alues)31 b(do)g(not)h(need)g(to)f(b)s(e)h(recalculated)f(on)0
173 y(subsequen)m(t)38 b(slices.)51 b(All)34 b(of)h(the)g(calculations)
e(o)s(ccur)j(o)m(v)m(er)g(a)f(lo)s(op)f(from)g(1)g(to)h(NQCSTP)i(for)e
(eac)m(h)0 293 y(bac)m(kscattered)g(Q)d(\014eld.)0 702
y Fp(BCTSCT)0 1008 y Fw(Called)k(b)m(y:)113 b Fv(NNSTEPS)0
1128 y Fw(Calls:)e Fv(GETRAN,)33 b(EQUA)-8 b(TE)146 1369
y(Calculates)37 b(the)g(bac)m(kscatter)i(comp)s(onen)m(t)e(for)f(the)h
(p)s(oten)m(tial)f(temp)s(erature)g(source)i(term.)56
b(A)0 1489 y(similar)34 b(pro)s(cedure)39 b(to)e Fw(BCKSCT)g
Fv(is)h(adopted)g(except)h(that)e(the)h(div)m(ergence)h(of)f(the)g(v)m
(ector,)i Fn(\036)p 3695 1522 58 4 v -1 w Fv(,)0 1609
y(is)d(required.)59 b(Again)37 b(the)h(bac)m(kscatter)i(energy)-8
b(,)40 b(DIST,)e(is)f(passed)i(to)e(the)h(routine)f(as)h(DISTMM,)0
1730 y(DISTM,)g(DIST,)g(DISTP)h(and)e(DISTPP)i(for)e(the)h(I-2,)g(I-1,)
h(I,)f(I+1)f(and)h(I+2)f(slices)g(resp)s(ectiv)m(ely)-8
b(,)0 1850 y(and)42 b(the)g(lo)s(cal)e(arra)m(ys)i(DISTUM,)h(DISTU)f
(and)g(DISTUP)h(con)m(tain)e(the)h(bac)m(kscattered)i(energy)0
1971 y(a)m(v)m(eraged)29 b(on)m(to)e(the)h(I-1,)g(I)g(and)f(I+1)g
(slices)h(with)f(resp)s(ect)h(to)g(the)f(relev)-5 b(an)m(t)28
b(comp)s(onen)m(t)f(of)g Fn(\036)p 3413 2003 V Fv(.)42
b(PHX,)0 2091 y(PHY)31 b(and)g(PHZ)g(con)m(tain)g(the)g(three)h(comp)s
(onen)m(ts)f(of)f Fn(\036)p 2062 2124 V 31 w Fv(as)h(in)f
Fw(BCKSCT)p Fv(,)h(and)g(PHXM)g(con)m(tains)0 2211 y(the)i(I-1)f(slice)
g Fn(x)p Fv(-comp)s(onen)m(t)g(of)h Fn(\036)p 1227 2244
V -1 w Fv(.)146 2452 y(F)-8 b(or)38 b(the)g(I=1)g(v)m(ertical)f(slice,)
i(DISTUM,)g(DISTU)g(and)f(DISTUP)h(are)f(determined)g(and)g(used)0
2573 y(to)g(calculate)g(PHX,)i(PHY,)f(PHZ)g(and)g(PHXM)g(in)f(calls)g
(to)g Fw(GETRAN)p Fv(.)g(F)-8 b(or)38 b(other)g(slices)h(only)0
2693 y(PHX,)h(PHY,)g(PHZ)f(and)g(DISTUP)h(are)f(calculated.)63
b(The)40 b(bac)m(kscatter)h(incremen)m(t)e(to)g(the)h(STH)0
2813 y(term)33 b(is)h(determined)f(b)m(y)i(a)f(discretization)e(of)i
(the)g(grad)g(op)s(erator.)46 b(Finally)-8 b(,)32 b(PHX)i(is)g
(assigned)g(to)0 2934 y(PHXM)39 b(b)m(y)g(an)g Fw(EQUA)-9
b(TE)37 b Fv(call,)h(so)g(that)g(the)h(I-1)f(v)-5 b(alues)38
b(do)g(not)g(need)h(to)f(b)s(e)h(recalculated)f(on)0
3054 y(subsequen)m(t)e(slices.)0 3463 y Fp(BEGIN)0 3768
y Fw(Called)g(b)m(y:)113 b Fv(LES)0 3889 y Fw(Calls:)99
b Fv(CHKP)-8 b(ARMS,)31 b(EXXIT,)f(INDGNEW,)g(SET0,)g(PREPGRID,)f
(SET1D,)h(SETSG,)g(SET-)0 4009 y(DIA)m(GS,)i(MICR)m(OSET,)j(SST)-8
b(AR)g(T,)34 b(RETREIVE,)g(NEWRETR)146 4250 y(Initiates)27
b(the)h(job)f(b)m(y)h(reading)f(in)g(namelists,)g(c)m(hec)m(king)i
(parameters,)f(reading)f(mo)s(del)f(dump)h(or)0 4370
y(initializing)c(\014elds)29 b(and)f(running)g(\014rst)h(few)g(mo)s
(del)d(steps.)44 b(A)28 b(sc)m(hematic)h(diagram)d(of)h(the)i
(structure)0 4491 y(of)j Fw(BEGIN)f Fv(is)h(sho)m(wn)i(in)e(Fig.)f(3.)
146 4731 y(The)44 b(\014rst)g(step)g(is)f(to)f(read)i(in)e(the)h
(CNTRL,)h(TIMENML)h(and)e(JOBINF)m(O)h(namelists)d(and)0
4852 y(to)h(c)m(hec)m(k)j(the)d(parameters)h(b)m(y)g(a)f(call)e(to)i
Fw(CHKP)-9 b(ARMS)p Fv(.)41 b(A)h(k)m(ey)i(v)-5 b(ariable)41
b(read)h(in)g(from)f(the)0 4972 y(CNTRL)32 b(namelist)c(is)j(IST)-8
b(AR)g(T.)32 b(If)e(IST)-8 b(AR)g(T=1)32 b(then)f(the)g(job)g(is)f(a)h
(set-up,)g(i.e.)g(the)g(\014rst)g(job)g(in)f(a)0 5093
y(c)m(hain.)46 b(If)33 b(IST)-8 b(AR)g(T=0)34 b(then)g(the)g(job)f(is)f
(a)i(con)m(tin)m(uation)e(of)h(a)g(c)m(hain.)46 b(The)34
b(v)-5 b(alues)33 b(of)g(eac)m(h)h(of)f(the)0 5213 y(namelist)c(v)-5
b(ariables)30 b(are)h(c)m(hec)m(k)m(ed)j(and)d(if)f(they)i(are)f(not)g
(v)-5 b(alid)30 b(then)h(the)h(error)f(\015ag,)g(L)p
3272 5213 30 4 v 35 w(ERR)m(OR,)g(is)0 5333 y(raised.)42
b(If)31 b(it)e(is)g(not)h(a)g(set-up)h(and)f(L)p 1400
5333 V 35 w(ERR)m(OR)g(has)h(b)s(een)g(raised)f(the)g(run)h(exits)f
(with)g(an)g Fw(EXXIT)0 5454 y Fv(call)38 b(with)g(ISTOPU=7.)65
b(The)40 b(argumen)m(ts)f(NND,)h(NNDIA)m(GD)e(and)i(NNDUMPD)f(are)g
(assigned)0 5574 y(to)c(NN,)h(NNDIA)m(G)f(and)h(NNDUMP)g(at)f(this)g(p)
s(oin)m(t;)h(these)h(con)m(trol)e(the)g(n)m(um)m(b)s(er)h(of)f(mo)s
(del)f(steps)0 5695 y(executed)e(in)e(the)h(job)e(in)h(the)h(main)d
(program,)i Fw(LES)p Fv(.)g(DGNEW,)g(WRK)g(and)g(P)h(are)f(all)e(set)j
(to)f(zero)0 5815 y(b)m(y)j(calls)f(to)g Fw(INDGNEW)f
Fv(and)i Fw(SET0)p Fv(.)1841 6107 y(54)p eop
%%Page: 55 58
55 57 bop 146 52 a Fv(If)35 b(the)g(job)g(is)f(a)h(set-up)g(then)h(the)
f(rest)g(of)g(the)g(namelists)f(are)g(read)h(in)f(\(INPUT,)j(GRID,)c
(TH-)0 173 y(PR)m(OF,)f(INITPR)m(OF,)h(SUBMODEL,)f(DIA)m(GNOST,)g(D)m
(YNAMICS,)i(NUMERICS,)f(RADCNTL)0 293 y(and)c(MO)m(VD)m(A)-8
b(T)g(A\).)30 b(Again)f(namelist)e(v)-5 b(ariables)28
b(are)h(c)m(hec)m(k)m(ed)j(for)d(v)-5 b(alidit)m(y)27
b(and)j(L)p 3117 293 30 4 v 35 w(ERR)m(OR)f(raised)0
414 y(and)36 b(error)g(message)h(written)f(if)f(they)j(are)e(not)g(v)-5
b(alid.)53 b(After)36 b(all)e(the)j(namelists)e(ha)m(v)m(e)i(b)s(een)g
(read,)0 534 y(if)e(L)p 160 534 V 35 w(ERR)m(OR)h(is)g(true)h(then)g
Fw(EXXIT)d Fv(is)i(called)f(with)h(ISTOPU=7.)56 b(The)37
b(next)g(stage)g(is)f(to)g(pre-)0 654 y(pro)s(cess)41
b(the)f(input)f(v)-5 b(alues)40 b(for)f(the)h(v)m(ertical)f(grid,)h
(initial)c(pro\014les)k(and)g(p)s(oten)m(tial)e(temp)s(erature)0
775 y(reference)48 b(pro\014le)f(b)m(y)g(calling)d(routine)i
Fw(PREPGRID)p Fv(.)f(This)i(rearranges)g(the)g(namelist)e(input)0
895 y(\(e.g.)75 b(THREF)p 610 895 V 35 w(READ,)43 b(ZNREF)p
1336 895 V 35 w(READ\))f(in)m(to)g(arra)m(ys)i(whic)m(h)f(can)g(b)s(e)h
(used)g(to)e(calculate)g(the)0 1016 y(grid/pro\014le)31
b(b)m(y)i(in)m(terp)s(olation)d(\(e.g.)44 b(THREF)m(GD,)32
b(ZNREF)m(GD\))f(in)h Fw(SET1D)p Fv(.)g(It)h(is)f(these)h(latter)0
1136 y(arra)m(ys)42 b(whic)m(h)f(are)g(ultimately)d(passed)43
b(to)e(the)g(mo)s(del)e(dump.)69 b(Next)42 b Fw(SET1D)f
Fv(is)f(called)g(whic)m(h)0 1256 y(sets)d(up)f(v)-5 b(arious)34
b(constan)m(ts)j(and)f(1-D)e(arra)m(ys,)j(including)d(the)i(grid,)f
(reference)i(states)g(and)e(initial)0 1377 y(pro\014les.)78
b(The)45 b(follo)m(wing)d(call)g(to)i Fw(SETSG)g Fv(sets)i(up)e(the)h
(subgrid)f(mo)s(del)e(constan)m(ts,)49 b(and)44 b(the)0
1497 y(call)36 b(to)h Fw(SETLS)h Fv(sets)h(the)f(large-scale)e
(forcing.)57 b(The)38 b(call)e(to)h Fw(SETDIA)m(GS)g
Fv(determines)h(whic)m(h)0 1617 y(grid)g(v)-5 b(alues)38
b(corresp)s(ond)i(to)e(the)h(diagnostic)e(slices)h(sp)s(eci\014ed)i(in)
e(namelist)f(DIA)m(GNOST.)h(If)h(the)0 1738 y(three-phase)k(microph)m
(ysics)f(has)g(b)s(een)g(selected)h(then)f Fw(MICR)m(OSET)f
Fv(is)h(called)e(whic)m(h)i(sets)h(up)0 1858 y(v)-5 b(arious)30
b(arra)m(ys)i(used)g(in)e(the)i(microph)m(ysics)f(calculations.)41
b(The)31 b(\014nal)g(call)e(is)h(to)h Fw(SST)-9 b(AR)g(T)30
b Fv(whic)m(h)0 1979 y(initialises)f(the)k(mo)s(del)e(\014elds)i(and)g
(runs)g(the)g(\014rst)g(few)g(timesteps)g(of)f(the)h(mo)s(del.)146
2219 y(If)j(the)g(job)f(is)g(not)g(a)g(set-up,)i(and)f(part)f(of)g(a)g
(c)m(hain,)h(the)g(\014rst)g(stage)g(is)f(to)g(read)h(in)e(the)i(mo)s
(del)0 2340 y(dump)43 b(through)h(either)f Fw(RETRIEVE)e
Fv(or)i Fw(NEWRETR)p Fv(.)f(The)i(O)m(VRIDE1)f(namelist)f(is)h(read)0
2460 y(in)g(\(although)g(its)g(v)-5 b(alues)44 b(are)g(not)f(c)m(hec)m
(k)m(ed)k(for)d(v)-5 b(alidit)m(y\),)44 b(and)g Fw(SET1D)p
Fv(,)g Fw(SETSG)p Fv(,)g Fw(SETLS)p Fv(,)0 2580 y Fw(SETDIA)m(GS)32
b Fv(and)h Fw(MICR)m(OSET)e Fv(called)h(as)h(for)f(the)h(set-up)g
(case.)0 2990 y Fp(CALC)p 385 2990 41 4 v 48 w(LEVS)0
3295 y Fw(Called)j(b)m(y:)113 b Fv(SET1D)0 3415 y Fw(Calls:)e
Fv(-)146 3656 y(Calculates)43 b(the)h(total)e(n)m(um)m(b)s(er)i(of)f
(lev)m(els)g(to)h(b)s(e)f(used)i(in)d(the)i(radiation)e(calculation.)73
b(Mc-)0 3776 y(Clattc)m(hey)31 b(pro\014les)g(are)f(used)i(to)e(\014ll)
f(in)g(the)i(rest)g(of)f(the)h(atmosphere)g(ab)s(o)m(v)m(e)g(the)g(mo)s
(del)e(top.)43 b(The)0 3897 y(calculation)36 b(w)m(orks)k(out)e(at)g
(what)h(lev)m(el)f(to)h(start)f(using)g(the)h(McClattc)m(hey)h(data.)61
b(The)40 b(pressure)0 4017 y(ab)s(o)m(v)m(e)26 b(whic)m(h)g(the)f
(McClattc)m(hey)i(data)e(is)g(used)h(is)f(PCUTOFF)h(and)f(this)g(is)g
(determined)g(b)m(y)h(the)g(top)0 4138 y(mo)s(del)37
b(pressure,)42 b(PREFN\(KKP\),)d(less)g(PMINDIFF,)f(where)i(PMINDIFF)f
(is)f(FRA)m(CDP)g(times)0 4258 y(the)28 b(pressure)h(di\013erence)f(b)s
(et)m(w)m(een)i(the)d(top)h(mo)s(del)d(lev)m(els)j(to)f(a)g(minim)m(um)
d(of)j(MINDP)h(and)f(a)g(max-)0 4378 y(im)m(um)e(of)h(MAXDP)-8
b(.)27 b(The)g(lev)m(el)f(in)g(the)h(McClattc)m(hey)h(pro\014les)f(at)f
(whic)m(h)h(PCUTOFF)g(is)f(reac)m(hed)i(is)0 4499 y(set)j(as)f(CUT)g
(\(note)g(McClattc)m(hey)i(lev)m(els)e(start)g(with)f(the)h(highest\))g
(and)g(the)g(n)m(um)m(b)s(er)g(of)g(radiation)0 4619
y(lev)m(els,)g(IRLEVS,)g(de\014ned)h(as)e(KKP+CUT.)h(The)g(McClattc)m
(hey)h(data)e(is)g(merged)g(with)f(the)i(mo)s(del)0 4739
y(data)k(in)g(routine)h Fw(MER)m(GE)p 1109 4739 34 4
v 39 w(D)m(A)-9 b(T)g(A)p Fv(,)33 b(but)i(information)d(from)h(this)i
(routine)f(is)g(used)i(for)e(reading)0 4860 y(in)e(the)h(sp)s(ectral)f
(\014les)h(in)f(the)h(initial)28 b(call)j(to)h Fw(RAD)p
1967 4860 V 40 w(LEM)p Fv(.)0 5269 y Fp(CALCBAR)0 5574
y Fw(Called)k(b)m(y:)113 b Fv(ST)-8 b(AR)g(T,)33 b(NNSTEPS)0
5695 y Fw(Calls:)111 b Fv(-)1841 6107 y(55)p eop
%%Page: 56 59
56 58 bop 146 52 a Fv(Calculates)33 b(the)g(horizon)m(tal)e(means)i(of)
f(the)i(prognostic)e(v)-5 b(ariables)32 b(for)g(3-D)f(in)m(tegrations.)
44 b(The)0 173 y(calculation)32 b(for)i(eac)m(h)h(\014eld)f(is)f
(carried)h(out)g(in)g(a)g(similar)d(w)m(a)m(y)-8 b(,)36
b(and)e(for)g(illustration)d(here)k(U)f(shall)0 293 y(b)s(e)j(used.)59
b(Firstly)-8 b(,)36 b(a)h(temp)s(orary)g(arra)m(y)-8
b(,)38 b(UBAR)-8 b(TMP)g(,)38 b(dimensioned)e(o)m(v)m(er)i(I)s(IPEP)h
(and)e(KKP)-8 b(,)37 b(is)0 414 y(assigned)27 b(with)g(the)g(v)-5
b(alues)27 b(of)g(U)g(o)m(v)m(er)h(J,)f(so)g(that)g(UBAR)-8
b(TMP\(I,K\))28 b(=)f(\006)2796 366 y Fe(j)t Fs(=)p Fe(j)t(j)t(p)2796
436 y(j)t Fs(=1)3015 414 y Fv(U\(J,K,I\).)g(If)g(repro-)0
534 y(ducible)32 b(calculations)e(o)m(v)m(er)j(an)f(arbitrary)g(n)m(um)
m(b)s(er)g(of)g(PEs)h(are)f(required)h(\(IREPBARP=1\))g(then)0
654 y(UBAR)-8 b(TMP)25 b(is)e(summed)h(o)m(v)m(er)h(eac)m(h)g(PE)g
(using)e(the)i(call)d(to)h(GCG)p 2479 654 30 4 v 35 w(R)-11
b(VECSUMR.)25 b(This)f(p)s(erforms)g(a)0 775 y(repro)s(ducible)i(sum)h
(o)m(v)m(er)i(all)c(PEs)j(and)f(places)h(the)f(result)g(in)g(UBAR.)g
(If)g(repro)s(ducible)f(calculations)0 895 y(are)35 b(not)f(required)h
(then)h(UBAR)e(is)h(calculated)e(on)i(the)g(lo)s(cal)d(PE)k(b)m(y)f
(summing)e(all)g(UBAR)-8 b(TMPs)0 1016 y(o)m(v)m(er)39
b(I=1,I)s(IPEP)-8 b(.)39 b(The)g(total)e(UBAR)h(is)g(then)g(found)g
(using)g(the)h(call)d(to)i(GC)p 3007 1016 V 35 w(RSUMR.)g(Finally)-8
b(,)0 1136 y(UBAR)46 b(is)g(a)m(v)m(eraged)h(o)m(v)m(er)h(the)e(n)m(um)
m(b)s(er)h(of)f(horizon)m(tal)e(p)s(oin)m(ts)i(b)m(y)h(m)m(ultiplying)c
(b)m(y)k(RNHPTS)0 1256 y(\(1/\(I)s(IP*JJP\)\))i(and)f(then)h(UBAR)g(is)
f(assigned)g(to)g(OLUBAR,)h(whic)m(h)g(stores)g(the)g(horizon)m(tal)0
1377 y(mean)32 b(in)g(common)f(blo)s(c)m(k)i(MEANS.)0
1786 y Fp(CALCVIS)0 2091 y Fw(Called)j(b)m(y:)113 b Fv(NNSTEPS)0
2211 y Fw(Calls:)e Fv(LO)m(WERBC,)34 b(SMA)m(G,)f(SMA)m(G1D,)f(SMA)m
(G2D)146 2452 y(Con)m(trol)40 b(routine)f(whic)m(h)h(calls)f(the)h
(subroutines)h(necessary)h(to)d(calculate)g(the)h(viscosit)m(y)g(and)0
2573 y(di\013usion)32 b(co)s(e\016cien)m(ts)i(\(VIS)f(and)g(DIFF\).)f
(A)h(sc)m(hematic)g(structure)i(for)d Fw(CALCVIS)g Fv(is)h(sho)m(wn)h
(in)0 2693 y(Fig.)f(6.)51 b(Argumen)m(ts)35 b(are)g(sp)s(eci\014c)g(v)m
(ertical)f(slices)h(of)g(\014elds)g(de\014ned)h(in)e(the)h(call)e(in)i
Fw(NNSTEPS)p Fv(.)0 2813 y Fw(LO)m(WERBC)c Fv(is)g(called)f(\014rst,)j
(and)f(this)f(returns)i(the)f(VIS)g(and)g(DIFF)e(on)i(K=1)f(\(surface)i
(b)s(ound-)0 2934 y(ary)45 b(condition\),)i(then)f Fw(SMA)m(G)p
Fv(,)g Fw(SMA)m(G2D)f Fv(or)g Fw(SMA)m(G1D)g Fv(are)g(called,)j(dep)s
(ending)d(on)g(the)0 3054 y(dimensions)39 b(of)g(the)h(run,)i(whic)m(h)
e(calculate)f(VIS)h(and)g(DIFF)f(throughout)g(the)h(rest)h(of)e(the)h
(slice.)0 3174 y Fw(SMA)m(G)33 b Fv(also)e(calculates)h(the)h(bac)m
(kscattered)i(energy)-8 b(,)34 b(DIS,)e(DIST)h(and)g(DISQ.)0
3584 y Fp(CB2DCALC)0 3889 y Fw(Called)j(b)m(y:)113 b
Fv(CBAR2D)0 4009 y Fw(Calls:)e Fv(RECOMBINE,)34 b(EQUA)-8
b(TE)146 4250 y(Utilit)m(y)38 b(routine)h(for)g(calculating)e(a)i
(repro)s(ducible)g(horizon)m(tal)f(mean)h(for)g(2-D)f(runs.)65
b(FIELD)0 4370 y(con)m(tains)36 b(the)g(distributed)f(\014eld)h(to)f(b)
s(e)h(meaned,)h(BAR)e(is)g(the)i(mean)e(and)h(ALL)-11
b(V)g(ALS)36 b(is)f(the)h(full)0 4491 y(domain)22 b(\014eld)h(to)h(b)s
(e)f(meaned.)41 b(F)-8 b(or)23 b(MPP)i(runs)f(FIELD)f(is)g(collected)g
(from)g(all)e(PEs)k(and)f(assigned)g(to)0 4611 y(ALL)-11
b(V)g(ALS)34 b(using)g(routine)f Fw(RECOMBINE)p Fv(,)f(else)i(this)f
(is)g(p)s(erformed)h(using)f Fw(EQUA)-9 b(TE)p Fv(.)33
b(BAR)0 4731 y(is)f(then)h(calculated)f(as)h(the)g(sum)f(o)m(v)m(er)i
(J=1,JJTOTP)g(of)e(ALL)-11 b(V)g(ALS.)0 5141 y Fp(CBAR2D)0
5446 y Fw(Called)36 b(b)m(y:)113 b Fv(ST)-8 b(AR)g(T,)33
b(NNSTEPS)0 5566 y Fw(Calls:)111 b Fv(SET0,)34 b(CB2DCALC)146
5807 y(Calculates)g(the)h(horizon)m(tal)e(means)i(of)f(the)g
(prognostic)g(v)-5 b(ariables)34 b(for)f(a)i(2-D)e(mo)s(del)g(run.)49
b(All)1841 6107 y(56)p eop
%%Page: 57 60
57 59 bop 0 52 a Fv(\014elds)30 b(are)h(dealt)e(with)h(similarly)-8
b(,)27 b(and)j(for)g(illustration)c(purp)s(oses)32 b(the)e(U)g(\014eld)
g(will)e(b)s(e)i(considered.)0 173 y(Firstly)-8 b(,)24
b(UBAR)h(is)e(initialised)e(to)j(zero)g(b)m(y)h(a)f Fw(SET0)g
Fv(call)f(and)h(then)h(the)f(sum)g(is)g(calculated)f(b)m(y)i(a)f(call)0
293 y(to)37 b Fw(CB2DCALC)g Fv(with)g(ALL)-11 b(V)g(ALS,)38
b(U)f(and)g(UBAR)h(as)f(argumen)m(ts.)58 b(The)38 b(calculation)d(is)i
(then)0 414 y(completed)c(b)m(y)i(dividing)d(UBAR)i(b)m(y)h(the)g(n)m
(um)m(b)s(er)f(of)g(grid)e(p)s(oin)m(ts)i(\(m)m(ultiply)e(b)m(y)i
(RNHPTS\))h(and)0 534 y(then)e(UBAR)f(is)g(assigned)g(to)g(OLUBAR,)g
(whic)m(h)h(is)f(the)h(arra)m(y)f(held)g(in)f(common)g(blo)s(c)m(k)h
(MEANS.)0 943 y Fp(CHGLOOK)0 1248 y Fw(Called)k(b)m(y:)113
b Fv(NNSTEPS)0 1369 y Fw(Calls:)e Fv(SETLOOK)146 1609
y(Up)s(dates)39 b(the)g(lo)s(ok-up)e(table)g(used)i(to)f(calculate)f
(the)i Fn(u)2313 1624 y Fi(\003)2390 1609 y Fv(and)f
Fn(\022)2630 1624 y Fi(\003)2708 1609 y Fv(for)f(sp)s(eci\014ed)i
(surface)g(heat)0 1730 y(\015uxes)g(in)f(the)g(con)m(v)m(ectiv)m(e)i
(case.)60 b(Called)37 b(from)f Fw(NNSTEPS)h Fv(if)g(time-v)-5
b(arying)35 b(sp)s(eci\014ed)k(surface)0 1850 y(heat)i(\015uxes)i(are)f
(used.)70 b(FBUO)m(Y)41 b(is)g(the)h(buo)m(y)m(ancy)h(\015ux,)h(and)e
(FBUO)m(YNEW)g(is)e(the)i(up)s(dated)0 1971 y(buo)m(y)m(ancy)36
b(\015ux.)47 b(If)34 b(FBUO)m(YNEW)g(is)g(not)f(p)s(ositiv)m(e)g(then)h
(the)h(case)f(is)f(not)h(con)m(v)m(ectiv)m(e,)i(the)e(lo)s(ok-)0
2091 y(up)41 b(table)e(do)s(es)i(not)f(need)h(to)f(b)s(e)h(up)s(dated,)
i(and)d(th)m(us)h(the)g(routine)f(is)g(exited.)67 b(The)41
b(next)g(stage)0 2211 y(is)j(to)g(determine)g(whether)h(the)g(curren)m
(t)g(lo)s(ok-up)e(table)h(can)h(b)s(e)f(up)s(dated,)k(or)c(whether)i(a)
e(new)0 2332 y(lo)s(ok-up)39 b(table)h(needs)i(to)e(b)s(e)h(created.)68
b(DFBMAX)40 b(giv)m(es)h(the)g(maxim)m(um)d(c)m(hange)k(in)d(buo)m(y)m
(ancy)0 2452 y(\015ux)33 b(b)s(et)m(w)m(een)h(lo)s(ok-up)c(table)i
(iterations,)e(so)i(NIT=\(FBUO)m(YNEW-FBUO)m(Y\)/DFBMAX)h(giv)m(es)0
2573 y(the)h(n)m(um)m(b)s(er)g(of)f(iterations)g(that)g(are)h(needed.)
48 b(If)34 b(this)f(is)g(greater)h(than)f(10)h(or)f(the)h(buo)m(y)m
(ancy)i(\015ux)0 2693 y(has)30 b(c)m(hanged)i(sign)d(then)i(a)e(new)i
(lo)s(ok-up)e(table)g(is)h(calculated)f(b)m(y)i(a)f(call)e(to)i
Fw(SETLOOK)g Fv(and)g(the)0 2813 y(routine)i(exited.)146
3054 y(The)26 b(remainder)e(of)h(the)g(routine)g(up)s(dates)g(the)h(lo)
s(ok-up)d(table.)41 b(The)26 b(calculation)c(is)j(lo)s(op)s(ed)e(o)m(v)
m(er)0 3174 y(N=1,NIT)38 b(with)g(FBUO)m(Y)g(increased)g(b)m(y)h
(DFB=\(FBUO)m(YNEW-FBUO)m(Y\)/NIT)f(in)f(eac)m(h)i(pass.)0
3295 y(The)32 b(lo)s(ok-up)e(table)h(is)f(up)s(dated)i(b)m(y)g
(recomputing)e Fn(u)2022 3310 y Fi(\003)2092 3295 y Fv(using)h(the)h
(new)g(v)-5 b(alue)31 b(of)f(FBUO)m(Y)i(and)f(the)0 3415
y(old)k(lo)s(ok-up)f(table)h(v)-5 b(alue)36 b(of)f Fn(u)1194
3430 y Fi(\003)1233 3415 y Fv(,)h(USTLOK.)h(This)f(new)g(v)-5
b(alue)36 b(of)f Fn(u)2625 3430 y Fi(\003)2699 3415 y
Fv(is)h(assigned)g(to)f(VELNEW,)0 3536 y(and)e(then)g(the)g(new)g
(USTLOK)g(is)f(determined)h(b)m(y)g(relaxing)f(to)m(w)m(ards)h(VELNEW.)
0 3945 y Fp(CHGLS)0 4250 y Fw(Called)j(b)m(y:)113 b Fv(NNSTEPS)0
4370 y Fw(Calls:)e Fv(-)146 4611 y(Up)s(dates)39 b(the)f(large-scale)f
(forcing)g(terms.)59 b(The)39 b(input)f(is)f(the)h(time-v)-5
b(arying)36 b(forcing)h(arra)m(ys,)0 4731 y(SULS)p 248
4731 30 4 v 36 w(TV,)25 b(SVLS)p 721 4731 V 36 w(TV,)g(STHLS)p
1264 4731 V 36 w(TV)h(and)f(SQLS)p 1896 4731 V 35 w(TV,)g(and)g(the)h
(output)f(is)f(the)h(large-scale)f(forcing)0 4852 y(terms)37
b(used)i(in)d(the)i(source)g(routines,)h(SULS,)f(SVLS,)f(STHLS)h(and)g
(SQLS.)f(The)i(curren)m(t)f(mo)s(del)0 4972 y(time,)d(TIME,)j(is)d
(compared)h(to)f(the)h(forcing)f(times,)h(TIMF)m(OR,)h(and)e(the)i(v)-5
b(alue)35 b(for)g(S*LS)h(calcu-)0 5093 y(lated)h(b)m(y)h(in)m(terp)s
(olation)d(from)h(S*LS)p 1433 5093 V 35 w(TV.)i(If)g(TIME)g(is)f
(outside)h(the)g(b)s(ounds)g(of)f(TIMF)m(OR)h(then)0
5213 y(the)27 b(forcing)e(is)i(set)g(to)f(the)h(v)-5
b(alues)27 b(at)f(those)h(b)s(ounds.)42 b(Finally)-8
b(,)25 b(if)h(the)h(indicators,)f(IF)m(OR)m(U,)h(IF)m(OR)-11
b(V,)0 5333 y(IF)m(OR)j(TH)28 b(or)f(IF)m(OR)m(Q)h(are)g(equal)g(to)f
(2,)i(then)f(SULS)g(etc)h(con)m(tains)f(the)g(pro\014le)f(to)h(whic)m
(h)g(the)g(mo)s(del)0 5454 y(mean)40 b(state)h(is)f(to)g(b)s(e)h
(relaxed,)h(and)f(so)f(SULS)h(etc)g(is)f(calculated)g(as)g(a)g
(tendency)j(b)m(y)e(subtract-)0 5574 y(ing)32 b(the)i(mo)s(del)d(mean)i
(\(OLZ*BAR\))f(and)h(dividing)e(b)m(y)j(the)g(relaxation)d(timescale,)h
(F)m(OR)-8 b(TIMSC.)0 5695 y(Alternativ)m(ely)g(,)36
b(if)f(IF)m(OR*=1)g(then)h(the)g(forcings)g(are)g(c)m(hanged)h(from)d
(unit)h(p)s(er)h(da)m(y)h(to)f(units)f(p)s(er)0 5815
y(second)f(b)m(y)f(dividing)e(b)m(y)i(the)g(n)m(um)m(b)s(er)g(of)g
(seconds)h(in)e(a)g(da)m(y)h(\(RSECSIND)m(A)-8 b(Y\).)1841
6107 y(57)p eop
%%Page: 58 61
58 60 bop 0 52 a Fp(CHKP)-11 b(ARMS)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(BEGIN)0 478 y Fw(Calls:)e Fv(EXXIT)146
719 y(Chec)m(ks)36 b(the)d(mo)s(del)f(parameters)g(for)h(consistency)-8
b(.)46 b(If)33 b(it)f(is)g(a)h(set-up)h(job)e(\(IST)-8
b(AR)g(T=1\),)34 b(then)0 839 y(information)d(on)k(the)g(parameter)f(v)
-5 b(alues)35 b(and)f(their)g(meanings)g(are)h(written)f(out)h(to)f
(the)h Fl(run)p 3585 839 30 4 v 36 w(info)0 959 y Fv(\014le,)27
b(unit)f(15.)41 b(A)27 b(wide)f(selection)g(of)g(parameters)h(are)f
(tested)i(in)d(turn;)k(if)d(an)g(inconsistency)h(is)f(found)0
1080 y(the)34 b(error)f(\015ag,)h(L)p 688 1080 V 35 w(ERR)m(OR,)f(is)g
(raised.)46 b(If,)34 b(at)f(the)h(end)g(of)f(the)h(routine,)g(L)p
2867 1080 V 35 w(ERR)m(OR)f(is)g(true)h(then)0 1200 y
Fw(EXXIT)d Fv(is)h(called)g(with)g(ISTOPU=5.)0 1609 y
Fp(CLASSCOL)0 1915 y Fw(Called)k(b)m(y:)113 b Fv(NNSTEPS)0
2035 y Fw(Calls:)e Fv(-)146 2276 y(Determines)37 b(the)h(column)f
(classi\014cation)f(for)h(the)h(conditionally)c(sampled)j(diagnostics.)
58 b(The)0 2396 y(main)30 b(output)h(of)h(this)f(routine)g(is)g(the)h
(arra)m(y)f(ICLASS,)i(held)e(in)g(common)f(blo)s(c)m(k)h(CLASSY,)i
(whic)m(h)0 2517 y(giv)m(es)25 b(the)h(column)e(classi\014cation)f(for)
h(eac)m(h)i(horizon)m(tal)e(grid)g(p)s(oin)m(t)g(on)h(that)f(PE.)i(The)
g(routine)e(is)h(set)0 2637 y(up)34 b(to)g(de\014ne)h(the)f(follo)m
(wing)d(column)i(classi\014cations:)45 b(0)34 b(-)f(clear,)h(1)g(-)f
(con)m(v)m(ectiv)m(e,)k(2)c(-)g(stratiform,)0 2757 y(3)38
b(-)f(trailing)e(region,)k(4)f(-)f(an)m(vil)g(cloud,)i(5)f(-)f(shallo)m
(w)h(cloud.)59 b(The)39 b(algorithm)c(used)k(to)f(determine)0
2878 y(con)m(v)m(ectiv)m(e)f(and)d(stratiform)e(columns)i(is)g(based)h
(on)g(2)16 b(km)34 b(radar)g(data)g(so)h(the)f(precipitation)f(\014eld)
0 2998 y(needs)41 b(to)e(b)s(e)g(a)m(v)m(eraged)i(on)m(to)e(a)g(2)16
b(km)39 b(horizon)m(tal)e(grid.)63 b(In)39 b(addition,)h(the)f(bac)m
(kground)i(rainfall)0 3118 y(rate)29 b(is)g(required,)h(and)g(b)s(oth)f
(of)g(these)h(lead)f(to)g(a)g(lot)f(of)g(the)i(apparen)m(t)g(complexit)
m(y)e(of)h(the)h(routine.)146 3359 y(Firstly)-8 b(,)31
b(the)h(mo)s(del)e(grid)h(spacing)g(is)h(c)m(hec)m(k)m(ed)j(to)c(see)i
(if)e(it)f(suitable)h(to)h(carry)g(out)f(the)i(column)0
3480 y(classi\014cation.)86 b(If)48 b(the)g(grid-spacing)d(is)i(larger)
f(than)i(RADGRID)e(\(2km\),)k(or)d(not)g(an)h(in)m(teger)0
3600 y(m)m(ultiple)39 b(of)j(RADGRID)e(or)h(if)g(the)h(mo)s(del)e
(domain)g(is)h(smaller)f(than)i(the)g(bac)m(kground)h(radius,)0
3720 y(BA)m(CKRAD,)33 b(then)g(the)g(routine)e(is)h(exited)h(with)f(an)
g(error)h(message)g(and)f(no)g(v)-5 b(alues)33 b(are)f(assigned)0
3841 y(to)g(ICLASS.)i(This)f(is)f(not)g(a)g(fatal)f(error,)i(ho)m(w)m
(ev)m(er,)i(and)e(the)g(run)g(con)m(tin)m(ues.)146 4081
y(The)41 b(next)f(step)g(is)f(to)g(determine)g(the)h(precipitation)d(v)
-5 b(alues)40 b(on)f(the)h(radar)f(grid,)h(PR)p 3504
4081 V 35 w(RAD.)0 4202 y(NXPTS)49 b(and)f(NYPTS)h(giv)m(e)f(the)h(n)m
(um)m(b)s(er)f(of)f(mo)s(del)g(p)s(oin)m(ts)g(in)h(the)g
Fn(x)g Fv(and)g Fn(y)j Fv(directions)d(re-)0 4322 y(sp)s(ectiv)m(ely)c
(in)e(eac)m(h)h(radar)g(grid)e(b)s(o)m(x.)75 b(NRAD)m(XPTS)44
b(and)e(NYRADPTS)i(giv)m(e)f(the)g(n)m(um)m(b)s(er)g(of)0
4443 y(radar)d(grid)g(p)s(oin)m(ts)g(in)g(the)h Fn(x)g
Fv(and)g Fn(y)j Fv(directions)c(in)g(the)h(whole)f(domain.)66
b(PR)p 3050 4443 V 36 w(RAD)40 b(is)g(not)g(dis-)0 4563
y(tributed)k(and)g(con)m(tains)h(the)f(v)-5 b(ales)44
b(for)g(the)h(whole)f(domain)e(on)i(eac)m(h)i(PE.)f(PR)p
3128 4563 V 35 w(RAD)e(is)h(calcu-)0 4683 y(lated)g(b)m(y)i(summing)c
(all)h(the)i(v)-5 b(alues)45 b(of)f(PRECIP)i(whic)m(h)f(o)s(ccur)g
(within)f(that)g(radar)g(grid)g(b)s(o)m(x,)0 4804 y(b)m(y)c(lo)s(oping)
c(o)m(v)m(er)k(NX=1,NRAD)m(XPTS)g(and)f(NY=1,NRAD)m(YPTS)h(for)e(eac)m
(h)i(radar)f(p)s(oin)m(t,)g(and)0 4924 y(then)45 b(IX=1,NXPTS)g(and)g
(IY=1,NYPTS)g(for)f(eac)m(h)h(mo)s(del)e(p)s(oin)m(t.)77
b(The)45 b(actual)f(mo)s(del)e(p)s(oin)m(t)0 5045 y(\(I,J\))32
b(is)g(de\014ned)i(as)e(\(\(NX-1\)*NXPTS+IX,\(NY-1\)*NYPTS+IY\))i(and)e
(the)h(PE)f(on)h(whic)m(h)f(\(I,J\))0 5165 y(is)42 b(lo)s(cated)g(is)h
(determined)f(as)h(NPE.)h(F)-8 b(or)42 b(MYPE=NPE,)j(PR)p
2467 5165 V 35 w(RAD\(NY,NX\))e(is)f(incremen)m(ted)0
5285 y(with)36 b(PRECIP\(J,I\).)i(On)f(completing)d(these)j(lo)s(ops)f
(PR)p 2177 5285 V 35 w(RAD)g(is)g(summed)g(across)h(all)d(PEs)k(b)m(y)f
(a)0 5406 y(GC)p 153 5406 V 35 w(RSUMR)26 b(call)d(and)j(th)m(us)g
(holds)f(all)e(the)j(radar)e(grid)h(precipitation)e(data)i(for)f(the)i
(whole)f(domain)0 5526 y(on)32 b(eac)m(h)i(PE.)146 5767
y(T)-8 b(o)34 b(determine)f(con)m(v)m(ectiv)m(e)i(columns)e(the)g(bac)m
(kground)i(precipitation)c(rate)i(is)g(required.)46 b(This)1841
6107 y(58)p eop
%%Page: 59 62
59 61 bop 0 52 a Fv(is)31 b(de\014ned)h(as)g(the)f(mean)g(of)g(all)e
(rain)m(y)i(grid)f(p)s(oin)m(ts)h(within)f(BA)m(CKRAD)h(of)g(the)g
(radar)g(grid)f(p)s(oin)m(t.)0 173 y(The)d(maxim)m(um)d(n)m(um)m(b)s
(er)i(of)g(radar)f(grid)g(p)s(oin)m(ts)h(in)g(the)g Fn(x)g
Fv(and)h Fn(y)t Fv(-directions)d(within)h(BA)m(CKRAD)h(is)0
293 y(determined)g(and)f(assigned)h(to)g(NXRANGE)g(and)f(NYRANGE.)h
(Then,)j(for)c(eac)m(h)h(radar)g(grid)e(p)s(oin)m(t,)0
414 y(rain)m(y)k(radar)g(grid)g(p)s(oin)m(ts)g(are)h(searc)m(hed)h(for)
e(b)s(et)m(w)m(een)j Fm(\006)p Fv(NXRANGE)e(and)g Fm(\006)p
Fv(NYRANGE,)g(adding)0 534 y(these)37 b(to)e(PR)p 519
534 30 4 v 36 w(B,)g(the)h(bac)m(kground)h(precipitation)d(rate,)i(and)
g(coun)m(ting,)g(through)g(ICOUNT,)h(the)0 654 y(n)m(um)m(b)s(er)g(of)g
(rain)m(y)f(radar)h(grid)e(p)s(oin)m(ts.)56 b(Note)37
b(that)g(indices)f(ha)m(v)m(e)j(to)d(b)s(e)h(o\013set)g(to)g(accommo)s
(date)0 775 y(the)30 b(p)s(erio)s(dic)e(b)s(oundary)i(conditions.)42
b(The)31 b(lo)s(op)d(is)h(completed)g(b)m(y)i(dividing)d(PR)p
3094 775 V 35 w(B)i(b)m(y)g(ICOUNT.)0 895 y(No)m(w)42
b(it)f(is)g(p)s(ossible)g(to)g(determine)g(whether)i(a)e(radar)g(grid)g
(column)f(is)h(con)m(v)m(ectiv)m(e.)73 b(A)42 b(column)0
1016 y(is)g(con)m(v)m(ectiv)m(e)i(if)d(its)g(rainfall)e(exceeds)44
b(CON)p 1757 1016 V 36 w(INTENSE)g(\(=10)16 b(mmh)2714
979 y Fi(\000)p Fs(1)2806 1016 y Fv(\))42 b(or)g(exceeds)i(the)f(bac)m
(k-)0 1136 y(ground)35 b(rainfall)d(rate)j(b)m(y)h(a)f(factor)g(CON)p
1601 1136 V 35 w(PEAK)h(\(=2\).)51 b(If)35 b(these)h(conditions)e(are)h
(satis\014ed)h(then)0 1256 y(ICLASSTEMP)-8 b(,)34 b(the)e(column)e
(classi\014cation)g(for)h(the)h(radar)f(grid)f(o)m(v)m(er)j(the)f
(whole)f(domain,)f(is)h(set)0 1377 y(to)i(1.)47 b(Ho)m(w)m(ev)m(er,)36
b(columns)d(can)h(also)f(b)s(e)h(con)m(v)m(ectiv)m(e)h(if)e(they)h(lie)
f(within)f(a)h(con)m(v)m(ectiv)m(e)j(radius)e(of)f(a)0
1497 y(con)m(v)m(ectiv)m(e)e(grid)d(p)s(oin)m(t.)41 b(Th)m(us,)31
b(again)d(lo)s(oping)e(o)m(v)m(er)k(all)d(radar)h(grid)g(p)s(oin)m(ts,)
h(if)f(ICLASSTEMP=1)0 1617 y(then)41 b(the)g(con)m(v)m(ectiv)m(e)i
(radius)d(is)g(determined)g(and)h(all)d(grid)h(p)s(oin)m(ts)i(within)e
(the)i(radius)f(are)g(also)0 1738 y(made)25 b(con)m(v)m(ectiv)m(e.)43
b(The)26 b(con)m(v)m(ectiv)m(e)h(radius)e(is)f(a)h(function)f(of)h(the)
g(bac)m(kground)i(precipitation)22 b(rate,)0 1858 y(and)28
b(these)h(threshold)f(v)-5 b(alues)28 b(are)g(held)f(in)g(arra)m(ys)i
(CONRAD)p 2347 1858 V 35 w(THRES)f(and)g(CONRAD)p 3369
1858 V 35 w(V)-11 b(AL)28 b(and)0 1979 y(the)39 b(correct)g(v)-5
b(alue)38 b(is)g(assigned)h(to)f(RADIUS.)h(The)h(pro)s(cedure)f(here)g
(is)g(similar)c(to)j(determining)0 2099 y(PR)p 144 2099
V 35 w(B.)28 b(NXRANGE)g(and)g(NYRANGE)g(are)g(calculated)e(for)i(this)
f(RADIUS)h(and)g(all)d(p)s(oin)m(ts)j(within)0 2219 y(RADIUS)h(of)f
(the)i(radar)e(grid)g(p)s(oin)m(t)g(ha)m(v)m(e)i(ICLASSTEMP)i(set)d
(equal)g(to)g(-1)f(if)f(not)i(1)g(already)-8 b(.)42 b(The)0
2340 y(last)27 b(task)h(is)f(to)g(de\014ne)h(all)e(non-con)m(v)m(ectiv)
m(e)j(p)s(oin)m(ts)e(that)g(ha)m(v)m(e)i(PR)p 2509 2340
V 35 w(RAD)e(exceeding)i(RAINY)p 3554 2340 V 35 w(V)-11
b(AL)0 2460 y(to)32 b(stratiform)f(b)m(y)i(setting)f(ICLASSTEMP=2.)146
2701 y(The)h(v)-5 b(alues)32 b(in)f(ICLASSTEMP)k(no)m(w)d(need)h(to)f
(b)s(e)g(passed)h(to)f(ICLASS,)h(whic)m(h)f(is)g(distributed)0
2821 y(o)m(v)m(er)37 b(all)d(the)i(PEs.)54 b(Again)35
b(it)g(lo)s(ops)f(o)m(v)m(er)j(all)d(the)i(radar)g(grid)e(p)s(oin)m
(ts,)j(and)f(then,)h(for)e(eac)m(h)i(radar)0 2942 y(grid)25
b(p)s(oin)m(t,)i(o)m(v)m(er)h(all)c(the)j(comp)s(onen)m(t)f(mo)s(del)f
(grid)g(p)s(oin)m(ts.)41 b(The)28 b(PE)f(on)f(whic)m(h)h(the)g(mo)s
(del)d(p)s(oin)m(t)i(is)0 3062 y(distributed)k(is)h(iden)m(ti\014ed)f
(b)m(y)i(NPE,)f(and)g(if)f(MYPE=NPE)i(then)g(ICLASS)g(is)e(set)h(to)g
(the)g(absolute)0 3182 y(v)-5 b(alue)28 b(of)h(ICLASSTEMP)j(for)c(that)
h(radar)g(grid)e(p)s(oin)m(t,)i(so)h(that)e(the)i(-1)e(v)-5
b(alues)29 b(b)s(ecome)g(1.)42 b(Finally)-8 b(,)0 3303
y(the)41 b(other)f(column)f(classi\014cations)h(are)g(de\014ned)i(and)e
(assigned)h(to)f(ICLASS)h(dep)s(ending)g(on)f(the)0 3423
y(v)-5 b(alues)32 b(of)h(liquid)d(and)j(ice)f(w)m(ater)i(paths)f(\(L)
-11 b(WP)33 b(and)f(IWP)i(resp)s(ectiv)m(ely\).)0 3832
y Fp(CLASSPRECIP)0 4138 y Fw(Called)i(b)m(y:)113 b Fv(PRECDIA)m(G)0
4258 y Fw(Calls:)e Fv(-)146 4499 y(Calculates)29 b(the)g(mo)s(del)e
(precipitation)g(\014eld,)i(PRECIP)-8 b(.)31 b(This)e(is)f(called)g
(for)g(eac)m(h)i(h)m(ydrometeor)0 4619 y(and)23 b(the)h(fall)c(rate,)25
b(QDO)m(WNFLUX,)e(at)g(lev)m(el)f(PPTLEV,)j(the)e(lev)m(el)g(whic)m(h)h
(corresp)s(onds)g(to)f(surface)0 4739 y(precipitation,)43
b(is)g(added)g(to)g(PRECIP)-8 b(.)44 b(It)f(is)f(m)m(ultiplied)e(b)m(y)
j(SECSIND)m(A)-8 b(YLOC)45 b(\(=3600.\))73 b(to)0 4860
y(con)m(v)m(ert)34 b(from)d(kgm)756 4824 y Fi(\000)p
Fs(2)883 4860 y Fv(to)h(mmh)1220 4824 y Fi(\000)p Fs(1)1313
4860 y Fv(.)0 5269 y Fp(CLASSSET)0 5574 y Fw(Called)k(b)m(y:)113
b Fv(PRECDIA)m(GSET)0 5695 y Fw(Calls:)e Fv(-)1841 6107
y(59)p eop
%%Page: 60 63
60 62 bop 146 52 a Fv(Initialises)39 b(and)j(calculates)e(arra)m(ys)i
(used)h(in)d(determining)g(the)h(column)f(classi\014cation.)69
b(The)0 173 y(precipitation,)30 b(PRECIP)-8 b(,)34 b(is)e(set)h(equal)g
(to)f(zero)h(\(this)f(is)f(calculated)h(in)g Fw(CLASSPRECIP)p
Fv(\))e(and)0 293 y(the)35 b(liquid)d(w)m(ater)j(path,)f(L)-11
b(WP)j(,)35 b(and)g(ice)e(w)m(ater)i(path,)g(IWP)-8 b(,)35
b(are)f(calculated.)47 b(Finally)-8 b(,)32 b(the)j(cloud)0
414 y(top)25 b(heigh)m(t,)h(CTHEIGHT,)g(is)f(determined)f(b)m(y)i
(calculating)c(the)k(cloud)e(w)m(ater)h(path,)i(CWP)p
3438 414 30 4 v 36 w(TEMP)-8 b(,)0 534 y(from)29 b(the)h(top)g(of)f
(the)i(domain)d(and)i(then)h(the)f(lev)m(el)f(at)h(whic)m(h)h(it)d
(exceeds)33 b(CWP)p 3051 534 V 36 w(CRIT)e(\(=0.02\))e(is)0
654 y(tak)m(en)34 b(to)e(b)s(e)h(CTHEIGHT.)0 1064 y Fp(CVELGAL)0
1369 y Fw(Called)j(b)m(y:)113 b Fv(STEPFLDS)0 1489 y
Fw(Calls:)e Fv(-)146 1730 y(P)m(erforms)33 b(partial)e(calculation)f
(of)i(the)h(maxim)m(um)e(domain)g(v)m(elo)s(cities)h(whic)m(h)h(are)g
(used)g(in)f(de-)0 1850 y(termining)23 b(the)j(adv)m(ectiv)m(e)h
(Couran)m(t)f(n)m(um)m(b)s(er)g(and)f(the)h(Galilean)c(transformation.)
39 b(The)27 b(maxim)m(um)0 1971 y(and)39 b(minim)m(um)d(horizon)m(tal)h
(v)m(elo)s(cities)h(on)h(the)h(PE,)g(ZUMAX)f(and)g(ZVMAX)h(and)f(ZUMIN)
g(and)0 2091 y(ZVMIN,)45 b(are)g(found)f(using)h(MAX)g(and)g(MIN)g
(functions)f(on)h(ZU)f(and)h(ZV,)f(whilst)g(the)h(largest)0
2211 y(magnitude)30 b(v)m(ertical)h(v)m(elo)s(cit)m(y)g(is)g(assigned)h
(to)f(ABSWMAX)h(using)f(the)h(absolute)f(of)g(ZW)h(and)f(the)0
2332 y(MAX)d(function.)42 b(On)28 b(the)g(\014nal)f(v)m(ertical)g
(slice)g(\(I=I)s(IPEP\))i(the)f(\014nal)g(horizon)m(tal)e(v)m(elo)s
(cit)m(y)h(extrema)0 2452 y(are)g(assigned)g(to)g(ZUMINN,)g(ZVMINN,)h
(ZUMAXX)f(and)g(ZVMAXX)h(and)f(the)g(Galilean)d(transfor-)0
2573 y(mation)g(undone)k(on)e(these)i(v)-5 b(alues,)27
b(whilst)f(CVELZ,)h(the)g Fn(z)k Fv(comp)s(onen)m(t)26
b(of)g(the)h(adv)m(ectiv)m(e)h(Couran)m(t)0 2693 y(n)m(um)m(b)s(er,)33
b(is)f(calculated)g(as)h(the)g(MAX)g(of)f(ABSWMAX)i(divided)e(b)m(y)h
(the)g(lo)s(cal)e(grid)g(spacing.)0 3102 y Fp(CVELGAL2)0
3407 y Fw(Called)36 b(b)m(y:)113 b Fv(NNSTEPS)0 3528
y Fw(Calls:)e Fv(-)146 3768 y(This)24 b(completes)g(the)h(calculation)c
(of)j(the)g(Galilean)d(transformation,)j(and)g(con)m(tin)m(ues)h(the)f
(calcu-)0 3889 y(lation)j(of)j(the)g(Couran)m(t)g(n)m(um)m(b)s(er,)g
(started)g(in)f Fw(CVELGAL)p Fv(.)g(The)i(global)c(extrema)j(of)f
(ZUMAXX,)0 4009 y(ZVMAXX,)46 b(CVELZ,)g(CVIS,)h(ZUMINN)f(and)g(ZVMINN)g
(are)f(determined)h(using)f(GC)p 3443 4009 V 35 w(RMAX)0
4130 y(and)37 b(GC)p 347 4130 V 35 w(RMIN)h(calls.)56
b(The)38 b(new)g(v)-5 b(alues)37 b(of)g(UGAL)g(and)g(V)m(GAL,)g(the)h
(Galilean)c(v)m(elo)s(cities,)j(are)0 4250 y(then)e(calculated)e(as)h
(the)g(mean)f(of)h(the)g(maxim)m(um)e(and)i(minim)m(um)c(of)k(the)g(v)m
(elo)s(cit)m(y)g(comp)s(onen)m(ts.)0 4370 y(Finally)-8
b(,)28 b(partial)f(calculations)i(of)g(the)h Fn(x)h Fv(and)f
Fn(y)j Fv(comp)s(onen)m(ts)d(of)g(the)g(adv)m(ectiv)m(e)i(Couran)m(t)e
(n)m(um)m(b)s(er,)0 4491 y(CVELX)h(and)g(CVEL)-8 b(Y)31
b(resp)s(ectiv)m(ely)-8 b(,)32 b(are)e(made)g(b)m(y)i(taking)d(the)i
(maxim)m(um)d(of)i(the)h(magnitude)e(of)0 4611 y(the)k(Galilean)c
(transformed)k(v)m(elo)s(cit)m(y)f(maxim)m(um)e(and)j(minim)m(um.)0
5020 y Fp(DIA)l(G)0 5325 y Fw(Called)j(b)m(y:)113 b Fv(EXXIT)0
5446 y Fw(Calls:)132 b Fv(EXXIT,)40 b(WR)-8 b(TCHA,)40
b(WR)-8 b(TNUM,)40 b(WR)-8 b(T2DHEAD,)38 b(WR)-8 b(T3DHEAD,)38
b(REQUA)-8 b(TE,)0 5566 y(XWRAP)g(,)23 b(PWRAP)-8 b(,)24
b(W)m(OUT1D,)f(W)m(OUT2D,)h(EQUA)-8 b(TE,)24 b(W)m(OUTSURF,)g(W)m
(OUTPV,)g(W)m(OUT-)0 5687 y(PD,)32 b(W)m(OUT3D)1841 6107
y(60)p eop
%%Page: 61 64
61 63 bop 146 52 a Fv(Con)m(trols)27 b(the)g(writing)e(of)i(the)g
(diagnostics)f(\014le.)41 b(The)28 b(diagnostics)d(\014le)i(is)f
(written)h(in)f(t)m(w)m(o)h(parts:)0 173 y(the)39 b(header,)j(whic)m(h)
d(is)g(a)f(c)m(haracter)i(string)e(con)m(taining)g(information)e(on)i
(the)i(diagnostics)e(to)g(b)s(e)0 293 y(written)i(out,)h(and)f(the)g
(data.)64 b(The)41 b(header)g(is)e(written)g(out)h(b)m(y)h(writing)d
(to)h(a)g(c)m(haracter)i(string,)0 414 y(HEADER,)33 b(and)g(then)h
(writing)d(this)i(string)f(to)h(the)g(diagnostics)f(\014le.)44
b(F)-8 b(or)32 b(most)h(diagnostic)e(\014elds)0 534 y(the)g(header)g
(is)f(written)h(using)f(calls)f(to)i Fw(WR)-9 b(TNUM)p
Fv(,)29 b(whic)m(h)i(write)g(out)f(the)h(length)f(of)g(the)h(arra)m(y)
-8 b(,)0 654 y(and)37 b(calls)e(to)i Fw(WR)-9 b(TCHA)35
b Fv(whic)m(h)i(write)f(c)m(haracter)i(strings)e(to)h(HEADER)g(,)g(suc)
m(h)h(as)f(the)g(name)0 775 y(of)e(the)h(diagnostic.)52
b(2-D)34 b(and)i(3-D)e(\014elds)i(ha)m(v)m(e)h(their)e(header)i
(information)32 b(written)k(out)f(b)m(y)i(calls)0 895
y(to)h Fw(WR)-9 b(T2DHEAD)35 b Fv(and)j Fw(WR)-9 b(T3DHEAD)36
b Fv(resp)s(ectiv)m(ely)-8 b(.)61 b(The)39 b(p)s(osition)d(on)i(the)g
(HEADER)0 1016 y(at)43 b(whic)m(h)i(to)e(write)h(is)f(held)g(in)g
(IHEAD)h(whic)m(h)h(is)e(incremen)m(ted)h(in)f(the)h(calls)f(to)g(the)i
(routines)0 1136 y(ab)s(o)m(v)m(e.)68 b(The)41 b(diagnostics)e(are)h
(written)h(out)f(in)f(the)i(order)g(con)m(trol/grid)d(arra)m(ys,)43
b(instan)m(taneous)0 1256 y(pro\014les,)e(time-a)m(v)m(eraged)e
(pro\014les,)j(sp)s(ectra,)g(timeseries,)e(2-D)f(prognostic)g
(\014elds,)i(2-D)e(radiation)0 1377 y(\015uxes,)33 b(2-D)d(diagnostic)g
(\014elds,)h(surface)h(plots)f(\(e.g.)43 b(precipitation\))29
b(and,)i(\014nally)-8 b(,)30 b(3-D)g(prognostic)0 1497
y(and)39 b(diagnostic)e(\014elds.)62 b(Necessarily)-8
b(,)40 b(the)f(\014eld)f(data)g(needs)j(to)d(b)s(e)g(written)h(out)f
(in)g(exactly)h(the)0 1617 y(same)32 b(order.)146 1858
y(Calls)39 b(to)g Fw(XWRAP)e Fv(and)j Fw(PWRAP)e Fv(preceed)j(the)f
(writing)e(out)h(of)g(the)h(data)f(to)g(reset)i(an)m(y)0
1979 y(halo)s(es)h(whic)m(h)h(ma)m(y)f(b)s(e)h(needed)h(to)e(b)s(e)h
(written)f(out)g(with)h(the)f(\014elds.)74 b(The)43 b(\014elds)g(are)g
(written)0 2099 y(out)31 b(with)g(calls)g(to)g Fw(W)m(OUT1D)g
Fv(whic)m(h)h(writes)g(out)f(a)h(1-D)e(arra)m(y)-8 b(,)32
b Fw(W)m(OUT2D)f Fv(whic)m(h)h(writes)g(out)0 2219 y(all)39
b(the)i(2-D)f(slices)h(for)g(a)f(prognostic)h(or)g(diagnostic)e
(\014eld,)k Fw(W)m(OUTSURF)f Fv(whic)m(h)f(writes)h(out)0
2340 y(a)36 b(single)g(2-D)f Fn(x)p Fv(-)p Fn(y)k Fv(plane,)f(and)e
Fw(W)m(OUT3D)g Fv(whic)m(h)h(writes)g(out)f(a)h(3-D)e(arra)m(y)i(for)f
(a)g(mo)s(del)f(\014eld.)0 2460 y(The)29 b(sp)s(ecial)e(cases)j(of)d
(the)i(PUDDLE)f(arra)m(y)g(and)g(the)h(p)s(oten)m(tial)d(v)m(orticit)m
(y)i(diagnostic)f(are)h(written)0 2580 y(out)33 b(using)f
Fw(W)m(OUTPD)g Fv(and)h Fw(W)m(OUTPV)e Fv(resp)s(ectiv)m(ely)-8
b(.)45 b(Eac)m(h)34 b(of)e(these)i(calls)d(ha)m(v)m(e)j(argumen)m(ts)0
2701 y(whic)m(h)41 b(are)g(passed)h(to)f(the)g(ultimate)d(writing)h
(routine,)k Fw(WR)-9 b(TFB)p Fv(.)39 b(These)k(are)e(NUN,)g(the)g(unit)
0 2821 y(n)m(um)m(b)s(er;)30 b(BLK,)d(an)h(arra)m(y)f(whic)m(h)h
(represen)m(ts)i(the)e(record)g(to)g(b)s(e)f(written)h(out;)h(LENBLK,)f
(whic)m(h)g(is)0 2942 y(the)h(size)h(of)e(the)h(record;)i(IST)-8
b(AR)g(T,)30 b(whic)m(h)f(is)g(the)g(curren)m(t)h(p)s(osition)d(on)i
(an)g(un)m(written)h(record;)g(and)0 3062 y(IFEND,)c(whic)m(h)i(is)e(a)
g(\015ag)g(indicating)e(whether)k(to)e(complete)g(writing)f(the)i
(\014nal)f(record,)i(or)f(to)f(lea)m(v)m(e)0 3182 y(un\014nished)41
b(for)e(the)h(next)h(diagnostic.)63 b(The)41 b(2-D)d(calls)g(ma)m(y)i
(also)f(ha)m(v)m(e)i(the)f(temp)s(orary)f(arra)m(ys,)0
3303 y(TEMPYZ2D,)e(TEMPXZ2D)h(and)f(TEMPXY2D,)h(in)e(their)g(argumen)m
(t)g(lists.)55 b(These)39 b(arra)m(ys)e(are)0 3423 y(used)50
b(in)d(constructing)i(the)g(2-D)e(slices)h(that)h(are)f(ev)m(en)m
(tually)h(written)f(out)h(to)f(the)h(diagnostic)0 3544
y(\014le.)76 b(Another)43 b(argumen)m(t)h(is)e(FIELD,)i(whic)m(h)g(is)e
(a)i(3-D)e(arra)m(y)h(whic)m(h)h(will)d(ultimately)g(con)m(tain)0
3664 y(the)d(data)f(to)g(b)s(e)h(written)f(out.)58 b(This)37
b(is)g(usually)g(assigned)h(in)e(the)i Fw(W)m(OUT2D)p
Fv(,)g Fw(W)m(OUT3D)f Fv(or)0 3784 y Fw(W)m(OUTSURF)g
Fv(routine,)h(but,)g(there)g(are)f(sev)m(eral)h(exceptions)g(suc)m(h)g
(as)g(for)e(Q)h(\014elds,)h(U)f(and)g(V)0 3905 y(when)44
b(the)f(Galilean)c(transformation)i(is)h(used,)k(and)d(\014elds)g
(deriv)m(ed)g(from)f(TH.)h(In)g(these)h(cases,)0 4025
y(FIELD)29 b(is)g(assigned)h(b)s(efore)g(the)g(subroutine)g(call.)40
b(T)-8 b(o)30 b(signal)e(this)h(in)g(the)h(subroutine,)h(the)f(logical)
0 4145 y(L)p 67 4145 30 4 v 35 w(INFIELD)38 b(is)g(used,)j(a)e(true)f
(v)-5 b(alue)38 b(indicating)e(that)i(the)h(arra)m(y)g(to)f(b)s(e)g
(written)h(out)f(is)g(already)0 4266 y(sited)33 b(in)e(FIELD.)0
4675 y Fp(DISTRIB)0 4980 y Fw(Called)36 b(b)m(y:)113
b Fv(FFSYNTH)0 5101 y Fw(Calls:)e Fv(WRAP)146 5341 y(Redistributes)32
b(the)g(v)-5 b(alues)31 b(of)g(arra)m(y)h(BIG)f(o)m(v)m(er)i(all)c(PEs)
k(in)m(to)e(arra)m(y)h(SMALL.)g(Used)g(for)f(MPP)0 5462
y(2-D)j(runs)i(only)-8 b(.)50 b(BIG)35 b(is)g(the)g(arra)m(y)g(whic)m
(h)h(con)m(tains)f(the)h(whole)f(domain)e(2-D)h(\014eld,)i(and)f(is)f
(th)m(us)0 5582 y(JJTOTP)g(in)f(length.)44 b(SMALL)34
b(is)e(the)i(distributed)f(\014eld)f(and)i(is)e(JJP)i(in)e(length.)45
b(The)34 b(pro)s(cedure)0 5702 y(is)i(con)m(trolled)g(b)m(y)i(PE)f(0)g
(whic)m(h)g(divided)f(BIG)h(up)g(in)m(to)f(the)h(distributed)g(parts,)h
(assigns)f(these)h(to)0 5823 y(TEMP)-8 b(,)30 b(and)e(uses)h(GC)p
880 5823 V 36 w(RSEND)f(to)f(send)j(TEMP)f(to)f(the)h(arra)m(y)f(SMALL)
g(on)h(the)f(other)g(PEs.)44 b(The)1841 6107 y(61)p eop
%%Page: 62 65
62 64 bop 0 52 a Fv(lo)s(cal)33 b(data)i(is)g(assigned)h(directly)f(to)
g(SMALL.)h(All)e(other)i(PEs)h(use)f(GC)p 2781 52 30
4 v 35 w(RRECV)g(to)f(receiv)m(e)i(the)0 173 y(data)32
b(pac)m(k)-5 b(age)32 b(in)m(to)g(SMALL.)h(The)g(routine)e(is)h
(concluded)h(b)m(y)g(a)f(call)e(to)i Fw(WRAP)f Fv(for)g(SMALL)i(to)0
293 y(set)g(up)g(the)g(new)h(halo)s(es.)43 b(This)32
b(is)g(the)h(opp)s(osite)f(of)h(routine)f Fw(RECOMBINE)p
Fv(.)0 702 y Fp(DIVERR)0 1008 y Fw(Called)k(b)m(y:)113
b Fv(NNSTEPS)0 1128 y Fw(Calls:)e Fv(WRAP)146 1369 y(Calculates)31
b(the)i(div)m(ergence)g(error)e(part)h(of)f(the)h(pressure)i(source)f
(term.)42 b(The)33 b(pressure)g(source)0 1489 y(is)d(held)f(in)h(P)-8
b(,)30 b(and)g(this)g(is)f(initialised)d(to)k(zero)h(at)e(the)i(b)s
(eginning)d(of)i(the)g(routine.)42 b(The)31 b(div)m(ergence)0
1609 y(is)f(calculated)f(b)m(y)j(simple)c(discretization)h(across)i
(the)g(mo)s(del)e(grid,)h(with)g(the)h(di\013eren)m(t)f(options)g(for)0
1730 y(forw)m(ard)42 b(step,)k(cen)m(tred)d(step)g(and)f(2-D)f(con)m
(trolled)g(within)g(and)h(IF)g(blo)s(c)m(k.)72 b(The)43
b(div)m(ergence)g(is)0 1850 y(m)m(ultiplied)33 b(b)m(y)k(TIMEC,)i(the)d
(recipro)s(cal)f(of)h(the)h(timestep,)g(to)f(get)g(the)h(correct)g
(pressure)h(source)0 1971 y(term.)83 b(If)46 b(the)h(option)e(has)h(b)s
(een)h(selected)g(to)f(prin)m(t)f(out)h(the)h(div)m(ergence)g(error)f
(\(IPRINT=1\))0 2091 y(then)31 b(the)g(p)s(osition)d(of)i(the)h(maxim)m
(um)d(div)m(ergence)k(error)e(on)h(the)f(slice)g(is)g(calculated)g(b)m
(y)h(using)f(the)0 2211 y(in)m(trinsic)41 b(function)g(ISAMAX)j(on)e
(the)g(t3e,)j(or)d(b)m(y)h(explicit)d(algorithm)f(in)j(the)g(p)s
(ortable)f(mo)s(del)0 2332 y(v)m(ersion.)48 b(This)34
b(returns)h(the)f(p)s(osition)e(of)h(the)i(maxim)m(um)c(of)i(P)i(whic)m
(h)f(is)f(placed)h(in)f(INDMAX.)h(A)0 2452 y(JMAX)h(and)g(KMAX)g(are)g
(then)g(determined)f(from)g(INDMAX.)h(If)f(the)h(maxim)m(um)e(div)m
(ergence)j(on)0 2573 y(the)j(slice)e(exceeds)k(that)d(already)g
(calculated)g(on)g(the)h(PE)g(\(DIVMAX\))f(then)h(the)g(indices)f(of)g
(the)0 2693 y(maxim)m(um)c(div)m(ergence)k(are)f(assigned)g(to)g
(ICOMAX.)h(Finally)-8 b(,)35 b(if)g(it)h(is)g(the)h(last)f(slice)g(of)h
(the)g(PE,)0 2813 y(then)c(DIVMAX)g(is)f(divided)g(b)m(y)i(TIMEC)g(to)e
(return)i(the)f(true)f(div)m(ergence)i(v)-5 b(alue.)0
3223 y Fp(DUMP)0 3528 y Fw(Called)36 b(b)m(y:)113 b Fv(EXXIT)0
3648 y Fw(Calls:)e Fv(-)146 3889 y(W)-8 b(rites)32 b(out)g(a)g(single)f
(mo)s(del)g(dump)h(\014le.)43 b(The)33 b(unit)e(n)m(um)m(b)s(er,)i
(NCHAN,)g(is)f(determined)g(using)0 4009 y(INDIC)38 b(whic)m(h)g
(indicates)g(whic)m(h)g(of)f(FILEA)h(or)g(FILEB)f(the)i(mo)s(del)d
(will)f(write)j(to.)58 b(Firstly)-8 b(,)38 b(the)0 4130
y(non-distributed)31 b(parameters,)i(v)-5 b(ariables)31
b(and)h(1-D)f(arra)m(ys)i(are)f(written)g(to)g(NCHAN.)h(When)g(this)0
4250 y(is)f(completed)f(NCHAN)i(is)f(closed.)43 b(The)33
b(next)g(stage)g(is)e(to)h(write)g(out)g(the)g(\014elds)h(distributed)e
(o)m(v)m(er)0 4370 y(all)j(PEs.)54 b(This)37 b(is)e(ac)m(hiev)m(ed)i(b)
m(y)g(lo)s(oping)c(o)m(v)m(er)k(the)g(n)m(um)m(b)s(er)f(of)f(PES)i
(with)f(NPE.)h(If)e(NPE)i(equals)0 4491 y(MYPE)44 b(then)f(the)g
(distributed)f(data)g(on)g(that)g(PE)h(is)f(written)h(out)f(a)g(v)m
(ertical)g(slice)f(at)i(a)f(time.)0 4611 y(NCHAN)32 b(is)f(reop)s(ened)
h(with)e(POSITION='APPEND')k(so)d(that)g(the)g(data)g(is)g(written)g
(at)f(the)i(end)0 4731 y(of)i(the)h(mo)s(del)e(dump)i(\014le.)49
b(Then)36 b(the)f(mo)s(del)e(data)h(is)g(written)h(out)f(lo)s(oping)e
(o)m(v)m(er)k(the)f(n)m(um)m(b)s(er)g(of)0 4852 y(slices.)53
b(A)m(t)36 b(the)g(end)h(of)e(the)h(lo)s(op)e(NCHAN)j(is)e(closed)h
(again.)52 b(This)36 b(pro)s(cedure)h(ensures)g(that)f(the)0
4972 y(mo)s(del)g(dump)h(can)h(b)s(e)f(read)h(in)e(again)g(b)m(y)j(an)m
(y)f(arbritrary)e(n)m(um)m(b)s(er)i(of)f(PEs.)59 b(A)m(t)37
b(the)h(end)g(of)f(the)0 5093 y(routine,)32 b(INDIC)h(is)f(c)m(hanged,)
i(if)d(necessary)-8 b(,)35 b(and)e(written)f(to)h(FILEZ.)0
5502 y Fp(D)l(YNVIS)0 5807 y Fw(Called)j(b)m(y:)113 b
Fv(NNSTEPS)1841 6107 y(62)p eop
%%Page: 63 66
63 65 bop 0 52 a Fw(Calls:)149 b Fv(UVWSR)m(CE,)45 b(UVW1D,)e(UVW2D,)g
(THSOUR)m(CE,)i(TH1D,)f(TH2D,)f(RADIA)-8 b(TION,)0 173
y(QSOUR)m(CE,)34 b(Q1D,)d(Q2D,)h(MICR)m(OPHYS,)j(LA)-8
b(THEA)g(T)146 414 y(Con)m(trol)29 b(routine)f(whic)m(h)i(calls)e(the)h
(subroutines)h(necessary)h(to)e(calculate)f(all)f(the)i(source)i(terms)
0 534 y(for)37 b(the)i(prognostic)e(\014elds)h(with)g(the)g(exception)h
(of)f(the)g(pressure)i(gradien)m(t)d(term.)59 b(A)38
b(sc)m(hematic)0 654 y(structure)33 b(of)e Fw(D)m(YNVIS)g
Fv(is)g(sho)m(wn)i(in)e(Fig.)g(7.)43 b(Di\013eren)m(t)31
b(routines)h(are)g(called)e(dep)s(ending)i(on)g(the)0
775 y(dimensionalit)m(y)c(of)j(the)h(run,)g(and)f(the)h(argumen)m(t)e
(lists)h(ha)m(v)m(e)h(di\013eren)m(t)g(time-lev)m(els)d(dep)s(ending)j
(on)0 895 y(the)39 b(time-stepping)d(used.)61 b(This)39
b(results)f(in)f(a)h(m)m(ulti-branc)m(hed)f(IF)h(blo)s(c)m(k.)60
b(The)39 b(\014rst)g(test)f(is)g(for)0 1016 y(a)e(forw)m(ard)g
(timestep)g(\(IF)m(ORSTEP=1\),)h(and)f(then)h(for)f(eac)m(h)h(routine)e
(a)h(further)g(dimensionalit)m(y)0 1136 y(test)g(follo)m(ws.)49
b(A)35 b(similar)c(structure)37 b(follo)m(ws)c(for)i(the)g(cen)m
(tred-step)i(case,)g(except)f(that)f(the)g(scalar)0 1256
y(calls)42 b(can)i(no)m(w)g(still)d(b)s(e)i(forw)m(ard-step)h(if)f(IF)m
(ORSCALP=0,)j(therefore,)h(these)e(are)e(enclosed)h(in)0
1377 y(an)e(extra)h(IF)f(blo)s(c)m(k.)72 b(The)43 b(subroutines)g
(called)e(are)h Fw(UVWSR)m(CE)p Fv(,)f Fw(UVW2D)h Fv(or)g
Fw(UVW1D)p Fv(,)0 1497 y(dep)s(ending)f(on)g(dimensionalit)m(y)-8
b(,)40 b(whic)m(h)h(calculate)f(the)h(source)h(terms)f(for)f(the)h(v)m
(elo)s(cit)m(y)g(comp)s(o-)0 1617 y(nen)m(ts;)g Fw(THSOUR)m(CE)p
Fv(,)c Fw(TH2D)g Fv(or)g Fw(TH1D)p Fv(,)g(dep)s(ending)h(on)g
(dimensionalit)m(y)-8 b(,)36 b(whic)m(h)i(calculate)0
1738 y(the)e(adv)m(ection)f(and)g(di\013usiv)m(e)g(terms)g(for)g(the)g
(TH)h(v)-5 b(ariable;)35 b Fw(RADIA)-9 b(TION)p Fv(,)32
b(whic)m(h)k(calculates)0 1858 y(the)31 b(heating)f(rate)g(due)h(to)g
(radiation;)e Fw(QSOUR)m(CE)p Fv(,)h Fw(Q2D)g Fv(or)h
Fw(Q1D)p Fv(,)f(dep)s(ending)h(on)f(dimension-)0 1979
y(alit)m(y)-8 b(,)30 b(whic)m(h)i(calculates)e(the)h(adv)m(ectiv)m(e)i
(and)e(di\013usiv)m(e)g(terms)g(for)g(the)g(Q)g(v)-5
b(ariables;)30 b Fw(LA)-9 b(THEA)g(T)0 2099 y Fv(whic)m(h)41
b(calculates)g(the)g(heating,)h(cloud)f(and)g(moisture)f(incremen)m(ts)
h(due)g(to)g(condensation;)k(and)0 2219 y Fw(MICR)m(OPHYS)p
Fv(,)27 b(whic)m(h)h(calculates)f(the)i(heating,)f(moistening)e(and)i
(h)m(ydrometeor)h(source)g(terms)0 2340 y(due)k(to)f(microph)m(ysics.)0
2749 y Fp(EQUA)-11 b(TE)0 3054 y Fw(Called)50 b(b)m(y:)154
b Fv(THSOUR)m(CE,)47 b(TH2D,)d(QSOUR)m(CE,)i(Q2D,)e(DIA)m(G,)g(W)m
(OUT2D,)h(W)m(OUTPV,)0 3174 y(PWRAP)-8 b(,)44 b(TVDUVW,)g(TVDUVW2D,)e
(BCKSCT,)j(BCTSCT,)g(BCQSCT,)g(XWRAP)-8 b(,)43 b(POIS-)0
3295 y(SON,)33 b(FF)-11 b(ANAL,)32 b(FFSYNTH,)h(CB2DCALL)0
3415 y Fw(Calls:)111 b Fv(-)146 3656 y(Utilit)m(y)42
b(routine)h(whic)m(h)h(sets)g(arra)m(y)g(FLD1)e(of)h(length)g(LEN)h
(equal)f(to)h(arra)m(y)f(FLD2)f(also)h(of)0 3776 y(length)32
b(LEN.)0 4186 y Fp(EXXIT)0 4491 y Fw(Called)44 b(b)m(y:)137
b Fv(LES,)40 b(BEGIN,)g(SET1D,)g(SET)-8 b(ANEL,)41 b(SETPREF,)g
(RETRIEVE,)g(NNSTEPS,)0 4611 y(THSOUR)m(CE,)c(TH2D,)e(TH1D,)h(DIA)m(G,)
f(WR)-8 b(TNUM,)36 b(SETDIA)m(GS,)h(ALLOCDGS,)e(ALLOCSP)-8
b(,)0 4731 y(ALLOCQS,)22 b(RESDGS,)g(TIMSER,)h(INTIMSER,)g(CHKP)-8
b(ARMS,)23 b(MOSTBC,)g(NEWRETR,)g(MER-)0 4852 y(GE)p
149 4852 30 4 v 35 w(D)m(A)-8 b(T)g(A,)33 b(RAD)p 736
4852 V 34 w(INTERF)-11 b(A)m(CE)p 1345 4852 V 38 w(L)g(W,)32
b(RAD)p 1812 4852 V 35 w(INTERF)-11 b(A)m(CE)p 2422 4852
V 37 w(SW)0 4972 y Fw(Calls:)111 b Fv(DIA)m(G,)32 b(DUMP)-8
b(,)33 b(NEWDUMP)-8 b(,)34 b(MO)m(VIECNTL)146 5213 y(Con)m(trols)39
b(the)f(cessation)h(of)f(the)h(co)s(de,)h(writing)d(of)h(error)g
(messages)i(and)e(the)h(writing)e(out)h(of)0 5333 y(diagnostic)g
(\014les)h(and)h(mo)s(del)d(dumps.)64 b(The)41 b(action)d(tak)m(en)i(b)
m(y)g Fw(EXXIT)e Fv(dep)s(ends)j(on)e(the)h(v)-5 b(alue)0
5454 y(of)32 b(the)i(argumen)m(t)e(ISTOPU)i(and)f(is)f(con)m(trolled)g
(b)m(y)i(six)f(logical)d(\015ags,)j(L)p 2772 5454 V 35
w(DIA)m(G,)f(L)p 3184 5454 V 35 w(ENDCHAIN,)0 5574 y(L)p
67 5574 V 35 w(DUMP)-8 b(,)37 b(L)p 522 5574 V 35 w(ENDJOB,)g(L)p
1091 5574 V 35 w(ALLPES)h(and)f(L)p 1800 5574 V 35 w(STOP)-8
b(.)38 b(T)-8 b(able)37 b(7)f(sho)m(ws)j(the)e(v)-5 b(alues)37
b(of)f(ISTOPU,)0 5695 y(their)43 b(meanings)g(and)h(actions.)77
b(Firstly)-8 b(,)45 b(the)f(message)g(\014le)g(is)f(op)s(ened)h(and)g
(then)h(the)f(v)-5 b(alue)43 b(of)0 5815 y(ISTOPU)37
b(is)e(tested)i(in)e(an)h(IF-ELSEIF)f(blo)s(c)m(k.)53
b(Information)34 b(is)h(written)h(to)f(the)h(message)g(\014le,)h(if)
1841 6107 y(63)p eop
%%Page: 64 67
64 66 bop 0 52 a Fv(necessary)-8 b(,)30 b(and)d(the)g(\015ags)g(raised)
g(as)g(appropriate.)40 b(The)28 b(actions)e(for)h(ISTOPU=-4)g(are)g
(dep)s(enden)m(t)0 173 y(on)32 b(the)h(con)m(ten)m(ts)i(of)d(the)h
(message)g(\014le)f(as)h(that)f(option)g(c)m(hec)m(ks)j(for)d(a)g(man)m
(ual)f(stop.)146 414 y(After)44 b(the)f(ISTOPU)h(test)g(actions)f(are)g
(carried)g(out)g(as)g(appropriate)f(for)h(the)g(logical)d(\015ags.)0
534 y(L)p 67 534 30 4 v 35 w(ALLPES)i(indicates)e(a)h(failure)e(on)i(a)
g(single)f(PE,)h(in)g(whic)m(h)g(case)h(GC)p 2825 534
V 35 w(ABOR)-8 b(T,)41 b(whic)m(h)h(stops)0 654 y(all)g(PEs,)47
b(has)d(to)g(b)s(e)g(called.)75 b(L)p 1265 654 V 35 w(DIA)m(G)44
b(indicates)f(that)g(a)g(diagnostic)g(dump)g(is)g(to)h(b)s(e)g(written)
0 775 y(b)m(y)d(a)e(call)g(to)g Fw(DIA)m(G)p Fv(.)g(The)i(name)f(of)f
(the)i(diagnostic)d(\014le)i(is)f(constructed,)k(and)e(the)f
(diagnostic)0 895 y(\014le)d(n)m(um)m(b)s(er,)i(NDGFILE,)d(incremen)m
(ted.)58 b(L)p 1733 895 V 35 w(ENDJOB)37 b(indicates)g(the)h(end)f(of)g
(a)g(job)g(of)g(a)g(c)m(hain)0 1016 y(run,)30 b(and)e(L)p
455 1016 V 35 w(ENDCHAIN)i(the)f(end)g(of)f(the)h(c)m(hain.)42
b(In)28 b(b)s(oth)h(cases,)h(information)c(is)i(written)g(to)g(the)0
1136 y(message)d(\014le)f(and)h Fw(MO)m(VIECNTL)f Fv(called)f(if)h
(animation)e(diagnostics)h(are)i(required.)41 b(If)25
b(L)p 3447 1136 V 35 w(DUMP)0 1256 y(is)30 b(true)g(then)h(a)f(mo)s
(del)e(dump)i(is)g(written)g(out)g(b)m(y)h(a)f(call)e(to)i
Fw(DUMP)g Fv(or)g Fw(NEWDUMP)p Fv(.)f(Finally)-8 b(,)0
1377 y(L)p 67 1377 V 35 w(STOP)g(,)33 b(L)p 481 1377
V 36 w(ENDCHAIN)g(or)f(L)p 1268 1377 V 35 w(ENDJOB)h(execute)h(the)f
(STOP)h(statemen)m(t.)0 1786 y Fp(FF)-15 b(ANAL)0 2091
y Fw(Called)36 b(b)m(y:)113 b Fv(POISSON)0 2211 y Fw(Calls:)e
Fv(EQUA)-8 b(TE,)34 b(TRANSPOSE,)g(F)m(OURIER,)f(RECOMBINE)146
2452 y(P)m(erforms)h(a)g(F)-8 b(ourier)33 b(transform)g(on)h(the)g
(pressure)i(source)f(term.)47 b(The)35 b(pressure)h(source)f(term)0
2573 y(is)42 b(passed)h(in)f(as)g(P)-8 b(,)43 b(and)f(the)h(F)-8
b(ourier)41 b(transformed)h(data)g(is)f(passed)j(out)e(as)g(PT.)i(The)f
(F)-8 b(ourier)0 2693 y(transform)37 b(is)g(carried)g(out)g(b)m(y)i
(either)e(the)h(mac)m(hine-sp)s(eci\014c)g(fast)f(F)-8
b(ourier)37 b(T)-8 b(ransform)37 b(\(\013t\))g(rou-)0
2813 y(tine)d(SCFFT)g(for)g(the)g(t3e,)h(or)e(the)i(generic)f(routine)f
Fw(F)m(OURIER)p Fv(,)g(in)h(the)g(p)s(ortable)f(mo)s(del.)47
b(The)0 2934 y(trigonometric)34 b(tables)i(are)h(required)g(for)e(the)i
(SCFFT)g(routine)f(whic)m(h)h(are)f(calculated)g(b)m(y)h(a)g(pre-)0
3054 y(liminary)29 b(call)i(to)i(SCFFT)f(with)h(dumm)m(y)f(data.)146
3295 y(Di\013eren)m(t)c(pro)s(cedures)h(are)f(required)g(to)g(cop)s(e)g
(with)f(the)i(di\013eren)m(t)f(distribution)e(of)h(data)h(in)f(2-D)0
3415 y(and)41 b(3-D.)e(F)-8 b(or)40 b(b)s(oth)g(cases)i(all)d(data)h
(in)f(the)i(direction)f(of)g(the)h(\013t)f(is)g(required)h(on)g(a)f
(single)g(PE.)0 3536 y(F)-8 b(or)33 b(the)i(2-D)e(case)i(only)e(a)h
Fn(y)t Fv(-direction)e(transform)h(is)g(needed,)k(but)d(it)f(in)g(this)
h(direction)f(that)h(the)0 3656 y(data)h(is)f(partitioned.)50
b(The)36 b(whole)f(pressure)i(source)g(data)d(is)h(brough)m(t)g
(together)h(in)e(PT)i(b)m(y)g(a)f(call)0 3776 y(to)c
Fw(RECOMBINE)p Fv(;)e(if)h(it)g(is)h(a)g(single)f(PE)h(run)h(then)g
Fw(EQUA)-9 b(TE)29 b Fv(is)i(used.)44 b(The)32 b(data)f(in)f(PT)i(has)0
3897 y(to)k(b)s(e)h(o\013set)f(so)h(that)f(the)h(it)e(starts)i(at)f(p)s
(osition)f(zero)i(and)f(then)h(the)g(\013t)f(can)h(b)s(e)f(called)g
(for)g(eac)m(h)0 4017 y(mo)s(del)31 b(lev)m(el.)43 b(The)34
b(routine)e(is)g(then)h(\014nished)g(for)f(the)h(2-D)e(case.)146
4258 y(The)24 b(3-D)e(case)i(is)f(more)g(complicated)e(as)i(\013ts)h
(need)g(to)f(b)s(e)g(p)s(erformed)g(in)f(the)i Fn(x)f
Fv(and)h Fn(y)i Fv(directions.)0 4378 y(As)35 b(the)g(data)f(is)g
(distributed)g(in)g(the)h Fn(x)g Fv(direction)e(nothing)h(sp)s(ecial)g
(needs)i(to)e(b)s(e)h(done)g(for)f(the)h(\013t)0 4499
y(in)k(the)i Fn(y)i Fv(direction)c(apart)h(from)e(an)i(o\013set)h(to)e
(the)i(data.)66 b(T)-8 b(o)40 b(do)g(the)g Fn(x)h Fv(direction)e(\013t)
g(the)i(data)0 4619 y(has)31 b(to)g(b)s(e)g(transp)s(osed)h(so)f(that)f
(the)i(data)e(is)h(no)m(w)g(distributed)f(in)h(the)g
Fn(y)j Fv(direction.)42 b(This)31 b(in)m(v)m(olv)m(es)0
4739 y(sw)m(apping)41 b(the)g Fn(x)g Fv(and)g Fn(y)i
Fv(directions)d(in)g(mo)m(ving)f(the)i(data)f(from)g(P)h(to)f(PT.)h
(The)h(algorithm)37 b(for)0 4860 y(doing)f(this)h(is)g(as)h(follo)m
(ws.)57 b(A)37 b(lo)s(op)f(is)h(conducted)i(o)m(v)m(er)f(the)g(n)m(um)m
(b)s(er)g(of)f(PEs)i(with)e(coun)m(ter)h(NP)-8 b(.)0
4980 y(F)g(or)29 b(eac)m(h)i(NP)f(a)f(data)h(pac)m(k)m(et,)i(P)-8
b(A)m(CKET,)31 b(starting)e(at)h(NP*JJPEP)-8 b(,)31 b(is)e(set)i(up.)42
b(The)31 b(data)f(within)0 5101 y(P)-8 b(A)m(CKET)35
b(is)d(lo)s(cally)f(transp)s(osed)j(b)m(y)g(a)e(call)g(to)g
Fw(TRANSPOSE)p Fv(.)g(Then,)j(the)e(P)-8 b(A)m(CKET)35
b(is)d(sen)m(t)0 5221 y(to)40 b(PE)h(NP)-8 b(.)41 b(If)f(the)g(data)g
(is)g(lo)s(cal)e(to)i(the)h(PE)g(the)f(data)g(is)g(assigned)g(straigh)m
(t)g(to)g(PT)h(after)f(the)0 5341 y Fw(TRANSPOSE)k Fv(call.)79
b(There)47 b(is)d(then)i(a)f(second)h(lo)s(op)e(o)m(v)m(er)i(the)g(n)m
(um)m(b)s(er)g(of)e(PES)i(with)f(NP)0 5462 y(as)40 b(lo)s(op)e(coun)m
(ter)i(and)g(this)f(time)f(the)i(purp)s(ose)g(is)f(to)h(receiv)m(e)g
(the)g(data)f(pac)m(k)m(ets.)67 b(The)40 b(starting)0
5582 y(p)s(osition)29 b(in)h(the)i Fn(x)f Fv(direction,)g(IST)-8
b(AR)g(T,)32 b(is)e(de\014ned)j(b)m(y)e(NP*I)s(IPEP)i(and)e(the)g
(receiv)m(ed)i(P)-8 b(A)m(CKET)0 5702 y(is)27 b(assigned)g(to)g(PT.)h
(In)g(b)s(oth)f(lo)s(ops)f(extra)i(data)f(needs)i(to)e(b)s(e)g
(assigned)h(to)f(accoun)m(t)h(for)e(the)i(halo)s(es.)0
5823 y(Finally)-8 b(,)31 b(the)j(data)f(is)g(o\013set)h(in)f(the)h
Fn(x)p Fv(-direction)e(for)h(the)h(call)e(to)h(SCFFT)h(or)g
Fw(F)m(OURIER)p Fv(.)e(After)1841 6107 y(64)p eop
%%Page: 65 68
65 67 bop 0 52 a Fv(these)34 b(calls,)d(the)i(3-D)f(pressure)i(source)g
(has)f(b)s(een)g(F)-8 b(ourier)31 b(transformed)h(and)h(placed)g(in)e
(PT.)0 462 y Fp(FFSYNTH)0 767 y Fw(Called)36 b(b)m(y:)113
b Fv(POISSON)0 887 y Fw(Calls:)e Fv(EQUA)-8 b(TE,)34
b(TRANSPOSE,)g(DISTRIB,)f(F)m(OURIER)146 1128 y(P)m(erforms)25
b(an)g(in)m(v)m(erse)i(F)-8 b(ourier)24 b(transform)g(on)g(the)i
(pressure)h(\014eld)d(in)h(w)m(a)m(v)m(espace.)44 b(The)26
b(pressure)0 1248 y(\014eld)k(in)g(w)m(a)m(v)m(espace)k(is)c(passed)i
(in)d(as)i(PT,)h(and)e(the)h(real)f(space)h(pressure)i(\014eld)d(is)g
(passed)i(out)e(as)h(P)-8 b(.)0 1369 y(The)24 b(in)m(v)m(erse)g(F)-8
b(ourier)22 b(transform)g(is)h(carried)f(out)h(b)m(y)h(the)g(mac)m
(hine-sp)s(eci\014c)e(fast)h(F)-8 b(ourier)22 b(T)-8
b(ransform)0 1489 y(\(\013t\))47 b(routine)g(CSFFT)h(for)g(the)g(t3e,)j
(or)d(the)g(generic)f(routine)h Fw(F)m(OURIER)e Fv(for)h(the)i(p)s
(ortable)0 1609 y(mo)s(del.)g(T)-8 b(rigonometric)32
b(tables)j(are)f(required)i(for)e(the)h(CSFFT)g(routines)g(and)g(are)g
(calculated)f(b)m(y)0 1730 y(a)e(preliminary)e(call)h(to)h(CSFFT)h
(with)f(dumm)m(y)h(data.)146 1971 y(Di\013eren)m(t)28
b(pro)s(cedures)h(are)f(required)g(to)g(cop)s(e)g(with)f(the)i
(di\013eren)m(t)f(distribution)e(of)h(data)h(in)f(2-D)0
2091 y(and)k(3-D.)e(F)-8 b(or)30 b(the)h(2-D)e(case)j(the)f(whole)f
(domain)f(w)m(a)m(v)m(espace)k(pressure)g(\014eld)d(is)g(con)m(tained)h
(in)f(PT.)0 2211 y(The)i(\013t)e(is)h(p)s(erformed)f(on)h(eac)m(h)h(v)m
(ertical)e(lev)m(el,)h(and)f(then)i(the)f(data)g(in)f(PT)h(is)g
(o\013set)g(bac)m(k)h(so)f(that)0 2332 y(the)j(data)f(b)s(egins)g(at)g
(p)s(osition)f(1)h(in)g(the)h(arra)m(y)-8 b(.)46 b(PT)35
b(no)m(w)f(con)m(tains)f(the)h(real)f(space)h(pressure)i(\014eld)0
2452 y(and)g(this)g(is)g(redistributed)f(across)i(the)g(PEs)g(in)m(to)e
(P)i(using)f(the)g(routine)g Fw(DISTRIB)e Fv(if)h(an)h(MPP)0
2573 y(run,)i(or)e(else)h(P)g(is)f(assigned)g(to)h(PT)g(b)m(y)g(an)g
Fw(EQUA)-9 b(TE)35 b Fv(call.)53 b(The)38 b(routine)e(is)g(then)h
(\014nished)g(for)0 2693 y(the)c(2-D)e(case.)146 2934
y(The)38 b(3-D)e(case)i(is)f(more)f(complicated)g(as)h(in)m(v)m(erse)i
(\013ts)e(need)h(to)f(b)s(e)g(p)s(erformed)g(in)f(the)i
Fn(x)f Fv(and)0 3054 y Fn(y)f Fv(directions.)42 b(As)33
b(the)g(data)f(in)g(PT)h(is)f(distributed)g(in)g(the)h
Fn(y)i Fv(direction)d(nothing)f(sp)s(ecial)h(needs)i(to)0
3174 y(b)s(e)e(done)h(for)e(the)i(\013t)f(in)f(the)i
Fn(x)f Fv(direction.)42 b(CSFFT)33 b(or)e Fw(F)m(OURIER)h
Fv(is)f(called)g(o)m(v)m(er)i(all)d(lev)m(els)i(and)0
3295 y(slices)d(and)g(data)g(in)f(PT)i(o\013set)g(to)f(return)g(to)g
(the)h(real)e(space)i(p)s(ositions.)41 b(T)-8 b(o)30
b(do)f(the)g Fn(y)k Fv(direction)28 b(\013t)0 3415 y(the)i(data)f(has)g
(to)g(b)s(e)h(transp)s(osed)g(so)f(that)g(the)h(data)f(is)g(no)m(w)g
(distributed)g(in)g(the)g Fn(x)h Fv(direction.)41 b(This)0
3536 y(in)m(v)m(olv)m(es)28 b(sw)m(apping)g(the)g Fn(x)g
Fv(and)f Fn(y)k Fv(directions)c(in)g(mo)m(ving)f(the)i(data)f(from)f
(PT)i(to)f(P)-8 b(.)28 b(The)h(algorithm)0 3656 y(for)39
b(doing)g(this)g(is)h(as)g(follo)m(ws.)63 b(A)40 b(lo)s(op)e(is)i
(conducted)h(o)m(v)m(er)g(the)f(n)m(um)m(b)s(er)g(of)f(PEs)i(with)e
(coun)m(ter)0 3776 y(NP)-8 b(.)39 b(F)-8 b(or)37 b(eac)m(h)j(NP)e(a)g
(data)g(pac)m(k)m(et,)k(P)-8 b(A)m(CKET,)40 b(starting)e(at)g(NP*I)s
(IPEP)-8 b(,)39 b(is)f(set)h(up.)62 b(The)39 b(data)0
3897 y(within)32 b(P)-8 b(A)m(CKET)35 b(is)d(lo)s(cally)e(transp)s
(osed)k(b)m(y)g(a)f(call)e(to)h Fw(TRANSPOSE)p Fv(.)g(Then,)i(the)g(P)
-8 b(A)m(CKET)0 4017 y(is)36 b(sen)m(t)i(to)e(PE)i(NP)-8
b(.)37 b(If)g(the)g(data)f(is)g(lo)s(cal)f(to)h(the)h(PE)h(the)f(data)f
(is)g(assigned)h(straigh)m(t)f(to)h(P)g(after)0 4138
y(the)e Fw(TRANSPOSE)e Fv(call.)48 b(There)36 b(is)e(then)h(a)f(second)
i(lo)s(op)d(o)m(v)m(er)i(the)g(n)m(um)m(b)s(er)g(of)f(PES)i(with)e(NP)0
4258 y(as)40 b(lo)s(op)e(coun)m(ter)i(and)g(this)f(time)f(the)i(purp)s
(ose)g(is)f(to)h(receiv)m(e)g(the)g(data)f(pac)m(k)m(ets.)67
b(The)40 b(starting)0 4378 y(p)s(osition)26 b(in)i(the)g
Fn(y)j Fv(direction,)d(JST)-8 b(AR)g(T,)29 b(is)f(de\014ned)h(b)m(y)g
(NP*JJPEP)h(and)e(the)g(receiv)m(ed)i(P)-8 b(A)m(CKET)0
4499 y(is)31 b(assigned)i(to)e(P)-8 b(.)32 b(In)h(b)s(oth)e(lo)s(ops)g
(extra)h(data)g(needs)h(to)f(b)s(e)g(assigned)g(to)g(accoun)m(t)g(for)g
(the)g(halo)s(es.)0 4619 y(The)42 b(data)e(can)i(then)f(b)s(e)g(F)-8
b(ourier)40 b(transformed)h(in)f(the)h Fn(y)t Fv(-direction)e(b)m(y)i
(the)h(call)d(to)i(CSFFT)g(or)0 4739 y Fw(F)m(OURIER)p
Fv(.)35 b(Finally)-8 b(,)35 b(the)i(data)e(is)h(o\013set)h(so)f(that)g
(it)f(b)s(egins)h(at)g(p)s(osition)f(1.)54 b(No)m(w,)38
b(P)e(con)m(tains)0 4860 y(the)d(pressure)h(\014eld)f(for)f(the)h(mo)s
(del.)0 5269 y Fp(F)l(ORINTER)0 5574 y Fw(Called)j(b)m(y:)113
b Fv(SETLS)0 5695 y Fw(Calls:)e Fv(-)1841 6107 y(65)p
eop
%%Page: 66 69
66 68 bop 146 52 a Fv(In)m(terp)s(olates)25 b(the)g(input)g
(large-scale)e(forcing)h(arra)m(ys)h(on)m(to)g(the)g(mo)s(del)e(grid.)
40 b(The)25 b(input)g(forcing)0 173 y(is)41 b(SLS)p 282
173 30 4 v 35 w(READ,)g(whic)m(h)h(is)e(on)h(grid)f(F)m(ORLEVS,)h(and)h
(the)f(output)g(forcing)f(is)h(SLS)p 3259 173 V 35 w(TV,)h(on)f(the)0
293 y(mo)s(del)33 b(grid.)48 b(Initially)-8 b(,)31 b(F)m(ORLEVS)k(is)f
(examined)g(to)g(c)m(hec)m(k)j(whether)e(is)f(is)g(a)g(pressure)j
(\014eld)d(\(top)0 414 y(v)-5 b(alues)43 b(less)g(than)g(b)s(ottom)f(v)
-5 b(alues\))42 b(or)h(a)g(heigh)m(t)f(\014eld.)75 b(If)43
b(it)e(is)i(the)g(former)f(then)i(the)f(v)m(ertical)0
534 y(in)m(terp)s(olation)25 b(is)i(carried)g(out)g(against)f(the)i(mo)
s(del)e(pressure,)k(PREFN;)e(if)e(it)h(is)g(the)h(latter)e(then)i(the)0
654 y(v)m(ertical)j(in)m(terp)s(olation)e(is)i(carried)g(out)g(against)
g(the)h(mo)s(del)d(heigh)m(t)j(\014eld,)f(ZN.)h(The)g(in)m(terp)s
(olation)0 775 y(algorithm)37 b(is)j(straigh)m(tforw)m(ard,)i(with)e
(SCTMP)i(b)s(eing)e(used)h(to)f(reduce)i(rep)s(eated)f(calculations.)0
895 y(F)-8 b(or)34 b(mo)s(del)f(lev)m(els)i(outside)g(of)f(the)h(F)m
(ORLEVS)g(range)g(the)g(v)-5 b(alues)34 b(of)h(SLS)p
2871 895 V 35 w(TV)g(are)g(extrap)s(olated)0 1016 y(b)m(y)e(assuming)f
(that)h(the)g(lo)s(cal)d(gradien)m(t)i(in)g(forcing)f(near)i(the)g
(range)g(limit)c(remains)i(constan)m(t.)0 1425 y Fp(GETRAN)0
1730 y Fw(Called)36 b(b)m(y:)113 b Fv(BCKSCT,)34 b(BCTSCT,)h(BCQSCT)0
1850 y Fw(Calls:)111 b Fv(WRAP)146 2091 y(Utilit)m(y)28
b(routine)g(whic)m(h)i(calculates)f(the)h(Bac)m(kscatter)h(v)m(ector,)g
Fn(\036)p 2514 2124 58 4 v Fv(.)42 b(P)m(assed)31 b(in)m(to)e(the)h
(routine)e(are)0 2211 y(the)34 b(bac)m(kscattered)i(energies)e(on)g
(the)g(I-1,)f(I)h(and)g(I+1)g(slices,)f(BCM,)i(BC)f(and)g(BCP)g(resp)s
(ectiv)m(ely)-8 b(,)0 2332 y(and)31 b(iden)m(ti\014ers)h(for)f(the)g(v)
m(ector)i(p)s(oten)m(tial,)d(ICOMP)i(and)g(IFIELD.)f(ICOMP)h(iden)m
(ti\014es)g(the)g(com-)0 2452 y(p)s(onen)m(t)d(and)f(IFIELD)g(the)h(mo)
s(del)d(\014eld.)42 b(T)-8 b(o)28 b(a)m(v)m(oid)g(rep)s(eating)g(an)m
(y)h(calculations,)e Fn(\036)p 3121 2485 V 28 w Fv(calculated)g(for)0
2573 y(the)32 b(previous)g(slices)g(are)f(held)h(in)f(VPOT.)h(This)g
(arra)m(y)g(has)g(\014v)m(e)h(dimensions)d(corresp)s(onding)i(to)f(J,)0
2693 y(K,)37 b(ICOMP)-8 b(,)38 b(IFIELD)e(and)h(\014nally)-8
b(,)37 b(the)g(slice,)h(1)e(or)h(2.)56 b(2)36 b(indicates)g(the)i(I-1)e
(slice,)h(1)g(the)g(I)g(slice.)0 2813 y(ARRA)-8 b(Y)32
b(is)g(the)h(output)g(v)m(ector,)h Fn(\036)p 1293 2846
V Fv(.)146 3054 y(F)-8 b(or)28 b(the)g(\014rst)h(slice,)g(VPOT)g(is)e
(calculated)h(for)g(I-1)f(and)i(I.)f(Both)g(BCM)h(and)g(BC)f(are)h(m)m
(ultiplied)0 3174 y(b)m(y)41 b(the)g(random)f(n)m(um)m(b)s(er)h(v)m
(ector,)i(FX,)e(with)f(o\013sets)h(de\014ned)h(in)e(arra)m(y)g(IS.)h
(These)h(randomised)0 3295 y(BCM)37 b(and)e(BC)i(are)e(then)i(a)m(v)m
(eraged)g(and)e(assigned)h(to)g(VPOT.)g(These)i(a)m(v)m(erages)f(are)f
(necessarily)0 3415 y(less)g(complex)f(near)h(the)g(mo)s(del)e(top)h
(and)h(b)s(ottom)e(and)i(sp)s(ecial)f(cases)i(are)e(co)s(ded)h(to)g
(accoun)m(t)g(for)0 3536 y(these.)42 b(F)-8 b(or)24 b(the)i
Fn(z)j Fv(comp)s(onen)m(t)c(of)g(the)g(v)m(elo)s(cit)m(y)g(v)m(ector)h
(\(IFIELD=1,)g(ICOMP=3\))g(the)f(KKP)g(v)-5 b(alue)0
3656 y(is)34 b(zero.)48 b(The)36 b(I+1)d(v)m(ector)j(is)d(then)i
(calculated)f(for)f(all)f(slices)i(in)g(the)g(same)g(w)m(a)m(y)-8
b(,)36 b(and)e(assigned)h(to)0 3776 y(TMPPOT.)43 b(The)g(\014nal)e(v)m
(ector,)k(ARRA)-8 b(Y,)41 b(is)g(calculated)g(b)m(y)h(p)s(erforming)d
(a)j(1:2:1)f(\014lter)g(on)g(the)0 3897 y(I-1,)31 b(I)h(and)g(I+1)g
(slice)f(v)-5 b(alues)31 b(and)h(halo)s(es)f(determined)h(b)m(y)g(a)g
(call)e(to)h Fw(WRAP)p Fv(.)f(Finally)-8 b(,)29 b(VPOT)k(is)0
4017 y(stored)j(for)e(the)i(calculation)c(of)j(the)h(next)g(slice)e(b)m
(y)i(assigning)e(VPOT\(,,,,1\))i(to)e(VPOT\(,,,,2\))i(and)0
4138 y(TMPPOT)e(to)f(VPOT\(,,,,1\).)0 4547 y Fp(GR)l(OUPDGS)0
4852 y Fw(Called)j(b)m(y:)113 b Fv(NNSTEPS)0 4972 y Fw(Calls:)e
Fv(-)146 5213 y(Sums)34 b(the)f(diagnostic)f(pro\014les)h(o)m(v)m(er)h
(all)d(PEs.)46 b(DGNEW)33 b(is)g(summed)f(o)m(v)m(er)j(all)c(PEs)j(b)m
(y)g(using)0 5333 y(GC)p 153 5333 30 4 v 35 w(RSUMR.)h(If)f(the)h(size)
f(of)g(DGNEW)g(falls)e(b)s(elo)m(w)i(the)h(maxim)m(um)d(for)i(a)g
(collection)e(op)s(eration)0 5454 y(\(MAX)m(COLL\),)38
b(then)f(this)f(is)g(done)h(b)m(y)h(one)f(call,)f(if)f(not,)j(separate)
f(GC)p 2775 5454 V 35 w(RSUMR)g(calls)f(are)g(used)0
5574 y(for)k(eac)m(h)i(diagnostic.)66 b(DGSPNEW)41 b(is)f(also)g
(summated,)i(along)e(with)g(the)h(terms)g(for)f(the)h(TKE)0
5695 y(budget)31 b(\(SUVWS)g(common)d(blo)s(c)m(k\).)43
b(Finally)-8 b(,)28 b(diagnostics)h(whic)m(h)i(require)f(the)h(domain)d
(a)m(v)m(erages)0 5815 y(are)36 b(calculated,)g(including)e(the)j(TKE)f
(tendency)-8 b(,)39 b(and)d(resolv)m(ed)h(and)g(subgrid)e(shear)i(pro)s
(duction)1841 6107 y(66)p eop
%%Page: 67 70
67 69 bop 0 52 a Fv(terms.)0 462 y Fp(INDGA)-15 b(V)0
767 y Fw(Called)36 b(b)m(y:)113 b Fv(ST)-8 b(AR)g(T,)33
b(RETRIEVE,)h(NEWRETR)0 887 y Fw(Calls:)111 b Fv(-)146
1128 y(Initialises)49 b(the)j(time-a)m(v)m(eraged)f(diagnostics)f(and)h
(sp)s(ectra.)101 b(The)52 b(running)f(a)m(v)m(erage)h(time,)0
1248 y(TIMEA)-11 b(V,)44 b(is)e(set)h(to)e(zero,)k(the)e(start)f(of)g
(the)h(a)m(v)m(eraging)e(p)s(erio)s(d,)j(OLDTIM,)f(is)e(set)i(to)f
(TIME,)0 1369 y(and)33 b(DGA)-11 b(V)32 b(and)g(DGSP)g(are)h(set)g(to)g
(zero.)0 1778 y Fp(INDGNEW)0 2083 y Fw(Called)j(b)m(y:)113
b Fv(BEGIN,)33 b(NNSTEPS)0 2203 y Fw(Calls:)111 b Fv(-)146
2444 y(Initialises)44 b(DGNEW)i(and)h(DGA)-11 b(V)46
b(used)h(in)f(the)g(time-a)m(v)m(eraged)g(diagnostics)f(and)i(sp)s
(ectra)0 2565 y(calculations.)42 b(Both)32 b(are)h(set)g(equal)f(to)h
(zero,)g(along)e(with)h(the)h(comp)s(onen)m(ts)g(of)f(the)h(TKE)g
(budget.)0 2974 y Fp(INITCFL)0 3279 y Fw(Called)j(b)m(y:)113
b Fv(ST)-8 b(AR)g(T,)33 b(NNSTEPS)0 3399 y Fw(Calls:)111
b Fv(-)146 3640 y(Initialises)50 b(v)-5 b(ariables)51
b(for)g(the)h(Couran)m(t)g(n)m(um)m(b)s(er)h(calculation.)99
b(CVIS,)53 b(CVEL,)f(CVELX,)0 3760 y(CVEL)-8 b(Y)33 b(and)g(CVELZ)g
(are)g(all)d(set)j(equal)g(to)f(zero.)0 4170 y Fp(INTERPIN)0
4475 y Fw(Called)k(b)m(y:)113 b Fv(SET1D)0 4595 y Fw(Calls:)e
Fv(-)146 4836 y(In)m(terp)s(olates)41 b(a)f(giv)m(en)h(set)h(of)e
(heigh)m(ts)h(and)f(v)-5 b(alues)41 b(on)m(to)g(the)g(mo)s(del)e(v)m
(ertical)h(grid.)66 b(This)41 b(is)0 4956 y(used)35 b(for)f
(calculating)e(the)i(mo)s(del)f(initial)d(pro\014les.)49
b(Arra)m(ys)35 b(of)f(the)g(heigh)m(ts,)h(ZNGD,)e(and)h(v)-5
b(alues,)0 5077 y(INITGD,)27 b(are)g(passed)i(in)m(to)d(the)h(routine.)
41 b(By)28 b(using)f(simple)e(linear)h(in)m(terp)s(olation)e(with)j
(the)g(mo)s(del)0 5197 y(v)m(ertical)32 b(grid,)f(ZN,)i(the)g(\014nal)f
(initial)c(pro\014le,)33 b(FINIT,)g(is)f(determined.)1841
6107 y(67)p eop
%%Page: 68 71
68 70 bop 0 52 a Fp(INTIMSER)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(SET1D)0 478 y Fw(Calls:)e Fv(ALLOCA)-8 b(TE,)34
b(EXXIT)146 719 y(Initialises)f(the)j(timeseries)e(arra)m(ys)i(and)g
(indices.)51 b(Firstly)-8 b(,)34 b(the)i(timeseries)e(arra)m(y)-8
b(,)36 b(SER,)g(is)f(set)0 839 y(equal)d(to)f(zero)h(if)f(IST)-8
b(AR)g(T=1)32 b(\(i.e.)f(a)g(setup)i(run\).)44 b(Then)32
b(space)h(is)f(allo)s(cated)d(in)i(SER)h(for)f(eac)m(h)i(of)0
959 y(the)d(timeseries)f(diagnostics)f(describ)s(ed)i(b)m(y)h(the)f
(NTS)p 2038 959 30 4 v 65 w(in)m(tegers)g(in)f(common)f(blo)s(c)m(k)h
(SERIES.)i(The)0 1080 y(v)-5 b(alues)23 b(are)g(allo)s(cated)f(b)m(y)i
(calls)e(to)g Fw(ALLOCA)-9 b(TE)23 b Fv(and)g(the)h(diagnostic)e(names)
h(assigned)g(to)g(CHTS.)0 1200 y(NEXT)32 b(holds)f(the)g(v)-5
b(alue)30 b(of)h(the)g(arra)m(y)g(index)h(as)f(it)f(is)g(incremen)m
(ted)i(in)e(eac)m(h)i Fw(ALLOCA)-9 b(TE)30 b Fv(call.)146
1441 y(The)24 b Fw(EXXIT)d Fv(call)g(is)i(for)f(an)h(allo)s(cation)c
(error)j(\(ISTOPU=9\))i(due)f(to)g(the)g(n)m(um)m(b)s(er)g(of)f(allo)s
(cated)0 1561 y(diagnostics)32 b(exceeding)h(NSRP)-8
b(.)0 1971 y Fp(LA)d(TENTDG)0 2276 y Fw(Called)36 b(b)m(y:)113
b Fv(MICR)m(O)m(X)0 2396 y Fw(Calls:)e Fv(-)146 2637
y(Calculates)31 b(the)h(microph)m(ysics)g(tendency)i(and)d(pro)s(cess)i
(rate)f(diagnostics.)42 b(The)32 b(microph)m(ysics)0
2757 y(tendency)f(terms)e(\(DQV)f(etc\))i(and)f(the)g(pro)s(cess)h
(rate)f(\(PGDEP)g(etc\))g(are)g(passed)i(in)m(to)d(the)h(routine)0
2878 y(from)c Fw(MICR)m(O)m(X)p Fv(.)g(The)i(tendency)i(terms)d(are)g
(added)h(to)e(the)i(arra)m(ys)g(DQ)p 2775 2878 V 34 w(DT)f(and)g(DTH)p
3381 2878 V 36 w(DT)g(from)0 2998 y(common)41 b(blo)s(c)m(k)h(DGSTORE)g
(\(these)i(ha)m(v)m(e)g(b)s(een)f(partially)d(calculated)h(in)h
Fw(LA)-9 b(THEA)g(T)p Fv(\).)41 b(The)0 3118 y(pro)s(cess)32
b(rates)e(are)h(assigned)f(to)g(PR)m(OCRA)-8 b(TE.)32
b(The)f(index)g(for)f(eac)m(h)h(pro)s(cess)g(rate)g(is)f(determined)0
3239 y(b)m(y)j(comparing)e(the)i(pro)s(cess)h(rate)f(name)f(with)g(the)
h(diagnostic)e(name,)h(PR)m(OCCHAR.)0 3648 y Fp(LA)-11
b(THEA)g(T)0 3953 y Fw(Called)36 b(b)m(y:)113 b Fv(D)m(YNVIS)0
4074 y Fw(Calls:)e Fv(-)146 4314 y(Calculates)30 b(the)g(condensation)g
(of)f(v)-5 b(ap)s(our)29 b(to)h(liquid)e(cloud.)42 b(The)30
b(routine)g(w)m(orks)h(b)m(y)f(calculat-)0 4435 y(ing)35
b(a)g(new)i(liquid)d(w)m(ater)j(mixing)c(ratio)h(using)i(a)f(T)-8
b(a)m(ylor)36 b(Expansion)g(for)g(the)g(saturation)f(mixing)0
4555 y(ratio.)40 b(Lo)s(oping)24 b(o)m(v)m(er)j(all)d(p)s(oin)m(ts)h
(on)h(the)g(slice)f(initial)d(v)-5 b(alues)26 b(of)f(p)s(oten)m(tial)f
(temp)s(erature,)k(THOLD,)0 4675 y(w)m(ater)40 b(v)-5
b(ap)s(our)39 b(mixing)e(ratio,)i(QV)m(OLD,)g(liquid)e(w)m(ater)j
(mixing)d(ratio,)j(QLOLD,)e(are)h(set,)j(along)0 4796
y(with)27 b(the)h(temp)s(erature)f(ab)s(out)g(whic)m(h)g(the)h(T)-8
b(a)m(ylor)27 b(series)h(is)f(expanded,)j(TBASE.)f(TBASE)f(is)f(then)0
4916 y(used)h(to)f(calculate)g(the)g(saturation)g(mixing)e(ratio)g(and)
j(other)f(related)g(expressions)i(whic)m(h)f(are)f(used)0
5037 y(in)35 b(the)h(T)-8 b(a)m(ylor)35 b(series)h(expansion,)h(QSA)-8
b(TPW,)37 b(DQSA)-8 b(TDTPW)36 b(and)g(QSA)-8 b(TF)d(A)m(CPW.)37
b(The)g(new)0 5157 y(liquid)25 b(w)m(ater)j(mixing)d(ratio)g(is)i(then)
h(calculated)e(as)h(QLNEW,)h(and)f(the)g(tendency)i(term,)f(DQLDT,)0
5277 y(diagnosed)i(as)g(QLNEW-QLOLD)f(divided)h(b)m(y)h(the)f
(timestep.)42 b(A)31 b(p)s(ositivit)m(y)d(c)m(hec)m(k)k(is)e(carried)g
(out)0 5398 y(and)h(then)g(the)g(tendency)i(terms,)e(STH,)h(SQ\(IQV\))f
(and)f(SQ\(IQL\))h(are)g(incremen)m(ted)g(as)g(appropri-)0
5518 y(ate.)48 b(Finally)-8 b(,)32 b(the)j(microph)m(ysics)f(tendency)j
(diagnostics,)c(DTH)p 2474 5518 V 36 w(DT)h(and)g(DQ)p
3031 5518 V 35 w(DT,)g(are)g(up)s(dated)0 5638 y(as)f(appropriate.)1841
6107 y(68)p eop
%%Page: 69 72
69 71 bop 0 52 a Fp(LOOK)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(LO)m(WERBC)0 478 y Fw(Calls:)e Fv(-)146 719 y(Uses)44
b(the)f(lo)s(ok-up)f(table)g(to)g(determine)g(a)h(v)-5
b(alue)42 b(for)g Fn(u)2340 734 y Fi(\003)2422 719 y
Fv(\(USTR\))h(for)f(a)g(giv)m(en)h(input)f(near)0 839
y(surface)h(v)m(elo)s(cit)m(y)f(\(VEL\).)g(The)h(p)s(osition)d(in)h
(the)i(lo)s(ok-up)e(table)g(is)g(determined)h(b)m(y)h(RL,)f(whic)m(h)0
959 y(uses)d(logarithmic)33 b(in)m(terp)s(olation)i(of)i(VEL)g(across)h
(the)g(maxim)m(um)d(and)i(minim)m(um)d(v)-5 b(alues)38
b(in)e(the)0 1080 y(lo)s(ok-up)27 b(table,)h(VELMAX)h(and)g(VELMIN.)g
(IL)f(is)g(the)g(in)m(teger)g(v)-5 b(alue)28 b(of)g(RL.)g(The)h(v)-5
b(alue)27 b(of)h(USTR)0 1200 y(is)g(then)i(determined)f(b)m(y)g(in)m
(terp)s(olating)e(to)h(RL)h(b)s(et)m(w)m(een)i(the)e(IL)g(and)g(IL+1)f
(v)-5 b(alues)29 b(of)f(the)i(lo)s(ok-up)0 1321 y(table)j(v)-5
b(alues)34 b(of)f Fn(u)705 1336 y Fi(\003)744 1321 y
Fv(,)h(USTLOK.)h(Sp)s(ecial)d(cases)k(for)d(near)h(neutral)f(or)h
(nearly)f(free)i(con)m(v)m(ection)f(are)0 1441 y(used)g(when)f(the)g(v)
-5 b(alue)32 b(of)h(VEL)g(falls)d(outside)j(the)g(extremes)h(of)e(the)h
(lo)s(ok-up)e(table.)0 1850 y Fp(LO)l(WERBC)0 2155 y
Fw(Called)36 b(b)m(y:)113 b Fv(CALCVIS)0 2276 y Fw(Calls:)e
Fv(LOOK,)32 b(MOSTBC)146 2517 y(Solv)m(es)e(the)f(surface)h(b)s
(oundary)g(condition)d(equations)j(deriv)m(ed)f(from)f(Monin-Obukho)m
(v)i(\(M-O\))0 2637 y(similarit)m(y)c(theory)-8 b(.)43
b(The)30 b(output)g(from)e(this)h(routine)g(are)g(v)-5
b(alues)30 b(of)e(VIS)i(and)g(DIFF,)e(the)i(viscosit)m(y)0
2757 y(and)37 b(di\013usion)g(co)s(e\016cien)m(ts,)i(at)e(the)h(b)s
(ottom)e(mo)s(del)g(lev)m(el,)i(and)f(the)h(v)-5 b(alues)37
b(of)g(scalars,)i(TH)e(and)0 2878 y(Q,)31 b(at)h(the)g(b)s(ottom)e(mo)s
(del)f(lev)m(el,)j(whic)m(h)g(is)f(e\013ectiv)m(ely)h(b)s(elo)m(w)f
(the)h(surface.)44 b(These)34 b(v)-5 b(alues)31 b(ensure)0
2998 y(that)44 b(the)h(subgrid)f(mo)s(del)f(tendency)k(terms)d(giv)m(e)
g(v)-5 b(alues)45 b(of)f(surface)h(stresses)i(and)e(\015uxes)h(that)0
3118 y(are)38 b(consisten)m(t)g(with)g(the)g(equations.)59
b(First)37 b(of)g(all,)g(the)h(trivial)e(case)i(where)h(either)f
(viscosit)m(y)g(or)0 3239 y(the)h(surface)g(b)s(oundary)g(conditions)f
(are)g(switc)m(hed)i(o\013)e(is)g(dealt)g(with)g(b)m(y)h(setting)g
(zero)g(v)-5 b(alues)38 b(of)0 3359 y(VIS)e(and)g(DIFF.)e(The)j(next)f
(step)h(is)e(to)g(calculate)g(the)h(magnitude)e(of)h(the)h(near)g
(surface)h(v)m(elo)s(cit)m(y)0 3480 y(\(mo)s(del)32 b(lev)m(el)h(2\))g
(whic)m(h)h(is)f(assigned)h(to)f(VEL.)h(Then)h(di\013eren)m(t)f(pro)s
(cedures)h(are)e(follo)m(w)m(ed)g(for)g(the)0 3600 y(t)m(w)m(o)g
(di\013eren)m(t)g(b)s(oundary)g(condition)e(t)m(yp)s(es.)146
3841 y(If)c(prescrib)s(ed)h(surface)g(\015uxes)h(are)e(selected)h
(\(ISCBCP=1\))g(then)f Fn(u)2674 3856 y Fi(\003)2740
3841 y Fv(\(USTR\))h(is)e(required)i(from)0 3961 y(the)43
b(M-O)f(solutions.)71 b(Di\013eren)m(t)42 b(equations)h(are)f(required)
h(for)f(con)m(v)m(ectiv)m(e,)47 b(neutral)41 b(and)i(stable)0
4081 y(cases,)d(and)d(these)h(are)g(iden)m(ti\014ed)f(b)m(y)h(the)f
(buo)m(y)m(ancy)i(\015ux,)h(FBUO)m(Y.)d(F)-8 b(or)36
b(the)i(con)m(v)m(ectiv)m(e)h(case)f(,)0 4202 y(USTR)27
b(is)f(deduced)i(b)m(y)g(using)e(the)h(lo)s(ok-up)e(table)h(with)g(a)g
(call)f(to)h(routine)g Fw(LOOK)p Fv(.)h(VIS)g(and)g(DIFF)0
4322 y(are)41 b(then)g(calculated)f(from)f(the)i(M-O)f(expressions)j
(for)d(the)h(con)m(v)m(ectiv)m(e)i(case.)68 b(F)-8 b(or)40
b(the)h(neutral)0 4443 y(and)g(stable)g(cases)h(USTR)f(can)h(b)s(e)f
(calculated)f(directly)-8 b(,)42 b(but)f(for)g(the)g(stable)g(case)h
(solutions)e(do)0 4563 y(not)32 b(exist)h(for)f(some)h(v)-5
b(alues)32 b(of)g(buo)m(y)m(ancy)j(\015ux.)44 b(If)33
b(this)f(is)g(the)h(case)h(then)f(it)e(is)h(assumed)i(that)e(the)0
4683 y(surface)j(la)m(y)m(er)g(is)f(to)s(o)g(stable)g(for)g(turbulence)
i(and)e(VIS)h(and)g(DIFF)f(are)g(set)i(to)e(zero.)50
b(F)-8 b(or)33 b(eac)m(h)j(of)0 4804 y(the)30 b(buo)m(y)m(ancy)h
(\015ux)g(conditions)d(the)i(b)s(ottom)e(lev)m(el)h(v)-5
b(alues)30 b(of)f(TH)h(and)g(Q)f(are)g(set)i(as)e(appropriate.)146
5045 y(If)45 b(a)g(prescrib)s(ed)h(surface)g(temp)s(erature)f(is)f
(selected)i(\(ISCBCP=2\))g(then)g(b)s(oth)f Fn(u)3372
5060 y Fi(\003)3456 5045 y Fv(and)g Fn(\022)3703 5060
y Fe(v)r Fi(\003)0 5165 y Fv(\(THVSTR\))j(are)f(required)h(from)e(the)h
(M-O)g(solutions.)86 b(These)49 b(are)e(calculated)f(iterativ)m(ely)g
(in)0 5285 y(routine)28 b Fw(MOSTBC)h Fv(for)g(whic)m(h)g(the)g(inputs)
g(are)g(VEL)g(and)g(DTHV)p 2603 5285 30 4 v 35 w(SURF,)g(the)g
(di\013erence)h(in)e Fn(\022)3703 5300 y Fe(v)r Fi(\003)0
5406 y Fv(b)s(et)m(w)m(een)36 b(the)f(near)f(surface)h(mo)s(del)e(lev)m
(el)g(and)i(the)f(surface)h Fn(\022)2347 5421 y Fe(v)2388
5406 y Fv(,)g(THVSURF.)g(VIS)f(and)g(DIFF)f(are)0 5526
y(then)38 b(trivially)d(calculated)i(from)f(USTR)i(and)g(THVSTR,)h(and)
f(the)g(b)s(ottom)e(mo)s(del)g(lev)m(el)i(v)-5 b(alues)0
5646 y(of)32 b(Q)g(and)h(TH)g(are)g(simply)e(in)m(terp)s(olated)g(from)
h(the)h(surface)g(v)-5 b(alues.)1841 6107 y(69)p eop
%%Page: 70 73
70 72 bop 146 52 a Fv(Finally)-8 b(,)29 b(the)j(bac)m(kscatter)h
(energies)f(are)f(set)h(to)f(zero)g(at)g(the)h(mo)s(del)d(b)s(ottom,)i
(and)g(the)h(viscous)0 173 y(n)m(um)m(b)s(er)h(for)f(the)h(CFL)g
(condition,)e(CVIS,)i(is)f(partially)e(calculated)i(for)g(the)h(b)s
(ottom)e(lev)m(el.)0 582 y Fp(MAKINGMO)l(VIES)0 887 y
Fw(Called)36 b(b)m(y:)113 b Fv(NNSTEPS)0 1008 y Fw(Calls:)e
Fv(-)146 1248 y(W)-8 b(rites)40 b(out)f(a)g(single)g(frame)f(of)h(an)h
(animation)c(to)j(\014le.)64 b(A)40 b(separate)g(\014le)f(is)g(written)
h(out)f(for)0 1369 y(eac)m(h)k(PE)f(and)g(eac)m(h)g(frame.)70
b(The)42 b(\014le)g(is)f(en)m(titled)g Fl(MO)n(Vxxxyyy)h
Fv(where)h(xxx)g(is)e(the)h(n)m(um)m(b)s(er)g(of)0 1489
y(the)32 b(PE)g(\(MYPE\))h(and)e(yyy)i(is)e(the)h(n)m(um)m(b)s(er)g(of)
f(the)h(frame,)f(NFR)p 2518 1489 30 4 v 35 w(THISJOB.)i(This)e(is)g
(written)h(to)0 1609 y(the)g(c)m(haracter)h(string)e(MO)m(VFILE.)i(The)
f(\014le)g(is)f(op)s(ened)i(as)f(unit)f(MYPEUNIT=50+MYPE)j(and)0
1730 y(an)41 b(arra)m(y)-8 b(,)44 b(ARR)-8 b(TIM,)42
b(written)g(to)f(the)h(\014le)f(con)m(taining)f(time)g(information.)67
b(Then)43 b(eac)m(h)f(mo)s(del)0 1850 y(\014eld)c(is)g(written)g(out)g
(in)f(turn,)j(dep)s(ending)e(on)g(the)h(IMO)m(V)g(\015ags.)60
b(The)39 b(\014eld)f(coun)m(ting)g(v)-5 b(ariable,)0
1971 y(NV)-11 b(AR,)34 b(is)e(incremen)m(ted,)j(and)e(the)h(name)f(of)f
(the)i(\014eld)f(assigned)h(to)f(V)-11 b(ARNAMES.)35
b(Then)f(a)f(lo)s(op)0 2091 y(is)41 b(conducted)i(o)m(v)m(er)f(the)g(n)
m(um)m(b)s(er)f(of)g(slices.)69 b(Animation)39 b(data)i(ma)m(y)g(only)g
(b)s(e)g(output)g(on)h(ev)m(ery)0 2211 y(IJINCP)j(slice)d(and)h
(column,)i(and)e(so)h(a)f(test)g(is)g(p)s(erformed)g(to)g(see)h(if)e
(the)i(the)f(curren)m(t)h(slice)f(is)0 2332 y(required.)73
b(If)42 b(so,)j(then)e(arra)m(y)f(SLICEMO)m(V)i(is)e(assigned)g(to)g
(the)g(\014eld)g(data)g(a)m(v)m(eraged)i(on)m(to)e(P-)0
2452 y(p)s(oin)m(ts)c(b)s(et)m(w)m(een)i(the)f(v)m(ertical)f(and)g
(horizon)m(tal)f(limits,)g(with)g(the)i(IJINCP)h(spacing)e(used)h(in)f
(the)0 2573 y(horizon)m(tal.)52 b(The)37 b(index)f(of)f(SLICEMO)m(V)j
(is)e(held)f(as)h(IMO)m(V)h(and)f(incremen)m(ted)g(after)g(eac)m(h)h
(lo)s(op)0 2693 y(pass.)46 b(Then)34 b(that)f(slice)g(of)g(animation)d
(data)j(is)f(written)h(out)g(as)h(SLICEMO)m(V.)h(This)e(is)g(con)m(tin)
m(ued)0 2813 y(un)m(til)k(all)e(slices)j(are)g(completed.)59
b(The)38 b(a)m(v)m(eraging)g(of)f(data)h(on)m(to)f(P-p)s(oin)m(ts)h
(requires)g(extra)h(slices)0 2934 y(for)c(the)g(U)h(\014elds,)g(whic)m
(h)g(are)f(obtained)f(b)m(y)j(message)e(passing)g(at)g(the)h(b)s
(eginning)e(of)g(the)i(routine.)0 3054 y(Q)42 b(\014elds)h(are)g(giv)m
(en)g(a)f(minim)m(um)e(v)-5 b(alue)42 b(of)g(10)1835
3018 y Fi(\000)p Fs(10)2007 3054 y Fv(to)g(a)m(v)m(oid)h(an)m(y)g
(problems)f(within)f(the)j(Vis5D)0 3174 y(soft)m(w)m(are)34
b(pac)m(k)-5 b(age)33 b(whic)m(h)g(can)g(b)s(e)f(used)i(to)e(displa)m
(y)h(the)g(animations.)0 3584 y Fp(MER)l(GE)p 514 3584
41 4 v 49 w(D)l(A)-11 b(T)g(A)0 3889 y Fw(Called)36 b(b)m(y:)113
b Fv(RAD)p 836 3889 30 4 v 35 w(LEM)0 4009 y Fw(Calls:)e
Fv(EXXIT)146 4250 y(Merges)41 b(the)e(mo)s(del)e(data)i(with)g(the)g
(McClattc)m(hey)i(pro\014le)d(to)h(pro)m(vide)g(the)h(input)e(temp)s
(era-)0 4370 y(ture,)44 b(v)-5 b(ap)s(our,)42 b(cloud,)h(ice)e(and)g
(ozone)g(pro\014les)g(for)f(the)i(radiation)c(sc)m(heme.)70
b(The)42 b(\014rst)g(stage)f(is)0 4491 y(to)c(calculate)f(at)h(whic)m
(h)g(lev)m(el)g(to)g(use)h(the)f(McClattc)m(hey)i(data)e(using)f(an)h
(algorithm)d(iden)m(tical)i(to)0 4611 y(that)g(in)f Fw(CALC)p
653 4611 34 4 v 40 w(LEVS)p Fv(.)g(CUT)i(is)e(the)i(p)s(oin)m(t)e(at)g
(whic)m(h)h(the)g(McClattc)m(hey)i(data)d(will)f(start)h(and)0
4731 y(TOT)-8 b(AL)p 348 4731 30 4 v 36 w(SIZE=CUT+KKP)42
b(giv)m(es)g(the)g(total)e(size)h(of)g(the)h(pro\014les)f(for)g(input)g
(in)m(to)f(the)i(radia-)0 4852 y(tion)h(co)s(de.)78 b(If)43
b(TOT)-8 b(AL)p 965 4852 V 36 w(SIZE)45 b(exceeds)h(the)e(maxim)m(um)e
(n)m(um)m(b)s(er)i(of)g(radiation)d(sc)m(heme)k(lev)m(els,)0
4972 y(NPD)p 220 4972 V 35 w(LEVELS,)35 b(then)g Fw(EXXIT)d
Fv(is)h(called)g(with)g(ISTOPU=11.)48 b(The)35 b(pro\014les)f(for)f
(the)i(radiation)0 5093 y(sc)m(heme,)27 b(PFINAL,)e(TFINAL,)g(QVFINAL,)
f(QLFINAL,)g(QIFINAL)g(and)g(O3FINAL)g(corresp)s(ond-)0
5213 y(ing)38 b(to)h(pressure,)j(temp)s(erature,)f(v)-5
b(ap)s(our,)40 b(liquid)d(cloud,)j(ice)f(and)g(ozone)g(resp)s(ectiv)m
(ely)-8 b(,)42 b(are)d(then)0 5333 y(assigned.)44 b(Unlik)m(e)31
b(all)f(other)i(pro\014les)g(in)g(the)g(mo)s(del)f(the)h(\014rst)h
(index)f(corresp)s(onds)h(to)f(the)g(highest)0 5454 y(mo)s(del)41
b(lev)m(el,)k(and)d(the)h(last)f(index)h(the)f(lo)m(w)m(est)i(mo)s(del)
c(lev)m(el.)73 b(Firstly)-8 b(,)44 b(the)f(McClattc)m(hey)h(data)0
5574 y(\(MCC)p 273 5574 V 36 w(P)p 375 5574 V 36 w(TR)m(O,)36
b(MCC)p 918 5574 V 36 w(O3)p 1079 5574 V 35 w(PR)m(O,)g(MCC)p
1617 5574 V 36 w(T)p 1723 5574 V 36 w(TR)m(O)g(and)f(MCC)p
2431 5574 V 37 w(Q)p 2544 5574 V 35 w(TR)m(O\))g(is)g(assigned)h(b)s
(et)m(w)m(een)i(1)0 5695 y(and)43 b(CUT,)g(then)g(the)g(mo)s(del)e
(data,)k(TN)e(\(temp)s(erature\),)i(QV)d(\(v)-5 b(ap)s(our\),)45
b(QL)d(\(cloud\))g(and)g(QI)0 5815 y(\(ice\))28 b(are)h(assigned)g(to)g
(the)g(rest)g(of)g(the)g(arra)m(y)-8 b(,)30 b(noting)d(that)i(the)g(mo)
s(del)e(data)i(is)f(ordered)i(v)m(ertically)1841 6107
y(70)p eop
%%Page: 71 74
71 73 bop 0 52 a Fv(in)39 b(the)g(opp)s(osite)g(w)m(a)m(y)i(to)e(the)h
(radiation)d(pro\014les.)63 b(The)41 b(ozone)e(pro\014le)g(is)g
(completed)g(using)g(the)0 173 y(McClattc)m(hey)e(data)f(crudely)g(in)m
(terp)s(olated)f(to)g(the)i(mo)s(del)d(grid.)52 b(Finally)-8
b(,)34 b(a)i(c)m(hec)m(k)i(is)d(p)s(erformed)0 293 y(for)i(negativ)m(e)
g(v)-5 b(alues)37 b(of)g(v)-5 b(ap)s(our,)38 b(cloud)f(and)g(ice)g
(whic)m(h)g(w)m(ould)h(cause)g(the)f(radiation)e(sc)m(heme)k(to)0
414 y(crash.)0 823 y Fp(MICR)l(OPHYS)0 1128 y Fw(Called)d(b)m(y:)113
b Fv(D)m(YNVIS)0 1248 y Fw(Calls:)e Fv(MICR)m(O)m(X,)34
b(WLA)-8 b(TENTDG)146 1489 y(Calculates)33 b(the)h(w)m(arm)f(rain)g
(microph)m(ysics)g(tendencies,)i(and)f(con)m(trols)f(the)h(call)d(to)i
(the)h(three-)0 1609 y(phase)h(microph)m(ysics.)47 b(The)35
b(\014rst)g(step)g(of)e(the)h(routine)g(is)f(to)h(call)e
Fw(MICR)m(O)m(X)h Fv(if)g(the)h(three-phase)0 1730 y(microph)m(ysics)j
(is)g(selected)h(\(IRAINP=10\).)57 b(If)37 b(not)g(then)h(the)g(w)m
(arm)e(rain)g(parametrizations)f(are)0 1850 y(calculated.)47
b(Three)35 b(alternativ)m(e)e(sc)m(hemes)j(exist)e(-)f(Kessler,)i(Lee)g
(and)f(Sw)m(ann)h(-)e(corresp)s(onding)h(to)0 1971 y(v)-5
b(alues)29 b(of)g(IRAINP)h(of)e(1,)i(2)f(and)g(3)g(resp)s(ectiv)m(ely)
-8 b(.)43 b(IRAINP=5)30 b(is)e(a)h(theoretical)f(sc)m(heme)j(for)d
(calcu-)0 2091 y(lating)f(the)i(maxim)m(um)d(precipitation)h
(e\016ciency)-8 b(.)43 b(Firstly)-8 b(,)28 b(the)i(fall)c(rate)j(of)f
(the)h(rain)f(is)g(calculated,)0 2211 y(QDO)m(WNFLUX,)k(and)g(the)h
(rain)e(tendency)j(term)d(incremen)m(ted)i(b)m(y)g(a)f(simple)e(v)m
(ertical)h(discretiza-)0 2332 y(tion.)61 b(PUDDLE)38
b(is)h(also)e(incremen)m(ted)j(at)e(this)g(p)s(oin)m(t.)61
b(The)40 b(saturation)e(de\014cit,)i(QWSDEF,)f(is)0 2452
y(also)g(calculated)g(here,)k(using)d(the)g(saturation)f(v)-5
b(alues)40 b(calculated)f(in)g Fw(LA)-9 b(THEA)g(T)p
Fv(,)38 b(QSA)-8 b(TPW.)0 2573 y(Eac)m(h)43 b(Rain)f(sc)m(heme)h(has)g
(three)g(con)m(v)m(ersion)h(t)m(yp)s(es:)64 b(auto)s(con)m(v)m(ersion,)
46 b(accretion)c(and)g(ev)-5 b(ap)s(ora-)0 2693 y(tion.)66
b(Auto)s(con)m(v)m(ersion)41 b(and)f(accretion)g(are)h(sources)g(of)f
(rain)g(from)f(cloud)g(and)i(are)f(assigned)h(to)0 2813
y(RAINSOUR)m(CE,)i(whilst)e(ev)-5 b(ap)s(oration)40 b(is)h(a)g(sink)g
(of)g(rain)g(to)g(v)-5 b(ap)s(our)41 b(and)h(is)f(th)m(us)h(assigned)g
(to)0 2934 y(RAINSINK.)34 b(Both)f(RAINSOUR)m(CE)i(and)e(RAINSINK)h
(are)f(p)s(ositiv)m(e)g(with)g(resp)s(ect)i(to)e(rain.)44
b(On)0 3054 y(completing)23 b(the)j(calculations)e(of)h(RAINSOUR)m(CE)i
(and)e(RAINSINK)h(the)g(microph)m(ysics)f(tendency)0
3174 y(diagnostics)42 b(are)g(calculated)g(in)g(the)h(call)e(to)h
Fw(WLA)-9 b(TENTDG)41 b Fv(and)i(the)g(tendency)i(terms)d(are)0
3295 y(up)s(dated.)65 b(STH)41 b(is)e(co)s(oled)g(b)m(y)h(ev)-5
b(ap)s(oration)39 b(so)h(uses)h(RAINSINK,)f(cloud)f(is)h(reduced)h(b)m
(y)f(auto-)0 3415 y(con)m(v)m(ersion)e(and)f(accretion)f(so)h(uses)h
(RAINSOUR)m(CE,)g(v)-5 b(ap)s(our)37 b(is)f(incremen)m(ted)h(b)m(y)h
(ev)-5 b(ap)s(oration)0 3536 y(so)38 b(uses)h(RAINSINK)f(and)f(the)h
(rain)f(tendency)i(is)e(calculated)g(using)g(b)s(oth)h(RAINSOUR)m(CE)g
(and)0 3656 y(RAINSINK.)0 4065 y Fp(MICR)l(OSET)0 4370
y Fw(Called)e(b)m(y:)113 b Fv(BEGIN)0 4491 y Fw(Calls:)e
Fv(-)146 4731 y(Initialises)29 b(some)i(of)g(the)h(functions)f(and)g
(expressions)i(used)g(in)d(the)i(three-phase)h(microph)m(ysics)0
4852 y(calculations.)39 b(The)27 b(Gamma)c(and)j(double)f(in)m(tegral)f
(functions)h(used)i(in)e(the)h(assumed)g(distributions)0
4972 y(of)32 b(the)h(w)m(ater)h(sp)s(ecies)f(are)g(time-consuming)d(to)
i(calculate)g(so)g(expressions)j(in)m(v)m(olving)c(those)i(func-)0
5093 y(tions)23 b(are)g(calculated)f(once)i(in)e Fw(MICR)m(OSET)g
Fv(and)i(then)f(used)i(in)d(the)i(calculations)d(in)h
Fw(MICR)m(O)m(X)p Fv(.)0 5213 y(These)36 b(are)e(held)g(in)f(t)m(w)m(o)
i(arra)m(ys:)48 b(PHYSCAL,)35 b(whic)m(h)g(just)f(con)m(tains)h(scalar)
e(v)-5 b(alues)34 b(indep)s(enden)m(t)0 5333 y(of)f(heigh)m(t,)h(and)f
(PHYS1D,)h(whic)m(h)g(is)f(also)g(dimensioned)f(b)m(y)j(the)f(n)m(um)m
(b)s(er)g(of)f(v)m(ertical)f(lev)m(els,)i(and)0 5454
y(con)m(tains)f(expressions)h(that)e(are)h(dep)s(enden)m(t)h(on)f
(heigh)m(t)f(\(e.g.)44 b(function)32 b(of)g(densit)m(y\).)1841
6107 y(71)p eop
%%Page: 72 75
72 74 bop 0 52 a Fp(MICR)l(O)l(X)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(MICR)m(OPHYS)0 478 y Fw(Calls:)e Fv(PRECDIA)m(GSET,)
34 b(PRECDIA)m(G,)g(LA)-8 b(TENTDG)146 719 y(Calculates)40
b(the)h(three-phase)g(microph)m(ysics)g(con)m(v)m(ersion)g(rates)g(and)
f(tendencies.)68 b(W)-8 b(ell)39 b(o)m(v)m(er)0 839 y(thirt)m(y)44
b(microph)m(ysics)f(con)m(v)m(ersion)i(terms)f(are)g(supp)s(orted)h(in)
e(the)h(co)s(de,)j(all)42 b(requiring)h(in)m(v)m(olv)m(ed)0
959 y(calculations.)d(This)27 b(leads)h(to)f(the)h(longest)f
(subroutine)g(in)g(the)h(LEM,)g(although)f(the)g(translation)f(of)0
1080 y(the)i(microph)m(ysics)g(expressions)h(describ)s(ed)f(in)f
(section)h(6)f(of)g(the)h(Scien)m(ti\014c)g(Do)s(cumen)m(tation)e
(\(Gra)m(y)0 1200 y(et)33 b(al)e(2001\))h(to)g(the)h(co)s(de)g(in)f
Fw(MICR)m(O)m(X)f Fv(is)h(relativ)m(ely)g(transparen)m(t.)146
1441 y(The)27 b(\014rst)g(stage)g(of)e(the)i(routine)e(is)h(to)g
(initialise)c(the)27 b(fall)d(rate)i(and)g(precipitation)e(diagnostics)
i(if)0 1561 y(required,)33 b(through)g Fw(PRECDIA)m(GSET)p
Fv(,)e(and)i(to)f(create)h(a)g(\014eld)g(of)f(absolute)g(temp)s
(erature,)h(T0.)0 1682 y(The)40 b(fall)d(rates)j(of)f(the)g(h)m
(ydrometeors)h(are)g(then)g(calculated)e(and)h(assigned)h(to)f(QDO)m
(WNFLUX)0 1802 y(for)28 b(mixing)f(ratios,)h(and)h(QNDO)m(WNFLUX)f(for)
g(n)m(um)m(b)s(er)h(concen)m(trations,)h(for)e(eac)m(h)i(h)m
(ydrometeor)0 1923 y(in)35 b(turn.)51 b(T)-8 b(o)36 b(minimise)c
(calculations)h(the)j(highest)f(lev)m(el)g(con)m(taining)f(the)i(h)m
(ydrometeor)f(is)g(deter-)0 2043 y(mined,)g(KTOPMIC,)h(and)f(QDO)m
(WNFLUX)f(only)h(calculated)f(from)f(lev)m(el)i(2)f(to)g(this)h(lev)m
(el.)50 b(Once)0 2163 y(QDO)m(WNFLUX)34 b(and)h(QNDO)m(WNFLUX)f(are)g
(determined,)h(a)f(simple)f(v)m(ertical)h(discretization)f(is)0
2284 y(used)44 b(to)e(calculate)g(the)h(rate)g(of)f(c)m(hange)h(of)g(w)
m(ater)g(substance)i(due)e(to)f(the)i(falling,)e(and)h(this)f(is)0
2404 y(added)36 b(to)e(the)h(appropriate)f(SQ.)h Fw(PRECDIA)m(G)e
Fv(is)h(then)i(called)d(to)i(calculate)f(the)h(fall)e(rate)h(and)0
2524 y(precipitation)39 b(diagnostics.)67 b(This)41 b(pro)s(cedure)g
(is)f(carried)h(out)f(for)g(eac)m(h)i(h)m(ydrometeor,)h(starting)0
2645 y(with)32 b(rain,)g(then)h(sno)m(w,)h(graup)s(el)d(and,)i
(\014nally)-8 b(,)31 b(cloud)i(ice.)146 2886 y(The)40
b(con)m(v)m(ersion)f(rates)g(are)f(calculated)g(in)f(a)h(big)g(lo)s(op)
e(o)m(v)m(er)k(K=1,KKP)e(and)g(a)g(nested)i(lo)s(op)0
3006 y(o)m(v)m(er)35 b(J=1,JJP)-8 b(.)35 b(Eac)m(h)g(grid)e(p)s(oin)m
(t)g(is)h(treated)h(in)e(turn,)i(using)f(scalars)g(to)g(store)h(the)f
(arra)m(y)g(v)-5 b(alues.)0 3126 y(This)38 b(simpli\014es)d(the)j(con)m
(v)m(ersion)h(calculations.)56 b(T)-8 b(emp)s(erature,)39
b(mixing)d(ratio,)h(n)m(um)m(b)s(er)h(concen-)0 3247
y(tration,)g(and)h(saturation)e(data)h(are)h(assigned)f(to)g(lo)s(cal)e
(scalar)i(v)-5 b(ariables.)59 b(Ho)m(w)m(ev)m(er,)43
b(b)s(efore)38 b(the)0 3367 y(calculation)c(pro)s(ceeds)k(a)f(c)m(hec)m
(k)i(is)d(made)g(to)g(see)i(if)e(there)h(are)g(an)m(y)g(condensed)i(w)m
(ater)e(sp)s(ecies)h(on)0 3488 y(that)e(grid)g(p)s(oin)m(t)f(or)h
(whether)i(it)d(is)h(sup)s(ersaturated)i(with)e(resp)s(ect)i(to)e(ice.)
55 b(If)36 b(not,)i(then)f(the)g(mi-)0 3608 y(croph)m(ysics)g
(calculations)d(are)i(not)g(carried)f(out)h(for)f(that)h(grid)e(p)s
(oin)m(t.)53 b(The)36 b(\014rst)h(con)m(v)m(ersion)g(rate)0
3728 y(to)f(b)s(e)h(calculated)f(is)g(the)h(primary)f(n)m(ucleation)g
(of)g(ice.)56 b(The)37 b(next)h(stage)f(is)f(to)h(calculate)e(v)-5
b(arious)0 3849 y(accretion)43 b(rates.)74 b(These)45
b(require)e(the)h(slop)s(e)e(parameter,)j Fn(\025)p Fv(,)h(\(LAMB)p
2774 3849 30 4 v 35 w(\),)g(fall)40 b(sp)s(eed)k(\(W)p
3512 3849 V 36 w(\))e(and)0 3969 y(v)m(en)m(tilation)d(co)s(e\016cien)m
(t)i(\(VENTF)-11 b(A)m(C)p 1475 3969 V 37 w(\))40 b(for)g(eac)m(h)h(h)m
(ydrometeor.)68 b(Then)41 b(the)g(graup)s(el)f(accretion)0
4089 y(rates)32 b(are)g(calculated.)42 b(These)34 b(ha)m(v)m(e)f
(di\013eren)m(t)f(calculations)e(dep)s(ending)i(on)g(whether)h(the)f
(graup)s(el)0 4210 y(is)i(\\w)m(et")i(or)e(\\dry".)51
b(If)35 b(the)g(graup)s(el)f(gro)m(wth)h(is)f(w)m(et,)j(then)e(only)g
(a)f(maxim)m(um)f(amoun)m(t)h(of)g(liquid)0 4330 y(can)40
b(freeze)h(to)e(form)f(graup)s(el.)64 b(An)m(y)41 b(excess)h(is)d(then)
h(shed)h(to)e(form)g(rain.)64 b(Other)39 b(collisions)e(are)0
4451 y(simpler,)27 b(including)f(sno)m(w)j(collecting)c(rain,)j(sno)m
(w)g(collecting)e(ice)h(and)h(cloud,)g(rain)f(collecting)e(sno)m(w)0
4571 y(and)43 b(rain)f(collecting)e(cloud)j(and)g(ice)f(to)h(form)e
(graup)s(el)h(or)h(sno)m(w.)75 b(The)44 b(temp)s(erature)e(m)m(ust)h(b)
s(e)0 4691 y(c)m(hec)m(k)m(ed)37 b(for)c(these)i(con)m(v)m(ersion)g
(rates)g(to)e(a)m(v)m(oid)h(making)e(sources)k(of)d(graup)s(el)g(or)g
(sno)m(w)i(b)s(elo)m(w)f(the)0 4812 y(freezing)42 b(lev)m(el.)73
b(Next)44 b(the)e(terms)h(for)f(sno)m(w)h(aggregation)e(and)i(sno)m(w)g
(breakup)h(are)e(calculated,)0 4932 y(follo)m(w)m(ed)27
b(b)m(y)j(the)e(auto)s(con)m(v)m(ersion)h(of)f(cloud)g(to)g(rain,)g
(the)h(sublimation)c(and)j(dep)s(osition)g(of)f(ice)h(and)0
5052 y(sno)m(w,)i(and)d(the)h(melting)d(of)i(ice,)h(sno)m(w)h(and)e
(graup)s(el.)41 b(A)27 b(test)i(for)d(saturation)h(is)g(p)s(erformed,)h
(and)f(in)0 5173 y(unsaturated)36 b(air)e(the)h(ev)-5
b(ap)s(oration)34 b(of)g(rain)g(is)h(calculated,)g(whilst)f(in)g
(saturated)i(air)d(the)j(con)m(tact)0 5293 y(n)m(ucleation)26
b(\(freezing)i(of)e(cloud)h(droplets)g(with)g(aerosols\))g(is)g
(determined.)41 b(Only)27 b(for)g(temp)s(eratures)0 5414
y(b)s(elo)m(w)40 b(freezing)g(are)g(the)h(homogeneous)f(freezing)g(of)f
(w)m(ater,)k(ice)d(collecting)e(w)m(ater)j(and)f(ice,)i(the)0
5534 y(auto)s(con)m(v)m(ersion)34 b(of)e(sno)m(w)i(and)g(graup)s(el)e
(and)h(the)g(freezing)g(of)g(rain)f(calculated,)g(whic)m(h)i(completes)
0 5654 y(the)f(calculation)d(of)i(all)f(the)i(pro)s(cess)h(rates.)1841
6107 y(72)p eop
%%Page: 73 76
73 75 bop 146 52 a Fv(The)37 b(p)s(en)m(ultimate)d(stage)i(of)f(the)h
(routine)f(is)g(to)g(sum)h(the)g(appropriate)e(pro)s(cess)j(rates)f(to)
g(giv)m(e)0 173 y(the)h(microph)m(ysics)f(tendencies)i(for)d(eac)m(h)i
(w)m(ater)g(sp)s(ecies.)56 b(Ho)m(w)m(ev)m(er,)39 b(b)s(efore)e(this)e
(the)i(sink)g(terms)0 293 y(for)e(eac)m(h)h(w)m(ater)h(v)-5
b(ariable)33 b(are)j(c)m(hec)m(k)m(ed)j(to)c(ensure)i(that)e(they)i(so)
e(not)h(exceed)h(the)f(curren)m(t)h(v)-5 b(alue.)0 414
y(If)36 b(they)g(do,)h(then)f(they)h(are)f(scaled)g(so)g(that)f(not)h
(all)d(of)j(the)g(w)m(ater)g(substance)i(is)d(remo)m(v)m(ed.)54
b(This)0 534 y(acts)39 b(as)g(some)g(form)e(of)i(p)s(ositivit)m(y)e(c)m
(hec)m(k.)64 b(The)40 b(pro)s(cess)g(rates)f(are)g(added)g(to)f(the)i
(arra)m(ys)f(DQV)0 654 y(etc)33 b(and)f(these,)h(in)e(turn,)h(added)h
(to)f(the)g(source)h(terms,)f(SQ)g(and)g(STH.)h(Finally)-8
b(,)29 b(the)j(pro)s(cess)i(rate)0 775 y(and)e(microph)m(ysics)g
(tendency)i(diagnostics)c(are)i(calculated)f(b)m(y)i(the)f(call)e(to)i
Fw(LA)-9 b(TENTDG)p Fv(.)30 b(This)0 895 y(then)j(ends)h(the)f(large)e
(lo)s(op)g(o)m(v)m(er)j(K.)0 1304 y Fp(MOISTRI)0 1609
y Fw(Called)i(b)m(y:)113 b Fv(SMA)m(G,)33 b(SMA)m(G2D,)g(SMA)m(G1D)0
1730 y Fw(Calls:)111 b Fv(-)146 1971 y(Calculates)34
b(the)g(moist)f(Ric)m(hardson)h(Num)m(b)s(er)g(for)g(the)g(case)h
(where)g(IMOISTRIP=1.)50 b(This)34 b(is)0 2091 y(calculated)j(b)m(y)i
(determining)e(the)h(buo)m(y)m(ancy)i(gradien)m(t)e(b)s(et)m(w)m(een)i
(a)e(parcel)f(at)h(lev)m(el)g(K+1,)h(and)f(a)0 2211 y(parcel)27
b(at)h(lev)m(el)f(K)h(ha)m(ving)g(b)s(een)g(lifted)e(to)i(K+1)f(taking)
g(in)m(to)g(accoun)m(t)i(the)f(condensation)g(of)f(liquid)0
2332 y(w)m(ater.)53 b(T)-8 b(o)35 b(carry)h(out)g(the)g(lifting)c(of)j
(the)h(parcel)f(the)h(conserv)m(ed)i(quan)m(tities)d(liquid)f(w)m(ater)
i(static)0 2452 y(energy)e(temp)s(erature)f(and)h(total)d(w)m(ater)j
(mixing)d(ratio)h(are)h(used.)47 b(These)35 b(are)e(initially)c
(calculated)0 2573 y(in)42 b(arra)m(ys)h(TL)g(and)f(QT,)h(and)g(the)g
(v)m(ertical)f(di\013erence)h(in)f(the)h(basic)f(state)h(of)f(TL)h
(assigned)g(to)0 2693 y(DTLREF.)29 b(Then,)j(the)e(p)s(oten)m(tial)e
(temp)s(erature)h(of)g(a)g(parcel)h(lifted)e(to)h(K+1)g(conserving)h
(its)f(moist)0 2813 y(static)g(energy)-8 b(,)31 b(TKP1,)g(is)e
(determined.)42 b(This)30 b(implicitly)c(includes)j(condensation,)i
(and)e(the)h(liquid)0 2934 y(w)m(ater)35 b(at)f(the)h(K+1)e(lev)m(el,)i
(QLP1,)g(is)e(then)i(calculated)f(using)g(a)g(T)-8 b(a)m(ylor)34
b(expansion.)49 b(Finally)-8 b(,)32 b(the)0 3054 y(Ric)m(hardson)37
b(Num)m(b)s(er,)h(RI,)e(is)h(calculated)e(taking)h(in)m(to)g(accoun)m
(t)i(the)f(gradien)m(t)f(of)h(h)m(ydrometeors)0 3174
y(in)32 b(the)h(buo)m(y)m(ancy)h(term)e(\(QLO)m(ADING\).)0
3584 y Fp(MOISTRI2)0 3889 y Fw(Called)k(b)m(y:)113 b
Fv(SMA)m(G,)33 b(SMA)m(G2D,)g(SMA)m(G1D)0 4009 y Fw(Calls:)111
b Fv(-)146 4250 y(Calculates)42 b(the)h(moist)e(Ric)m(hardson)h(Num)m
(b)s(er)h(for)e(the)i(case)h(where)f(IMOISTRIP=2.)74
b(This)0 4370 y(is)34 b(calculated)f(b)m(y)i(determining)e(the)i
(relativ)m(e)e(buo)m(y)m(ancy)j(di\013erence)f(b)s(et)m(w)m(een)i(t)m
(w)m(o)d(la)m(y)m(ers)h(when)h(a)0 4491 y(small)g(mass)j(of)f(air)g(is)
g(exc)m(hanged)j(b)s(et)m(w)m(een)f(the)g(t)m(w)m(o)f(la)m(y)m(ers.)63
b(T)-8 b(o)38 b(carry)h(out)g(the)g(mixing)e(of)h(the)0
4611 y(la)m(y)m(ers)43 b(the)g(conserv)m(ed)i(quan)m(tities)d(liquid)e
(w)m(ater)k(static)e(energy)h(temp)s(erature)f(and)h(total)e(w)m(ater)0
4731 y(mixing)33 b(ratio)h(are)h(used.)53 b(The)37 b(liquid)c(w)m(ater)
j(static)f(energy)h(temp)s(erature)f(is)g(initially)c(calculated)0
4852 y(in)i(TL,)h(and)g(the)g(v)m(ertical)g(di\013erence)g(in)f(the)h
(basic)g(state)g(of)g(TL)g(assigned)g(to)f(DTLREF.)h(Firstly)-8
b(,)0 4972 y(the)33 b(liquid)e(w)m(ater)j(and)f(buo)m(y)m(ancy)i(of)e
(the)g(t)m(w)m(o)h(la)m(y)m(ers)f(are)g(calculated.)44
b(QLLI)33 b(is)f(the)i(liquid)d(w)m(ater)0 5093 y(in)h(the)g(lo)m(w)m
(er)h(lev)m(el,)f(QLUI)g(the)h(liquid)d(w)m(ater)j(in)f(the)g(upp)s(er)
h(lev)m(el,)f(TQLLI)h(the)f(virtual)f(p)s(oten)m(tial)0
5213 y(temp)s(erature)d(in)g(the)h(lo)m(w)m(er)g(lev)m(el)f(and)g
(TQLUI)h(the)g(virtual)e(p)s(oten)m(tial)g(temp)s(erature)h(in)g(the)h
(upp)s(er)0 5333 y(lev)m(el.)53 b(Then)37 b(TL)f(and)g(the)h(total)d(w)
m(ater)j(mixing)c(ratio)i(are)h(mixed)f(b)s(et)m(w)m(een)j(the)e(t)m(w)
m(o)h(lev)m(els)f(b)m(y)h(a)0 5454 y(fraction)25 b(EPS.)i(TUN,)g(is)e
(the)i(upp)s(er)f(lev)m(el)g(mixed)f(TL,)h(TLN)h(the)f(lo)m(w)m(er)h
(lev)m(el)e(mixed)h(TL,)g(QUN)g(the)0 5574 y(upp)s(er)h(lev)m(el)f
(mixed)f(total)g(w)m(ater,)k(and)d(QLN)g(the)h(lo)m(w)m(er)f(lev)m(el)g
(mixed)g(total)f(w)m(ater.)42 b(The)27 b(new)g(liquid)0
5695 y(w)m(ater)36 b(and)f(virtual)f(p)s(oten)m(tial)f(temp)s(erature)i
(for)g(the)g(t)m(w)m(o)h(lev)m(els,)g(QLLN,)f(QLUN,)h(TQLUN)f(and)0
5815 y(TQLLN,)e(are)g(then)g(calculated,)e(and)i(th)m(us)h(the)f(Ric)m
(hardson)f(Num)m(b)s(er,)h(RI,)g(can)g(b)s(e)f(determined.)1841
6107 y(73)p eop
%%Page: 74 77
74 76 bop 0 52 a Fp(MOSTBC)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(LO)m(WERBC)0 478 y Fw(Calls:)e Fv(EXXIT)146 719
y(Calculates)37 b Fn(u)679 734 y Fi(\003)755 719 y Fv(and)h
Fn(\022)995 734 y Fe(v)r Fi(\003)1109 719 y Fv(for)e(a)h(prescrib)s(ed)
h(surface)g(temp)s(erature.)58 b(The)38 b(main)e(inputs)h(to)g(the)0
839 y(routine)c(are)g(an)h(arra)m(y)f(of)g(near)h(surface)g(v)m(elo)s
(cities,)f(DELU,)g(and)h(virtual)e(p)s(oten)m(tial)g(temp)s(erature)0
959 y(di\013erences)42 b(to)f(the)g(lo)m(w)m(est)h(grid,)g(DEL)-8
b(T.)41 b(With)g(these)h(v)-5 b(alues)41 b(the)g(relationships)f(deriv)
m(ed)i(from)0 1080 y(Monin-Obukho)m(v)33 b(\(M-O\))g(similarit)m(y)c
(theory)34 b(can)f(b)s(e)g(solv)m(ed)g(to)f(giv)m(e)h(v)-5
b(alues)33 b(of)f Fn(u)3157 1095 y Fi(\003)3229 1080
y Fv(and)h Fn(\022)3464 1095 y Fe(v)r Fi(\003)3540 1080
y Fv(.)45 b(The)0 1200 y(\014rst)40 b(step)f(is)g(to)g(determine)f
(whic)m(h)i(p)s(oin)m(ts)f(are)g(con)m(v)m(ectiv)m(e,)k(whic)m(h)c(are)
g(neutral)g(and)g(whic)m(h)g(are)0 1321 y(stable.)j(This)28
b(is)f(established)h(b)m(y)h(examining)d(DEL)-8 b(T;)28
b(the)g(n)m(um)m(b)s(er)g(of)f(unstable)h(p)s(oin)m(ts)g(is)f(assigned)
0 1441 y(to)37 b(NUNST)-8 b(ABL)39 b(and)f(the)g(indices)g(to)f
(JINDUNST,)i(the)f(n)m(um)m(b)s(er)g(of)f(stable)h(p)s(oin)m(ts)f(is)g
(assigned)0 1561 y(to)31 b(NST)-8 b(ABL)32 b(and)f(the)h(indices)f(to)g
(JINDST)-8 b(AB,)32 b(and)f(the)h(n)m(um)m(b)s(er)g(of)f(neutral)f(p)s
(oin)m(ts)h(is)g(assigned)0 1682 y(to)f(NNEUTRL)i(and)f(the)g(indices)f
(to)g(JINDNEUT.)i(The)g(trivial)c(neutral)i(case)h(is)g(dealt)f(with)g
(\014rst,)0 1802 y(and)37 b(the)g(diagnosed)f Fn(u)876
1817 y Fi(\003)952 1802 y Fv(and)g Fn(\022)1190 1817
y Fe(v)r Fi(\003)1303 1802 y Fv(are)h(assigned)g(to)f(USTRDG)g(and)h
(TSTRDG)f(resp)s(ectiv)m(ely)-8 b(,)39 b(the)0 1923 y(main)31
b(outputs)i(of)f(the)h(routine.)146 2163 y(The)24 b(stable)f(p)s(oin)m
(ts)f(are)h(dealt)f(with)h(next.)41 b(Sp)s(ecial)21 b(cases)j(for)f
(laminar)d(\015o)m(w)j(and)g(the)g(degenerate)0 2284
y(case)33 b(where)h(there)f(is)f(no)g(solution)e(for)i(the)h(M-O)f
(expressions)i(are)e(computed)h(\014rst,)g(and)f(then)h(the)0
2404 y(general)38 b(quadratic)h(is)g(solv)m(ed)g(for)g(the)g(other)g
(stable)g(p)s(oin)m(ts.)62 b(Finally)-8 b(,)38 b(the)i(unstable)f(p)s
(oin)m(ts)f(are)0 2524 y(examined,)c(and)g(these)h(expressions)g(can)g
(only)e(b)s(e)h(solv)m(ed)g(b)m(y)h(iteration.)45 b(The)35
b(next)g(guess)g Fn(u)3550 2539 y Fi(\003)3622 2524 y
Fv(and)0 2645 y Fn(\022)45 2660 y Fe(v)r Fi(\003)156
2645 y Fv(are)g(calculated)e(in)h(USTRPL)h(and)g(TSTRPL)g(and)g(the)g
(previous)g(guess)g Fn(u)3015 2660 y Fi(\003)3089 2645
y Fv(and)f Fn(\022)3325 2660 y Fe(v)r Fi(\003)3436 2645
y Fv(are)h(held)0 2765 y(in)41 b(TSTRL)i(and)f(USTRL.)h(If)f(the)h
(di\013erence)f(b)s(et)m(w)m(een)j(the)d(t)m(w)m(o)h(are)f(less)h(than)
f(the)g(tolerances)0 2886 y(TOTM)35 b(and)e(TOTT)i(for)e(all)e
(unstable)j(p)s(oin)m(ts)f(then)h(USTRDG)f(and)h(TSTRDG)f(are)h
(assigned)g(to)0 3006 y(USTRPL)c(and)g(TSTRPL)h(and)e(the)h(routine)f
(is)h(exited.)42 b(If)30 b(not,)g(the)g(v)-5 b(alues)29
b(are)h(stored)g(in)f(USTRL)0 3126 y(and)j(TSTRL,)h(with)f(a)f(smo)s
(othing)f(op)s(erator,)i(and)g(the)h(next)f(iteration)f(attempted.)43
b(A)32 b(maxim)m(um)0 3247 y(of)27 b(200)g(iterations)f(are)i(p)s
(ermitted.)41 b(If)28 b(the)g(solution)e(has)i(not)g(con)m(v)m(erged)h
(after)f(200)f(iterations)f(then)0 3367 y Fw(EXXIT)31
b Fv(is)h(called)g(with)g(ISTOPU=4.)0 3776 y Fp(MO)l(VIECNTL)0
4081 y Fw(Called)k(b)m(y:)113 b Fv(EXXIT)0 4202 y Fw(Calls:)e
Fv(-)146 4443 y(W)-8 b(rites)41 b(out)g(a)f(con)m(trol)g(\014le)h(to)f
(b)s(e)h(used)h(b)m(y)g(the)f(external)g(soft)m(w)m(are)h(for)f(pro)s
(cessing)g(the)g(an-)0 4563 y(imation)k(\014les.)89 b(The)49
b(routine)e(lo)s(ops)g(o)m(v)m(er)i(the)f(n)m(um)m(b)s(er)h(of)e
(frames)h(written)f(out)h(in)f(that)h(job,)0 4683 y(NFR)p
215 4683 30 4 v 35 w(THISJOB,)43 b(and)g(calculates)e(the)i(da)m(y)-8
b(,)46 b(hour,)f(min)m(ute)c(and)i(second)h(\(ID)m(A)-8
b(Y,)42 b(IHR,)h(IMIN,)0 4804 y(ISEC\))33 b(from)e(the)h(frame)f(time)f
(\(RMO)m(VTIMES\).)k(The)f(arra)m(ys)f(IMO)m(VD)m(A)-8
b(YS)33 b(and)f(IMO)m(VTIMES)0 4924 y(are)k(set)h(with)f(the)h
(appropriate)f(time)f(data.)54 b(User)38 b(information)33
b(is)j(written)g(to)g(unit)g(48,)h(and)f(an-)0 5045 y(imation)41
b(data)j(to)g(unit)g(49.)79 b(This)44 b(includes)g(the)h(times)f(for)f
(eac)m(h)j(of)e(the)g(frames,)j(the)e(n)m(um)m(b)s(er)0
5165 y(of)f(frames,)j(the)d(n)m(um)m(b)s(er)h(of)f(v)-5
b(ariables,)46 b(the)e(names)h(of)f(the)g(v)-5 b(ariables,)46
b(the)f(dimensions)e(of)h(the)0 5285 y(animation)30 b(frames)i(and)g
(the)h(horizon)m(tal)e(grid)h(spacing)g(and)h(the)g(v)m(ertical)f
(grid.)1841 6107 y(74)p eop
%%Page: 75 78
75 77 bop 0 52 a Fp(NAMEDIA)l(GS)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(ALLOCDGS)0 478 y Fw(Calls:)e Fv(-)146
719 y(Assigns)32 b(the)g(diagnostic)e(names)h(for)f(eac)m(h)j
(partition)c(of)h(the)i(conditionally)c(sampled)j(diagnos-)0
839 y(tics)40 b(to)f(CHA)-11 b(V.)41 b(The)g(inputs)f(are)f(CHBASE,)j
(the)e(base)h(index)f(of)f(CHA)-11 b(V;)41 b(NAM,)f(whic)m(h)h(is)e
(the)0 959 y(name)f(of)h(the)g(diagnostic;)i(and)e(NQV)-11
b(ALS,)39 b(whic)m(h)h(is)e(the)h(n)m(um)m(b)s(er)h(of)e(Q)h(\014elds)g
(appropriate)f(for)0 1080 y(that)31 b(diagnostic.)42
b(If)31 b(NQV)-11 b(ALS=0,)31 b(then)h(CHA)-11 b(V)32
b(is)f(simply)e(assigned)j(b)m(y)g(lo)s(oping)c(o)m(v)m(er)33
b(the)e(n)m(um-)0 1200 y(b)s(er)g(of)g(partitions,)e(NUPDO)m(WN,)j(and)
f(joining)e(the)i(partition)e(name,)i(CUPDO)m(WN,)h(with)f(NAM.)0
1321 y(If)41 b(NQV)-11 b(ALS)41 b(is)f(greater)g(than)h(zero,)i(then)e
(there)g(are)g(NQV)-11 b(ALS)41 b(Q)g(\014elds)f(asso)s(ciated)h(with)f
(the)0 1441 y(diagnostic,)35 b(so)g(no)m(w)h(the)g(same)f(pro)s(cedure)
i(is)d(follo)m(w)m(ed)h(except)i(b)m(y)f(lo)s(oping)d(o)m(v)m(er)j(NQV)
-11 b(ALS)36 b(to)s(o,)0 1561 y(writing)30 b(the)i(v)-5
b(alue)31 b(to)g(QV)-11 b(ALNAM,)33 b(and)e(creating)g(CHA)-11
b(V)33 b(b)m(y)f(joining)e(CUPDO)m(WN,)i(NAM)g(and)0
1682 y(QV)-11 b(ALNAM)33 b(together.)0 2091 y Fp(NEWDUMP)0
2396 y Fw(Called)j(b)m(y:)113 b Fv(EXXIT)0 2517 y Fw(Calls:)e
Fv(-)146 2757 y(W)-8 b(rites)37 b(out)g(m)m(ultiple)e(mo)s(del)g(dump)i
(\014les,)i(one)e(for)f(eac)m(h)i(PE.)g(The)g(unit)f(n)m(um)m(b)s(er,)h
(NCHAN,)0 2878 y(is)k(determined)h(using)f(INDIC)h(whic)m(h)g
(indicates)f(whic)m(h)h(of)g(FILEA)g(or)f(FILEB)h(the)g(mo)s(del)e
(will)0 2998 y(write)f(to.)66 b(Firstly)-8 b(,)40 b(the)h
(non-distributed)e(parameters,)k(v)-5 b(ariables)38 b(and)j(1-D)e(arra)
m(ys)h(are)h(written)0 3118 y(to)35 b(NCHAN.)h(The)h(next)f(stage)f(is)
g(to)g(write)g(out)h(the)f(\014elds)h(distributed)f(o)m(v)m(er)h(all)e
(PEs.)53 b(Eac)m(h)36 b(PE)0 3239 y(writes)e(its)f(o)m(wn)h(\014elds)g
(to)f(its)g(o)m(wn)h(\014le,)g(lo)s(oping)d(o)m(v)m(er)k(the)f(n)m(um)m
(b)s(er)g(of)f(v)m(ertical)g(slices,)g(I)s(IPEP)-8 b(.)35
b(A)m(t)0 3359 y(the)c(end)h(of)e(the)h(routine,)g(INDIC)g(is)f(c)m
(hanged,)i(if)e(required,)i(and)f(written)f(to)h(FILEZ,)f(but)h(only)g
(on)0 3480 y(PE)i(0.)0 3889 y Fp(NEWRETR)0 4194 y Fw(Called)j(b)m(y:)
113 b Fv(BEGIN)0 4314 y Fw(Calls:)e Fv(EXXIT,)34 b(INDGA)-11
b(V,)32 b(SET0,)i(SETRAN)146 4555 y(Reads)42 b(in)e(m)m(ultiple)e(mo)s
(del)h(dump)i(\014les,)i(where)f(eac)m(h)f(\014le)g(is)f(sp)s(eci\014c)
h(for)g(eac)m(h)g(PE.)h(FILEZ)0 4675 y(is)37 b(op)s(ened)i(and)f(read)g
(to)g(determine)g(whic)m(h)g(of)g(FILEA)g(or)f(FILEB)i(the)f(latest)f
(dump)h(is)g(written)0 4796 y(to,)d(and)f(then)h(that)f(\014le)g(is)g
(op)s(ened)h(with)f(unit)g(n)m(um)m(b)s(er)g(NCHAN.)i(Initially)-8
b(,)31 b(the)k(parameters)f(are)0 4916 y(read)j(in)g(and)g(are)g
(compared)g(with)f(the)i(parameters)f(in)f(the)h(co)s(de.)58
b(If)37 b(they)h(di\013er)e(then)i(an)f(error)0 5037
y(\015ag,)31 b(L)p 277 5037 30 4 v 35 w(ERR)m(OR,)h(is)f(raised.)43
b(If)31 b(L)p 1300 5037 V 35 w(ERR)m(OR)g(is)g(true)h(at)f(the)h(end)g
(of)f(all)e(the)j(c)m(hec)m(ks)i(then)e Fw(EXXIT)0 5157
y Fv(is)38 b(called)g(with)g(ISTOPU=6.)63 b(Non-fatal)37
b(di\013erences)j(are)e(\015agged)h(up)g(with)g(a)f(w)m(arning)h
(written)0 5277 y(to)k(standard)h(out.)75 b(The)44 b(rest)g(of)f(the)h
(data)e(is)h(then)h(read)g(in,)h(including)c(the)j(lo)s(cal)d
(distributed)0 5398 y(\014elds)36 b(whic)m(h)h(are)f(read)g(in,)h(lo)s
(oping)c(o)m(v)m(er)38 b(the)e(n)m(um)m(b)s(er)h(of)e(slices,)i(I)s
(IPEP)-8 b(.)37 b(Before)g(the)f(timeseries)0 5518 y(are)g(read)g(in)f
(the)h(timeseries)g(arra)m(y)-8 b(,)37 b(SER,)f(is)f(set)i(equal)f(to)f
(zero)i(with)e(a)h(call)e(to)h Fw(SET0)h Fv(to)g(a)m(v)m(oid)0
5638 y(an)m(y)48 b(unde\014ned)h(v)-5 b(alues)48 b(in)e(the)i(arra)m(y)
-8 b(.)88 b(If)47 b(the)h(time-a)m(v)m(eraged)f(diagnostics)f(need)j
(to)e(b)s(e)g(reset)0 5759 y(\(ITIMRDG=1\))38 b(then)i
Fw(INDGA)-12 b(V)37 b Fv(is)h(called.)61 b(Finally)-8
b(,)38 b(after)g(all)f(the)i(data)g(is)f(read)h(in,)h(the)f(job)1841
6107 y(75)p eop
%%Page: 76 79
76 78 bop 0 52 a Fv(n)m(um)m(b)s(er,)33 b(NJOB,)f(is)f(incremen)m(ted,)
i(and)f(the)g(random)f(n)m(um)m(b)s(er)h(v)m(ectors)i(for)d(bac)m
(kscatter)j(reset)f(b)m(y)0 173 y(a)f(call)f(to)h Fw(SETRAN)p
Fv(.)0 582 y Fp(NNSTEPS)0 887 y Fw(Called)k(b)m(y:)113
b Fv(LES,)33 b(ST)-8 b(AR)g(T)0 1008 y Fw(Calls:)147
b Fv(SETRAN,)44 b(SETINDEX,)g(SETMOIST,)h(XWRAP)-8 b(,)44
b(CHGLS,)f(SETINDEX2,)k(SET-)0 1128 y(FLUX,)i(CHGLOOK,)h(CALCVIS,)h(D)m
(YNVIS,)f(BCKSCT,)h(BCTSCT,)h(BCQSCT,)f(DIVERR,)0 1248
y(PSR)m(CE,)35 b(CLASSCOL,)g(INDGNEW,)f(RESDGS,)g(SUBDGS,)f(STEPFLDS,)i
(REINDEX,)f(CAL-)0 1369 y(CBAR,)29 b(CVELGAL2,)h(POISSON,)g(PSTEP)-8
b(,)30 b(PDGS,)f(SW)-11 b(APSMTH,)31 b(GR)m(OUPDGS,)d(TIMSER,)0
1489 y(TESTCFL,)34 b(INITCFL,)g(EXXIT,)g(MAKINGMO)m(VIES,)g(A)-11
b(VDG,)32 b(TESTTIME)146 1730 y(Con)m(trol)42 b(routine)g(for)f(the)i
(in)m(tegration)e(of)h(the)g(mo)s(del)f(\014elds)i(and)f(the)h
(calculation)d(of)h(time-)0 1850 y(a)m(v)m(eraged)h(and)f(timeseries)f
(diagnostics.)67 b(The)41 b(structure)h(of)e Fw(NNSTEPS)g
Fv(is)g(sho)m(wn)i(in)e(Figs.)g(4)0 1971 y(and)35 b(5.)52
b(The)36 b(routine)f(has)h(t)m(w)m(o)g(main)e(lo)s(ops,)h(one)g(o)m(v)m
(er)i(the)f(n)m(um)m(b)s(er)f(of)g(timesteps,)h(NN,)g(\(the)g(N-)0
2091 y(lo)s(op\))26 b(and)i(an)g(inner)g(one)g(o)m(v)m(er)h(the)g(n)m
(um)m(b)s(er)f(of)g(v)m(ertical)f(slices)h(\(I)s(IPEP\))h(plus)f(halo)s
(es)f(\(the)h(I-lo)s(op\).)0 2211 y(Before)k(the)h(N-lo)s(op)d(a)i(few)
h(time)e(\015ags)h(are)g(set)h(up)g(\(TIMESTR)-8 b(T)34
b(and)e(ITIMEUP\))j(and)d(IFIRST,)0 2332 y(the)i(\014rst)f(v)m(ertical)
g(slice,)f(is)h(determined.)45 b(This)34 b(is)e(dep)s(enden)m(t)j(on)f
(the)f(c)m(hoice)h(of)e(bac)m(kscatter)j(and)0 2452 y(is)j(de\014ned)i
(as)f(IFIRSTP)-8 b(.)39 b(F)-8 b(or)38 b(2-D)f(runs)j(it)d(is)h(set)i
(to)e(1.)61 b(A)m(t)39 b(the)g(b)s(eginning)e(of)h(the)h(N-lo)s(op)e
(the)0 2573 y(L)p 67 2573 30 4 v 35 w(DODGS)f(\015ag)h(is)g(set,)j
(whic)m(h)d(indicates)g(whether)i(diagnostics)e(are)g(to)g(b)s(e)h
(calculated)e(\(usually)0 2693 y(at)c(N+NN\),)h(the)h(bac)m(kscatter)g
(random)e(n)m(um)m(b)s(er)h(v)m(ectors)h(are)f(reset)h(ev)m(ery)g
(second)g(step)g(b)m(y)g(a)e(call)0 2813 y(to)42 b Fw(SETRAN)p
Fv(,)g(and)h(the)g(indices)f(for)h(the)g(viscosit)m(y)-8
b(,)46 b(di\013usion,)e(bac)m(kscattered)h(energy)f(arra)m(ys)0
2934 y(\(VIS,)g(DIFF)e(and)h(DIS\))g(and)g(source)h(terms)f(\(SU)h
(etc\))f(are)g(initialised)d(in)i Fw(SETINDEX)p Fv(.)g(The)0
3054 y(saturation)h(functions)i(used)g(in)f(the)g(moist)f(Ric)m
(hardson)h(Num)m(b)s(er)h(calculations)d(are)i(set)i(in)d(the)0
3174 y(call)35 b(to)h Fw(SETMOIST)p Fv(,)h(the)g Fn(x)p
Fv(-direction)e(halo)s(es)h(put)h(in)f(place)g(for)g(all)f(the)i
(\014elds)f(b)m(y)i(the)f(call)e(to)0 3295 y Fw(XWRAP)c
Fv(and)h(time-v)-5 b(arying)30 b(large-scale)h(forcing)h(up)s(dated)h
(b)m(y)g(a)g(call)e(to)h Fw(CHGLS)p Fv(.)146 3536 y(The)k(I-lo)s(op)c
(o)m(v)m(er)j(the)g(v)m(ertical)f(slices)g(no)m(w)h(b)s(egins.)48
b(Firstly)-8 b(,)34 b(the)g(indices)g(for)g(the)h(main)d(prog-)0
3656 y(nostic)d(\014elds)h(are)g(up)s(dated)g(in)f Fw(SETINDEX2)p
Fv(.)41 b(If)29 b(time-v)-5 b(arying)27 b(surface)k(heat)f(\015uxes)h
(ha)m(v)m(e)g(b)s(een)0 3776 y(sp)s(eci\014ed)k(then)g(the)f(new)i(buo)
m(y)m(ancy)g(\015ux)f(is)e(calculated)h(in)f Fw(SETFLUX)h
Fv(and)h(the)f(lo)s(ok-up)f(table)0 3897 y(up)s(dated)41
b(b)m(y)h(calling)37 b Fw(CHGLOOK)p Fv(.)k(The)h(viscosities,)g
(di\013usivities)d(and)i(bac)m(kscatter)h(energies)0
4017 y(are)d(then)h(calculated)e(b)m(y)h(the)h(calls)e(to)g
Fw(CALCVIS)p Fv(.)h(Dep)s(ending)f(on)h(whether)h(forw)m(ard)f(or)g
(cen-)0 4138 y(tred)c(steps)h(ha)m(v)m(e)f(b)s(een)g(sp)s(eci\014ed,)h
Fw(CALCVIS)e Fv(is)g(called)f(using)h(the)h(curren)m(t)h(timestep)e
(\014elds)g(\(U)0 4258 y(etc\))g(or)g(previous)g(timestep)f(\014elds)h
(\(ZU)f(etc\).)48 b Fw(CALCVIS)33 b Fv(is)g(called)f(on)i(halo)e
(slices)i(as)g(they)g(are)0 4378 y(required)39 b(for)e
Fn(@)5 b(=@)g(x)40 b Fv(discretizations.)60 b(F)-8 b(or)37
b(the)i(main)d(lo)s(cal)g(slices)i(\(I)p Fn(>)p Fv(0\))g(routines)g
(are)g(called)f(to)0 4499 y(calculate)26 b(the)i(prognostic)f(v)-5
b(ariables)26 b(source)i(terms.)42 b(These)29 b(are)e
Fw(D)m(YNVIS)p Fv(,)f(whic)m(h)i(calculates)f(all)0 4619
y(the)39 b(tendencies)h(apart)e(from)f(the)i(pressure)i(gradien)m(t)d
(term)g(and)g(bac)m(kscatter,)k(and)d Fw(BCKSCT)p Fv(,)0
4739 y Fw(BCTSCT)e Fv(and)h Fw(BCQSCT)f Fv(whic)m(h)h(calculate)f(the)h
(bac)m(kscatter)h(terms)f(for)f(v)m(elo)s(cit)m(y)-8
b(,)38 b(p)s(oten)m(tial)0 4860 y(temp)s(erature)f(and)h(Q)f(resp)s
(ectiv)m(ely)-8 b(.)60 b(The)38 b(pressure)i(source)e(term)f(is)g
(calculated)g(in)g(the)h(routines)0 4980 y Fw(DIVERR)32
b Fv(and)j Fw(PSR)m(CE)p Fv(.)e(The)i(next)g(part)f(of)g(the)h(lo)s(op)
d(calculates)i(the)h(diagnostics)e(if)g(N=NN.)0 5101
y(Calls)d(to)h Fw(RESDGS)g Fv(and)g Fw(SUBDGS)p Fv(,)h(again)e(dep)s
(enden)m(t)j(on)e(the)h(time-stepping)e(option,)g(calcu-)0
5221 y(late)f(the)i(time-a)m(v)m(eraged,)g(sp)s(ectra)g(and)f
(conditionally-sampled)c(diagnostics,)k(the)h(former)f(mainly)0
5341 y(resolv)m(ed)39 b(\014elds,)h(and)e(the)g(latter)f(mostly)g
(subgrid)h(quan)m(tities.)59 b(The)39 b(prognostic)f(\014elds)g(are)g
(then)0 5462 y(stepp)s(ed)j(b)m(y)g(the)f(call)e(to)h
Fw(STEPFLDS)p Fv(.)i(The)f(\014elds)g(are)g(stepp)s(ed)h(t)m(w)m(o)g
(slices)e(b)s(ehind)h(the)g(lo)s(op)0 5582 y(coun)m(ter)f(as)f(I-2)g(v)
-5 b(alues)38 b(are)g(required)h(in)e(the)i(bac)m(kscatter)h
(calculations.)58 b(The)39 b(\014nal)e(step)i(of)f(the)0
5702 y(I-lo)s(op)33 b(is)h(to)g(reset)i(the)e(viscosit)m(y)-8
b(,)36 b(bac)m(kscatter)g(and)f(source)g(term)f(indices)h(for)f(the)h
(next)g(slice,)g(b)m(y)0 5823 y(calling)30 b Fw(REINDEX)p
Fv(.)1841 6107 y(76)p eop
%%Page: 77 80
77 79 bop 146 52 a Fv(Ha)m(ving)24 b(completed)g(the)g(in)m(tegration)f
(o)m(v)m(er)i(all)d(slices,)j(apart)f(from)f(the)h(pressure)i(gradien)m
(t)e(term,)0 173 y(the)j(horizon)m(tal)d(means)i(of)g(the)h(\014eld)f
(are)g(calculated)f(in)h Fw(CALCBAR)p Fv(,)f(or)h Fw(CBAR2D)e
Fv(if)h(2-D.)h(The)0 293 y(Couran)m(t)i(n)m(um)m(b)s(er)f(calculation)e
(is)h(completed)h(in)f Fw(CVELGAL2)p Fv(,)i(but)f(only)f(for)h(the)g
(\014rst)h(timestep)0 414 y(\(N=1\).)58 b(Next)39 b(the)f(pressure)i
(\014eld)d(is)g(calculated)g(in)g(the)h(call)e(to)h Fw(POISSON)h
Fv(and)g(the)g(v)m(elo)s(cit)m(y)0 534 y(\014elds)31
b(stepp)s(ed)h(with)e(the)h(pressure)h(gradien)m(t)e(term)g(b)m(y)i
(calling)27 b Fw(PSTEP)j Fv(lo)s(oping)e(o)m(v)m(er)k(I)s(IPEP)-8
b(.)31 b(In)0 654 y(the)k(same)g(lo)s(op)e(pressure)k(dep)s(enden)m(t)f
(diagnostics)e(are)h(calculated)f(in)g Fw(PDGS)p Fv(.)h(The)g
(diagnostics)0 775 y(are)27 b(then)g(summed)f(o)m(v)m(er)h(all)e(PEs)j
(in)d Fw(GR)m(OUPDGS)h Fv(and)h(the)g(timeseries)f(diagnostics)f
(calculated)0 895 y(in)40 b Fw(TIMSER)p Fv(.)f(The)j(next)f(step)g(is)f
(to)g(up)s(date)h(the)g(mo)s(del)e(step)i(\(NSTEP\),)h(time)d(\(TIME\))
i(and)0 1016 y(hour)28 b(and)f(da)m(y)h(v)-5 b(ariables)27
b(for)f(the)i(radiation)e(co)s(de.)42 b(A)m(t)28 b(this)f(p)s(oin)m(t)f
(the)i(CFL)g(criteria)e(is)h(c)m(hec)m(k)m(ed)j(in)0
1136 y(routine)c Fw(TESTCFL)p Fv(.)g(This)g(is)g(only)g(called)e(on)i
(the)h(\014rst)f(timestep)g(of)g(the)g(N-lo)s(op.)40
b(After)26 b(the)g(CFL)0 1256 y(criteria)g(has)i(b)s(een)h(c)m(hec)m(k)
m(ed)i(the)d(CFL)g(v)-5 b(ariables)26 b(are)i(reset)h(b)m(y)f(a)g(call)
e(to)h Fw(INITCFL)p Fv(.)h Fw(TESTCFL)0 1377 y Fv(calculates)k(a)g(new)
i(timestep,)e(DTMNEW.)i(If)e(this)g(exceeds)j(the)e(curren)m(t)h
(timestep,)e(DTM,)h(DTM)0 1497 y(is)k(adv)-5 b(anced)39
b(to)m(w)m(ards)g(DTMNEW)g(at)e(a)h(rate)f(RINCMAX.)i(If)f(DTMNEW)h(is)
e(less)h(than)g(DTM,)0 1617 y(then)26 b(DTM)f(is)g(set)h(to)f(DTMNEW)h
(immediately)-8 b(.)38 b(If)26 b(DTM)f(no)m(w)h(falls)e(b)s(elo)m(w)h
(a)g(sp)s(eci\014ed)h(minim)m(um)0 1738 y(v)-5 b(alue,)31
b(DTMMIN,)i(then)f Fw(EXXIT)e Fv(is)h(called)f(with)i(ISTOPU=12.)43
b(The)33 b(N-lo)s(op)c(is)j(completed)f(b)m(y)0 1858
y(a)h(call)f(to)h Fw(MAKINGMO)m(VIES)g Fv(if)f(animation)f(frames)i
(are)g(required.)146 2099 y Fw(NNSTEPS)21 b Fv(is)g(completed)g(b)m(y)i
(up)s(dating)e(the)h(time-a)m(v)m(eraged)f(diagnostics)g(in)g(routine)g
Fw(A)-12 b(VDG)0 2219 y Fv(and)31 b(then)g(testing)f(the)h(mo)s(del)e
(time)g(for)h(p)s(ossible)g(diagnostic)f(outputs,)j(job)e(end)h(or)f(a)
h(mo)s(del)d(halt.)0 2340 y(In)i(these)i(cases)f(the)g(\015ags)f
(ITIMHAL)-8 b(T,)32 b(ITIMDUM)f(and)g(ITIMPDG)f(are)h(c)m(hec)m(k)m(ed)
i(and)d Fw(EXXIT)0 2460 y Fv(called)h(with)i(the)g(appropriate)e(v)-5
b(alue)32 b(of)g(ISTOPU.)0 2869 y Fp(PDGS)0 3174 y Fw(Called)k(b)m(y:)
113 b Fv(NNSTEPS)0 3295 y Fw(Calls:)e Fv(-)146 3536 y(Calculates)22
b(the)g(time-a)m(v)m(eraged)f(diagnostics)g(whic)m(h)h(require)g
(pressure)i(or)d(the)h(pressure-stepp)s(ed)0 3656 y(\014elds.)53
b(P)m(erturbation)36 b(quan)m(tities)f(from)g(the)h(mean)f(for)g(U,)h
(V,)g(TH)g(and)g(Q)f(are)h(calculated)f(as)h(set)0 3776
y(as)g(UPR,)f(VPR,)h(THPR)g(and)g(QPR.)f(These)i(are)f(used)g(to)f
(calculate)g(the)h(pressure)h(terms)e(for)g(the)0 3897
y(v)m(elo)s(cit)m(y)e(and)f(scalar)g(\015ux)i(budgets.)45
b(Diagnostics)31 b(of)i(pressure)h(gradien)m(t)e(are)h(used)h(for)e
(the)h(condi-)0 4017 y(tionally)25 b(sampled)i(diagnostics,)g(and)h
(for)f(the)h(calculation)d(of)i(the)h(v)m(elo)s(cit)m(y)f(tendencies)i
(used)f(in)f(the)0 4138 y(TKE)40 b(budget.)65 b(The)41
b(resolv)m(ed)f(turbulen)m(t)g(kinetic)f(energy)-8 b(,)43
b(RESTKE,)d(is)f(also)g(calculated)g(here,)0 4258 y(using)32
b(the)h(pressure-stepp)s(ed)j(\014elds.)0 4667 y Fp(POISSON)0
4972 y Fw(Called)g(b)m(y:)113 b Fv(NNSTEPS)0 5093 y Fw(Calls:)e
Fv(FF)-11 b(ANAL,)33 b(FFSYNTH,)g(WRAP)-8 b(,)33 b(EQUA)-8
b(TE)146 5333 y(Calculates)31 b(the)h(pressure)i(\014eld)d(b)m(y)i
(solving)d(a)i(P)m(oisson-lik)m(e)f(elliptical)c(equation.)43
b(Before)32 b(solv-)0 5454 y(ing)39 b(the)i(equation,)h(the)f
(calculation)d(of)i(the)h(pressure)h(source)g(\(i.e.)e(the)g(righ)m(t)g
(hand)h(side)f(of)g(the)0 5574 y(elliptical)27 b(equation\))32
b(has)f(to)h(b)s(e)f(completed.)43 b(As)32 b(this)f(in)m(v)m(olv)m(es)h
(a)f Fn(@)5 b(=@)g(x)34 b Fv(term)d(of)g(the)h Fn(u)e
Fv(tendency)-8 b(,)0 5695 y(SU,)37 b(and)f(halo)s(es)g(of)g(SU)h(are)f
(not)g(a)m(v)-5 b(ailable)34 b(at)i(the)h(time)e(of)h(the)h(pressure)h
(source)g(calculation,)d(a)0 5815 y(partial)d(term)i(is)h(calculated)e
(on)i(the)g(adjacen)m(t)g(PE.)h(This)e(v)-5 b(alue)34
b(is)h(stored)g(in)f(the)h(I)s(IPEP+1)g(slice)1841 6107
y(77)p eop
%%Page: 78 81
78 80 bop 0 52 a Fv(and)28 b(these)i(are)e(passed)i(b)s(et)m(w)m(een)g
(the)f(PEs)g(using)f(GC)p 2034 52 30 4 v 35 w(RRECV)h(and)g(GC)p
2784 52 V 35 w(RSEND.)f(P)h(in)e(slice)h(I=1)0 173 y(is)37
b(incremen)m(ted)g(with)g(this)g(partial)e(v)-5 b(alue)37
b(to)g(complete)f(the)i(calculation.)55 b(Next,)39 b(the)f(maxim)m(um)0
293 y(div)m(ergence)i(error)f(is)g(calculated)f(and)h(written)g(out)g
(if)e(required.)64 b(This)39 b(in)m(v)m(olv)m(es)h(comparing)d(the)0
414 y(lo)s(cal)i(maxim)m(um)g(div)m(ergence)j(error,)i(DIVMAX,)d(sa)m
(v)m(ed)i(as)f(RLOCDIVMAX,)f(with)g(the)h(global)0 534
y(DIVMAX,)31 b(determined)f(b)m(y)i(GC)p 1270 534 V 35
w(RMAX,)f(and)f(if)f(the)i(t)m(w)m(o)g(v)-5 b(alues)31
b(are)f(iden)m(tical,)f(that)i(PEs)g(DIV-)0 654 y(MAX)k(lo)s(cation,)f
(in)g(ICOMAX,)i(is)e(passed)j(to)d(PE)i(0)e(for)h(writing)e(out)i(as)g
(the)g(co)s(ordinates)g(of)f(the)0 775 y(maxim)m(um)c(div)m(ergence)k
(error.)146 1016 y(The)26 b(pressure)g(source,)h(P)-8
b(,)24 b(is)g(horizon)m(tally)e(F)-8 b(ourier)23 b(transformed)h(in)f
(routine)h Fw(FF)-12 b(ANAL)24 b Fv(whic)m(h)0 1136 y(also)32
b(places)h(the)h(transformed)e(pressure)j(source)f(in)m(to)e(PT,)i(sw)m
(apping)g(the)f(I)g(and)g(J)g(indices)g(in)f(the)0 1256
y(pro)s(cess.)74 b(The)43 b(transformed)e(elliptical)e(equation)j(can)g
(then)h(b)s(e)f(solv)m(ed)h(through)f(a)g(tridiagonal)0
1377 y(solv)m(er.)85 b(The)47 b(Is)f(and)h(Js)f(used)i(in)d(the)h(solv)
m(er's)i(lo)s(ops)d(corresp)s(ond)i(to)e(w)m(a)m(v)m(en)m(um)m(b)s
(ers.)87 b(The)47 b(J)0 1497 y(w)m(a)m(v)m(en)m(um)m(b)s(er)30
b(lo)s(ops)c(from)g(JJPEMINP)k(to)d(JJPEMAXP)i(and)f(the)g(I)g(w)m(a)m
(v)m(en)m(um)m(b)s(er)h(from)e(IST)-8 b(AR)g(T)0 1617
y(to)30 b(IMAXP)-8 b(.)32 b(F)-8 b(or)29 b(3-D)h(runs)h(J)f(lo)s(ops)g
(from)f(0)h(to)h(JJPEP+1,)h(whilst)d(I)i(lo)s(ops)e(from)h(0)g(\(or)g
(2)g(for)g(zero)0 1738 y(w)m(a)m(v)m(en)m(um)m(b)s(er)36
b(case\))e(to)e(I)s(IP+1.)46 b(In)33 b(2-D)f(the)i(indices)f(in)f(PT)i
(are)f(not)g(sw)m(app)s(ed)i(and)e(J)h(no)m(w)f(lo)s(ops)0
1858 y(from)c(1)h(to)g(1,)h(and)f(I)g(from)f(0)h(to)g(JJP+1.)43
b(In)31 b(b)s(oth)f(cases)i(the)e(tridiagonal)d(solv)m(er)k(is)f
(parallelized)d(in)0 1979 y(the)33 b Fn(y)t Fv(-direction.)42
b(The)34 b(solv)m(er)f(pro)s(ceeds)h(b)m(y)f(lo)s(oping)e(up)m(w)m
(ards)j(through)f(all)e(the)i(mo)s(del)e(lev)m(els)i(for)0
2099 y(eac)m(h)28 b(w)m(a)m(v)m(en)m(um)m(b)s(er)h(pair,)e(and)g(then)h
(do)m(wn)g(again.)40 b(A)m(t)27 b(the)g(end)h(of)e(the)i(lo)s(op)d(a)i
(separate)g(co)s(de)h(deals)0 2219 y(with)33 b(the)h(sp)s(ecial)f(case)
i(of)e(the)h(zero)g(w)m(a)m(v)m(en)m(um)m(b)s(er.)49
b(On)34 b(completion)e(of)h(the)h(solv)m(er)g(PT)h(is)e(passed)0
2340 y(to)39 b Fw(FFSYNTH)h Fv(to)f(p)s(erform)g(an)g(in)m(v)m(erse)i
(F)-8 b(ourier)38 b(transform)h(and)h(to)f(place)g(the)h(data)g(bac)m
(k)g(in)0 2460 y(arra)m(y)29 b(P)h(with)f(the)g(I)h(and)f(J)h(indices)e
(sw)m(app)s(ed)j(bac)m(k.)44 b(P)29 b(at)g(this)g(stage)h(con)m(tains)f
(the)h(pressure)h(\014eld)0 2580 y(\()p Fn(p)87 2544
y Fi(0)110 2580 y Fn(=\032)209 2595 y Fe(s)246 2580 y
Fv(\).)146 2821 y(Finally)-8 b(,)30 b(P)i(is)f(wrapp)s(ed)h(in)f(the)i
Fn(y)h Fv(direction)d(b)m(y)i(the)f(call)e(to)h Fw(WRAP)f
Fv(and,)j(for)e(3-D)f(runs,)j(the)0 2942 y(I)s(IPEP+1)j(halo)e(is)g
(assigned,)i(either)f(b)m(y)h Fw(EQUA)-9 b(TE)34 b Fv(for)g(a)h(single)
f(PE)h(run,)h(or)f(message)h(passing)0 3062 y(for)d(an)g(MPP)h(run.)46
b(This)33 b(slice)g(of)g(P)g(is)g(required)h(for)e(calculating)f(the)j
(pressure)h(gradien)m(t)e(term)f(in)0 3182 y Fw(PSTEP)p
Fv(.)0 3592 y Fp(PRECDIA)l(G)0 3897 y Fw(Called)k(b)m(y:)113
b Fv(MICR)m(O)m(X)0 4017 y Fw(Calls:)e Fv(CLASSPRECIP)146
4258 y(Calculates)33 b(precipitation)f(diagnostics.)45
b(The)34 b(h)m(ydrometeor)g(fall)d(rate)j(for)e(the)i(w)m(ater)g(sp)s
(ecies,)0 4378 y(QDO)m(WNFLUX,)c(is)f(stored)h(in)f(F)-11
b(ALLQ)30 b(for)f(use)i(in)e(later)g(diagnostic)f(calculations,)h(and)h
(then)g(the)0 4499 y(surface)39 b(precipitation)d(rate,)j(PRECIP)-8
b(,)40 b(is)d(incremen)m(ted)i(for)f(this)f(w)m(ater)i(sp)s(ecies)g(b)m
(y)g(the)f(call)f(to)0 4619 y Fw(CLASSPRECIP)p Fv(.)0
5028 y Fp(PRECDIA)l(GSET)0 5333 y Fw(Called)f(b)m(y:)113
b Fv(MICR)m(O)m(X)0 5454 y Fw(Calls:)e Fv(CLASSSET)146
5695 y(Initialises)32 b(the)j(precipitation)d(diagnostic)g(arra)m(ys.)
49 b(F)-11 b(ALLQ,)34 b(whic)m(h)g(stores)h(the)g(h)m(ydrometeor)0
5815 y(fall)i(rate,)j(is)f(set)g(to)g(zero,)i(then)e
Fw(CLASSSET)g Fv(is)g(called)f(whic)m(h)h(p)s(erforms)f(a)h(similar)d
(op)s(eration)1841 6107 y(78)p eop
%%Page: 79 82
79 81 bop 0 52 a Fv(on)42 b(the)g(surface)g(precipitation)e(rate,)k
(PRECIP)-8 b(,)43 b(and)f(calculates)f(other)h(\014elds)g(required)g
(for)f(the)0 173 y(column)31 b(classi\014ed)i(diagnostics.)0
582 y Fp(PREPGRID)0 887 y Fw(Called)j(b)m(y:)113 b Fv(BEGIN)0
1008 y Fw(Calls:)e Fv(-)146 1248 y(Pro)s(cesses)40 b(the)f(namelist)c
(input)j(de\014ning)g(reference)h(and)f(initial)c(pro\014les)k(in)m(to)
f(arra)m(ys)h(whic)m(h)0 1369 y(can)h(b)s(e)g(used)i(for)d(in)m(terp)s
(olation)e(in)j Fw(INTERPIN)p Fv(.)d(INIT)p 2271 1369
30 4 v 36 w(READ)j(and)g(ZNI)p 2996 1369 V 35 w(READ)g(are)g(arra)m(ys)
0 1489 y(of)32 b(pro\014le)g(v)-5 b(alues)33 b(and)f(corresp)s(onding)h
(heigh)m(ts)g(read)g(in)e(from)h(the)h(namelists,)e(and)i(INITGD)f(and)
0 1609 y(ZNGD)45 b(are)h(the)g(output)g(v)-5 b(alues)46
b(and)h(heigh)m(ts)f(whic)m(h)g(can)h(b)s(e)f(in)m(terp)s(olated.)83
b(The)47 b(\014rst)f(v)-5 b(alue)0 1730 y(of)39 b(INITGD)h(is)g(set)g
(to)g(the)g(\014rst)h(v)-5 b(alue)39 b(of)g(INIT)p 1895
1730 V 36 w(READ)h(and)g(the)g(\014rst)h(v)-5 b(alue)39
b(of)h(ZNGD)e(set)j(to)0 1850 y(VER)-8 b(YLO)m(W,)29
b(a)f(large)f(negativ)m(e)i(v)-5 b(alue,)28 b(so)h(that)f(the)h
(pro\014le)e(v)-5 b(alues)28 b(at)g(all)f(heigh)m(ts)h(b)s(elo)m(w)g
(the)h(\014rst)0 1971 y(sp)s(eci\014ed)c(heigh)m(t)g(in)e(ZNI)p
952 1971 V 35 w(READ)i(will)d(b)s(e)j(INIT)p 1812 1971
V 36 w(READ\(1\).)40 b(Next,)27 b(lo)s(oping)22 b(with)i(coun)m(ter)i
(IN)e(o)m(v)m(er)0 2091 y(2)h(to)f(the)i(total)d(n)m(um)m(b)s(er)i(of)g
(p)s(ossible)f(v)-5 b(alues)25 b(\(NINITP\),)h(INITGD\(IN\))f(is)g(set)
g(to)g(INIT)p 3285 2091 V 36 w(READ\(IN-)0 2211 y(1\))44
b(and)h(ZNGD\(IN\))e(to)i(ZNI)p 1151 2211 V 35 w(READ\(IN-1\).)79
b(The)45 b(v)-5 b(alues)45 b(of)f(ZNGD)f(and)i(INITGD)f(are)h(then)0
2332 y(c)m(hec)m(k)m(ed)35 b(for)c(unset)h(v)-5 b(alues,)32
b(i.e.)f(those)h(ab)s(o)m(v)m(e)g(the)g(last)f(sp)s(eci\014ed)h(INIT)p
2728 2332 V 36 w(READ,)g(and)f(if)g(so)g(are)h(set)0
2452 y(to)h(the)h(top)f(INIT)p 682 2452 V 36 w(READ)g(and)h(a)f(heigh)m
(t)g(w)m(ell)f(ab)s(o)m(v)m(e)i(the)g(domain)e(top,)h(VER)-8
b(YHIGH,)34 b(to)f(ensure)0 2573 y(that)f(the)h(in)m(terp)s(olation)d
(is)i(carried)g(out)h(successfully)-8 b(.)0 2982 y Fp(PSR)l(CE)0
3287 y Fw(Called)36 b(b)m(y:)113 b Fv(NNSTEPS)0 3407
y Fw(Calls:)e Fv(WRAP)146 3648 y(Calculates)31 b(the)h(gradien)m(t)e
(of)h(the)h(v)m(elo)s(cit)m(y)f(tendencies)i(as)e(part)g(of)g(the)h
(pressure)h(source)f(term.)0 3768 y(The)d(pressure)h(source,)h(P)-8
b(,)28 b(already)g(con)m(tains)g(the)h(div)m(ergence)g(calculated)f(in)
f Fw(DIVERR)p Fv(,)f(and)j(this)0 3889 y(arra)m(y)41
b(is)f(incremen)m(ted)h(with)f(the)h(gradien)m(ts)f(of)g(SU,)h(SV)g
(and)g(SW,)g(the)g(v)m(elo)s(cit)m(y)f(source)h(terms.)0
4009 y(These)g(are)d(straigh)m(tforw)m(ard)h(discretizations,)g(except)
i(for)d Fn(@)5 b(=@)g(x)41 b Fv(of)d(SU.)i(SU)f(is)f(only)g(calculated)
0 4130 y(on)c(the)h(main)d(mo)s(del)h(slices)h(and)g(the)h(I=1)f
(pressure)i(source)f(calculation)d(requires)j(the)g(I=0)f(v)-5
b(alue)0 4250 y(of)33 b(SU.)i(T)-8 b(o)33 b(a)m(v)m(oid)h(message)g
(passing)g(at)g(this)f(stage)h(the)h(I=0)e(comp)s(onen)m(t)h(of)f(the)i
(pressure)g(source)0 4370 y(is)i(calculated)h(on)f(an)h(adjacen)m(t)h
(PE,)g(assigned)f(to)f(P\(I)s(IPEP+1\))j(and)e(then)g(passed)i(to)d
(complete)0 4491 y(the)28 b(calculation)d(in)i Fw(POISSON)p
Fv(.)h(This)g(means,)g(ho)m(w)m(ev)m(er,)j(that)d(to)f(ensure)i(repro)s
(ducibilit)m(y)d(across)0 4611 y(di\013eren)m(t)35 b(n)m(um)m(b)s(ers)g
(of)f(PEs)i(the)f(discretization)e(of)h(the)h Fn(@)5
b(=@)g(x)36 b Fv(SU)f(term)f(is)g(brok)m(en)h(to)f(mimic)e(the)0
4731 y(order)h(of)g(calculation)e(that)i(e\013ectiv)m(ely)h(o)s(ccurs)g
(on)f(the)h(I=1)f(slice.)45 b(Th)m(us,)35 b(there)f(is)f(a)g(sp)s
(ecial)g(case)0 4852 y(for)f(the)g(I=1)g(slice)g(in)f(whic)m(h)i(the)f
Fn(@)5 b(=@)g(x)34 b Fv(SU)f(term)f(is)f(only)h(partially)d(completed,)
j(and)h(for)e(the)i(2-D)0 4972 y(case,)h(for)e(whic)m(h)h(the)g
Fn(@)5 b(=@)g(x)34 b Fv(term)e(is)g(not)h(necessary)-8
b(.)0 5381 y Fp(PSTEP)0 5687 y Fw(Called)36 b(b)m(y:)113
b Fv(NNSTEPS)0 5807 y Fw(Calls:)e Fv(WRAP)1841 6107 y(79)p
eop
%%Page: 80 83
80 82 bop 146 52 a Fv(Adds)42 b(the)f(pressure)i(gradien)m(t)d(term)h
(to)f(the)h(stepp)s(ed)i(v)m(elo)s(cit)m(y)d(\014elds.)69
b(The)41 b(v)m(elo)s(cit)m(y)g(\014elds,)0 173 y(ZU,)30
b(ZV)g(and)h(ZW,)f(ha)m(v)m(e)i(already)e(b)s(een)i(stepp)s(ed)f(with)g
(the)f(other)h(dynamical)e(incremen)m(ts)i(at)f(this)0
293 y(stage,)42 b(and)d(the)h(addition)e(of)h(the)h(pressure)i(gradien)
m(t)d(term)g(completes)h(their)f(in)m(tegration.)63 b(The)0
414 y(Galilean)34 b(v)m(elo)s(cit)m(y)j(is)f(remo)m(v)m(ed)i(from)e
(U,V,ZU)h(and)g(ZV)g(at)g(the)g(b)s(eginning)f(of)g(the)i(routine,)f
(and)0 534 y(ZU,)44 b(ZV)g(and)g(ZW)g(incremen)m(ted)h(b)m(y)g(simple)d
(discretizations)h(of)h(the)h(pressure)h(gradien)m(t.)78
b(The)0 654 y(surface)33 b(b)s(oundary)g(conditions)f(for)g(ZU)g(and)h
(ZV)f(are)h(enforced)g(at)g(the)g(end)g(of)f(the)h(routine.)0
1064 y Fp(PWRAP)0 1369 y Fw(Called)j(b)m(y:)113 b Fv(DIA)m(G)0
1489 y Fw(Calls:)e Fv(EQUA)-8 b(TE)146 1730 y(Ensures)27
b(that)e(the)h(pressure)h(\014eld)e(halo)s(es)g(are)g(assigned)g(for)g
(diagnostics)f(output.)41 b(GC)p 3410 1730 30 4 v 36
w(RSEND)0 1850 y(and)22 b(GC)p 332 1850 V 36 w(RRECV)g(are)h(used)g(to)
f(pass)h(the)g(slices)f(b)s(et)m(w)m(een)i(PEs)g(to)e(set)h(up)f(the)h
(I=0)f(and)h(I=I)s(IPEP+1)0 1971 y(v)-5 b(alues)32 b(or,)h(if)e(it)h
(is)g(a)g(single)g(PE)h(run,)g Fw(EQUA)-9 b(TE)31 b Fv(is)h(used)i(for)
e(the)h(same)f(purp)s(ose.)0 2380 y Fp(QSOUR)l(CE)0 2685
y Fw(Called)k(b)m(y:)113 b Fv(D)m(YNVIS)0 2805 y Fw(Calls:)e
Fv(TVDSCAL,)34 b(EQUA)-8 b(TE)146 3046 y(Calculates)36
b(the)h(dynamical)e(tendency)j(terms)e(for)g(the)h(Q)f(\014elds)h(for)f
(a)g(3-D)f(run.)55 b(The)37 b(source)0 3166 y(terms)k(for)f(the)h(adv)m
(ection,)i(di\013usion,)e(damping)f(la)m(y)m(er)g(and)h(large-scale)e
(forcing)h(are)g(calculated)0 3287 y(for)j(eac)m(h)i(Q)f(\014eld,)i
(plus)e(an)g(adjustmen)m(t)g(for)f(an)m(y)i(negativ)m(e)f(h)m
(ydrometeor)g(con)m(ten)m(ts)i(that)e(ma)m(y)0 3407 y(ha)m(v)m(e)38
b(arisen)f(from)f(the)i(adv)m(ection)f(and)g(di\013usion)f(sc)m(hemes,)
k(and)d(added)h(to)f(SQ.)g(The)h(adv)m(ection)0 3528
y(is)h(dealt)h(with)f(\014rst.)66 b(If)40 b(the)g(UL)-8
b(TIMA)g(TE)42 b(adv)m(ection)e(sc)m(heme)h(has)g(b)s(een)f(requested)i
(for)e(scalars)0 3648 y(\(ITVDSCALP=1\))26 b(then)g(the)g(adv)m(ection)
f(term)g(is)g(calculated)f(and)h(assigned)h(to)f(SQ)g(in)f(the)i
(routine)0 3768 y Fw(TVDSCAL)p Fv(.)35 b(Alternativ)m(ely)-8
b(,)34 b(the)h(Piacsek-Williams)d(cen)m(tred)k(di\013erence)g(adv)m
(ection)f(sc)m(heme)h(is)0 3889 y(used.)75 b(The)43 b(discretization)e
(is)h(not)h(complex,)h(and)f(a)f(sp)s(ecial)g(case)h(is)f(used)i(for)e
(the)h(top)f(mo)s(del)0 4009 y(lev)m(el.)79 b(Di\013usion)42
b(uses)k(a)e Fm(r)1116 3973 y Fs(2)1200 4009 y Fv(op)s(erator)g(and,)j
(again,)f(this)e(is)g(straigh)m(tforw)m(ard.)78 b(DIFF)44
b(is)g(held)0 4130 y(on)34 b Fn(w)s Fv(-p)s(oin)m(ts)f(and)h(needs)i
(to)e(b)s(e)h(a)m(v)m(eraged)g(on)m(to)f(v)m(elo)s(cit)m(y)h(p)s(oin)m
(ts)e(for)h(the)h(correct)g(discretization.)0 4250 y(P)m(aren)m(theses)
44 b(are)c(used)i(to)f(ensure)h(symmetrical)c(calculations.)66
b(Again)40 b(the)h(top)g(mo)s(del)e(lev)m(el)h(is)0 4370
y(treated)49 b(separately)-8 b(.)91 b(The)50 b(damping)d(la)m(y)m(er)h
(in)m(v)m(olv)m(es)i(relaxing)d(the)i(\014eld)f(v)-5
b(alues)48 b(bac)m(k)i(to)e(the)0 4491 y(horizon)m(tal)f(mean.)92
b(F)-8 b(or)47 b(the)j(large-scale)d(forcing,)k(if)d(subsidence)j(is)d
(used)i(\(ISUBP=1\),)j(then)0 4611 y(v)m(ertical)23 b(adv)m(ection)g
(is)g(applied)f(to)h(the)h(horizon)m(tal)d(mean)i(\014elds;)k(for)c
(prescrib)s(ed)h(large-scale)e(forcing)0 4731 y(\(IF)m(OR)m(CEP=1\),)33
b(SQLS)g(is)f(added)i(to)e(SQ.)g(Finally)-8 b(,)30 b(the)j(v)-5
b(alues)33 b(for)f(Q)g(\014elds)h(represen)m(ting)h(w)m(ater)0
4852 y(sp)s(ecies)28 b(mixing)d(ratios,)i(are)g(c)m(hec)m(k)m(ed)j(to)d
(see)h(if)e(the)i(SQ)f(source)h(term)e(w)m(ould)h(mak)m(e)g(them)g
(negativ)m(e.)0 4972 y(If)i(so,)g(then)g(SQ)g(is)f(appropriately)f
(scaled)i(so)g(that)f(on)h(the)g(next)g(timestep)f(Q)h(will)d(remain)h
(p)s(ositiv)m(e.)0 5381 y Fp(Q1D)0 5687 y Fw(Called)36
b(b)m(y:)113 b Fv(D)m(YNVIS)0 5807 y Fw(Calls:)e Fv(-)1841
6107 y(80)p eop
%%Page: 81 84
81 83 bop 146 52 a Fv(Calculates)36 b(the)h(dynamical)e(tendency)j
(terms)e(for)g(the)h(Q)f(\014elds)h(for)f(a)g(1-D)f(run.)55
b(The)37 b(source)0 173 y(terms)48 b(are)g(di\013usion)f(and)i
(large-scale)d(forcing.)90 b(Only)48 b(the)g(v)m(ertical)g(comp)s(onen)
m(t)g(of)g(di\013usion)0 293 y(needs)d(to)f(b)s(e)g(considered.)79
b(F)-8 b(or)43 b(the)h(large-scale)f(forcing,)j(if)d(subsidence)i(is)f
(used)h(\(ISUBP=1\),)0 414 y(then)33 b(v)m(ertical)e(adv)m(ection)h(is)
f(applied)g(to)h(the)g(horizon)m(tal)e(mean)i(\014elds;)g(for)f
(prescrib)s(ed)i(large-scale)0 534 y(forcing)e(\(IF)m(OR)m(CEP=1\),)j
(SQLS)f(is)f(added)h(to)f(SQ.)0 943 y Fp(Q2D)0 1248 y
Fw(Called)k(b)m(y:)113 b Fv(D)m(YNVIS)0 1369 y Fw(Calls:)e
Fv(TVDSC2D,)33 b(EQUA)-8 b(TE)146 1609 y(Calculates)24
b(the)g(dynamical)f(tendency)j(terms)e(for)f(the)i(Q)f(\014elds)g(for)g
(a)f(2-D)g(run.)41 b(All)22 b Fn(@)5 b(=@)g(x)27 b Fv(terms)0
1730 y(are)j(assumed)g(to)f(b)s(e)h(zero.)43 b(The)30
b(source)h(terms)f(for)f(the)h(adv)m(ection,)g(di\013usion,)g(damping)e
(la)m(y)m(er)h(and)0 1850 y(large-scale)39 b(forcing)h(are)h
(calculated)f(for)g(eac)m(h)i(Q)e(\014eld,)j(plus)e(an)f(adjustmen)m(t)
i(for)e(an)m(y)h(negativ)m(e)0 1971 y(h)m(ydrometeor)i(con)m(ten)m(ts)h
(that)e(ma)m(y)g(ha)m(v)m(e)i(arisen)e(from)f(the)i(adv)m(ection)g(and)
f(di\013usion)g(sc)m(hemes,)0 2091 y(and)32 b(added)g(to)g(SQ.)g(The)h
(adv)m(ection)f(is)f(dealt)g(with)h(\014rst.)43 b(If)32
b(the)g(UL)-8 b(TIMA)g(TE)34 b(adv)m(ection)e(sc)m(heme)0
2211 y(has)23 b(b)s(een)h(requested)h(for)e(scalars)f(\(ITVDSCALP=1\))i
(then)g(the)f(adv)m(ection)g(term)g(is)f(calculated)g(and)0
2332 y(assigned)38 b(to)f(SQ)g(in)g(the)h(routine)f Fw(TVDSC2D)p
Fv(.)g(Alternativ)m(ely)-8 b(,)38 b(the)g(Piacsek-Williams)c(cen)m
(tred)0 2452 y(di\013erence)45 b(adv)m(ection)g(sc)m(heme)h(is)f(used.)
81 b(The)45 b(discretization)e(is)i(not)f(complex,)j(and)e(a)f(sp)s
(ecial)0 2573 y(case)g(is)f(used)i(for)e(the)h(top)f(mo)s(del)f(lev)m
(el.)76 b(Di\013usion)42 b(uses)j(a)e Fm(r)2495 2536
y Fs(2)2578 2573 y Fv(op)s(erator)g(and,)j(again,)f(this)e(is)0
2693 y(straigh)m(tforw)m(ard.)g(DIFF)31 b(is)g(held)h(on)f
Fn(w)s Fv(-p)s(oin)m(ts)g(and)h(needs)h(to)e(b)s(e)h(a)m(v)m(eraged)h
(on)m(to)f(v)m(elo)s(cit)m(y)g(p)s(oin)m(ts)0 2813 y(for)39
b(the)g(correct)h(discretization.)61 b(P)m(aren)m(theses)42
b(are)e(used)g(to)f(ensure)h(symmetrical)d(calculations.)0
2934 y(Again)32 b(the)h(top)g(mo)s(del)e(lev)m(el)h(is)g(treated)i
(separately)-8 b(.)44 b(The)34 b(damping)d(la)m(y)m(er)i(in)m(v)m(olv)m
(es)h(relaxing)d(the)0 3054 y(\014eld)g(v)-5 b(alues)31
b(bac)m(k)h(to)f(the)h(horizon)m(tal)d(mean.)43 b(F)-8
b(or)30 b(the)i(large-scale)d(forcing,)i(if)f(subsidence)j(is)d(used)0
3174 y(\(ISUBP=1\),)d(then)e(v)m(ertical)e(adv)m(ection)i(is)f(applied)
f(to)h(the)h(horizon)m(tal)e(mean)g(\014elds;)28 b(for)c(prescrib)s(ed)
0 3295 y(large-scale)33 b(forcing)g(\(IF)m(OR)m(CEP=1\),)j(SQLS)e(is)g
(added)h(to)f(SQ.)h(Finally)-8 b(,)32 b(the)j(v)-5 b(alues)34
b(for)g(Q)g(\014elds)0 3415 y(represen)m(ting)h(w)m(ater)f(sp)s(ecies)h
(mixing)c(ratios,)i(are)h(c)m(hec)m(k)m(ed)i(to)e(see)h(if)d(the)i(SQ)g
(source)g(term)g(w)m(ould)0 3536 y(mak)m(e)h(them)g(negativ)m(e.)51
b(If)35 b(so,)h(then)g(SQ)f(is)f(appropriately)g(scaled)h(so)h(that)f
(the)g(next)h(timestep)f(Q)0 3656 y(will)30 b(remain)h(p)s(ositiv)m(e.)
0 4065 y Fp(RAD)p 313 4065 41 4 v 48 w(INTERF)-15 b(A)l(CE)p
1151 4065 V 49 w(L)g(W)0 4370 y Fw(Called)36 b(b)m(y:)113
b Fv(RAD)p 836 4370 30 4 v 35 w(LEM)0 4491 y Fw(Calls:)e
Fv(ES)33 b(R)m(OUTINES,)h(EXXIT)146 4731 y(In)m(terfaces)e(the)f(Edw)m
(ards-Slingo)e(\(ES\))i(longw)m(a)m(v)m(e)f(radiation)e(sc)m(heme)k(to)
d(the)i(LEM.)g(This)f(rou-)0 4852 y(tine)d(is)h(only)f(compiled)f(in)i
(the)g(co)s(de)g(if)f(the)h(ESRAD)g(pre-compiler)e(option)h(is)g(used.)
43 b(The)29 b(v)-5 b(alues)28 b(of)0 4972 y(v)-5 b(ariables)25
b(used)j(in)d(the)i(ES)g(co)s(de)f(are)h(set)g(to)f(appropriate)f(v)-5
b(alues)26 b(for)g(the)h(run)g(and)f(the)h(ES)g(routines)0
5093 y(SET)p 196 5093 V 36 w(CLOUD)p 587 5093 V 35 w(PR)m(OP)32
b(and)f(FLUX)p 1390 5093 V 35 w(CALC)h(are)f(called.)42
b(Finally)-8 b(,)28 b(the)k(output)f(\015uxes,)i(FLUX)p
3611 5093 V 35 w(UP)0 5213 y(and)28 b(FLUX)p 462 5213
V 35 w(NET,)h(are)f(used)h(to)f(calculate)f(the)h(heating)g(rate)g(and)
g(set)h(LEM)f(diagnostic)f(arra)m(ys.)43 b(If)0 5333
y(the)30 b(error)g(\015ag,)g(IERR,)g(from)f(the)h(ES)g(co)s(de)g(is)g
(returned)g(with)g(an)g(abnormal)d(v)-5 b(alue)30 b(then)g
Fw(EXXIT)0 5454 y Fv(is)i(called)f(with)i(ISTOPU=11.)1841
6107 y(81)p eop
%%Page: 82 85
82 84 bop 0 52 a Fp(RAD)p 313 52 41 4 v 48 w(INTERF)-15
b(A)l(CE)p 1151 52 V 49 w(SW)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(RAD)p 836 358 30 4 v 35 w(LEM)0 478 y Fw(Calls:)e
Fv(ES)33 b(R)m(OUTINES,)h(EXXIT)146 719 y(In)m(terfaces)49
b(the)e(Edw)m(ards-Slingo)f(\(ES\))i(short)m(w)m(a)m(v)m(e)h(radiation)
c(sc)m(heme)j(to)e(the)i(LEM.)f(This)0 839 y(routine)d(is)g(only)g
(compiled)e(in)i(the)h(co)s(de)f(if)g(the)g(ESRAD)h(pre-compiler)d
(option)i(is)f(used.)81 b(The)0 959 y(v)-5 b(alues)34
b(of)f(v)-5 b(ariables)32 b(used)j(in)e(the)h(ES)h(co)s(de)f(are)f(set)
i(to)e(appropriate)g(v)-5 b(alues)34 b(for)f(the)h(run)g(and)g(the)0
1080 y(ES)24 b(routine)g(FLUX)p 749 1080 V 35 w(CALC)h(is)e(called.)39
b(Finally)-8 b(,)23 b(the)i(output)f(\015uxes,)j(FLUX)p
2863 1080 V 35 w(UP)d(and)g(FLUX)p 3513 1080 V 35 w(NET,)0
1200 y(are)38 b(used)h(to)e(calculate)f(the)j(heating)e(rate)g(and)h
(set)g(LEM)h(diagnostic)d(arra)m(ys.)59 b(If)38 b(the)g(error)g
(\015ag,)0 1321 y(IERR,)31 b(from)f(the)i(ES)g(co)s(de)f(is)g(returned)
h(with)f(an)h(abnormal)d(v)-5 b(alue)30 b(then)i Fw(EXXIT)e
Fv(is)h(called)f(with)0 1441 y(ISTOPU=11.)0 1850 y Fp(RAD)p
313 1850 41 4 v 48 w(LEM)0 2155 y Fw(Called)36 b(b)m(y:)113
b Fv(SET1D,)33 b(RADIA)-8 b(TION)0 2276 y Fw(Calls:)163
b Fv(SET0,)52 b(MER)m(GE)p 1128 2276 30 4 v 35 w(D)m(A)-8
b(T)g(A,)48 b(SEC)p 1700 2276 V 36 w(CALC,)h(RAD)p 2306
2276 V 34 w(INTERF)-11 b(A)m(CE)p 2915 2276 V 38 w(SW,)48
b(RAD)p 3402 2276 V 34 w(INTER-)0 2396 y(F)-11 b(A)m(CE)p
265 2396 V 36 w(L)g(W,)33 b(WRAP)-8 b(,)33 b(READ)p 1160
2396 V 35 w(L)-11 b(W)p 1345 2396 V 35 w(SPEC,)34 b(READ)p
1983 2396 V 35 w(SW)p 2172 2396 V 36 w(SPEC)146 2637
y(Pro)s(cesses)e(the)e(LEM)g(mo)s(del)e(\014elds)h(in)m(to)g(a)g(form)f
(whic)m(h)i(can)g(b)s(e)f(used)i(b)m(y)f(the)g(Edw)m(ards-Slingo)0
2757 y(\(ES\))25 b(radiation)c(sc)m(heme.)42 b(Calls)23
b(to)h(the)h(ES)f(routines)g(READ)p 2307 2757 V 35 w(L)-11
b(W)p 2492 2757 V 36 w(SPEC)25 b(and)g(READ)p 3277 2757
V 35 w(SW)p 3466 2757 V 35 w(SPEC,)0 2878 y(and)e(the)g(in)m(terface)g
(routines)g Fw(RAD)p 1351 2878 34 4 v 39 w(INTERF)-12
b(A)m(CE)p 2051 2878 V 38 w(SW)23 b Fv(and)g Fw(RAD)p
2725 2878 V 39 w(INTERF)-12 b(A)m(CE)p 3425 2878 V 38
w(L)g(W)22 b Fv(are)0 2998 y(protected)29 b(b)m(y)g(up)s(date)g(*IF)f
(DEF)f(ESRAD)i(statemen)m(ts)g(to)f(a)m(v)m(oid)g(p)s(oten)m(tial)e
(compilation)f(errors)k(if)0 3118 y(the)h(ES)g(sc)m(heme)h(is)e(not)g
(used.)44 b(A)m(t)29 b(the)h(b)s(eginning)e(of)h(eac)m(h)i(job)e(the)h
(sp)s(ectral)f(\014les)h(need)g(to)g(b)s(e)f(read)0 3239
y(in,)40 b(if)e(the)h(ES)h(sc)m(heme)g(is)e(used,)k(and)d(this)g(is)f
(done)i(if)d(the)j(argumen)m(t)e(ISETUP=1.)64 b(This)40
b(is)e(the)0 3359 y(only)31 b(action)g(the)h(routine)f(mak)m(es)h(in)f
(those)h(circumstances)h(and)e(after)h(calling)d(READ)p
3308 3359 30 4 v 35 w(L)-11 b(W)p 3493 3359 V 35 w(SPEC)0
3480 y(and)33 b(READ)p 482 3480 V 35 w(SW)p 671 3480
V 35 w(SPEC)h(a)e(RETURN)h(statemen)m(t)h(is)e(executed.)146
3720 y(The)d(\014rst)g(stage)f(for)f(the)i(usual)f(call)e(to)h(the)i
(routine)e(is)h(to)g(create)g(temp)s(erature,)h(w)m(ater)g(v)-5
b(ap)s(our,)0 3841 y(cloud)29 b(w)m(ater)i(and)f(cloud)f(ice)h(arra)m
(ys)h(whic)m(h)f(are)g(in)f(the)h(correct)h(units)e(for)h(the)g(ES)g
(co)s(de.)43 b(Absolute)0 3961 y(temp)s(erature)j(is)g(calculated)g
(from)f(THREF,)i(TH)g(and)f(the)h(Exner)h(function)e(and)g(assigned)h
(to)0 4081 y(TN.)g(The)g(w)m(ater)g(v)-5 b(ap)s(our,)49
b(liquid)44 b(cloud,)50 b(rain,)e(sno)m(w,)j(graup)s(el)45
b(and)i(cloud)e(ice)h(mixing)f(ratios)0 4202 y(are)c(assigned)h(to)f
(arra)m(ys)h(QV,)g(QL,)f(QR,)g(QS,)h(QG)f(and)g(QI)h(resp)s(ectiv)m
(ely)-8 b(,)45 b(and)c(then)h(con)m(v)m(erted)0 4322
y(in)m(to)37 b(sp)s(eci\014c)i(h)m(umidities.)59 b(Then)39
b(all)d(the)j(liquid)d(w)m(ater)j(and)f(all)e(the)j(frozen)g(w)m(ater)f
(is)g(placed)g(in)0 4443 y(the)f(QL)e(and)i(QI)f(arra)m(ys)g(resp)s
(ectiv)m(ely)-8 b(,)38 b(using)e(RAINF)-11 b(A)m(CA,)37
b(SNWF)-11 b(A)m(CA)38 b(and)e(GRAPF)-11 b(A)m(CA)37
b(to)0 4563 y(de\014ne)f(the)f(relativ)m(e)f(con)m(tributions)g(of)g
(rain,)g(sno)m(w)h(and)g(graup)s(el)f(to)g(the)h(e\013ectiv)m(e)g
(liquid)e(and)i(ice)0 4683 y(sp)s(eci\014c)28 b(h)m(umidities.)40
b(The)28 b(temp)s(erature,)h(v)-5 b(ap)s(our,)28 b(cloud)f(and)h(ice)f
(pro\014les)g(are)h(then)g(merged)f(with)0 4804 y(McClattc)m(hey)34
b(data)d(in)g(the)i(call)d(to)i Fw(MER)m(GE)p 1806 4804
34 4 v 39 w(D)m(A)-9 b(T)g(A)30 b Fv(to)i(giv)m(e)g(a)f(full)f
(atmospheric)i(pro\014le,)f(and)0 4924 y(the)44 b(surface)g(temp)s
(erature,)i(TSURFLOCAL,)d(is)g(set)h(dep)s(ending)g(on)f(the)g(b)s
(oundary)h(condition)0 5045 y(c)m(hosen.)h(The)33 b(longw)m(a)m(v)m(e)f
(and)g(short)m(w)m(a)m(v)m(e)i(incremen)m(ts,)f(STH)p
2328 5045 30 4 v 35 w(L)-11 b(W)32 b(and)g(STH)p 2931
5045 V 36 w(SW,)g(are)g(set)h(to)e(zero)0 5165 y(b)m(y)i
Fw(SET0)g Fv(calls)e(and)i(then)g(the)g(radiation)d(co)s(de)j(is)f
(called.)146 5406 y(F)-8 b(or)35 b(the)g(short)m(w)m(a)m(v)m(e)j(co)s
(de)e(the)f(solar)g(zenith)g(angle)f(has)i(to)f(b)s(e)g(calculated)f
(dep)s(ending)i(on)f(the)0 5526 y(latitude)22 b(and)i(time)e(of)h(da)m
(y)-8 b(.)41 b(This)24 b(is)f(ac)m(hiev)m(ed)i(through)e(the)h(routine)
f Fw(SEC)p 2817 5526 34 4 v 40 w(CALC)p Fv(.)h(LIT)g(indicates)0
5646 y(whether)34 b(short)m(w)m(a)m(v)m(e)g(radiation)c(is)i(inciden)m
(t,)g(and)g(if)f(so)h(the)h(alb)s(edo)e(is)h(calculated)f(and)h(the)h
(short-)0 5767 y(w)m(a)m(v)m(e)h(\015uxes)g(and)f(heating)e(rates)i
(calculated)e(through)i(the)f(call)f(to)h Fw(RAD)p 2843
5767 V 40 w(INTERF)-12 b(A)m(CE)p 3544 5767 V 37 w(SW)p
Fv(.)1841 6107 y(82)p eop
%%Page: 83 86
83 85 bop 0 52 a Fv(If)34 b(the)g(short)m(w)m(a)m(v)m(e)j(radiation)32
b(is)h(not)h(inciden)m(t)g(then)g(the)h(heating)e(rates)h(and)g
(\015uxes)i(are)e(set)h(equal)0 173 y(to)51 b(zero.)100
b(Longw)m(a)m(v)m(e)53 b(radiativ)m(e)d(heating)h(rates)h(and)f
(\015uxes)i(are)f(calculated)e(at)h(all)e(times,)56 b(if)0
293 y(IRADL)-11 b(WP=1,)40 b(b)m(y)g(the)f(call)e(to)h
Fw(RAD)p 1551 293 34 4 v 40 w(INTERF)-12 b(A)m(CE)p 2252
293 V 37 w(L)g(W)p Fv(.)39 b(Finally)-8 b(,)37 b(the)i(heating)f(rates)
h(are)0 414 y(assigned)f(to)f(STHRAD)g(and)g(the)h(\015uxes)h(stored)f
(in)f(the)g(v)-5 b(arious)37 b(arra)m(ys)h(used)g(for)f(the)h
(radiation)0 534 y(diagnostic)31 b(outputs.)0 943 y Fp(RADIA)-11
b(TION)0 1248 y Fw(Called)36 b(b)m(y:)113 b Fv(D)m(YNVIS)0
1369 y Fw(Calls:)e Fv(RAD)p 611 1369 30 4 v 35 w(LEM)146
1609 y(Determines)49 b(whether)h(to)e(recalculate)g(the)h(radiativ)m(e)
f(heating)g(rates)h(and)g(incremen)m(ts)g(the)0 1730
y(p)s(oten)m(tial)37 b(temp)s(erature)i(tendency)i(term,)g(STH,)f(with)
e(the)i(radiativ)m(e)e(heating)g(rate.)63 b(Radiation)0
1850 y(can)37 b(b)s(e)g(recalculated)f(at)h(\014xed)h(time)d(in)m(terv)
-5 b(als,)38 b(or)e(\014xed)i(timestep)f(in)m(terv)-5
b(als.)55 b(F)-8 b(or)36 b(a)h(\014xed)h(time)0 1971
y(in)m(terv)-5 b(al,)37 b(RAD)p 611 1971 V 35 w(INT)p
824 1971 V 36 w(TIME,)h(the)g(time)e(since)i(the)f(last)g(radiation)e
(call,)i(at)g(RAD)p 3169 1971 V 34 w(LAST)p 3461 1971
V 36 w(TIME,)0 2091 y(is)i(c)m(hec)m(k)m(ed)j(to)e(see)g(if)e(it)h
(exceeds)j(RAD)p 1544 2091 V 34 w(INT)p 1756 2091 V 36
w(TIME.)f(F)-8 b(or)39 b(a)g(\014xed)h(n)m(um)m(b)s(er)g(of)f(steps,)k
(NNRAD,)0 2211 y(then)38 b(the)g(n)m(um)m(b)s(er)f(of)g(mo)s(del)f
(steps,)k(NSTEPS,)f(is)e(c)m(hec)m(k)m(ed)k(to)c(see)h(if)e(it)h(is)f
(exactly)i(divisible)e(b)m(y)0 2332 y(NNRAD.)e(If)h(either)f(of)g
(these)i(tests)g(are)e(true)h(a)g(\015ag,)g(RAD)p 2297
2332 V 34 w(CALC,)h(is)e(raised)g(and)h Fw(RAD)p 3500
2332 34 4 v 39 w(LEM)0 2452 y Fv(is)e(called)f(to)h(calculate)f(new)i
(radiativ)m(e)e(heating)g(rates.)46 b(The)34 b(radiation)d(incremen)m
(t,)j(STHRAD,)f(is)0 2573 y(then)g(added)g(to)g(STH.)0
2982 y Fp(RECOMBINE)0 3287 y Fw(Called)j(b)m(y:)113 b
Fv(FF)-11 b(ANAL,)32 b(W)m(OUT2D,)h(W)m(OUTPV,)h(CB2DCALL)0
3407 y Fw(Calls:)111 b Fv(-)146 3648 y(Com)m(bines)28
b(a)f(distributed)f(\014eld)h(in)m(to)g(a)g(single)f(whole)h(domain)f
(\014eld)h(on)g(all)e(PEs.)43 b(Used)28 b(only)f(for)0
3768 y(2-D)j(MPP)j(runs.)44 b(Arra)m(y)32 b(BIG)g(is)f(the)h(\014eld)f
(o)m(v)m(er)i(the)f(whole)g(domain,)e(dimensioned)h(b)m(y)h(JJTOTP)-8
b(,)0 3889 y(and)41 b(arra)m(y)g(SMALL)g(is)f(the)h(distributed)f
(\014eld,)j(dimensioned)d(b)m(y)h(JJP)-8 b(.)42 b(BIG)e(is)g
(constructed)j(on)0 4009 y(PE)d(0)e(b)m(y)i(passing)f(SMALL)g(from)f
(eac)m(h)h(other)g(PE,)h(via)e(an)h(arra)m(y)g(TEMP)-8
b(,)40 b(and)f(assigning)f(it)g(to)0 4130 y(the)32 b(appropriate)f
(part)g(of)g(BIG.)h(Then)h(the)f(completed)f(BIG)g(is)g(passed)i(bac)m
(k)g(to)e(all)f(other)h(PEs)i(so)0 4250 y(that)f(the)h(whole)g(domain)e
(\014eld)h(is)g(a)m(v)-5 b(ailable)31 b(on)h(all)f(pro)s(cessors.)45
b(This)33 b(is)f(the)h(opp)s(osite)f(of)g(routine)0 4370
y Fw(DISTRIB)p Fv(.)0 4780 y Fp(REINDEX)0 5085 y Fw(Called)k(b)m(y:)113
b Fv(NNSTEPS)0 5205 y Fw(Calls:)e Fv(-)146 5446 y(Cycles)44
b(the)f(bac)m(kscatter,)k(viscosit)m(y)42 b(and)h(source)h(term)d
(indices)i(for)e(the)i(in)m(tegration)e(of)h(the)0 5566
y(next)k(v)m(ertical)e(slice.)80 b(The)46 b(I-1)f(slice)f(will)f(b)s
(ecome)i(the)g(I-2)g(slice)f(etc,)49 b(and)c(so)g(the)h(indices)e(are)0
5687 y(altered)37 b(to)h(re\015ect)h(this.)59 b(Eac)m(h)38
b(index)g(is)g(assigned)g(to)f(a)h(temp)s(orary)f(in)m(teger)g
(su\016xed)j(OL,)e(then)0 5807 y(the)h(new)g(v)-5 b(alues)38
b(are)g(assigned)g(b)m(y)h(setting)f(IDISIM1=IDISI0OL)g(\(new)h(I-1)f
(=)g(old)f(I\))h(etc.)61 b(The)1841 6107 y(83)p eop
%%Page: 84 87
84 86 bop 0 52 a Fv(exceptions)37 b(are)g(for)e(the)i(new)g(slice)f(b)s
(eing)f(brough)m(t)i(in)m(to)e(the)i(set)g(of)f(stored)h(slices,)g(e.g)
f(IDISIP2.)0 173 y(F)-8 b(or)41 b(these)i(cases,)i(these)f(are)d(set)i
(to)e(the)h(index)g(whic)m(h)h(is)e(lea)m(ving)g(the)h(set)g(of)g
(stored)g(slices,)i(i.e)0 293 y(IDISIP2=IDISIM2OL)33
b(\(new)h(I+2)e(=)g(old)g(I-2\).)0 702 y Fp(REQUA)-11
b(TE)0 1008 y Fw(Called)36 b(b)m(y:)113 b Fv(DIA)m(G)0
1128 y Fw(Calls:)e Fv(-)146 1369 y(Utilit)m(y)32 b(routine)i(whic)m(h)g
(sets)i(a)d(real)h(arra)m(y)-8 b(,)34 b(FLD1,)g(equal)f(to)h(the)h
(REAL)f(of)f(an)h(in)m(teger)g(arra)m(y)0 1489 y(of)e(same)h(size,)f
(IFLD.)0 1898 y Fp(RESDGS)0 2203 y Fw(Called)k(b)m(y:)113
b Fv(NNSTEPS)0 2324 y Fw(Calls:)e Fv(WRAP)-8 b(,)33 b(EXXIT)146
2565 y(Calculates)d(the)g(resolv)m(ed)h(time-a)m(v)m(eraged)f
(diagnostics,)f(the)i(conditionally-sampled)26 b(diagnos-)0
2685 y(tics)31 b(and)f(the)i(sp)s(ectra)f(diagnostics)f(.)43
b(Both)30 b(sets)i(of)e(diagnostics)g(are)h(assigned)g(to)f(DGNEW)h
(using)0 2805 y(the)39 b(indices)f(held)h(in)e(common)h(blo)s(c)m(k)g
(DGCNT)h(and)f(allo)s(cated)f(in)h Fw(ALLOCDGS)p Fv(.)h(Firstly)-8
b(,)39 b(di-)0 2926 y(agnostics)33 b(of)f(horizon)m(tal)f(means)i(are)f
(calculated.)43 b(Next)34 b(diagnostics)d(of)i(the)g(pro)s(ducts)g(of)f
(primed)0 3046 y(quan)m(tities)39 b(are)g(calculated.)63
b(These)40 b(require)g(the)g(p)s(erturbations)e(from)g(the)i(horizon)m
(tal)d(a)m(v)m(erage,)0 3166 y(and)26 b(these)h(are)f(calculated)f(as)i
(UPR,)f(VPR,)g(THPR)h(and)f(QPR.)g(The)h(p)s(erturbation)e(virtual)g(p)
s(oten-)0 3287 y(tial)k(temp)s(erature)j(\(required)f(to)h(determine)f
(whether)h(a)g(p)s(oin)m(t)e(is)h(p)s(ositiv)m(ely)g(buo)m(y)m(an)m
(t\),)i(THVPR,)0 3407 y(is)40 b(also)f(calculated.)65
b(Some)39 b(diagnostics,)j(suc)m(h)f(as)f(those)h(in)m(v)m(olv)m(ed)g
(in)e(the)i(calculation)c(of)j(shear)0 3528 y(pro)s(duction,)26
b(UW)-11 b(A,)26 b(UWB,)g(VW)-11 b(A)25 b(and)h(VWB,)f(are)g(not)g
(assigned)h(to)f(DGNEW)g(immediately)-8 b(,)23 b(but)0
3648 y(undergo)h(further)h(pro)s(cessing)f(in)g Fw(GR)m(OUPDGS)p
Fv(.)g(The)h(subgrid)f(stress)h(\015uxes)h(are)e(also)f(calculated)0
3768 y(in)33 b Fw(RESDGS)g Fv(to)g(get)h(consistency)h(with)e(slices)h
(and)f(time-lev)m(els.)45 b(The)35 b(\015ux)f(budget)g(diagnostics)0
3889 y(are)f(also)e(calculated)h(here.)146 4130 y(Next)k(the)f
(conditionally-sampled)c(diagnostics)j(are)h(calculated.)49
b(Logical)33 b(arra)m(ys,)j(indicating)0 4250 y(whic)m(h)45
b(partitions)e(ha)m(v)m(e)j(b)s(een)f(selected)h(b)m(y)f(the)g(user,)k
(are)44 b(assigned)h(at)f(the)h(b)s(eginning)e(of)h(the)0
4370 y(routine.)73 b(F)-8 b(or)42 b(eac)m(h)i(p)s(oin)m(t)e(scalars)h
(are)f(assigned)h(with)g(the)g(prop)s(erties)g(that)f(are)h(used)h(for)
e(the)0 4491 y(conditional)34 b(sampling,)h(and)i(these)h(are)e(then)h
(used)h(to)e(set)h(up)g(logicals)d(de\014ning)i(the)h(p)s(oin)m(t.)54
b(F)-8 b(or)0 4611 y(example,)42 b(L)p 486 4611 30 4
v 35 w(UP)f(indicates)f(an)h(ascending)f(p)s(oin)m(t,)i(L)p
2065 4611 V 35 w(DO)m(WN)f(a)f(descending)i(p)s(oin)m(t,)f(etc.)68
b(Then)0 4731 y(lo)s(oping)29 b(o)m(v)m(er)j(NUPDO)m(WN,)g(the)f(n)m
(um)m(b)s(er)h(of)f(conditionally)d(sampled)i(partitions,)g(L)p
3269 4731 V 35 w(UPD)m(WN)i(is)0 4852 y(set)d(to)f(true)h(or)f(false)g
(dep)s(ending)g(on)h(whether)g(the)g(p)s(oin)m(t)f(satis\014es)h(the)g
(criteria)d(for)i(that)g(partition.)0 4972 y(The)j(column)d
(classi\014cations)h(are)g(also)g(used)h(for)f(conditionally)e
(sampling)g(here.)44 b(The)30 b(v)-5 b(alues)30 b(from)0
5093 y(the)38 b(L)p 240 5093 V 35 w(UPWN)g(are)f(then)h(assigned)f(to)g
(L)p 1594 5093 V 35 w(UPD)m(WN4D)g(for)g(use)h(in)e Fw(PDGS)p
Fv(.)h(Finally)-8 b(,)36 b(the)h(actual)0 5213 y(diagnostics)31
b(are)h(calculated.)42 b(The)33 b(diagnostic)d(v)-5 b(alue)31
b(is,)h(in)f(general,)g(calculated)g(as)h(a)g(scalar,)f(but)0
5333 y(only)38 b(incremen)m(ted)h(to)f(DGNEW)h(if)e(L)p
1493 5333 V 35 w(UPD)m(WN)i(is)g(true.)61 b(Diagnostics)37
b(in)m(v)m(olving)h(eac)m(h)h(Q)g(\014eld)0 5454 y(are)33
b(p)s(erformed)f(o)m(v)m(er)h(a)g(separate)g(lo)s(op.)146
5695 y(The)38 b(\014nal)e(part)h(of)f(the)h(routine)g(in)m(v)m(olv)m
(es)g(calculating)e(the)i(sp)s(ectra)g(diagnostics.)56
b(An)37 b(in-line)0 5815 y(F)-8 b(ourier)46 b(transform)h(algorithm)d
(is)j(used.)89 b(It)47 b(lo)s(ops)g(o)m(v)m(er)h(the)g(w)m(a)m(v)m(en)m
(um)m(b)s(ers,)54 b(NU,)48 b(from)e(0)h(to)1841 6107
y(84)p eop
%%Page: 85 88
85 87 bop 0 52 a Fv(JJTOTP/2)28 b(in)f(whic)m(h)h(the)g(t)m(w)m(o)g(sp)
s(ectral)f(comp)s(onen)m(ts)h(are)g(calculated.)41 b(In)28
b(the)g(example)e(of)h(the)h(U)0 173 y(sp)s(ectra)33
b(these)h(are)e(ANU)h(and)g(BNU.)g(These)h(are)f(then)g(lo)s(op)s(ed)e
(o)m(v)m(er)i(the)g(n)m(um)m(b)s(er)g(of)f(grid)g(p)s(oin)m(ts,)0
293 y(J,)41 b(from)g(1)g(to)g(JJTOTP)-8 b(,)42 b(incremen)m(ting)e(ANU)
i(or)f(BNU,)h(for)f(the)g(U)h(sp)s(ectra)g(example,)h(with)e(a)0
414 y(cosine)i(factor,)i(CS,)f(or)f(a)f(sine)h(factor,)i(SN,)f(times)e
(the)h(U)g(\014eld)g(v)-5 b(alue.)74 b(The)44 b(sp)s(ectral)f(v)-5
b(alue)42 b(is)0 534 y(then)34 b(calculated)f(for)g(eac)m(h)h(w)m(a)m
(v)m(en)m(um)m(b)s(er)i(in)d(DGSPNEW)h(b)m(y)g(summing)e(the)i(squares)
h(of)e(the)h(t)m(w)m(o)0 654 y(comp)s(onen)m(ts,)f(ANU)g(and)g(BNU,)g
(and)f(m)m(ultiplying)e(b)m(y)j(an)g(appropriate)e(factor.)0
1064 y Fp(RETRIEVE)0 1369 y Fw(Called)36 b(b)m(y:)113
b Fv(BEGIN)0 1489 y Fw(Calls:)e Fv(EXXIT,)34 b(INDGA)-11
b(V,)32 b(SET0,)i(SETRAN)146 1730 y(Reads)i(in)f(the)h(single)e(mo)s
(del)g(dump)h(\014le.)52 b(FILEA,)36 b(FILEB)g(and)f(FILEZ)g(are)h(all)
d(op)s(ened)j(and)0 1850 y(the)g(con)m(ten)m(ts)h(of)d(FILEZ)h(read)h
(to)f(determine)g(the)g(unit)g(n)m(um)m(b)s(er,)h(NCHAN,)g(of)f(the)h
(latest)f(dump)0 1971 y(\014le.)42 b(Initially)-8 b(,)27
b(the)j(parameters)f(are)g(read)h(in.)42 b(These)31 b(are)e(compared)g
(with)g(the)h(parameters)f(in)g(the)0 2091 y(co)s(de.)54
b(If)36 b(they)h(di\013er)f(then)h(an)f(error)g(\015ag,)h(L)p
1743 2091 30 4 v 35 w(ERR)m(OR,)f(is)f(raised.)54 b(If)36
b(L)p 2790 2091 V 35 w(ERR)m(OR)g(is)g(true)g(at)g(the)0
2211 y(end)h(of)f(all)e(the)j(c)m(hec)m(ks)i(then)e Fw(EXXIT)e
Fv(is)h(called)f(with)h(ISTOPU=6.)56 b(Non-fatal)34 b(di\013erences)j
(are)0 2332 y(\015agged)27 b(up)g(with)g(a)g(w)m(arning)f(written)h(to)
g(standard)g(out.)42 b(The)28 b(rest)f(of)g(the)g(data)g(is)f(then)i
(read)f(in)f(up)0 2452 y(to)h(the)h(distributed)f(\014elds.)42
b(Before)27 b(the)h(timeseries)f(are)g(read)h(in)e(the)i(timeseries)f
(arra)m(y)-8 b(,)28 b(SER,)g(is)f(set)0 2573 y(equal)i(to)g(zero)h
(with)f(a)g(call)e(to)i Fw(SET0)g Fv(to)g(a)m(v)m(oid)g(an)m(y)h
(unde\014ned)h(v)-5 b(alues)30 b(in)e(the)i(arra)m(y)-8
b(.)42 b(If)30 b(the)f(time-)0 2693 y(a)m(v)m(eraged)g(diagnostics)e
(need)i(to)f(b)s(e)g(reset)h(\(ITIMRDG=1\))e(then)i Fw(INDGA)-12
b(V)26 b Fv(is)h(called.)41 b(Next,)30 b(the)0 2813 y(routine)c(lo)s
(ops)g(o)m(v)m(er)i(the)f(n)m(um)m(b)s(er)g(of)f(PES)i(\(NPR)m(OC\).)f
(I)s(IPEP)h(slices)f(of)f(the)h(mo)s(del)e(\014elds)i(are)g(then)0
2934 y(read)35 b(in)g(b)m(y)h(PE)g(NPR)m(OC-1.)51 b(After)35
b(reading)g(in,)g(eac)m(h)h(slice)e(is)h(sen)m(t)h(from)e(PE)i(NPR)m
(OC-1)f(to)g(the)0 3054 y(appropriate)27 b(PE)i(de\014ned)h(b)m(y)f
(the)g(lo)s(op)e(coun)m(ter,)j(NPE,)f(using)f(a)g(series)h(of)f(GC)p
2998 3054 V 35 w(RSEND)h(calls.)40 b(On)0 3174 y(pro)s(cessor)32
b(NPE)f(the)g(data)g(is)f(receiv)m(ed)i(b)m(y)g(equiv)-5
b(alen)m(t)30 b(GC)p 2264 3174 V 36 w(RRECV)h(calls.)41
b(Finally)-8 b(,)29 b(after)h(all)f(the)0 3295 y(data)k(is)g(read)h
(in,)f(the)h(job)f(n)m(um)m(b)s(er,)i(NJOB,)e(is)g(incremen)m(ted,)i
(and)e(the)h(random)f(n)m(um)m(b)s(er)h(v)m(ectors)0
3415 y(for)e(bac)m(kscatter)i(reset)g(b)m(y)f(a)g(call)e(to)h
Fw(SETRAN)p Fv(.)0 3824 y Fp(SEC)p 268 3824 41 4 v 49
w(CALC)0 4130 y Fw(Called)k(b)m(y:)113 b Fv(RAD)p 836
4130 30 4 v 35 w(LEM)0 4250 y Fw(Calls:)e Fv(ES)33 b(R)m(OUTINES)146
4491 y(Determines)d(the)g(solar)f(constan)m(t)i(and)f(solar)f(zenith)h
(angle)f(for)g(the)h(radiation)e(sc)m(heme.)44 b(It)30
b(uses)0 4611 y(t)m(w)m(o)42 b(Edw)m(ards-Slingo)f(\(ES\))h(radiation)d
(routines,)44 b(whic)m(h)e(are)g(protected)g(b)m(y)h(*IF)e(DEF,ESRAD)0
4731 y(to)35 b(a)m(v)m(oid)g(compilation)d(errors)j(when)i(the)e(ES)h
(sc)m(heme)g(is)f(not)g(used.)53 b(The)36 b(da)m(y)g(n)m(um)m(b)s(er)f
(and)h(y)m(ear)0 4852 y(are)f(input)f(in)m(to)g(SOLPOS,)h(whic)m(h)g
(returns)h(SCS)g(whic)m(h,)f(when)h(m)m(ultiplied)c(b)m(y)j(the)g
(default)f(solar)0 4972 y(constan)m(t,)d(DEFSOLC,)f(giv)m(es)g(the)g
(solar)e(constan)m(t,)k(SOL)p 2188 4972 V 35 w(CONST.)f(This)e(is)g
(follo)m(w)m(ed)g(b)m(y)i(a)e(call)f(to)0 5093 y(SOLANG)33
b(whic)m(h,)h(b)m(y)g(using)e(the)i(latitude,)e(longitude)f(and)j(lo)s
(cal)c(time)i(return)i(the)f(cosine)g(of)g(the)0 5213
y(solar)f(zenith)g(angle,)g(COSZ.)1841 6107 y(85)p eop
%%Page: 86 89
86 88 bop 0 52 a Fp(SET0)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(BEGIN,)33 b(UVW1D,)f(RAD)p 1645 358 30 4 v 35 w(LEM,)h(CBAR2D,)f
(SETLS)0 478 y Fw(Calls:)111 b Fv(-)146 719 y(Utilit)m(y)31
b(routine)h(whic)m(h)h(sets)h(the)f(input)f(arra)m(y)-8
b(,)33 b(FLD,)e(of)h(length,)h(LEN,)g(to)f(zero.)0 1128
y Fp(SET1D)0 1433 y Fw(Called)k(b)m(y:)113 b Fv(BEGIN)0
1553 y Fw(Calls:)107 b Fv(ALLOCDGS,)31 b(INTIMSER,)j(ALLOCQS,)e(EXXIT,)
g(INTERPIN,)h(SET0,)g(SET)-8 b(ANEL,)0 1674 y(SETPREF,)34
b(SETLOOK,)f(CALC)p 1338 1674 V 36 w(LEVS,)g(RAD)p 1908
1674 V 35 w(LEM,)g(SETFLUX)146 1915 y(Sets)d(up)g(1-D)e(arra)m(ys)h
(and)g(v)-5 b(arious)29 b(v)-5 b(ariables)28 b(and)h(constan)m(ts)h
(for)f(use)h(in)e(the)i(forthcoming)d(job.)0 2035 y(Firstly)-8
b(,)26 b(the)g(diagnostic)e(slots,)j(timeseries)d(slots)i(and)f(Q)h
(\014eld)f(indices)g(are)h(allo)s(cated)e(in)g(the)i(calls)f(to)0
2155 y Fw(ALLOCDGS)p Fv(,)j Fw(INTIMSER)f Fv(and)g Fw(ALLOCQS)i
Fv(resp)s(ectiv)m(ely)-8 b(.)42 b(F)-8 b(unctions)28
b(of)f(namelist)e(inputs)0 2276 y(and)42 b(ph)m(ysical)g(parameters)f
(are)h(set)h(up,)h(suc)m(h)f(as)f(F)p 2037 2276 V 35
w(ON)p 2221 2276 V 35 w(G,)f(functions)h(of)f(the)i(timestep,)g(time-)0
2396 y(smo)s(othing)34 b(factor)i(and)g(virtual)e(p)s(oten)m(tial)g
(temp)s(erature)i(co)s(e\016cien)m(ts)h(\(THCONA,)g(THCONB\).)0
2517 y(The)42 b(diagnostic)d(\015ags,)k(IDGTH,)d(IDGQ,)g(IDGSP)h(and)f
(IDGPD,)g(are)h(c)m(hec)m(k)m(ed)j(for)c(consistency)0
2637 y(with)h(the)h(parameters)g(and)f(reset)i(if)d(necessary)-8
b(,)46 b(and)c(defaults)f(of)g(IDGQ)g(and)h(IDGPD)e(are)i(set)0
2757 y(to)i(the)h(IDGQMR)p 741 2757 V 34 w(ALL,)g(IDGQNC)p
1448 2757 V 35 w(ALL)f(or)g(IDGPD)p 2181 2757 V 34 w(ALL)h(v)-5
b(alues)44 b(if)f(used.)80 b(The)46 b(c)m(hoices)f(of)0
2878 y(NITEST)40 b(and)e(NJTEST,)i(whic)m(h)e(de\014ne)h(the)g(n)m(um)m
(b)s(ers)g(of)e(2-D)g(diagnostic)g(slices)g(to)h(b)s(e)g(output)0
2998 y(are)f(also)f(c)m(hec)m(k)m(ed)k(against)c(the)h(dimensionalit)m
(y)d(of)j(the)g(mo)s(del)e(and)i(reset)h(as)f(appropriate.)56
b(The)0 3118 y(input)42 b(surface)i(\015uxes)g(are)f(set)h(to)e(zero)h
(if)f(no)h(surface)g(b)s(oundary)h(condition)d(has)i(b)s(een)h(applied)
0 3239 y(\(INOSURFP=1\).)146 3480 y(After)33 b(some)e(mo)s(del)g(v)-5
b(ariables)31 b(ha)m(v)m(e)i(b)s(een)g(written)f(to)g(standard)g(out,)h
(constan)m(ts)g(for)f(the)g(hor-)0 3600 y(izon)m(tal)k(grid)g(spacing)h
(are)h(set)g(up,)h(and)f(then)g(the)f(v)m(ertical)g(grid)f
(constructed.)60 b(This)38 b(is)f(done)h(b)m(y)0 3720
y(simple)29 b(linear)g(in)m(terp)s(olation)e(b)s(et)m(w)m(een)33
b(the)e(sp)s(eci\014ed)g(grid)f(v)-5 b(alues)30 b(in)g(K)m(GD)f(and)i
(HGD,)e(and)i(then)0 3841 y(smo)s(othed)f(o)m(v)m(er)h(NSMTH)g(passes.)
45 b(Finally)27 b(a)j(fourth)g(order)g(in)m(terp)s(olation)e(is)h(used)
j(to)d(set)i(the)g(ZN)0 3961 y(v)-5 b(alue)33 b(from)g(the)h(Z)f(v)-5
b(alue.)47 b(The)35 b(v)m(ertical)e(grid)g(spacing)g(arra)m(ys)i(are)e
(constructed)j(and)e Fw(EXXIT)e Fv(is)0 4081 y(called)c(with)h
(ISTOPU=7)i(if)d(a)h(negativ)m(e)h(v)m(ertical)f(grid)f(spacing)h(is)g
(encoun)m(tered.)45 b(Next)30 b(the)g(initial)0 4202
y(pro\014les)i(of)f(U,)h(V,)f(TH)h(and)g(Q)g(\(UINIT,)g(VINIT,)h
(THINIT)g(and)f(QINIT\))g(are)g(calculated,)f(if)f(indi-)0
4322 y(cated)j(b)m(y)g(the)f(logicals)d(L)p 970 4322
V 35 w(INITU,)34 b(L)p 1413 4322 V 35 w(INITV,)f(L)p
1855 4322 V 35 w(INITTH)g(and)g(L)p 2530 4322 V 35 w(INITQ.)g(These)g
(are)f(calculated)0 4443 y(b)m(y)j(linear)c(in)m(terp)s(olation)g(in)i
Fw(INTERPIN)e Fv(if)i(the)h(switc)m(h)g(is)f(true,)h(or)g(set)g(to)f
(zero)h(with)f(a)h Fw(SET0)0 4563 y Fv(call)d(if)g(the)i(switc)m(h)h
(is)e(false.)146 4804 y(The)24 b(next)f(stage)g(of)g(the)g(routine)f
(is)g(to)g(set)h(up)g(the)h(reference)g(pro\014les)e(of)h(p)s(oten)m
(tial)d(temp)s(erature,)0 4924 y(densit)m(y)49 b(and)f(pressure.)91
b(The)48 b(reference)i(p)s(oten)m(tial)c(temp)s(erature,)51
b(THREF,)e(is)e(set)h(b)m(y)h(linear)0 5045 y(in)m(terp)s(olation)25
b(of)j(THREF)m(GD)f(and)h(ZNREF)m(GD)f(if)g(the)h(run)g(is)g(anelastic)
e(\(IANELP=1\),)k(whereas)0 5165 y(if)46 b(the)i(run)g(is)f(Boussinesq)
i(\(IANELP=0\),)j(it)47 b(is)g(simply)f(set)i(to)g(the)g(constan)m(t)g
(THREF0.)89 b(If)0 5285 y(THINIT)41 b(hasn't)f(b)s(een)g(set)g
(previously)-8 b(,)41 b(it)e(is)g(then)h(set)g(to)f(THREF)h(b)m(y)g
(default.)63 b(The)41 b(pressure)0 5406 y(and)28 b(densit)m(y)i
(reference)g(pro\014les,)f(PREFN)g(and)f(RHO/N)g(are)g(set)i(in)d(the)i
(calls)e(to)h Fw(SET)-9 b(ANEL)27 b Fv(for)0 5526 y(anelastic)36
b(or)h Fw(SETPREF)e Fv(if)h(Boussinesq.)59 b(RHO/N)36
b(is)h(set)g(to)g(RHOBOUS)g(in)f(the)i(latter)d(case,)0
5646 y(or)c(if)e(TH)j(not)e(used.)44 b(The)32 b(v)m(ertical)e
(di\013erence)i(in)e(THREF,)h(DTHREF,)g(is)g(also)f(set)h(at)g(this)f
(p)s(oin)m(t.)1841 6107 y(86)p eop
%%Page: 87 90
87 89 bop 146 52 a Fv(More)32 b(1-D)e(arra)m(ys)i(are)g(set)g(up,)g
(including)d(the)j(D)f(and)h(E)f(arra)m(ys,)i(whic)m(h)f(con)m(tain)f
(the)h(trigono-)0 173 y(metric)40 b(functions)g(used)i(for)e(the)h
(tridiagonal)d(solv)m(er)j(in)f Fw(POISSON)p Fv(,)g(arra)m(ys)h
(holding)e(the)j(grid)0 293 y(spacing)33 b(used)i(in)e(the)h(bac)m
(kscatter)h(calculations,)d(follo)m(w)m(ed)h(b)m(y)h(all)d(the)j
(functions)g(of)f(densit)m(y)h(and)0 414 y(grid-spacing)24
b(used)i(in)f(the)h(v)m(ertical)e(discretization)g(of)h(the)h(mo)s(del)
e(equations.)41 b(The)27 b(mixing)c(length,)0 534 y(RNEUTML,)31
b(and)e(its)g(square,)i(RNEUTML)p 1722 534 30 4 v 37
w(SQ,)e(are)h(calculated,)f(along)f(with)h(the)h(buo)m(y)m(ancy)h(co-)0
654 y(e\016cien)m(t)g Fn(g)t(=\022)503 669 y Fe(s)539
654 y Fv(,)f(whic)m(h)h(is)e(made)h(consisten)m(t)g(with)g(the)g
(reference)i(thermo)s(dynamic)c(pro\014les)i(for)f(the)0
775 y(anelastic)g(case.)44 b(The)31 b(geostrophic)f(wind)g(arra)m(ys,)i
(UG)e(and)g(V)m(G,)g(are)g(set)h(up)g(and)f(the)h(Exner)g(func-)0
895 y(tion)i(arra)m(ys,)j(PREFR)m(CP)f(and)f(RPREFR)m(CP)-8
b(,)36 b(and)e(the)h(reference)h(temp)s(erature)e(pro\014le,)g(TREF.)0
1016 y(If)27 b(it)f(is)h(a)g(set-up)g(run)h(the)f(saturation)g
(functions)g(are)g(calculated)f(for)h(use)h(in)e(the)i(moist)d(Ric)m
(hardson)0 1136 y(n)m(um)m(b)s(er)33 b(calculations)e(\(these)i(will)e
(b)s(e)i(o)m(v)m(erridden)g(in)f Fw(SETMOIST)p Fv(\).)h(Next)g(the)g
(damping)e(la)m(y)m(er)0 1256 y(co)s(e\016cien)m(ts,)48
b(DMPCO/Z,)43 b(are)h(calculated,)h(and)f(grid)e(and)i(reference)h
(pro\014le)e(data)g(written)h(to)0 1377 y(standard)33
b(out.)146 1617 y(The)k(next)f(section)g(of)e(the)i(routine)f(concen)m
(trates)i(on)f(setting)f(up)h(v)-5 b(ariables)34 b(and)h(arra)m(ys)h
(used)0 1738 y(with)d(the)g(surface)h(b)s(oundary)f(condition.)44
b(F)-8 b(unctions)32 b(of)h(the)g(roughness)i(lengths,)e(Z0)f(and)h
(Z0TH,)0 1858 y(along)j(with)g(the)i(V)-8 b(on)37 b(Karman)f(constan)m
(t,)j(VK,)e(are)g(set)h(up.)57 b(If)37 b(prescrib)s(ed)h(surface)g
(heat)f(\015uxes)0 1979 y(are)43 b(used)h(\(ISCBCP=1\))g(then)f(the)h
(input)e(energy)i(\015uxes)g(are)f(con)m(v)m(erted)i(to)e(temp)s
(erature)f(and)0 2099 y(moisture)g(\015uxes)j(\(FTH)f(and)g(F)m(Q\))f
(whic)m(h,)j(in)d(turn,)k(are)c(used)i(to)e(construct)h(a)f(buo)m(y)m
(ancy)j(\015ux)0 2219 y(\(FBUO)m(Y\).)39 b(The)h(lo)s(ok-up)e(table)h
(for)g(solving)f(the)h(surface)h(relationships)e(deriv)m(ed)i(from)e
(Monin-)0 2340 y(Obukho)m(v)30 b(similarit)m(y)25 b(theory)k(is)f(then)
h(constructed)h(in)d Fw(SETLOOK)p Fv(.)i(F)-8 b(or)28
b(the)g(prescrib)s(ed)i(surface)0 2460 y(temp)s(erature)22
b(case)h(\(ISCBCP=2\))g(the)g(surface)g(temp)s(erature)f(and)g(surface)
h(moisture,)g(TSURF)f(and)0 2580 y(QSURF,)28 b(are)h(calculated)f
(along)f(with)h(the)h(surface)h(virtual)d(p)s(oten)m(tial)g(temp)s
(erature,)i(THVSURF.)0 2701 y(F)-8 b(or)38 b(the)i(time-v)-5
b(arying)37 b(surface)j(b)s(oundary)f(condition)f(\(IFBCHGP=1\),)j
Fw(SETFLUX)e Fv(is)g(called)0 2821 y(to)g(retriev)m(e)h(the)g(curren)m
(t)g(surface)h(v)-5 b(alues.)64 b(V)-8 b(arious)38 b(constan)m(ts)j
(used)f(in)f(the)h(iterativ)m(e)f(solutions)0 2942 y(in)45
b Fw(MOSTBC)h Fv(are)f(also)g(assigned)h(at)f(this)g(p)s(oin)m(t.)82
b(Finally)-8 b(,)46 b(arra)m(ys)g(used)h(in)d(the)i(w)m(arm)g(rain)0
3062 y(microph)m(ysics)37 b(are)f(set)i(up)f(and)g(the)g(radiation)d
(sp)s(ectral)j(\014les)f(read)h(in)f(b)m(y)i(the)f(\\dumm)m(y")f(call)f
(to)0 3182 y Fw(RAD)p 262 3182 34 4 v 39 w(LEM)p Fv(.)0
3592 y Fp(SET)-11 b(ANEL)0 3897 y Fw(Called)36 b(b)m(y:)113
b Fv(SET1D)0 4017 y Fw(Calls:)e Fv(EXXIT)146 4258 y(Calculates)36
b(the)g(reference)i(state)f(pressure)h(and)e(densit)m(y)h(for)f(the)g
(anelastic)f(case.)56 b(The)37 b(refer-)0 4378 y(ence)31
b(pressure,)h(PREFN,)e(is)f(determined)h(from)e(the)i(reference)i(p)s
(oten)m(tial)c(temp)s(erature,)i(THREF,)0 4499 y(using)41
b(the)h(univ)m(ersal)f(gas)h(la)m(w)f(and)h(the)g(h)m(ydrostatic)f
(appro)m(ximation.)68 b(After)42 b(some)f(manipula-)0
4619 y(tion,)d(this)g(giv)m(es)g Fn(d=dz)t Fv(\()p Fn(p)961
4634 y Fe(s)997 4619 y Fn(=p)1095 4634 y Fs(0)1134 4619
y Fv(\))1172 4583 y Fs(\()p Fe(r)r(=c)1299 4591 y Fd(p)1336
4583 y Fs(\))1404 4619 y Fv(=)e Fm(\000)p Fn(g)t(=)p
Fv(\()p Fn(c)1773 4634 y Fe(p)1812 4619 y Fn(\022)1857
4634 y Fe(s)1894 4619 y Fv(\))i(where)h Fn(p)2306 4634
y Fe(s)2381 4619 y Fv(is)e(PREFN,)h Fn(\022)2935 4634
y Fe(s)3010 4619 y Fv(is)f(THREF)h(and)g Fn(p)3740 4634
y Fs(0)0 4739 y Fv(is)h(the)h(reference)h(surface)f(pressure,)j(PSFR.)c
(This)h(is)f(solv)m(ed)h(in)e(t)m(w)m(o)i(passes.)66
b(Initially)-8 b(,)38 b(the)i(top)0 4860 y(lev)m(el)c(pressure,)j(PTOP)
-8 b(,)37 b(is)f(set)h(to)f(zero.)54 b(A)m(t)37 b(\014rst)g(PREFN)f
(represen)m(ts)j(\()p Fn(p)2884 4875 y Fe(s)2920 4860
y Fn(=p)3018 4875 y Fs(0)3058 4860 y Fv(\))3096 4824
y Fs(\()p Fe(r)r(=c)3223 4832 y Fd(p)3259 4824 y Fs(\))3290
4860 y Fv(,)f(the)e(Exner)0 4980 y(function,)29 b(and)g(PDIFF)e
(calculates)h(the)h(di\013erence)g(in)f(this)g(expression)i(at)e(eac)m
(h)i(mo)s(del)d(lev)m(el)h(using)0 5101 y(the)36 b(righ)m(t)f(hand)i
(side)e(of)h(the)g(original)d(equation.)53 b(PREFN)36
b(is)f(then)i(constructed)g(b)m(y)g(in)m(tegrating)0
5221 y(PDIFF)f(o)m(v)m(er)j(the)e(mo)s(del)f(lev)m(els,)i(and)f(then)h
(con)m(v)m(erted)i(to)c(pressure,)41 b(b)m(y)d(m)m(ultiplying)33
b(b)m(y)39 b(PSFR)0 5341 y(and)33 b(taking)e(to)i(the)g(in)m(v)m(erse)h
(p)s(o)m(w)m(er)f(of)f(\()p Fn(R)q(=c)1700 5356 y Fe(p)1740
5341 y Fv(\),)g(R)p 1915 5341 30 4 v 35 w(ON)p 2099 5341
V 35 w(CP)-8 b(.)146 5582 y(After)49 b(the)g(\014rst)h(pass)f(the)g
(basic)g(state)g(is)f(adjusted)i(so)f(that)g(the)g(sp)s(eci\014ed)g
(surface)h(pres-)0 5702 y(sure,)h(PSF,)c(will)d(equal)i(the)h(surface)g
(pressure,)52 b(P0,)e(diagnosed)d(from)e(PREFN.)i(The)g(metho)s(d)0
5823 y(emplo)m(y)m(ed)29 b(to)g(do)g(this)g(dep)s(ends)i(on)e(the)h(c)m
(hoice)g(of)e(IADJANELP)-8 b(.)30 b(IF)f(IADJANELP=2)h(then)g(this)1841
6107 y(87)p eop
%%Page: 88 91
88 90 bop 0 52 a Fv(is)24 b(ac)m(hiev)m(ed)j(b)m(y)e(altering)e(THREF)j
(b)m(y)f(a)g(v)-5 b(alue)24 b(THF)-11 b(A)m(CTOR)26 b(calculated)e(to)h
(ensure)h(P0=PSF.)f(F)-8 b(or)0 173 y(IADJANELP=4)36
b(PTOP)h(is)f(adjusted)g(so)h(that)e(P0=PSF,)h(just)h(b)m(y)f(setting)g
(it)f(to)g(the)i(di\013erence)0 293 y(b)s(et)m(w)m(een)43
b(P0)f(and)f(PSF.)h(If)f(a)g(negativ)m(e)h(PTOP)g(is)f(encoun)m(tered)i
(then)f Fw(EXXIT)e Fv(is)h(called)f(with)0 414 y(ISTOPU=8.)66
b(The)41 b(second)g(pass)g(is)e(then)i(carried)e(out,)j(and)e(PREFN)g
(assigned)g(with)g(the)g(\014nal)0 534 y(reference)j(state)e(pressure.)
72 b(Finally)-8 b(,)40 b(the)i(densit)m(y)-8 b(,)44 b(RHO/N,)d(is)g
(calculated)f(from)g(PREFN)h(and)0 654 y(THREF)33 b(using)f(the)h(univ)
m(ersal)g(gas)f(la)m(w.)0 1064 y Fp(SETDIA)l(GS)0 1369
y Fw(Called)k(b)m(y:)113 b Fv(BEGIN)0 1489 y Fw(Calls:)e
Fv(EXXIT,)34 b(ALLOCSP)146 1730 y(Sp)s(eci\014es)d(the)g(lev)m(els)g
(for)e(the)i(2-D)e(diagnostic)g(slices)h(and)g(sp)s(ectra)h(lev)m(els.)
43 b(The)31 b(inputs)g(are)f(the)0 1850 y(n)m(um)m(b)s(er)c(of)e
(slices)h(\(NITEST,)i(NJTEST)g(and)f(NKTEST\))g(and)f(the)h(p)s
(ositions)e(in)g(metres)i(\(XTEST,)0 1971 y(YTEST)k(and)f(ZTEST\).)h(F)
-8 b(or)28 b(the)h(horizon)m(tal)e(directions)h(the)i(grid)d(p)s(oin)m
(t)h(nearest)i(to)e(the)i(sp)s(eci\014ed)0 2091 y(XTEST)40
b(or)e(YTEST)i(is)d(determined.)61 b(This)38 b(v)-5 b(alue,)40
b(I)e(or)g(J,)h(is)e(then)i(c)m(hec)m(k)m(ed)j(to)c(ensure)h(that)f(it)
0 2211 y(do)s(es)44 b(not)g(fall)d(outside)j(the)g(domain.)76
b(If)43 b(it)g(do)s(es,)k(the)d(error)g(\015ag,)i(IERR,)e(is)g(raised.)
77 b(I)44 b(and)f(J)0 2332 y(are)h(then)g(assigned)g(to)f(the)i(arra)m
(y)e(of)h(diagnostic)e(grid)h(p)s(oin)m(ts,)j(ITEST)f(and)f(JTEST,)h
(and)f(the)0 2452 y(v)-5 b(alues)36 b(of)f(XTEST)i(and)f(YTEST)i(are)d
(adjusted)i(to)f(accoun)m(t)g(for)f(the)i(exact)f(grid)f(p)s(oin)m(t)g
(used.)54 b(A)0 2573 y(similar)37 b(pro)s(cedure)j(is)g(used)h(for)e
(ZTEST,)i(except)g(that)f(no)m(w)g(this)g(is)f(compared)h(to)f(the)h(v)
m(ertical)0 2693 y(grid,)31 b(ZN,)h(to)f(determine)h(the)g(exact)h(lev)
m(els)f(assigned)h(to)e(KTEST.)i(The)g(sp)s(ectra)g(lev)m(els,)f(KSP)-8
b(,)32 b(are)0 2813 y(also)g(determined)h(in)f(a)g(similar)e(w)m(a)m(y)
-8 b(,)34 b(b)m(y)g(comparing)d(the)i(input)g(ZSP)g(to)f(the)h(v)m
(ertical)g(grid.)43 b(If,)33 b(at)0 2934 y(the)39 b(end)f(of)g(the)h
(routine,)g(IERR)f(has)h(b)s(een)g(raised)f(then)g Fw(EXXIT)f
Fv(is)h(called)f(with)h(ISTOPU=7.)0 3054 y(Finally)-8
b(,)30 b(the)j(sp)s(ectra)g(slots)f(are)h(allo)s(cated)e(b)m(y)i(the)g
(call)e(to)h Fw(ALLOCSP)p Fv(.)0 3463 y Fp(SETFLUX)0
3768 y Fw(Called)k(b)m(y:)113 b Fv(NNSTEPS,)34 b(SET1D)0
3889 y Fw(Calls:)111 b Fv(-)146 4130 y(Calculates)28
b(the)h(curren)m(t)h(heat)e(\015ux)i(or)e(surface)h(temp)s(erature)f
(when)i(the)f(time-v)-5 b(arying)26 b(surface)0 4250
y(b)s(oundary)40 b(condition)e(option)g(\(IFBCHGP=1\))h(is)g(c)m
(hosen.)65 b(The)41 b(inputs)e(are)g(the)h(curren)m(t)h(time,)0
4370 y(TIMEA,)35 b(the)e(arra)m(ys)h(of)f(times,)g(TIMHF,)h(and)f(the)h
(corresp)s(onding)f(\015uxes,)i(FFTH)e(and)g(FF)m(Q,)g(or)0
4491 y(surface)41 b(v)-5 b(alues)40 b(FTSURF)g(and)h(F)m(QSURF.)f
(Using)f(linear)g(in)m(terp)s(olation)f(the)i(temp)s(erature)g(and)0
4611 y(moisture)24 b(\015uxes,)k(FTH)c(and)h(F)m(Q,)g(or)f(surface)i
(temp)s(erature)e(and)h(moisture,)g(TSURF)g(and)g(QSURF,)0
4731 y(at)30 b(TIMEA)h(are)f(determined)g(from)f(these)j(inputs.)42
b(The)31 b(extreme)g(p)s(ositions)e(of)g(TIMEA)j(less)e(than)0
4852 y(the)h(\014rst)g(TIMHF)h(v)-5 b(alue)30 b(and)g(TIMEA)j(greater)d
(than)h(the)g(last)f(TIMHF)h(v)-5 b(alue)30 b(are)h(accoun)m(ted)h(for)
0 4972 y(b)m(y)i(setting)f(FTH)g(and)g(F)m(Q,)g(or)g(TSURF)g(and)h
(QSURF,)e(to)h(the)h(\014rst)f(or)g(last)f(v)-5 b(alue)33
b(of)f(FFTH)h(and)0 5093 y(FF)m(Q,)c(or)g(FTSURF)g(and)g(F)m(QSURF,)g
(as)g(appropriate.)41 b(The)31 b(new)f(buo)m(y)m(ancy)h(\015ux,)g(FBUO)
m(YNEW,)0 5213 y(is)43 b(then)i(calculated)d(from)h(FTH)h(and)g(F)m(Q.)
f(The)i(new)g(surface)f(virtual)e(p)s(oten)m(tial)g(temp)s(erature,)0
5333 y(THVSURF,)26 b(is)f(calculated)f(from)g(TSURF)h(and)h(QSURF,)f
(along)e(with)i(some)g(surface)i(temp)s(erature)0 5454
y(dep)s(enden)m(t)34 b(constan)m(ts)g(used)g(in)e(the)h(surface)g(b)s
(oundary)g(condition)e(calculations)g(in)h Fw(MOSTBC)p
Fv(.)1841 6107 y(88)p eop
%%Page: 89 92
89 91 bop 0 52 a Fp(SETFRI)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(SMA)m(G,)33 b(SMA)m(G2D,)g(SMA)m(G1D)0 478 y Fw(Calls:)111
b Fv(-)146 719 y(Calculates)44 b(the)g(Ric)m(hardson)g(n)m(um)m(b)s(er)
g(dep)s(enden)m(t)i(functions)e(used)h(for)e(the)h(determination)0
839 y(of)d(the)g(viscosit)m(y)h(and)f(di\013usion)f(co)s(e\016cien)m
(ts)i(in)e(the)i(subgrid)f(mo)s(del.)67 b(VIS)41 b(and)h(DIFF)e(are)h
(as-)0 959 y(signed)29 b(to)g(the)h(appropriate)e(function)h(dep)s
(ending)h(on)f(the)g(v)-5 b(alue)29 b(of)g(the)h(Ric)m(hardson)f(n)m
(um)m(b)s(er,)h(RI.)0 1080 y(ELAMR)p 367 1080 30 4 v
36 w(SQ,)f(whic)m(h)h(is)f(used)h(in)f(the)g(Bac)m(kscatter)i
(calculations,)e(is)f(also)h(set.)43 b(All)27 b(of)i(these)i(arra)m(ys)
0 1200 y(are)i(only)f(partially)e(calculated)h(at)h(this)h(p)s(oin)m
(t;)e(the)i(calculation)e(is)h(completed)g(in)g Fw(SMA)m(G)g
Fv(etc.)0 1605 y Fp(SETINDEX)0 1910 y Fw(Called)k(b)m(y:)113
b Fv(NNSTEPS)0 2031 y Fw(Calls:)e Fv(-)146 2271 y(Initialises)41
b(the)i(slice)f(indices)g(for)g(viscosit)m(y)-8 b(,)45
b(bac)m(kscatter)g(and)d(the)h(source)h(terms.)73 b(F)-8
b(or)42 b(the)0 2392 y(trivial)27 b(2-D)i(case)i(all)c(the)k(indices)e
(are)h(set)h(to)e(1)h(\(all)d(p)s(oin)m(t)i(to)h(the)g(only)f(mo)s(del)
g(slice\).)41 b(F)-8 b(or)29 b(the)i(3-D)0 2512 y(cases)41
b(the)e(indices)g(are)g(assigned)h(starting)e(with)h(1)g(for)g(the)g
(lo)m(w)m(est)h(I)g(slice)e(\(e.g.)64 b(IDISIM2\))39
b(and)0 2633 y(incremen)m(ted)e(b)m(y)h(the)f(v)-5 b(alue)36
b(INC,)i(for)e(viscosit)m(y)h(and)g(source)h(terms,)g(and)f(INC)p
3095 2633 V 36 w(BSCA)-8 b(T)38 b(for)e(the)0 2753 y(bac)m(kscatter)e
(indices,)f(as)g(the)g(indices)f(increase)h(in)f(I.)0
3158 y Fp(SETINDEX2)0 3463 y Fw(Called)k(b)m(y:)113 b
Fv(NNSTEPS)0 3583 y Fw(Calls:)e Fv(-)146 3824 y(Sets)31
b(the)f(slice)f(indices)g(for)g(the)h(prognostic)f(mo)s(del)f
(\014elds.)43 b(F)-8 b(or)29 b(the)h(2-D)e(case)j(these)g(are)e(all)f
(set)0 3945 y(to)k(1,)h(else)f(they)i(are)e(set)i(to)e(the)h(actual)f
(v)-5 b(alue)32 b(of)g(the)h(slice.)0 4349 y Fp(SETLOOK)0
4655 y Fw(Called)j(b)m(y:)113 b Fv(SET1D)0 4775 y Fw(Calls:)e
Fv(CHGLOOK)146 5016 y(Sets)36 b(up)e(the)h(lo)s(ok-up)e(table)h(to)g
(calculate)f Fn(u)1852 5031 y Fi(\003)1925 5016 y Fv(from)h(the)g(near)
h(surface)g(wind)f(sp)s(eed)i(using)e(the)0 5136 y(relationships)22
b(from)h(Monin-Obukho)m(v)i(\(M-O\))e(similarit)m(y)d(theory)-8
b(.)41 b(The)25 b(maxim)m(um)d(and)i(minim)m(um)0 5256
y(wind)e(sp)s(eeds)j(supp)s(orted)e(in)f(the)h(lo)s(ok-up)e(table)h
(are)h(de\014ned)h(b)m(y)f(VELMAX)h(and)f(VELMIN.)g(A)g(lo)s(op)0
5377 y(is)28 b(then)g(conducted)i(o)m(v)m(er)f(all)d(en)m(tries)j(to)e
(the)i(lo)s(ok-up)e(table)g(\(IK=1,LOOKP\).)h(The)h(lo)s(ok-up)e(wind)0
5497 y(sp)s(eed,)34 b(VELLOK,)e(is)g(de\014ned)h(b)m(y)h(a)e(geometric)
f(in)m(terp)s(olation,)e(and)k(the)f(v)-5 b(alue)32 b(of)g
Fn(u)3244 5512 y Fi(\003)3283 5497 y Fv(,)g(USTLOK,)0
5618 y(is)f(initialised)d(to)j(a)g(simple)f(function)g(of)h(VELLOK.)h
(The)g(formal)d(calculation)g(for)i(USTLOK)h(then)0 5738
y(pro)s(ceeds)37 b(o)m(v)m(er)g(30)f(iterations.)52 b(The)37
b(initial)32 b(v)-5 b(alue)35 b(of)h(USTLOK)g(is)g(included)f(in)g(the)
i(calculation)0 5858 y(through)29 b(OB,)f(and)h(X1)g(and)f(X2)h
(represen)m(t)h(other)f(parts)g(of)f(the)h(M-O)g(functions.)42
b(F)-8 b(or)28 b(eac)m(h)h(pass)h(of)1841 6107 y(89)p
eop
%%Page: 90 93
90 92 bop 0 52 a Fv(the)36 b(iteration)e(USTLOK)i(is)f(relaxed)h(to)m
(w)m(ards)g(the)h(new)f(target)f(v)-5 b(alue)35 b(with)h(a)f(smo)s
(othing)f(factor)0 173 y(of)j(SMTH.)j(A)m(t)e(the)g(end)h(of)e(the)h
(lo)s(op)f(the)h(extreme)h(cases)g(for)e(the)i(neutral)e(and)h(free)g
(con)m(v)m(ectiv)m(e)0 293 y(conditions,)32 b(CNEUT)i(and)e(CF)m(C,)i
(are)e(de\014ned.)0 702 y Fp(SETLS)0 1008 y Fw(Called)k(b)m(y:)113
b Fv(SET1D)0 1128 y Fw(Calls:)e Fv(SET0,)34 b(F)m(ORINTER,)f(EXXIT)146
1369 y(Sets)44 b(up)f(the)h(subsidence)h(v)m(elo)s(cit)m(y)-8
b(,)45 b(WSUBS,)f(and)f(prescrib)s(ed)g(large-scale)f(forcing)f(v)-5
b(alues,)0 1489 y(SULS,)42 b(SVLS,)f(STHLS)h(and)f(SQLS.)g(If)g
(ISUBP=1)h(then)f(WSUBS)h(is)f(prescrib)s(ed.)69 b(This)41
b(has)h(a)0 1609 y(default)30 b(v)-5 b(alue)29 b(of)h(zero)h(and)g(the)
f(user)i(needs)g(to)e(c)m(hange)h(the)g(co)s(de)f(if)g(an)m(y)h(other)f
(v)-5 b(alue)30 b(is)g(required.)0 1730 y(If)43 b(IF)m(OR)m(CEP=1)i
(then)f(the)g(large-scale)d(forcing)i(v)-5 b(alues)43
b(are)g(read)h(in)f(from)f(the)i(\014le)f Fl(F)-7 b(or)i(c)g(e.dat)p
Fv(.)0 1850 y(Initially)d(,)29 b(the)j(v)-5 b(alues)32
b(are)g(set)g(to)g(zero)g(b)m(y)h(calls)e(to)g Fw(SET0)p
Fv(.)43 b(If)32 b(time)e(constan)m(t)j(forcing)e(is)g(selected,)0
1971 y(ITMF)m(ORP=0,)42 b(then)d(SULS,)h(SVLS,)g(STHLS)g(and)f(SQLS)h
(are)f(read)g(in)g(directly)f(from)g(the)i(\014le.)0
2091 y(These)45 b(are)f(assumed)g(to)f(b)s(e)h(in)e(the)i(correct)g
(format)e(for)h(the)h(mo)s(del)e(v)m(ertical)g(grid)h(and)g(in)g(the)0
2211 y(appropriate)37 b(units)i(p)s(er)f(second.)62 b(Prior)38
b(to)g(reading)f(eac)m(h)j(arra)m(y)-8 b(,)40 b(a)e(blank)g(read)g(is)g
(a)m(v)-5 b(ailable)36 b(for)0 2332 y(an)m(y)i(annotation)e(in)h(the)h
(\014le)f(and)h(an)f(in)m(teger,)i(IF)m(OR)m(U,)f(IF)m(OR)-11
b(V,)37 b(IF)m(OR)-8 b(TH)38 b(or)f(IF)m(OR)m(Q)h(read)f(in)0
2452 y(indicating)31 b(if)i(an)m(y)h(forcing)e(data)i(follo)m(ws.)45
b(If)34 b(the)g(in)m(teger)f(is)g(zero)h(then)g(it)f(is)g(assumed)h
(that)g(there)0 2573 y(is)e(no)h(subsequen)m(t)i(data)d(to)h(read)f
(in.)146 2813 y(If)k(time-v)-5 b(arying)33 b(forcing)h(is)h(selected,)i
(ITMF)m(ORP=1,)g(then)f(a)g(series)g(of)f(forcing)f(pro\014les)h(are)0
2934 y(read)50 b(in,)j(whic)m(h)e(are)e(in)m(terp)s(olated)g(and)h
(stored)g(in)f(SULS)p 2333 2934 30 4 v 36 w(TV,)h(SVLS)p
2831 2934 V 36 w(TV,)g(STHLS)p 3399 2934 V 36 w(TV)g(and)0
3054 y(SQLS)p 251 3054 V 35 w(TV.)36 b(SULS,)g(SVLS,)g(STHLS)g(and)f
(SQLS)h(can)f(b)s(e)h(determined)f(from)f(these)j(arra)m(ys)f(in)e(the)
0 3174 y(routine)25 b Fw(CHGLS)i Fv(called)d(from)h Fw(NNSTEPS)p
Fv(.)g(In)h(addition,)g(these)h(forcing)e(pro\014les)g(can)i(b)s(e)f
(target)0 3295 y(pro\014les)34 b(to)f(whic)m(h)i(the)f(horizon)m(tal)e
(mean)h(should)h(relax)f(to.)47 b(This)34 b(circumstance)g(is)g
(indicated)f(b)m(y)0 3415 y(IF)m(OR)m(U,)28 b(IF)m(OR)-11
b(V,)27 b(IF)m(OR)-8 b(TH)28 b(or)f(IF)m(OR)m(Q)g(b)s(eing)g(set)h
(equal)f(to)g(2.)41 b(A)28 b(v)-5 b(alue)27 b(of)g(1)g(indicates)f(a)i
(forcing)0 3536 y(tendency)45 b(in)c(units)i(p)s(er)f(da)m(y)-8
b(.)74 b(The)44 b(relaxation)d(timescale,)j(F)m(OR)-8
b(TIMSC,)43 b(and)g(the)g(n)m(um)m(b)s(er)g(of)0 3656
y(v)m(ertical)28 b(lev)m(els)g(for)g(the)h(forcing)e(data,)i(KTMF)m
(OR,)g(and)f(the)h(n)m(um)m(b)s(er)g(of)f(time)f(v)-5
b(alues,)29 b(NTMF)m(OR,)0 3776 y(are)38 b(read)g(in)f(\014rst.)59
b(KTMF)m(OR)38 b(and)g(NTMF)m(OR)g(are)g(compared)g(against)f(the)h
(parameters)f(KKP)0 3897 y(\(n)m(um)m(b)s(er)44 b(of)f(mo)s(del)e(lev)m
(els\))j(and)f(NTMF)m(ORP)i(\(maxim)m(um)c(n)m(um)m(b)s(er)i(of)g
(forcing)g(times\))f(and)i(if)0 4017 y(they)h(exceed)g(these)g(v)-5
b(alues)44 b(then)g Fw(EXXIT)e Fv(is)h(called)f(with)i(ISTOPU=14.)77
b(Next)44 b(the)g(v)m(ertical)0 4138 y(grid,)f(F)m(ORLEVS,)f(and)f(the)
h(time)f(v)-5 b(alues,)43 b(NTMF)m(OR,)f(are)g(read)g(in.)69
b(Finally)-8 b(,)42 b(the)g(forcing)e(for)0 4258 y(eac)m(h)c(\014eld)g
(is)f(read)g(in)g(in)g(turn.)52 b(After)36 b(a)f(blank)g(read)h(for)f
(an)m(y)h(annotation)e(in)h(the)g(data)g(\014le,)h(and)0
4378 y(the)46 b(indicator)e(IF)m(OR)m(U,)i(IF)m(OR)-11
b(V,)45 b(IF)m(OR)-8 b(TH)46 b(or)f(IF)m(OR)m(Q,)h(then)g(SULS)p
2801 4378 V 36 w(READ,)f(SVLS)p 3437 4378 V 36 w(READ,)0
4499 y(STHLS)p 318 4499 V 36 w(READ)35 b(and)h(SQLS)p
1113 4499 V 35 w(READ)f(are)h(read)f(in)g(\(if)f(the)i(indicators)e
(are)h(non-zero\).)52 b(These)37 b(are)0 4619 y(then)32
b(in)m(terp)s(olated)e(on)m(to)i(the)g(mo)s(del)d(grid)i(through)g
(calls)g(to)g(the)h(subroutine)f Fw(F)m(ORINTER)f Fv(and)0
4739 y(held)i(in)g(the)h(arra)m(ys)g(SULS)p 1034 4739
V 36 w(TV,)g(SVLS)p 1515 4739 V 36 w(TV,)g(STHLS)p 2066
4739 V 36 w(TV)g(and)g(SQLS)p 2713 4739 V 35 w(TV,)g(resp)s(ectiv)m
(ely)-8 b(.)0 5149 y Fp(SETMOIST)0 5454 y Fw(Called)36
b(b)m(y:)113 b Fv(NNSTEPS)0 5574 y Fw(Calls:)e Fv(-)146
5815 y(Calculates)29 b(the)g(horizon)m(tally)e(uniform)g(saturation)h
(functions)h(used)h(in)e(the)h(calculation)e(of)h(the)1841
6107 y(90)p eop
%%Page: 91 94
91 93 bop 0 52 a Fv(moist)37 b(Ric)m(hardson)h(n)m(um)m(b)s(er.)61
b(These)40 b(functions)f(are)f(based)h(around)f(the)h(horizon)m(tally)d
(a)m(v)m(eraged)0 173 y(temp)s(erature,)45 b(TST)-8 b(ARNEW.)43
b(The)g(saturation)f(mixing)e(ratio,)j(QSA)-8 b(T,)43
b(the)f(rate)g(of)g(c)m(hange)h(of)0 293 y(QSA)-8 b(T)39
b(with)f(temp)s(erature,)i(DQSA)-8 b(TDT,)38 b(and)g(the)h(co)s
(e\016cien)m(t)g(used)h(in)d(the)i(T)-8 b(a)m(ylor)38
b(Expansion)0 414 y(calculation)31 b(of)i(liquid)e(w)m(ater,)k(QSA)-8
b(TF)d(A)m(C,)34 b(are)f(determined)h(from)e(the)h(mo)s(del)f
(functions)h(QSA)-8 b(T-)0 534 y(URA)g(TION)42 b(and)f(DQWSA)-8
b(TDT.)41 b(TST)-8 b(ARPR)42 b(holds)f(the)h(reference)g(temp)s
(erature)f(used)i(in)d(the)0 654 y(T)-8 b(a)m(ylor)32
b(Expansion.)0 1064 y Fp(SETPREF)0 1369 y Fw(Called)k(b)m(y:)113
b Fv(SET1D)0 1489 y Fw(Calls:)e Fv(EXXIT)146 1730 y(Calculates)25
b(the)g(reference)i(state)e(pressure)i(for)e(the)g(Boussinesq)i(case.)
42 b(The)26 b(reference)h(pressure,)0 1850 y(PREFN,)h(is)g(determined)g
(from)f(the)h(input)g(p)s(oten)m(tial)e(temp)s(erature)i(pro\014le,)h
(THPR)m(OF,)f(using)g(the)0 1971 y(univ)m(ersal)f(gas)h(la)m(w)f(and)g
(the)h(h)m(ydrostatic)g(appro)m(ximation.)39 b(After)28
b(some)f(manipulation,)e(this)i(giv)m(es)0 2091 y Fn(d=dz)t
Fv(\()p Fn(p)287 2106 y Fe(s)324 2091 y Fn(=p)422 2106
y Fs(0)461 2091 y Fv(\))499 2055 y Fs(\()p Fe(r)r(=c)626
2063 y Fd(p)662 2055 y Fs(\))721 2091 y Fv(=)h Fm(\000)p
Fn(g)t(=)p Fv(\()p Fn(c)1082 2106 y Fe(p)1121 2091 y
Fn(\022)1166 2106 y Fe(s)1203 2091 y Fv(\))k(where)h
Fn(p)1603 2106 y Fe(s)1671 2091 y Fv(is)e(PREFN,)h Fn(\022)2213
2106 y Fe(s)2282 2091 y Fv(is)f(THPR)m(OF)i(and)e Fn(p)3067
2106 y Fs(0)3139 2091 y Fv(is)g(the)h(reference)0 2211
y(surface)44 b(pressure,)j(PSFR.)c(This)g(is)f(solv)m(ed)h(in)f(t)m(w)m
(o)i(passes.)75 b(Initially)-8 b(,)42 b(the)i(top)e(lev)m(el)h
(pressure,)0 2332 y(PTOP)-8 b(,)39 b(is)f(set)h(to)f(zero.)60
b(A)m(t)39 b(\014rst)g(PREFN)f(represen)m(ts)j(\()p Fn(p)2268
2347 y Fe(s)2304 2332 y Fn(=p)2402 2347 y Fs(0)2442 2332
y Fv(\))2480 2296 y Fs(\()p Fe(r)r(=c)2607 2304 y Fd(p)2643
2296 y Fs(\))2674 2332 y Fv(,)f(the)f(Exner)g(function,)g(and)0
2452 y(PDIFF)25 b(calculates)f(the)i(di\013erence)g(in)f(this)g
(expression)i(at)e(eac)m(h)h(mo)s(del)e(lev)m(el)h(using)g(the)h(righ)m
(t)e(hand)0 2573 y(side)31 b(of)g(the)h(original)c(equation.)43
b(PREFN)31 b(is)g(then)h(constructed)h(b)m(y)f(in)m(tegrating)e(PDIFF)h
(o)m(v)m(er)h(the)0 2693 y(mo)s(del)h(lev)m(els,)h(and)h(then)g(con)m
(v)m(erted)h(to)e(pressure)i(b)m(y)f(m)m(ultiplying)c(b)m(y)k(PSFR)f
(and)h(taking)e(to)h(the)0 2813 y(in)m(v)m(erse)g(p)s(o)m(w)m(er)g(of)e
(\()p Fn(R)q(=c)923 2828 y Fe(p)962 2813 y Fv(\),)h(R)p
1138 2813 30 4 v 35 w(ON)p 1322 2813 V 35 w(CP)-8 b(.)146
3054 y(After)37 b(the)g(\014rst)h(pass)f(the)g(basic)g(state)g(is)f
(adjusted)i(so)f(that)f(the)h(sp)s(eci\014ed)h(surface)g(pressure,)0
3174 y(PSF,)e(will)e(equal)h(the)h(surface)h(pressure,)i(P0,)d
(diagnosed)g(from)e(PREFN.)j(PTOP)f(is)g(adjusted)g(so)0
3295 y(that)44 b(P0=PSF,)h(just)f(b)m(y)h(setting)f(it)f(to)h(the)h
(di\013erence)g(b)s(et)m(w)m(een)h(P0)e(and)h(PSF.)f(If)g(a)g(negativ)m
(e)0 3415 y(PTOP)35 b(is)f(encoun)m(tered)i(then)f Fw(EXXIT)e
Fv(is)h(called)f(with)h(ISTOPU=8.)49 b(The)35 b(second)h(pass)f(is)f
(then)0 3536 y(carried)e(out,)h(and)f(PREFN)h(assigned)g(with)f(the)h
(\014nal)f(reference)i(state)f(pressure.)0 3945 y Fp(SETRAN)0
4250 y Fw(Called)j(b)m(y:)113 b Fv(RETRIEVE,)34 b(NNSTEPS,)h(NEWRETR)0
4370 y Fw(Calls:)111 b Fv(-)146 4611 y(Sets)44 b(up)f(the)g(arra)m(y)g
(of)g(random)e(n)m(um)m(b)s(ers)j(and)f(random)f(indices)g(used)i(for)f
(calculating)d(the)0 4731 y(bac)m(kscatter)f(incremen)m(ts.)57
b(T)-8 b(o)37 b(ensure)i(that)e(the)g(random)f(n)m(um)m(b)s(ers)i(are)f
(the)h(same)f(on)g(eac)m(h)h(PE,)0 4852 y(the)c(random)e(n)m(um)m(b)s
(er)i(arra)m(y)-8 b(,)33 b(FX,)h(and)f(the)h(random)e(indices,)h(ISTMP)
-8 b(,)35 b(are)f(only)e(determined)i(on)0 4972 y(PE)29
b(0)f(and)g(then)h(passed)h(to)e(all)e(other)j(PEs)g(b)m(y)g(use)g(of)f
(the)h(GC)p 2362 4972 V 35 w(RBCAST)g(call.)41 b(FX)28
b(is)g(determined)0 5093 y(b)m(y)36 b(assigning)d(it)h(in)g(the)h
(random)e(n)m(um)m(b)s(er)i(function,)g(RANDOM)p 2536
5093 V 35 w(NUMBER.)h(0.5)e(is)g(subtracted)0 5213 y(so)27
b(that)h(the)f(random)g(n)m(um)m(b)s(ers)h(range)f(from)f(-0.5)g(to)h
(0.5,)h(rather)g(than)f(the)h(0)f(to)g(1)g(whic)m(h)h(is)e(output)0
5333 y(from)31 b(RANDOM)p 694 5333 V 35 w(NUMBER.)i(Because)h(FX)e(w)m
(ould)g(giv)m(e)g(the)h(same)f(set)h(of)f(random)f(n)m(um)m(b)s(ers)j
(on)0 5454 y(eac)m(h)f(v)m(ertical)e(slice,)h(arra)m(ys)h(of)f(random)f
(indices)h(for)f(eac)m(h)i(v)m(ertical)f(slice)f(are)h(determined)g(so)
h(that)0 5574 y(di\013eren)m(t)g(random)f(n)m(um)m(b)s(ers)i(will)c(b)s
(e)k(used)g(for)e(di\013eren)m(t)h(slices.)44 b(These)35
b(random)d(indices,)h(JNEW)0 5695 y(and)e(KNEW,)g(are)f(calculated)g(b)
m(y)h(m)m(ultiplying)c(JJP)k(and)g(KKP)g(resp)s(ectiv)m(ely)g(b)m(y)h
(RANF.)e(If)g(these)0 5815 y(v)-5 b(alues)43 b(fall)e(out)i(of)g(b)s
(ounds)h(\(exceed)h(JMAX)f(or)f(KMAX\))h(or)f(are)g(close)h(to)f(the)g
(previous)h(slice)1841 6107 y(91)p eop
%%Page: 92 95
92 94 bop 0 52 a Fv(v)-5 b(alues)27 b(\(JOLD)g(and)g(K)m(OLD\))f(then)i
(they)g(are)f(recalculated.)41 b(JNEW)28 b(and)g(KNEW)f(are)g(assigned)
h(to)0 173 y(ISTMP)-8 b(.)37 b(ISTMP)g(con)m(tains)f(the)g(random)e
(indices)i(for)f(all)e(slices.)52 b(This)36 b(is)f(then)h(distributed)f
(o)m(v)m(er)0 293 y(all)27 b(PEs)j(b)m(y)f(calling)d(GC)p
921 293 30 4 v 36 w(RBCAST)j(and)g(then)h(setting)e(the)h(lo)s(cal)e
(random)h(index)h(arra)m(y)-8 b(,)29 b(IS,)h(to)e(the)0
414 y(relev)-5 b(an)m(t)33 b(part)f(of)g(ISTMP)-8 b(.)0
823 y Fp(SETSG)0 1128 y Fw(Called)36 b(b)m(y:)113 b Fv(BEGIN)0
1248 y Fw(Calls:)e Fv(-)146 1489 y(Initialises)29 b(the)i(constan)m(ts)
h(that)f(are)g(used)h(in)e(the)h(subgrid)g(mo)s(del.)41
b(These)32 b(are)f(SUBB,)h(SUBC,)0 1609 y(SUBG,)27 b(SUBH,)h(SUBR,)f(A)
-8 b(TH2)p 1236 1609 V 36 w(N,)27 b(A2)p 1521 1609 V
35 w(N,)g(PR)p 1821 1609 V 35 w(N)g(and)h(RIC,)f(and)g(functions)g(of)g
(them.)41 b(A)28 b(c)m(hec)m(k)h(is)0 1730 y(carried)i(out)h(on)f(the)h
(user)g(input)g(mixing)d(length,)i(RMLMAX,)i(to)e(c)m(hec)m(k)j(that)d
(it)g(falls)e(within)i(rea-)0 1850 y(sonable)g(b)s(ounds)i(\(b)s(et)m
(w)m(een)h(the)e(ratios)e(CSTOP)j(and)f(CSBOT)h(of)e(the)h(horizon)m
(tal)e(grid)h(spacing\).)0 1971 y(If)i(it)e(do)s(es)i(not)g(then)g(a)f
(w)m(arning)g(message)h(is)f(written)h(to)f(standard)h(out,)g(but)f
(the)h(run)g(pro)s(ceeds.)0 2380 y Fp(SMA)l(G)0 2685
y Fw(Called)j(b)m(y:)113 b Fv(CALCVIS)0 2805 y Fw(Calls:)e
Fv(WRAP)-8 b(,)33 b(MOISTRI2,)h(MOISTRI,)f(SETFRI)146
3046 y(Calculates)d(the)i(viscosit)m(y)-8 b(,)31 b(di\013usion)f(and)g
(bac)m(kscattered)k(energy)d(for)f(a)h(3-D)e(run.)43
b(The)32 b(trivial)0 3166 y(case)42 b(of)f(no)g(viscosit)m(y)h(\(INO)m
(VISP=1\))g(is)e(accommo)s(dated)g(b)m(y)i(setting)f(the)h(viscosit)m
(y)-8 b(,)44 b(VIS,)d(and)0 3287 y(di\013usion,)48 b(DIFF,)d(to)g(zero)
i(and)e(returning.)83 b(T)-8 b(o)46 b(calculate)f(VIS)h(and)g(DIFF)f
(the)h(half-squared)0 3407 y(strain)34 b(rate,)i(SSQ,)f(needs)h(to)f(b)
s(e)g(calculated.)50 b(This)35 b(is)f(calculated)g(in)g(a)h(lo)s(op)e
(o)m(v)m(er)j(J)f(and)g(K)g(with)0 3528 y(eac)m(h)44
b(comp)s(onen)m(t)e(of)g(SSQ)h(b)s(eing)f(calculated)g(as)g(a)h
(separate)g(scalar,)i(SSQ11,)g(SSQ22,)g(SSQ33,)0 3648
y(SSQ12,)32 b(SSQ13)g(and)g(SSQ23.)43 b(These)34 b(are)f(the)f(squares)
i(of)e(v)m(elo)s(cit)m(y)g(gradien)m(t)f(terms)h(and)h(need)g(to)0
3768 y(b)s(e)c(a)m(v)m(eraged)g(on)m(to)f(w-p)s(oin)m(ts.)42
b(SSQ\(J,K\))29 b(is)f(then)h(determined)f(b)m(y)h(summing)e(all)f(the)
j(comp)s(onen)m(ts)0 3889 y(together.)41 b(The)23 b(next)h(stage)f(is)g
(to)g(calculate)e(the)j(Ric)m(hardson)f(n)m(um)m(b)s(er,)i(RI.)e(F)-8
b(or)22 b(a)h(moist)e(sim)m(ulation)0 4009 y(\(IP)-8
b(ASQP=0\))41 b(this)e(is)h(ac)m(hiev)m(ed)h(b)m(y)g(calling)d
Fw(MOISTRI)h Fv(or)h Fw(MOISTRI2)g Fv(dep)s(ending)g(on)g(the)0
4130 y(v)-5 b(alue)30 b(of)g(IMOISTRIP)-8 b(,)32 b(whereas)g(for)d(the)
i(dry)g(case)g(this)f(is)g(calculated)g(in-line)e(as)i(the)h(gradien)m
(t)f(of)0 4250 y(the)h(buo)m(y)m(ancy)i(o)m(v)m(er)f(SSQ.)f(VIS)h(and)f
(DIFF)e(can)i(then)h(b)s(e)f(determined)g(b)m(y)h(using)e(the)h
(appropriate)0 4370 y(Ric)m(hardson)e(n)m(um)m(b)s(er)g(function)f(in)g
Fw(SETFRI)p Fv(,)g(m)m(ultiplying)e(b)m(y)j(the)g(square)h(of)e(the)h
(mixing)e(length)0 4491 y(and)33 b(dividing)d(b)m(y)k(the)f(square)h
(ro)s(ot)d(of)h(SSQ.)146 4731 y(On)39 b(the)f(appropriate)g(step)h(the)
g(viscous)g(Couran)m(t)g(n)m(um)m(b)s(er,)h(CVIS,)g(is)e(partially)d
(calculated,)0 4852 y(b)m(y)29 b(assigning)d(CVISS)j(to)e(the)i(maxim)m
(um)c(of)i(VIS)h(and)g(DIFF)f(o)m(v)m(er)i(the)f(grid)f(spacing)g
(squared,)j(and)0 4972 y(then)j(placing)e(the)i(maxim)m(um)d(v)-5
b(alue)32 b(of)h(CVISS)g(or)f(CVIS)i(in)e(CVIS.)146 5213
y(The)41 b(last)e(part)h(of)g(the)g(routine)g(calculates)f(the)h(bac)m
(kscattered)j(energies:)58 b(DIS)40 b(for)g(v)m(elo)s(cit)m(y)-8
b(,)0 5333 y(DIST)28 b(for)e(p)s(oten)m(tial)g(temp)s(erature)h(and)h
(DISQ)f(for)g(the)g(Q)h(\014elds.)42 b(The)28 b(calculation)d(is)i
(constructed)0 5454 y(with)37 b(DISF)g(represen)m(ting)h(the)f(\014fth)
h(p)s(o)m(w)m(er)g(of)f(the)g(mixing)e(length)i(ratio,)g(and)g(DISFM,)h
(DISFT)0 5574 y(and)47 b(DISF)m(Q)g(represen)m(ting)h(the)f(fraction)f
(of)g(the)h(viscous)h(or)f(scalar)f(v)-5 b(ariance)46
b(drain)h(whic)m(h)g(is)0 5695 y(bac)m(kscattered.)f(DIS)32
b(is)f(calculated)g(from)g(VIS)i(and)f(DIFF,)f(whilst)h(the)g(scalar)g
(v)-5 b(ariances)32 b(need)h(to)0 5815 y(b)s(e)g(calculated)e(to)i
(determine)f(DIST)h(and)f(DISQ.)1841 6107 y(92)p eop
%%Page: 93 96
93 95 bop 0 52 a Fp(SMA)l(G1D)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(CALCVIS)0 478 y Fw(Calls:)e Fv(WRAP)-8 b(,)33 b(MOISTRI2,)h
(MOISTRI,)f(SETFRI)146 719 y(Calculates)k(the)h(viscosit)m(y)g(and)f
(di\013usion)f(for)h(a)g(1-D)f(run.)58 b(The)38 b(trivial)d(case)j(of)f
(no)g(viscosit)m(y)0 839 y(\(INO)m(VISP=1\))44 b(is)e(accommo)s(dated)f
(b)m(y)j(setting)e(the)h(viscosit)m(y)-8 b(,)46 b(VIS,)d(and)g
(di\013usion,)h(DIFF,)e(to)0 959 y(zero)34 b(and)f(returning.)45
b(T)-8 b(o)33 b(calculate)f(VIS)i(and)f(DIFF)g(the)g(half-squared)g
(strain)g(rate,)g(SSQ,)h(needs)0 1080 y(to)43 b(b)s(e)g(calculated.)73
b(In)43 b(1-D)f(this)h(is)f(just)h(the)g(square)i(of)d(the)h(v)m
(ertical)f(shear.)76 b(The)43 b(next)h(stage)0 1200 y(is)38
b(to)h(calculate)e(the)i(Ric)m(hardson)g(n)m(um)m(b)s(er,)i(RI.)e(F)-8
b(or)38 b(a)g(moist)f(sim)m(ulation)f(\(IP)-8 b(ASQP=0\))40
b(this)e(is)0 1321 y(ac)m(hiev)m(ed)e(b)m(y)f(calling)c
Fw(MOISTRI)j Fv(or)g Fw(MOISTRI2)g Fv(dep)s(ending)h(on)f(the)g(v)-5
b(alue)34 b(of)g(IMOISTRIP)-8 b(,)0 1441 y(whereas)41
b(for)e(the)h(dry)g(case)h(this)e(is)g(calculated)g(in-line)e(as)j(the)
g(gradien)m(t)f(of)g(the)h(buo)m(y)m(ancy)h(o)m(v)m(er)0
1561 y(SSQ.)27 b(VIS)g(and)g(DIFF)e(can)i(then)g(b)s(e)g(determined)g
(b)m(y)g(using)g(the)g(appropriate)e(Ric)m(hardson)i(n)m(um)m(b)s(er)0
1682 y(function)h(in)g Fw(SETFRI)p Fv(,)h(m)m(ultiplying)c(b)m(y)30
b(the)f(square)h(of)e(the)i(mixing)c(length)j(and)f(dividing)f(b)m(y)j
(the)0 1802 y(square)k(ro)s(ot)d(of)h(SSQ.)146 2043 y(On)39
b(the)f(appropriate)g(step)h(the)g(viscous)g(Couran)m(t)g(n)m(um)m(b)s
(er,)h(CVIS,)g(is)e(partially)d(calculated,)0 2163 y(b)m(y)29
b(assigning)d(CVISS)j(to)e(the)i(maxim)m(um)c(of)i(VIS)h(and)g(DIFF)f
(o)m(v)m(er)i(the)f(grid)f(spacing)g(squared,)j(and)0
2284 y(then)j(placing)e(the)i(maxim)m(um)d(of)j(v)-5
b(alue)32 b(of)g(CVISS)h(or)g(CVIS)g(in)f(CVIS.)0 2693
y Fp(SMA)l(G2D)0 2998 y Fw(Called)k(b)m(y:)113 b Fv(CALCVIS)0
3118 y Fw(Calls:)e Fv(WRAP)-8 b(,)33 b(MOISTRI2,)h(MOISTRI,)f(SETFRI)
146 3359 y(Calculates)k(the)h(viscosit)m(y)g(and)f(di\013usion)f(for)h
(a)g(2-D)f(run.)58 b(The)38 b(trivial)d(case)j(of)f(no)g(viscosit)m(y)0
3480 y(\(INO)m(VISP=1\))44 b(is)e(accommo)s(dated)f(b)m(y)j(setting)e
(the)h(viscosit)m(y)-8 b(,)46 b(VIS,)d(and)g(di\013usion,)h(DIFF,)e(to)
0 3600 y(zero)34 b(and)f(returning.)45 b(T)-8 b(o)33
b(calculate)f(VIS)i(and)f(DIFF)g(the)g(half-squared)g(strain)g(rate,)g
(SSQ,)h(needs)0 3720 y(to)45 b(b)s(e)h(calculated.)81
b(This)45 b(is)g(calculated)f(in)h(a)g(lo)s(op)f(o)m(v)m(er)i(J)g(and)f
(K)g(with)g(eac)m(h)i(comp)s(onen)m(t)e(of)0 3841 y(SSQ)c(b)s(eing)g
(calculated)f(as)h(a)g(separate)h(scalar,)h(SSQ22,)g(SSQ33,)g(SSQ12,)g
(SSQ13)e(and)h(SSQ23.)0 3961 y(These)35 b(are)f(the)g(squares)h(of)e(v)
m(elo)s(cit)m(y)g(gradien)m(t)g(terms)h(and)f(need)i(to)e(b)s(e)h(a)m
(v)m(eraged)g(on)m(to)g(w-p)s(oin)m(ts.)0 4081 y(SSQ\(J,K\))i(is)g
(then)h(determined)f(b)m(y)h(summing)d(all)g(the)j(comp)s(onen)m(ts)g
(together.)54 b(The)37 b(next)g(stage)0 4202 y(is)h(to)h(calculate)e
(the)i(Ric)m(hardson)g(n)m(um)m(b)s(er,)i(RI.)e(F)-8
b(or)38 b(a)g(moist)f(sim)m(ulation)f(\(IP)-8 b(ASQP=0\))40
b(this)e(is)0 4322 y(ac)m(hiev)m(ed)e(b)m(y)f(calling)c
Fw(MOISTRI)j Fv(or)g Fw(MOISTRI2)g Fv(dep)s(ending)h(on)f(the)g(v)-5
b(alue)34 b(of)g(IMOISTRIP)-8 b(,)0 4443 y(whereas)41
b(for)e(the)h(dry)g(case)h(this)e(is)g(calculated)g(in-line)e(as)j(the)
g(gradien)m(t)f(of)g(the)h(buo)m(y)m(ancy)h(o)m(v)m(er)0
4563 y(SSQ.)27 b(VIS)g(and)g(DIFF)e(can)i(then)g(b)s(e)g(determined)g
(b)m(y)g(using)g(the)g(appropriate)e(Ric)m(hardson)i(n)m(um)m(b)s(er)0
4683 y(function)h(in)g Fw(SETFRI)p Fv(,)h(m)m(ultiplying)c(b)m(y)30
b(the)f(square)h(of)e(the)i(mixing)c(length)j(and)f(dividing)f(b)m(y)j
(the)0 4804 y(square)k(ro)s(ot)d(of)h(SSQ.)146 5045 y(On)39
b(the)f(appropriate)g(step)h(the)g(viscous)g(Couran)m(t)g(n)m(um)m(b)s
(er,)h(CVIS,)g(is)e(partially)d(calculated,)0 5165 y(b)m(y)29
b(assigning)d(CVISS)j(to)e(the)i(maxim)m(um)c(of)i(VIS)h(and)g(DIFF)f
(o)m(v)m(er)i(the)f(grid)f(spacing)g(squared,)j(and)0
5285 y(then)j(placing)e(the)i(maxim)m(um)d(of)j(CVISS)g(or)f(CVIS)i(in)
e(CVIS.)1841 6107 y(93)p eop
%%Page: 94 97
94 96 bop 0 52 a Fp(SST)-11 b(AR)g(T)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(BEGIN)0 478 y Fw(Calls:)e Fv(INDGA)-11
b(V,)33 b(WRAP)-8 b(,)33 b(SET0,)g(CALCBAR,)h(INITCFL,)f(NNSTEPS,)i
(CBAR2D)146 719 y(Initialises)f(the)i(prognostic)f(\014elds,)i(and)f
(some)f(diagnostic)g(\014elds,)i(for)e(the)h(mo)s(del)e(in)m(tegration)
0 839 y(and)24 b(runs)g(the)g(\014rst)f(few)h(steps.)42
b(Firstly)-8 b(,)24 b(some)f(run)h(con)m(trol)f(v)-5
b(ariables,)24 b(suc)m(h)h(as)e(NJOB,)h(NDGFILE,)0 959
y(NSTEP)33 b(and)e(TIME)i(are)e(initialised,)d(along)i(with)h(the)h
(time-a)m(v)m(eraged)f(diagnostics)f(with)h(the)h(call)0
1080 y(to)d Fw(INDGA)-12 b(V)p Fv(.)28 b(Then)i(the)g(prognostics)f
(\014elds,)i(U,)e(V,)h(W)f(and)h(TH)f(are)h(set.)43 b(The)30
b(default)f(is)g(to)g(set)0 1200 y(U)h(to)g(UINIT,)h(V)f(to)f(VINIT,)i
(W)f(to)g(0,)g(and)g(TH)h(to)e(THINIT-THREF.)j(The)f(b)s(oundary)f
(condition)0 1321 y(v)-5 b(alues)36 b(for)f(TH)h(are)g(set)h(dep)s
(ending)f(on)f(the)i(c)m(hoice)f(of)f(surface)i(b)s(oundary)f
(condition.)52 b(W)36 b(at)f(the)0 1441 y(domain)24 b(top)h(is)g(set)h
(to)e(zero.)42 b(The)26 b(\\previous)g(timestep")e(\014elds,)j(ZU,)f
(ZV,)f(ZW)g(and)g(ZTH)h(are)f(set)h(to)0 1561 y(U,)k(V,)g(W)g(and)f(TH)
i(resp)s(ectiv)m(ely)-8 b(.)43 b(Next)31 b(the)f(Q)f(\014elds)h(are)g
(initialised,)d(using)i(QINIT,)i(in)e(the)h(same)0 1682
y(w)m(a)m(y)-8 b(.)44 b(The)32 b(horizon)m(tal)e(means)h(are)h
(calculated)e(b)m(y)i(calling)d Fw(CALCBAR)h Fv(or)h
Fw(CBAR2D)f Fv(and)h(the)0 1802 y(diagnostic)26 b(\014elds)h(of)f
(PUDDLE)h(and)g(the)h(column)d(classi\014cation)h(\014elds)h(are)g(all)
e(initialised)e(to)k(zero.)0 1923 y(The)33 b(CFL)f(criteria)f(v)-5
b(ariables)31 b(are)h(initialised)c(in)j(the)i(call)d(to)i
Fw(INITCFL)p Fv(.)g Fw(NNSTEPS)f Fv(is)h(called)0 2043
y(to)38 b(start)h(the)g(in)m(tegration)e(with)i(a)f(single)g(forw)m
(ard)h(step.)62 b(The)40 b(t)m(yp)s(e)g(of)e(time-stepping)f(required)0
2163 y(is)d(determined)g(and)h(IF)m(ORSTEP)h(assigned)f(as)f
(appropriate,)h(and)f(then)h(NST)-8 b(AR)g(T-1)35 b(single)f(step)0
2284 y(calls)j(to)i Fw(NNSTEPS)e Fv(are)i(p)s(erformed,)g(where)h(NST)
-8 b(AR)g(T)40 b(is)e(the)h(total)e(n)m(um)m(b)s(er)i(of)f(steps)i(to)e
(b)s(e)0 2404 y(p)s(erformed)32 b(b)m(y)i(the)f(routine.)0
2813 y Fp(STEP)0 3118 y Fw(Called)j(b)m(y:)113 b Fv(STEPFLDS)0
3239 y Fw(Calls:)e Fv(WRAP)146 3480 y(Steps)23 b(the)g(scalar)e
(\014elds.)40 b(FLD)21 b(is)g(the)i(curren)m(t)g(timestep)e(\014eld,)j
(ZFLD)d(is)g(the)i(previous)f(timestep)0 3600 y(\014eld)31
b(and)g(SFLD)f(is)g(the)h(tendency)i(of)d(the)i(\014eld.)42
b(F)-8 b(or)30 b(a)h(forw)m(ard)g(step,)h(ZFLD)d(is)i(set)g(to)g(FLD)f
(plus)0 3720 y(the)f(pro)s(duct)g(of)g(the)g(timestep,)g(DTM,)g(and)g
(SFLD,)f(whereas)j(for)d(a)h(cen)m(tred)h(step,)g(ZFLD)e(is)g(set)i(to)
0 3841 y(ZFLD)25 b(plus)i(the)f(pro)s(duct)h(of)f(t)m(wice)h(the)g
(timestep,)g(DTM)p 2178 3841 30 4 v 36 w(X2,)h(and)e(SFLD.)g(Th)m(us,)j
(ZFLD)c(con)m(tains)0 3961 y(the)33 b(new)h(timestep)e(v)-5
b(alue)32 b(of)g(the)h(\014eld)f(at)g(the)h(end)h(of)e(the)h(routine.)0
4370 y Fp(STEPFLDS)0 4675 y Fw(Called)j(b)m(y:)113 b
Fv(NNSTEPS)0 4796 y Fw(Calls:)e Fv(CVELGAL,)33 b(STEPGAL,)h(STEPW,)g
(STEP)146 5037 y(Con)m(trols)24 b(the)g(stepping)g(of)g(the)g
(prognostic)f(\014elds)h(and)g(the)g(partial)e(calculation)f(of)j(the)g
(Couran)m(t)0 5157 y(n)m(um)m(b)s(er)39 b(and)g(time-smo)s(othing.)57
b(F)-8 b(or)38 b(the)h(Rob)s(ert)f(\014lter)g(\(ISMTH=1\))i(the)f
(previous)g(time-lev)m(el)0 5277 y(\014elds)c(m)m(ust)h(b)s(e)f(sa)m(v)
m(ed)i(for)e(use)h(in)e(the)i(\014lter.)51 b(Th)m(us,)37
b(ZU,)e(ZV)g(and)g(ZW)g(are)g(assigned)h(to)f(SA)-11
b(VU,)0 5398 y(SA)g(VV)26 b(and)e(SA)-11 b(VW)26 b(resp)s(ectiv)m(ely)
-8 b(.)42 b(The)26 b(horizon)m(tal)d(means)i(are)g(also)f(sa)m(v)m(ed)i
(to)f(SA)-11 b(V)m(OLUBAR)25 b(and)0 5518 y(SA)-11 b(V)m(OL)g(VBAR.)42
b(The)g(Couran)m(t)f(n)m(um)m(b)s(er)g(calculation)d(is)j(started)g(in)
f Fw(CVELGAL)p Fv(.)g(The)i(mo)s(del)0 5638 y(\014elds)k(are)f(then)h
(stepp)s(ed.)83 b(U)46 b(and)f(V)h(are)f(stepp)s(ed)i(in)e(calls)f(to)h
Fw(STEPGAL)p Fv(,)g(W)g(in)g(calls)f(to)0 5759 y Fw(STEPW)37
b Fv(and)g(TH)h(and)g(Q)f(in)g(calls)f(to)h Fw(STEP)p
Fv(.)g(Ho)m(w)m(ev)m(er,)k(the)d(previous)g(timestep)f(\(Z*\))g
(\014elds)1841 6107 y(94)p eop
%%Page: 95 98
95 97 bop 0 52 a Fv(are)34 b(still)d(required)j(for)g(calculation)d(of)
i(viscosit)m(y)-8 b(,)35 b(only)e(the)h(\014elds)g(on)g(slice)f(I-2)g
(are)h(stepp)s(ed.)49 b(The)0 173 y(exception)37 b(is)f(for)f(the)i
(\014nal)e(slice,)i(when)g(the)g(I-1)f(and)g(I)g(slices)g(are)h(also)e
(stepp)s(ed.)56 b(F)-8 b(or)35 b(using)h(the)0 293 y(Rob)s(ert)h
(\014lter)f(on)i(the)f(scalar)g(\014elds,)h(the)g(previous)g(time-lev)m
(el)d(\014elds)i(are)g(included)g(b)m(y)h(partially)0
414 y(up)s(dating)32 b(the)h(curren)m(t)g(time)f(lev)m(el)g(\014elds)h
(b)s(efore)f(the)h(call)e(to)h Fw(STEP)p Fv(.)0 823 y
Fp(STEPGAL)0 1128 y Fw(Called)k(b)m(y:)113 b Fv(STEPFLDS)0
1248 y Fw(Calls:)e Fv(WRAP)146 1489 y(Steps)35 b(a)f(Galilean)d
(transformed)j(v)m(elo)s(cit)m(y)g(\014eld.)47 b(FLD)34
b(is)f(the)i(curren)m(t)g(timestep)e(\014eld,)i(ZFLD)0
1609 y(is)c(the)h(previous)g(timestep)f(\014eld,)g(SFLD)g(is)g(the)h
(tendency)h(of)e(the)h(\014eld)f(and)h(GAL)f(is)g(the)h(Galilean)0
1730 y(transformation.)40 b(FLD)28 b(and)i(ZFLD)d(are)j(under)g(the)f
(Galilean)d(transformation)h(at)i(this)g(p)s(oin)m(t.)41
b(F)-8 b(or)0 1850 y(a)33 b(forw)m(ard)g(step,)h(ZFLD)e(is)g(set)i(to)f
(FLD)f(plus)h(the)g(pro)s(duct)h(of)e(the)i(timestep,)f(DTM,)g(and)g
(SFLD,)0 1971 y(whereas)g(for)f(a)f(cen)m(tred)j(step,)f(ZFLD)d(is)h
(set)i(to)e(ZFLD)g(plus)h(the)g(pro)s(duct)g(of)f(t)m(wice)i(the)f
(timestep,)0 2091 y(DTM)p 240 2091 30 4 v 35 w(X2,)k(and)g(SFLD.)e
(Both)i(FLD)e(and)h(ZFLD)f(are)i(incremen)m(ted)f(b)m(y)i(GAL.)e(Th)m
(us,)i(at)e(the)h(end)0 2211 y(of)f(the)i(routine,)f(FLD)f(is)g(the)h
(true)h(v)-5 b(alue)35 b(of)g(the)i(curren)m(t)g(step)f(v)m(elo)s(cit)m
(y)-8 b(,)37 b(and)f(ZFLD)e(is)i(the)g(true)0 2332 y(v)-5
b(alue)32 b(of)g(the)h(next)h(timestep)e(v)m(elo)s(cit)m(y)-8
b(.)0 2741 y Fp(STEPW)0 3046 y Fw(Called)36 b(b)m(y:)113
b Fv(STEPFLDS)0 3166 y Fw(Calls:)e Fv(WRAP)146 3407 y(Steps)48
b(the)f(v)m(ertical)f(v)m(elo)s(cit)m(y)g(\014elds.)86
b(FLD)46 b(is)g(the)h(curren)m(t)h(timestep)e(\014eld,)k(ZFLD)45
b(is)h(the)0 3528 y(previous)33 b(timestep)e(\014eld)h(and)g(SFLD)g(is)
f(the)i(tendency)h(of)e(the)g(\014eld.)43 b(F)-8 b(or)32
b(a)f(forw)m(ard)i(step,)g(ZFLD)0 3648 y(is)h(set)h(to)f(FLD)f(plus)h
(the)h(pro)s(duct)g(of)e(the)i(timestep,)g(DTM,)f(and)h(SFLD,)e
(whereas)j(for)e(a)g(cen)m(tred)0 3768 y(step,)e(ZFLD)e(is)h(set)g(to)g
(ZFLD)f(plus)h(the)g(pro)s(duct)h(of)e(t)m(wice)i(the)f(timestep,)g
(DTM)p 3101 3768 V 36 w(X2,)g(and)g(SFLD.)0 3889 y(Th)m(us,)j(ZFLD)d
(con)m(tains)i(the)g(new)h(timestep)e(v)-5 b(alue)32
b(of)g(the)h(\014eld)f(at)g(the)h(end)h(of)e(the)h(routine.)0
4298 y Fp(SUBDGS)0 4603 y Fw(Called)j(b)m(y:)113 b Fv(NNSTEPS)0
4724 y Fw(Calls:)e Fv(WRAP)146 4964 y(Calculates)31 b(the)h(subgrid)e
(time-a)m(v)m(eraged)h(diagnostics.)42 b(Firstly)-8 b(,)30
b(the)i(energy)g(dissipations)e(due)0 5085 y(to)g(the)g(subgrid)g(mo)s
(del)e(are)i(calculated.)42 b(This)30 b(has)g(to)g(accoun)m(t)g(for)g
(the)g(bac)m(kscattering)h(of)e(energy)0 5205 y(and)46
b(requires)g(the)h(v)-5 b(alues)45 b(of)h(the)g(mixing)e(length)h
(squared)i(\(ELAMR)p 2799 5205 V 36 w(SQ\))f(and)f(half)g(squared)0
5325 y(strain)38 b(rate)h(\(SSQ\))f(calculated)g(in)g
Fw(SMA)m(G)h Fv(etc.)62 b(Th)m(us,)42 b(these)d(subgrid)g(diagnostic)e
(ha)m(v)m(e)j(to)e(b)s(e)0 5446 y(calculated)k(on)g(the)h(same)f(slice)
g(that)g(VIS)h(and)g(DIFF)e(ha)m(v)m(e)j(b)s(een)f(calculated)f(for)g
(consistency)-8 b(.)0 5566 y(SUBE)39 b(con)m(tains)g(the)g(viscous)h
(dissipation)d(and)i(SUBETH)h(the)f(temp)s(erature)f(v)-5
b(ariance)39 b(loss.)61 b(A)0 5687 y(series)30 b(of)e(subgrid)h
(diagnostics)g(are)g(then)h(calculated)e(in)g(a)h(big)f(lo)s(op)g(o)m
(v)m(er)i(J,)g(with)e(DGNEW)h(b)s(eing)0 5807 y(incremen)m(ted)k(with)f
(the)h(appropriate)f(v)-5 b(alue)32 b(in)g(the)h(appropriate)e(index)i
(for)f(eac)m(h)i(diagnostic.)1841 6107 y(95)p eop
%%Page: 96 99
96 98 bop 0 52 a Fp(SW)-15 b(APSMTH)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(NNSTEPS)0 478 y Fw(Calls:)e Fv(-)146
719 y(Sw)m(aps)42 b(the)g(time-lev)m(els)d(of)h(the)i(prognostic)e
(\014elds)h(and)g(horizon)m(tal)e(means)i(and)g(carries)g(out)0
839 y(a)46 b(time-smo)s(othing)d(op)s(eration.)85 b(The)47
b(co)s(e\016cien)m(ts)h(for)e(the)i(time-smo)s(other,)f(C1)g(and)g(C2,)
j(are)0 959 y(set)42 b(up)f(dep)s(ending)g(on)g(whether)i(the)e(Rob)s
(ert)g(or)f(standard)i(time-smo)s(other)c(has)k(b)s(een)f(selected)0
1080 y(\(ITSMTH=1)35 b(or)f(2,)g(resp)s(ectiv)m(ely\).)48
b(Firstly)-8 b(,)33 b(the)i(Rob)s(ert)e(\014lter)g(is)h(considered.)48
b(F)-8 b(or)33 b(the)i(U)f(\014eld,)0 1200 y(U)29 b(con)m(tains)h(the)f
(curren)m(t)i(timestep)e(v)-5 b(alue,)29 b(ZU)g(the)h(new)g(stepp)s(ed)
g(v)-5 b(alue)29 b(and)g(SA)-11 b(VU)30 b(the)g(previous)0
1321 y(timestep)36 b(v)-5 b(alue.)53 b(U)37 b(is)e(assigned)i(to)f
(UTMP1,)i(and)e(ZU)g(to)g(U,)g(so)g(that)g(U)g(will)e(con)m(tain)i(the)
h(new)0 1441 y(stepp)s(ed)28 b(\014eld,)f(whic)m(h)g(will)d(b)s(e)j
(the)g(curren)m(t)h(timestep)e(\014eld)g(on)g(the)h(next)h(timestep.)41
b(ZU)26 b(is)g(then)h(set)0 1561 y(to)33 b(a)h(com)m(bination)d(of)j
(UTMP1,)h(U)e(and)h(SA)-11 b(VU,)35 b(whic)m(h)f(will)d(b)s(e)j(a)f
(smo)s(othed)h(previous)g(timestep)0 1682 y(v)-5 b(alue)32
b(on)g(the)h(next)g(timestep.)43 b(An)33 b(analogous)e(pro)s(cedure)i
(is)f(carried)g(out)g(for)g(V)g(and)h(W.)g(F)-8 b(or)31
b(the)0 1802 y(scalars,)44 b(TH)e(and)f(Q,)h(smo)s(othing)d(w)m(as)k
(partially)c(carried)i(out)g(b)s(efore)h(the)g(\014elds)f(w)m(ere)i
(stepp)s(ed)0 1923 y(and)36 b(this)f(is)g(completed)g(here.)54
b(F)-8 b(or)35 b(TH,)h(ZTH)g(is)f(assigned)h(to)f(TH)p
2599 1923 30 4 v 36 w(NP1,)i(and)e(then)i(ZTH)e(set)i(to)0
2043 y(TH)f(plus)e(a)h(fraction)f(of)g(TH)p 1096 2043
V 36 w(NP1.)51 b(TH)36 b(is)e(then)i(set)f(to)g(TH)p
2321 2043 V 36 w(NP1.)51 b(Again,)34 b(the)i(time-lev)m(els)d(ha)m(v)m
(e)0 2163 y(b)s(een)39 b(sw)m(app)s(ed)h(so)f(that)f(TH)h(will)d(b)s(e)
i(the)h(curren)m(t)g(timestep)f(and)h(ZTH)f(the)h(previous)g(timestep)0
2284 y(on)k(the)g(next)h(mo)s(del)e(step.)76 b(A)43 b(similar)d(action)
i(is)h(carried)f(out)h(on)g(the)h(Q)f(\014elds.)75 b(The)44
b(Rob)s(ert)0 2404 y(\014lter)35 b(is)g(completed)f(b)m(y)j(carrying)e
(out)g(exactly)g(the)h(same)f(pro)s(cedure)i(on)e(the)h(horizon)m(tal)d
(means,)0 2524 y(OLUBAR)f(etc.)146 2765 y(The)g(standard)f(time-smo)s
(other)d(exc)m(hanges)33 b(a)d(small)e(fraction)h(b)s(et)m(w)m(een)k
(the)e(U)f(and)h(ZU)f(\014elds.)0 2886 y(This)36 b(is)f(a)g(fairly)f
(trivial)e(pro)s(cedure,)38 b(and)d(is)g(conducted)i(as)f(the)g(U)g
(and)f(ZU)g(\014elds)h(are)g(sw)m(app)s(ed,)0 3006 y(using)i(the)g
(temp)s(orary)g(store)g(UTMP1.)61 b(An)38 b(analogous)f(pro)s(cedure)i
(is)e(used)j(for)d(all)f(other)i(\014elds)0 3126 y(and)33
b(the)g(horizon)m(tal)e(means.)0 3536 y Fp(TESTCFL)0
3841 y Fw(Called)36 b(b)m(y:)113 b Fv(NNSTEPS)0 3961
y Fw(Calls:)e Fv(-)146 4202 y(T)-8 b(ests)34 b(the)f(Couran)m(t)f(n)m
(um)m(b)s(er)h(and)f(alters)g(the)h(timestep)e(as)i(appropriate.)42
b(The)34 b(computations)0 4322 y(of)40 b(the)g(v)m(elo)s(cit)m(y)h
(Couran)m(t)f(n)m(um)m(b)s(er,)j(CVEL,)e(and)g(viscous)g(Couran)m(t)f
(n)m(um)m(b)s(er,)j(CVIS,)e(are)g(com-)0 4443 y(pleted)g(b)m(y)h(m)m
(ultiplying)c(b)m(y)j(the)h(timestep)e(and)h(dividing)e(b)m(y)j(the)g
(grid)e(spacing.)68 b(The)42 b(Couran)m(t)0 4563 y(n)m(um)m(b)s(er,)32
b(CFLNO,)f(is)g(then)h(calculated)e(as)i(the)f(sum)g(of)g(the)h(ratios)
e(of)h(CVEL)h(and)f(CVIS)h(to)f(their)0 4683 y(target)37
b(v)-5 b(alues,)39 b(CVELMAX)g(and)f(CVISMAX.)h(The)g(new)g(timestep,)f
(DTMNEW,)h(can)f(then)g(b)s(e)0 4804 y(determined)32
b(b)m(y)i(dividing)d(the)i(curren)m(t)g(timestep,)g(DTM,)f(b)m(y)i
(CFLNO.)0 5213 y Fp(TESTTIME)0 5518 y Fw(Called)i(b)m(y:)113
b Fv(NNSTEPS)0 5638 y Fw(Calls:)e Fv(-)1841 6107 y(96)p
eop
%%Page: 97 100
97 99 bop 146 52 a Fv(Chec)m(ks)50 b(whether)e(it)e(is)h(time)f(to)g
(carry)i(out)f(preset)h(time-dep)s(enden)m(t)f(actions.)87
b(These)48 b(are)0 173 y(sp)s(eci\014ed)32 b(in)f(the)h(arra)m(ys)g
(TIMPDG)f(\(time)f(to)h(write)h(diagnostics)e(\014le\),)h(TIMRDG)g
(\(time)f(to)h(reset)0 293 y(diagnostics)41 b(and)h(write)g
(diagnostics)f(\014le\),)k(TIMDUMP)e(\(time)e(to)g(write)h(a)g(mo)s
(del)f(dump\))g(and)0 414 y(TIMHAL)-8 b(T)30 b(\(time)c(to)i(halt)f
(the)h(run\).)43 b(Flags)27 b(for)g(eac)m(h)i(of)f(these)h(actions,)g
(ITIMPDG,)f(ITIMRDG,)0 534 y(ITIMDUM)e(and)f(ITIMHAL)-8
b(T)26 b(are)f(all)e(set)i(to)g(zero,)h(along)e(with)g(ITIMEUP)-8
b(,)27 b(whic)m(h)e(is)g(raised)f(if)g(an)m(y)0 654 y(other)34
b(\015ag)f(is)g(raised.)46 b(Eac)m(h)34 b(arra)m(y)g(is)f(c)m(hec)m(k)m
(ed)k(in)c(turn.)46 b(If)34 b(mo)s(del)d(time,)i(TIME,)i(is)e(greater)g
(than)0 775 y(the)j(arra)m(y)h(v)-5 b(alue)35 b(then)i(that)f(arra)m(y)
g(v)-5 b(alue)35 b(is)h(set)g(to)g(TIMLAR)m(GE,)h(a)f(v)m(ery)i(large)c
(v)-5 b(alue,)37 b(and)f(the)0 895 y(appropriate)e(\015ags)h(raised.)50
b(Finally)-8 b(,)33 b(the)i(n)m(um)m(b)s(er)h(of)e(steps)i(are)f(c)m
(hec)m(k)m(ed)j(against)c(NSTEPMAX,)0 1016 y(the)39 b(maxim)m(um)d(n)m
(um)m(b)s(er)j(of)f(steps)i(allo)m(w)m(ed,)f(and)g(the)g(same)f
(\015ags)h(raised)f(as)h(for)f(the)h(end)g(of)f(the)0
1136 y(run.)51 b(The)36 b(\015ags)f(are)g(used)h(in)e
Fw(NNSTEPS)g Fv(to)g(determine)h(whether)h(to)f(call)e
Fw(EXXIT)g Fv(and)i(what)0 1256 y(v)-5 b(alue)32 b(of)g(ISTOPU)i(to)e
(use.)0 1666 y Fp(THSOUR)l(CE)0 1971 y Fw(Called)k(b)m(y:)113
b Fv(D)m(YNVIS)0 2091 y Fw(Calls:)e Fv(TVDSCAL,)34 b(EQUA)-8
b(TE,)33 b(EXXIT)146 2332 y(Calculates)h(the)h(dynamical)d(tendency)k
(terms)e(for)g(the)h(p)s(oten)m(tial)d(temp)s(erature)i(p)s
(erturbation)0 2452 y(\(TH\))27 b(\014eld)f(for)g(a)g(3-D)f(run.)41
b(The)27 b(source)h(terms)e(for)g(the)h(adv)m(ection,)h(di\013usion,)e
(damping)f(la)m(y)m(er)h(and)0 2573 y(large-scale)f(forcing)g(are)h
(calculated.)40 b(The)27 b(adv)m(ection)g(is)e(dealt)h(with)g(\014rst.)
42 b(If)26 b(the)g(UL)-8 b(TIMA)g(TE)28 b(ad-)0 2693
y(v)m(ection)i(sc)m(heme)g(has)g(b)s(een)g(requested)h(for)e(scalars)g
(\(ITVDSCALP=1\))h(then)g(the)f(adv)m(ection)h(term)0
2813 y(is)d(calculated)h(and)g(assigned)g(to)f(STH)i(in)e(the)i
(routine)e Fw(TVDSCAL)p Fv(.)h(Alternativ)m(ely)-8 b(,)28
b(the)g(Piacsek-)0 2934 y(Williams)h(cen)m(tred)35 b(di\013erence)f
(adv)m(ection)f(sc)m(heme)i(is)d(used.)47 b(The)34 b(discretization)d
(is)i(not)g(complex,)0 3054 y(and)f(a)g(sp)s(ecial)f(case)i(is)f(used)i
(for)d(the)i(top)f(mo)s(del)e(lev)m(el.)43 b(Because)34
b(TH)f(represen)m(ts)h(a)e(p)s(erturbation)0 3174 y(from)e(the)i
(reference)i(state,)e(THREF,)g(then)g(this)g(m)m(ust)f(also)g(b)s(e)h
(v)m(ertically)e(adv)m(ected)k(to)d(complete)0 3295 y(the)45
b(adv)m(ection)g(term.)79 b(This)44 b(is)g(only)g(carried)g(out)h(for)f
(the)h(anelastic)e(case,)49 b(as)44 b(in)g(the)h(Boussi-)0
3415 y(nesq)34 b(case)f(THREF)f(is)g(constan)m(t)h(with)f(heigh)m(t.)43
b(The)33 b(adv)m(ection)g(is)f(completed)f(b)m(y)i(the)g(horizon)m(tal)
0 3536 y(adv)m(ection)41 b(of)f(baro)s(clinicit)m(y)-8
b(,)40 b(if)g(the)h(run)g(is)f(baro)s(clinic)e(\(IBAR)m(OCLP=1\).)69
b(The)41 b(thermal)f(wind)0 3656 y(equation)29 b(is)f(used)i(to)f
(determine)g(the)g(large)f(scale)h(horizon)m(tal)e(gradien)m(t)i(in)f
(p)s(oten)m(tial)g(temp)s(erature)0 3776 y(here,)j(so)g(that)f(it)f(is)
g(written)h(in)f(terms)h(of)g(the)h(geostrophic)e(wind)h(shear)h
(\(DUGDZ)d(and)j(D)m(V)m(GDZ\).)0 3897 y(Baro)s(clinicit)m(y)23
b(is)i(not)g(supp)s(orted)i(in)d(a)i(moist)e(run)h(\(IP)-8
b(ASQP=0\))26 b(in)f(whic)m(h)h(case)h Fw(EXXIT)d Fv(is)h(called)0
4017 y(with)32 b(ISTOPU=2.)45 b(\(This)32 b(parameter)g(con\015ict)h
(should)f(b)s(e)h(trapp)s(ed)g(in)f Fw(CHKP)-9 b(ARMS)p
Fv(.\))146 4258 y(Di\013usion)43 b(uses)j(a)e Fm(r)967
4222 y Fs(2)1051 4258 y Fv(op)s(erator)g(and,)k(again,)e(this)e(is)g
(straigh)m(tforw)m(ard.)79 b(DIFF)43 b(is)h(held)h(on)0
4378 y Fn(w)s Fv(-p)s(oin)m(ts)f(and)i(needs)h(to)f(b)s(e)g(a)m(v)m
(eraged)h(on)m(to)e(v)m(elo)s(cit)m(y)h(p)s(oin)m(ts)f(for)g(the)i
(correct)f(discretization.)0 4499 y(P)m(aren)m(theses)38
b(are)c(used)i(to)f(ensure)h(symmetrical)c(calculations.)48
b(The)36 b(top)e(mo)s(del)g(lev)m(el)g(is)g(treated)0
4619 y(separately)-8 b(.)42 b(Again,)29 b(for)f(the)h(anelastic)f
(case,)i(the)f(v)m(ertical)f(di\013usion)f(of)i(the)g(reference)h
(state)f(needs)0 4739 y(to)42 b(b)s(e)g(calculated)f(separately)-8
b(.)73 b(The)43 b(damping)d(la)m(y)m(er)i(in)m(v)m(olv)m(es)h(relaxing)
e(the)i(\014eld)e(v)-5 b(alues)42 b(bac)m(k)0 4860 y(to)h(the)h
(horizon)m(tal)d(mean.)76 b(F)-8 b(or)42 b(the)i(large-scale)d
(forcing,)k(if)e(subsidence)i(is)d(used)j(\(ISUBP=1\),)0
4980 y(then)33 b(v)m(ertical)e(adv)m(ection)h(is)f(applied)g(to)h(the)g
(horizon)m(tal)e(mean)i(\014elds;)g(for)f(prescrib)s(ed)i(large-scale)0
5101 y(forcing)e(\(IF)m(OR)m(CEP=1\),)j(STHLS)f(is)f(added)i(to)e(STH.)
0 5510 y Fp(TH1D)0 5815 y Fw(Called)k(b)m(y:)113 b Fv(D)m(YNVIS)1841
6107 y(97)p eop
%%Page: 98 101
98 100 bop 0 52 a Fw(Calls:)111 b Fv(EXXIT)146 293 y(Calculates)34
b(the)h(dynamical)d(tendency)k(terms)e(for)g(the)h(p)s(oten)m(tial)d
(temp)s(erature)i(p)s(erturbation)0 414 y(\(TH\))39 b(\014eld)f(for)g
(a)g(1-D)f(run.)61 b(The)39 b(source)h(terms)e(for)g(the)h
(di\013usion,)f(adv)m(ection)h(of)f(baro)s(clinicit)m(y)0
534 y(and)45 b(large-scale)e(forcing)h(are)h(calculated.)80
b(The)46 b(adv)m(ection)f(of)g(baro)s(clinicit)m(y)d(is)j(calculated)f
(b)m(y)0 654 y(using)36 b(the)h(thermal)e(wind)h(equation)g(to)g
(determine)g(the)h(large)f(scale)g(horizon)m(tal)f(gradien)m(t)h(in)f
(p)s(o-)0 775 y(ten)m(tial)e(temp)s(erature.)49 b(Th)m(us)35
b(it)f(is)g(written)g(in)f(terms)h(of)g(the)h(geostrophic)f(wind)g
(shear)h(\(DUGDZ)0 895 y(and)g(D)m(V)m(GDZ\).)f(Baro)s(clinicit)m(y)e
(is)i(not)h(supp)s(orted)h(in)e(a)h(moist)e(run)j(\(IP)-8
b(ASQP=0\))35 b(in)f(whic)m(h)i(case)0 1016 y Fw(EXXIT)25
b Fv(is)h(called)g(with)g(ISTOPU=2.)43 b(\(This)27 b(parameter)f
(con\015ict)g(should)h(b)s(e)g(trapp)s(ed)g(in)f Fw(CHK-)0
1136 y(P)-9 b(ARMS)p Fv(.\))146 1377 y(Only)42 b(the)g(v)m(ertical)f
(comp)s(onen)m(t)h(of)f(di\013usion)g(needs)i(to)e(b)s(e)h(considered.)
72 b(F)-8 b(or)41 b(the)h(anelastic)0 1497 y(case,)31
b(the)f(v)m(ertical)f(di\013usion)g(of)g(the)h(reference)h(state)f(of)g
(p)s(oten)m(tial)e(temp)s(erature,)i(THREF,)g(needs)0
1617 y(to)35 b(b)s(e)h(calculated)e(separately)-8 b(.)52
b(F)-8 b(or)35 b(Boussinesq)i(runs)f(THREF)g(is)f(constan)m(t)h(with)f
(heigh)m(t)g(so)h(the)0 1738 y(calculation)d(is)h(unnecessary)-8
b(.)54 b(F)-8 b(or)35 b(the)g(large-scale)f(forcing,)h(if)f(subsidence)
j(is)e(used)h(\(ISUBP=1\),)0 1858 y(then)d(v)m(ertical)e(adv)m(ection)h
(is)f(applied)g(to)h(the)g(horizon)m(tal)e(mean)i(\014elds;)g(for)f
(prescrib)s(ed)i(large-scale)0 1979 y(forcing)e(\(IF)m(OR)m(CEP=1\),)j
(STHLS)f(is)f(added)i(to)e(STH.)0 2388 y Fp(TH2D)0 2693
y Fw(Called)k(b)m(y:)113 b Fv(D)m(YNVIS)0 2813 y Fw(Calls:)e
Fv(TVDSC2D,)33 b(EQUA)-8 b(TE,)34 b(EXXIT)146 3054 y(Calculates)g(the)h
(dynamical)d(tendency)k(terms)e(for)g(the)h(p)s(oten)m(tial)d(temp)s
(erature)i(p)s(erturbation)0 3174 y(\(TH\))29 b(\014eld)g(for)f(a)g
(2-D)g(run.)42 b(Th)m(us)30 b(an)m(y)g Fn(@)5 b(=@)g(x)30
b Fv(terms)f(are)g(assumed)g(to)g(b)s(e)g(zero.)42 b(The)30
b(source)g(terms)0 3295 y(for)41 b(the)i(adv)m(ection,)h(di\013usion,)g
(damping)c(la)m(y)m(er)i(and)g(large-scale)e(forcing)h(are)h
(calculated.)71 b(The)0 3415 y(adv)m(ection)32 b(is)f(dealt)g(with)g
(\014rst.)43 b(If)32 b(the)g(UL)-8 b(TIMA)g(TE)33 b(adv)m(ection)f(sc)m
(heme)g(has)g(b)s(een)g(requested)i(for)0 3536 y(scalars)h
(\(ITVDSCALP=1\))g(then)g(the)g(adv)m(ection)h(term)e(is)g(calculated)g
(and)h(assigned)f(to)h(STH)g(in)0 3656 y(the)27 b(routine)g
Fw(TVDSC2D)p Fv(.)g(Alternativ)m(ely)-8 b(,)27 b(the)g
(Piacsek-Williams)d(cen)m(tred)k(di\013erence)g(adv)m(ection)0
3776 y(sc)m(heme)35 b(is)f(used.)50 b(The)35 b(discretization)e(is)g
(not)h(complex,)h(and)f(a)g(sp)s(ecial)f(case)i(is)f(used)h(for)f(the)h
(top)0 3897 y(mo)s(del)40 b(lev)m(el.)71 b(Because)43
b(TH)g(represen)m(ts)h(a)d(p)s(erturbation)g(from)g(the)h(reference)h
(state,)i(THREF,)0 4017 y(then)37 b(this)e(m)m(ust)h(also)f(b)s(e)h(v)m
(ertically)f(adv)m(ected)j(to)d(complete)h(the)g(adv)m(ection)g(term.)
53 b(This)37 b(is)e(only)0 4138 y(carried)44 b(out)g(for)f(the)i
(anelastic)e(case,)48 b(as)d(in)e(the)i(Boussinesq)g(case)h(THREF)e(is)
g(constan)m(t)h(with)0 4258 y(heigh)m(t.)d(The)29 b(adv)m(ection)g(is)e
(completed)h(b)m(y)h(the)g(horizon)m(tal)e(adv)m(ection)h(of)g(baro)s
(clinicit)m(y)-8 b(,)26 b(if)i(the)g(run)0 4378 y(is)i(baro)s(clinic)e
(\(IBAR)m(OCLP=1\).)43 b(The)31 b(thermal)e(wind)h(equation)g(is)g
(used)h(to)f(determine)g(the)h(large)0 4499 y(scale)25
b(horizon)m(tal)e(gradien)m(t)i(in)f(p)s(oten)m(tial)f(temp)s(erature)i
(here,)i(so)e(that)g(it)f(is)g(written)h(in)f(terms)h(of)f(the)0
4619 y(geostrophic)30 b(wind)f(shear)i(\(DUGDZ)d(and)i(D)m(V)m(GDZ\).)e
(Baro)s(clinicit)m(y)g(is)h(not)h(supp)s(orted)g(in)f(a)h(moist)0
4739 y(run)44 b(\(IP)-8 b(ASQP=0\))45 b(in)e(whic)m(h)i(case)g
Fw(EXXIT)d Fv(is)i(called)e(with)i(ISTOPU=2.)79 b(\(This)44
b(parameter)0 4860 y(con\015ict)32 b(should)h(b)s(e)g(trapp)s(ed)f(in)g
Fw(CHKP)-9 b(ARMS)p Fv(.\))146 5101 y(Di\013usion)43
b(uses)j(a)e Fm(r)967 5064 y Fs(2)1051 5101 y Fv(op)s(erator)g(and,)k
(again,)e(this)e(is)g(straigh)m(tforw)m(ard.)79 b(DIFF)43
b(is)h(held)h(on)0 5221 y Fn(w)s Fv(-p)s(oin)m(ts)f(and)i(needs)h(to)f
(b)s(e)g(a)m(v)m(eraged)h(on)m(to)e(v)m(elo)s(cit)m(y)h(p)s(oin)m(ts)f
(for)g(the)i(correct)f(discretization.)0 5341 y(P)m(aren)m(theses)38
b(are)c(used)i(to)f(ensure)h(symmetrical)c(calculations.)48
b(The)36 b(top)e(mo)s(del)g(lev)m(el)g(is)g(treated)0
5462 y(separately)-8 b(.)42 b(Again,)29 b(for)f(the)h(anelastic)f
(case,)i(the)f(v)m(ertical)f(di\013usion)f(of)i(the)g(reference)h
(state)f(needs)0 5582 y(to)42 b(b)s(e)g(calculated)f(separately)-8
b(.)73 b(The)43 b(damping)d(la)m(y)m(er)i(in)m(v)m(olv)m(es)h(relaxing)
e(the)i(\014eld)e(v)-5 b(alues)42 b(bac)m(k)0 5702 y(to)h(the)h
(horizon)m(tal)d(mean.)76 b(F)-8 b(or)42 b(the)i(large-scale)d
(forcing,)k(if)e(subsidence)i(is)d(used)j(\(ISUBP=1\),)0
5823 y(then)34 b(adv)m(ection)h(is)e(applied)g(to)g(the)i(horizon)m
(tal)d(mean)h(\014elds;)i(for)f(prescrib)s(ed)g(large-scale)f(forcing)
1841 6107 y(98)p eop
%%Page: 99 102
99 101 bop 0 52 a Fv(\(IF)m(OR)m(CEP=1\),)33 b(STHLS)h(is)e(added)h(to)
f(STH.)0 462 y Fp(TIMSER)0 767 y Fw(Called)k(b)m(y:)113
b Fv(NNSTEPS)0 887 y Fw(Calls:)e Fv(EXXIT)146 1128 y(Calculates)33
b(the)h(timeseries)f(diagnostics.)46 b(First)32 b(of)i(all)d(the)j
(index,)g(ITND,)g(for)f(the)h(timeseries)0 1248 y(arra)m(y)-8
b(,)45 b(SER,)d(is)g(incremen)m(ted.)73 b(If)42 b(ITND)g(exceeds)j(the)
e(size)f(of)g(the)g(timeseries,)i(NTIMP)-8 b(,)44 b(then)0
1369 y Fw(EXXIT)36 b Fv(is)h(called)f(with)h(ISTOPU=13.)59
b(Next,)40 b(a)d(n)m(um)m(b)s(er)h(of)f(scalars)h(used)g(in)f(the)h
(calculation)0 1489 y(of)i(the)i(timeseries)e(are)h(initialised:)56
b(SENHF)42 b(for)e(the)h(sensible)g(surface)h(heat)f(\015ux,)j(LA)-8
b(THF)41 b(for)0 1609 y(the)h(surface)g(laten)m(t)f(heat)g(\015ux,)k
(UFLUX)c(and)h(VFLUX)f(for)g(the)h(surface)g(stresses,)k(WMAX)c(for)0
1730 y(the)28 b(maxim)m(um)d(v)m(ertical)i(v)m(elo)s(cit)m(y)-8
b(,)29 b(WMIN)f(for)f(the)h(minim)m(um)d(v)m(ertical)i(v)m(elo)s(cit)m
(y)-8 b(,)28 b(MFLUX)g(for)f(the)0 1850 y(v)m(ertically)35
b(in)m(tegrated)h(mass)g(\015ux,)i(LIQCC)f(for)f(the)g(liquid)f(cloud)g
(co)m(v)m(er,)k(TOTCC)f(for)d(the)i(total)0 1971 y(cloud)e(co)m(v)m
(er,)i(CTOCC)g(for)e(the)h(cold)e(cloud)h(co)m(v)m(er,)j(CL)-8
b(TOP)36 b(for)f(the)h(liquid)d(cloud)i(top,)h(CLBAS)0
2091 y(for)k(the)i(liquid)d(cloud)i(base,)j(CITOP)e(for)e(the)i(ice)f
(cloud)f(top,)j(CIBAS)f(for)f(the)g(ice)g(cloud)g(base,)0
2211 y(QLMAX)30 b(for)g(the)g(maxim)m(um)e(liquid)g(w)m(ater,)j(HQLMAX)
g(for)e(the)i(heigh)m(t)f(of)f(the)i(maxim)m(um)c(liquid)0
2332 y(w)m(ater,)47 b(QXMAX)e(for)e(the)h(maxim)m(um)d(of)j(a)f(Q)h
(\014eld,)i(and)e(HQXMAX)g(for)g(the)g(heigh)m(t)f(of)h(that)0
2452 y(maxim)m(um.)c(Eac)m(h)30 b(term)e(is)g(then)i(calculated)d(in)h
(turn)h(lo)s(oping)e(o)m(v)m(er)j(all)c(the)j(mo)s(del)f(p)s(oin)m(ts)g
(on)h(that)0 2573 y(PE.)44 b(Most)f(calculations)e(are)i(straigh)m
(tforw)m(ard,)i(but)e(the)h(calculation)c(of)j(the)g(cloud)g(co)m(v)m
(er)h(uses)0 2693 y(\015ags)33 b(to)g(ensure)i(that)e(cloudy)g(columns)
g(are)g(not)g(coun)m(ted)i(t)m(wice.)46 b(Once)34 b(the)f(cloud)g(has)h
(exceeded)0 2813 y(the)28 b(threshold)h(once)f(in)g(the)g(column)f
(then)i(the)f(\015ag)g(is)g(raised)f(whic)m(h)i(prev)m(en)m(ts)h(that)e
(column)f(b)s(eing)0 2934 y(coun)m(ted)43 b(as)f(cloudy)g(again.)69
b(The)43 b(surface)f(heat)g(\015uxes)h(and)f(stresses)i(are)e
(calculated)f(from)f(the)0 3054 y(surface)33 b(subgrid)g(diagnostic)e
(v)-5 b(alues)32 b(held)h(in)f(DGNEW.)146 3295 y(The)46
b(next)g(set)g(of)f(timeseries)f(to)h(b)s(e)g(considered)h(are)f(the)g
(radiation)e(\014elds)i(for)g(whic)m(h)g(OL-)0 3415 y(RA)-11
b(V,)45 b(the)g(outgoing)e(longw)m(a)m(v)m(e,)49 b(DSL)-11
b(W)g(A)g(V,)45 b(the)h(do)m(wn)m(w)m(elling)e(surface)i(longw)m(a)m(v)
m(e,)i(USL)-11 b(W)g(A)g(V,)0 3536 y(the)35 b(up)m(w)m(elling)e
(surface)i(longw)m(a)m(v)m(e,)g(DTSW)-11 b(A)g(V,)36
b(the)e(do)m(wn)m(w)m(elling)g(top)g(of)g(the)h(atmosphere)f(\(toa\))0
3656 y(short)m(w)m(a)m(v)m(e,)47 b(UTSW)-11 b(A)g(V,)43
b(the)f(up)m(w)m(elling)e(toa)i(short)m(w)m(a)m(v)m(e,)k(DSSW)-11
b(A)g(V,)42 b(the)g(do)m(wn)m(w)m(elling)g(surface)0
3776 y(short)m(w)m(a)m(v)m(e,)i(and)c(USSW)-11 b(A)g(V,)41
b(the)f(up)m(w)m(elling)e(surface)j(short)m(w)m(a)m(v)m(e,)j(are)39
b(all)f(initiated.)62 b(These)41 b(are)0 3897 y(simply)g(calculated)h
(b)m(y)h(summing)e(the)i(relev)-5 b(an)m(t)43 b(diagnostic)e(arra)m(ys)
i(assigned)g(in)f(the)h(radiation)0 4017 y(co)s(de.)g(These)30
b(are)f(follo)m(w)m(ed)f(b)m(y)i(the)f(column)f(classi\014ed)h
(timeseries)f(for)g(con)m(v)m(ectiv)m(e)k(and)d(stratiform)0
4138 y(areas)41 b(and)h(precipitation)c(\(A)m(CV,)43
b(AST,)e(PPTCV)i(and)e(PPTST)i(resp)s(ectiv)m(ely\),)i(plus)c(the)g
(total)0 4258 y(in)m(tegrals)d(of)g(the)h(w)m(ater)h(sp)s(ecies)f
(mixing)e(ratios.)61 b(A)39 b(timeseries)f(of)g(accum)m(ulated)g
(precipitation,)0 4378 y(PUD)m(X,)26 b(is)g(also)f(calculated)f(at)i
(this)f(stage,)j(follo)m(w)m(ed)d(b)m(y)i(the)f(resolv)m(ed)h(and)e
(subgrid)h(kinetic)f(energy)0 4499 y(\(RESEZ)33 b(and)f(SUBEZ\).)146
4739 y(Once)i(all)c(these)k(scalars)e(ha)m(v)m(e)i(b)s(een)f
(calculated)e(the)i(v)-5 b(alues)33 b(can)f(b)s(e)h(group)s(ed)g
(across)g(all)d(PEs.)0 4860 y(F)-8 b(or)35 b(extremes,)i(suc)m(h)g(as)e
(CL)-8 b(TOP)36 b(etc,)h(GC)p 1675 4860 30 4 v 35 w(RMAX)f(and)f(GC)p
2392 4860 V 35 w(RMIN)h(are)g(used,)h(whilst)d(for)h(in)m(te-)0
4980 y(grals)d(GC)p 387 4980 V 35 w(RSUMR)h(is)f(used.)44
b(F)-8 b(or)32 b(determining)f(HQLMX)i(and)g(HQXMX)g(the)g(PE)g(on)g
(whic)m(h)g(the)0 5101 y(maxim)m(um,)38 b(QLMAX)h(or)f(QXMAX,)h(o)s
(ccurs)g(needs)h(to)e(b)s(e)h(iden)m(ti\014ed.)61 b(This)39
b(is)f(done)h(b)m(y)g(sa)m(ving)0 5221 y(QXMAX)34 b(lo)s(cally)c(on)k
(the)f(PE)h(as)g(QMAXSA)-11 b(VE.)35 b(If)e(QMAXSA)-11
b(VE)35 b(is)d(not)h(equal)h(to)e(the)i(domain)0 5341
y(maxim)m(um,)i(HQXMX)i(is)e(set)i(to)f(a)f(large)g(negativ)m(e)h
(default)g(v)-5 b(alue.)56 b(By)38 b(then)f(using)g(GC)p
3443 5341 V 35 w(RMAX)0 5462 y(on)32 b(HQXMX)i(the)f(heigh)m(t)f(of)g
(the)h(maxim)m(um)d(Q)j(v)-5 b(alue)32 b(is)g(retriev)m(ed.)146
5702 y(Finally)-8 b(,)49 b(the)f(scalars)f(are)h(assigned)g(to)f(the)h
(appropriate)f(index)h(of)f(the)h(arra)m(y)g(SER,)g(with)0
5823 y(\014nal)35 b(scaling)g(carried)h(out,)g(suc)m(h)i(as)e(dividing)
e(b)m(y)j(the)g(total)d(n)m(um)m(b)s(er)j(of)e(p)s(oin)m(ts,)i
(TOTPNTS,)h(to)1841 6107 y(99)p eop
%%Page: 100 103
100 102 bop 0 52 a Fv(retriev)m(e)31 b(a)f(domain)f(a)m(v)m(erage)j(or)
e(to)g(con)m(v)m(ert)i(in)m(to)e(the)h(correct)g(units)f(\(SENHF)h(and)
g(LA)-8 b(THF\))31 b(or)f(a)0 173 y(p)s(ercen)m(tage)k(\(LIQCC,)f
(CTOCC)h(and)f(TOTCC\).)0 582 y Fp(TRANSPOSE)0 887 y
Fw(Called)j(b)m(y:)113 b Fv(FF)-11 b(ANAL,)32 b(FFSYNTH)0
1008 y Fw(Calls:)111 b Fv(-)146 1248 y(Sw)m(aps)37 b(the)f(order)g(of)f
(the)h Fn(x)g Fv(and)g Fn(y)t Fv(-direction)d(indices)j(b)s(et)m(w)m
(een)h(a)f(mo)s(del)e(\014eld,)i(FIELD,)f(and)0 1369
y(a)f(data)g(pac)m(k)m(et,)j(P)-8 b(A)m(CKET.)36 b(FIELD)e(is)g
(dimensioned)g(\(IYF,KKP)-8 b(,IXF\))34 b(whilst)g(P)-8
b(A)m(CKET)36 b(is)e(di-)0 1489 y(mensioned)d(\(IXP)-8
b(,KKP)g(,IYP\).)32 b(IST)-8 b(AR)g(T)31 b(giv)m(es)g(the)h(starting)d
(p)s(oin)m(t)h(in)g(the)h(J)g(direction)f(for)g(whic)m(h)0
1609 y(FIELD)36 b(is)f(to)h(b)s(e)h(assigned)f(to)g(P)-8
b(A)m(CKET.)38 b(P)-8 b(A)m(CKET)38 b(is)d(th)m(us)i(set)g(equal)f(to)g
(FIELD)g(b)m(y)h(lo)s(oping)0 1730 y(o)m(v)m(er)d(J=IST)-8
b(AR)g(T+1,IST)g(AR)g(T+IYP)g(,)34 b(K=1,KKP)e(and)h(I=1,IXP)-8
b(.)0 2139 y Fp(TVDSC2D)0 2444 y Fw(Called)36 b(b)m(y:)113
b Fv(TH2D,)32 b(Q2D)0 2565 y Fw(Calls:)111 b Fv(UL)-8
b(TF2D)146 2805 y(Calculates)26 b(the)g(UL)-8 b(TIMA)g(TE)28
b(adv)m(ection)f(of)e(a)h(scalar)f(quan)m(tit)m(y)i(in)f(2-D.)e(Th)m
(us,)29 b(the)e Fn(@)5 b(=@)g(x)28 b Fv(term)0 2926 y(is)33
b(not)g(required.)45 b(The)34 b(face)g(\015uxes)h(for)d(the)i
Fn(y)i Fv(and)d Fn(z)38 b Fv(directions)33 b(are)g(calculated)f(from)g
(the)h(call)f(to)0 3046 y Fw(UL)-9 b(TF2D)32 b Fv(as)f(FFLXL)f(and)i
(FFLXB.)e(These)j(are)e(then)h(used,)h(along)c(with)i(the)h(v)m(elo)s
(cities,)e(V)h(and)0 3166 y(W,)i(to)f(calculate)g(the)h(source)g(term)f
(for)g(the)h(scalar,)f(SF.)146 3407 y(There)h(is)d(the)i(p)s(ossibilit)
m(y)d(of)h(requiring)g(a)h(J=-1)f(v)-5 b(alue)31 b(in)f(the)h
Fw(UL)-9 b(TF2D)32 b Fv(routine.)42 b(If)31 b(the)h(2-D)0
3528 y(run)c(is)g(massiv)m(ely)g(parallel)e(then)i(this)g(v)-5
b(alue)28 b(is)g(held)g(on)g(other)g(PEs)i(and)e(can)g(only)g(b)s(e)g
(retriev)m(ed)i(b)m(y)0 3648 y(message)e(passing.)41
b(This)28 b(is)f(ac)m(hiev)m(ed)h(b)m(y)h(setting)e(up)g(extra)h(halo)e
(arra)m(ys)i(ZFHALO,)f(for)f(the)i(scalar)0 3768 y(\014eld,)k(and)h
(VHALO,)g(for)f(the)h Fn(y)j Fv(comp)s(onen)m(t)c(of)g(v)m(elo)s(cit)m
(y)-8 b(,)33 b(and)f(passing)h(these)h(to)e Fw(UL)-9
b(TF2D)p Fv(.)0 4178 y Fp(TVDSCAL)0 4483 y Fw(Called)36
b(b)m(y:)113 b Fv(THSOUR)m(CE,)34 b(QSOUR)m(CE)0 4603
y Fw(Calls:)111 b Fv(UL)-8 b(TFLX)146 4844 y(Calculates)34
b(the)h(UL)-8 b(TIMA)g(TE)36 b(adv)m(ection)e(of)g(a)g(scalar)f(quan)m
(tit)m(y)i(in)f(3-D.)f(The)i(face)f(\015uxes)i(for)0
4964 y(the)g Fn(y)t Fv(,)f Fn(z)40 b Fv(and)35 b Fn(x)g
Fv(directions)g(are)g(calculated)f(from)g(the)i(call)d(to)i
Fw(UL)-9 b(TFLX)36 b Fv(as)f(FFLXL,)g(FFLXB,)0 5085 y(FFLXI)41
b(and)g(FLXIP1.)70 b(These)43 b(are)e(then)h(used,)j(along)40
b(with)h(the)g(v)m(elo)s(cities,)i(U,)e(V)h(and)f(W,)h(to)0
5205 y(calculate)31 b(the)i(source)h(term)e(for)g(the)h(scalar,)f(SF.)
1817 6107 y(100)p eop
%%Page: 101 104
101 103 bop 0 52 a Fp(TVDUVW)0 358 y Fw(Called)36 b(b)m(y:)113
b Fv(UVWSR)m(CE)0 478 y Fw(Calls:)e Fv(UL)-8 b(TFLX,)33
b(EQUA)-8 b(TE)146 719 y(Calculates)25 b(the)h(UL)-8
b(TIMA)g(TE)28 b(adv)m(ection)e(of)f(the)h(v)m(elo)s(cit)m(y)f(comp)s
(onen)m(ts)h(in)f(3-D.)f(Eac)m(h)j(v)m(elo)s(cit)m(y)0
839 y(comp)s(onen)m(t)k(is)g(treated)h(in)f(turn.)43
b(The)33 b(face)e(\015uxes)i(for)e(the)h Fn(y)t Fv(,)f
Fn(z)36 b Fv(and)31 b Fn(x)h Fv(directions)f(are)g(calculated)0
959 y(from)46 b(the)h(call)e(to)h Fw(UL)-9 b(TFLX)48
b Fv(as)f(FFLXL,)f(FFLXB,)g(FFLXI)g(and)h(UFLXIP1,)k(VFLXIP1)c(or)0
1080 y(WFLXIP1)31 b(dep)s(ending)g(on)g(the)g(v)m(elo)s(cit)m(y)f(comp)
s(onen)m(t.)43 b Fw(UL)-9 b(TFLX)31 b Fv(calculates)f(the)h(\015uxes)i
(for)d(the)0 1200 y(adv)m(ection)j(of)e(a)h(scalar)g(\014eld,)g
(assuming)g(the)g(grid)g(staggering)f(with)h(the)h(scalar)e(at)h(a)g
(P-p)s(oin)m(t)f(and)0 1321 y(the)40 b(v)m(elo)s(cit)m(y)f(comp)s(onen)
m(ts)g(p)s(ositioned)f(at)h(half)f(p)s(oin)m(ts)h(in)g(eac)m(h)h
(direction.)62 b(Th)m(us,)43 b(to)c(calculate)0 1441
y(the)d(\015uxes)g(and)f(the)h(adv)m(ectiv)m(e)h(source)f(terms)f(the)g
(adv)m(ecting)h(v)m(elo)s(cities)e(are)h(a)m(v)m(eraged)h(on)m(to)f
(the)0 1561 y(half)43 b(p)s(oin)m(ts)g(with)g(resp)s(ect)j(to)d(the)h
(adv)m(ected)i(\014eld.)77 b(These)45 b(\\e\013ectiv)m(e")g(v)m(elo)s
(cities)e(are)g(termed)0 1682 y(UEM2,)c(UEM1,)h(UE,)e(UEP1,)h(VEM1,)h
(VE,)e(VEP1,)h(WEM1,)g(WE)f(and)g(WEP1,)h(where)g(U,V)f(or)0
1802 y(W)33 b(corresp)s(onds)h(to)e(the)i(comp)s(onen)m(t)e(and)h(M2,)g
(M1,)g(P1)g(and)g(P2)g(corresp)s(ond)g(to)g(the)g(I-slice)f(with)0
1923 y(resp)s(ect)44 b(to)e(the)g(adv)m(ected)j(\014eld.)72
b(These)45 b(e\013ectiv)m(e)e(v)m(elo)s(cities)e(need)j(to)e(b)s(e)g
(calculated)g(for)g(eac)m(h)0 2043 y(adv)m(ected)35 b(comp)s(onen)m(t)e
(in)f(turn.)45 b(Once)34 b(the)f(face)h(\015uxes)g(ha)m(v)m(e)h(b)s
(een)e(calculated)f(the)i(source)g(term,)0 2163 y(SU,)c(SV)h(or)e(SW,)i
(is)e(calculated)g(and)h(the)h(b)s(ottom)d(face)j(\015uxes,)h(FFLXB,)e
(are)g(sa)m(v)m(ed)h(for)f(use)h(in)e(the)0 2284 y(diagnostics)j
(routines)g(b)m(y)i(assigning)d(to)h(AD)m(V)p 1771 2284
30 4 v 35 w(U,)h(AD)m(V)p 2157 2284 V 35 w(V)g(and)g(AD)m(V)p
2706 2284 V 35 w(W)g(in)e Fw(EQUA)-9 b(TE)p Fv(.)0 2693
y Fp(TVDUVW2D)0 2998 y Fw(Called)36 b(b)m(y:)113 b Fv(UVW2D)0
3118 y Fw(Calls:)e Fv(UL)-8 b(TF2D,)32 b(EQUA)-8 b(TE)146
3359 y(Calculates)40 b(the)g(UL)-8 b(TIMA)g(TE)42 b(adv)m(ection)e(of)g
(the)g(v)m(elo)s(cit)m(y)g(comp)s(onen)m(ts)h(in)e(2-D.)g(Th)m(us,)k
(the)0 3480 y Fn(@)5 b(=@)g(x)28 b Fv(term)e(is)f(not)h(required.)42
b(Eac)m(h)27 b(v)m(elo)s(cit)m(y)f(comp)s(onen)m(t)g(is)g(treated)g(in)
f(turn.)42 b(The)27 b(face)f(\015uxes)i(for)0 3600 y(the)33
b Fn(y)j Fv(and)d Fn(z)k Fv(directions)32 b(are)h(calculated)f(from)f
(the)j(call)d(to)h Fw(UL)-9 b(TF2D)33 b Fv(as)g(FFLXL)f(and)h(FFLXB.)0
3720 y Fw(UL)-9 b(TF2D)48 b Fv(calculates)f(the)i(\015uxes)g(for)e(the)
i(adv)m(ection)f(of)f(a)h(scalar)f(\014eld,)k(assuming)c(the)i(grid)0
3841 y(staggering)38 b(with)h(the)h(scalar)f(at)g(a)g(P-p)s(oin)m(t)f
(and)i(the)g(v)m(elo)s(cit)m(y)f(comp)s(onen)m(ts)h(p)s(ositioned)e(at)
h(half)0 3961 y(p)s(oin)m(ts)j(in)f(eac)m(h)i(direction.)70
b(Th)m(us,)46 b(to)c(calculate)f(the)h(\015uxes)i(and)e(the)g(adv)m
(ectiv)m(e)i(source)f(terms)0 4081 y(the)d(adv)m(ecting)h(v)m(elo)s
(cities)e(are)g(a)m(v)m(eraged)j(on)m(to)d(the)i(half)d(p)s(oin)m(ts)i
(with)g(resp)s(ect)h(to)e(the)i(adv)m(ected)0 4202 y(\014eld.)47
b(These)36 b(\\e\013ectiv)m(e")f(v)m(elo)s(cities)d(are)i(termed)g(VE)h
(and)f(WE)g(for)g(the)g(horizon)m(tal)e(and)i(v)m(ertical)0
4322 y(comp)s(onen)m(t.)51 b(F)-8 b(or)34 b(the)i(adv)m(ection)f(of)g
(V)g(in)f(m)m(ulti-pro)s(cessor)f(run,)k(message)e(passing)g(needs)i
(to)d(b)s(e)0 4443 y(used)k(to)f(calculate)e(the)j(JJP+1)f(halo)e(for)i
(VE)g(and)g(WE.)g(These)i(e\013ectiv)m(e)f(v)m(elo)s(cities)e(need)i
(to)e(b)s(e)0 4563 y(calculated)22 b(for)g(eac)m(h)h(adv)m(ected)i
(comp)s(onen)m(t)d(in)g(turn.)41 b(Once)23 b(the)g(face)g(\015uxes)h
(ha)m(v)m(e)g(b)s(een)f(calculated,)0 4683 y(the)34 b(source)h(term,)e
(SV)h(or)f(SW,)h(is)g(calculated)e(and)i(the)g(b)s(ottom)e(face)i
(\015uxes,)i(FFLXB,)d(are)h(sa)m(v)m(ed)0 4804 y(for)e(use)i(in)d(the)i
(diagnostics)f(routines)h(b)m(y)g(assigning)e(to)i(AD)m(V)p
2371 4804 V 35 w(V)f(and)h(AD)m(V)p 2919 4804 V 35 w(W)g(in)f
Fw(EQUA)-9 b(TE)p Fv(.)146 5045 y(There)45 b(is)d(the)h(p)s(ossibilit)m
(y)e(of)i(requiring)f(a)g(J=-1)h(v)-5 b(alue)42 b(in)g(the)i
Fw(UL)-9 b(TF2D)43 b Fv(routine.)74 b(If)43 b(the)0 5165
y(2-D)35 b(is)g(massiv)m(ely)g(parallel)f(then)i(this)f(v)-5
b(alue)36 b(is)f(held)h(on)f(other)h(PEs)h(and)f(can)g(only)g(b)s(e)g
(retriev)m(ed)0 5285 y(b)m(y)i(message)f(passing.)57
b(This)37 b(is)g(ac)m(hiev)m(ed)h(b)m(y)g(setting)f(up)g(extra)h(halo)e
(arra)m(ys)h(ZFHALO,)g(for)f(the)0 5406 y(adv)m(ected)41
b(\014eld,)h(and)d(VHALO,)h(for)f(the)h Fn(y)j Fv(comp)s(onen)m(t)d(of)
f(the)h(e\013ectiv)m(e)h(v)m(elo)s(cit)m(y)-8 b(,)41
b(and)f(passing)0 5526 y(these)34 b(to)e Fw(UL)-9 b(TF2D)p
Fv(.)1817 6107 y(101)p eop
%%Page: 102 105
102 104 bop 0 52 a Fp(UL)-11 b(TFLX)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(TVDSCAL,)33 b(TVDUVW)0 478 y Fw(Calls:)111
b Fv(-)146 719 y(Calculates)36 b(the)h(limited)d(face)j(\015uxes)h(for)
e(the)h(UL)-8 b(TIMA)g(TE)38 b(adv)m(ection)f(sc)m(heme)h(in)e(3-D.)g
(The)0 839 y(inputs)41 b(are)f(the)h(adv)m(ected)i(\014eld)d(on)g(the)h
(I-2,)h(I-1,)h(I,)d(I+1)h(and)f(I+2)h(slices,)h(ZFM2,)g(ZFM1,)g(ZF,)0
959 y(ZFP1)36 b(and)h(ZFP2)f(and)g(the)h(v)m(elo)s(cities)f(on)g(these)
i(slices,)g(UM2,)g(UM1,)g(U,)f(UP1,)g(VM1,)h(V,)f(VP1,)0
1080 y(WM1,)e(W)f(and)h(WP1.)49 b(The)35 b(outputs)g(are)f(the)h(left)e
(face)h(\()p Fn(x)p Fv(-direction\))f(\015ux,)j(FLXI,)e(the)h(left)e
(face)0 1200 y(\()p Fn(y)t Fv(-direction\))j(\015ux,)41
b(FFLXL,)c(and)i(the)g(b)s(ottom)e(face)i(\015ux,)h(FFLXB.)e(The)i
(calculation)c(for)i(eac)m(h)0 1321 y(\015ux)f(follo)m(ws)d(a)i
(roughly)f(similar)e(pro)s(cedure)j(and)g(is)g(as)g(follo)m(ws.)52
b(The)37 b(v)-5 b(ariable)34 b(names)i(used)h(will)0
1441 y(those)29 b(for)f(the)i(calculation)c(of)i(FFLXB.)g(\(Zs)h(b)s
(ecome)f(Ys)i(or)e(Xs)h(for)f(the)h(calculations)e(of)h(the)h(other)0
1561 y(\015uxes\).)49 b(Firstly)-8 b(,)33 b(dep)s(ending)h(on)g(the)g
(direction)f(of)h(the)g(adv)m(ecting)g(v)m(elo)s(cit)m(y)-8
b(,)34 b(up)m(wind,)h(do)m(wn)m(wind)0 1682 y(and)23
b(cen)m(tre)h(v)-5 b(alues)23 b(are)g(determined,)h(FZU,)e(FZC)h(and)g
(FZU)f(resp)s(ectiv)m(ely)-8 b(.)41 b(These)25 b(are)d(then)i(used)g
(to)0 1802 y(calculate)32 b(the)i(unlimited)d(face)j(v)-5
b(alue,)33 b(FZFS,)g(using)g(m)m(ulti-dimensional)c(in)m(terp)s
(olation.)43 b(As)34 b(w)m(ell)0 1923 y(as)c(spatial)f(in)m(terp)s
(olation,)f(this)i(in)m(v)m(olv)m(es)h(some)f(information)d(concerning)
k(the)f(departure)i(p)s(oin)m(t)d(of)0 2043 y(the)40
b(adv)m(ected)h(v)-5 b(alue,)41 b(whic)m(h)f(leads)g(to)f(a)g(term)g
(in)m(v)m(olving)g(the)h(other)f(comp)s(onen)m(ts)h(of)f(v)m(elo)s
(cities)0 2163 y(and)d(CFL)g(n)m(um)m(b)s(ers.)53 b(The)37
b(next)g(stage)f(is)f(to)g(limit)d(FZFS.)j(This)h(is)f(done)h(b)m(y)h
(normalising)32 b(FZFS)0 2284 y(and)i(FZC)g(with)g(resp)s(ect)h(to)f
(FZU)f(as)h(FZNFS)g(and)g(FZNCS)g(resp)s(ectiv)m(ely)-8
b(.)49 b(The)35 b(p)s(ossible)e(limited)0 2404 y(v)-5
b(alues)37 b(are)h(FZNREFS,)e(whic)m(h)i(is)f(FZNFS)f(taking)h(in)m(to)
g(accoun)m(t)h(the)f(total)f(out\015o)m(w)i(out)f(of)g(the)0
2524 y(b)s(o)m(x)27 b(using)f(the)h(sum)g(of)f(the)h(Couran)m(t)g(n)m
(um)m(b)s(ers)g(\(SUM)p 2083 2524 30 4 v 36 w(CFL)p 2314
2524 V 35 w(OUT\),)g(1.0)f(and)h(FZNCS.)g(FZTEMP)0 2645
y(giv)m(es)h(the)g(limited)d(normalised)h(face)i(v)-5
b(alue,)29 b(and)e(this)h(is)f(unnormalised)g(and)g(assigned)h(to)g
(FFLXB.)0 2765 y(If)40 b(FZC)g(is)g(a)f(lo)s(cal)f(extrem)m(um)j(a)e
(\014rst-order)i(up)m(wind)g(adv)m(ection)f(is)g(used,)j(and)d
(FFLXB=FZC.)0 2886 y(SIGN)33 b(functions)f(are)h(used)g(to)g(minimise)c
(the)k(use)h(of)e(IF)g(tests.)0 3295 y Fp(UL)-11 b(TF2D)0
3600 y Fw(Called)36 b(b)m(y:)113 b Fv(TVDSC2D,)33 b(TVDUVW2D)0
3720 y Fw(Calls:)111 b Fv(-)146 3961 y(Calculates)36
b(the)h(limited)d(face)j(\015uxes)h(for)e(the)h(UL)-8
b(TIMA)g(TE)38 b(adv)m(ection)f(sc)m(heme)h(in)e(2-D.)g(The)0
4081 y(inputs)k(are)g(the)g(adv)m(ected)i(\014eld)d(ZF)g(and)h(the)g(v)
m(elo)s(cities)f(V)h(and)g(W.)g(The)h(outputs)f(are)g(the)g(left)0
4202 y(face)g(\()p Fn(y)t Fv(-direction\))e(\015ux,)43
b(FFLXL,)d(and)g(the)g(b)s(ottom)f(face)h(\015ux,)j(FFLXB.)d(The)h
(calculation)d(for)0 4322 y(eac)m(h)d(\015ux)f(follo)m(ws)e(a)i
(roughly)f(similar)d(pro)s(cedure)35 b(and)f(is)f(as)h(follo)m(ws.)45
b(The)35 b(v)-5 b(ariable)32 b(names)h(used)0 4443 y(will)e(those)k
(for)e(the)h(calculation)d(of)i(FFLXB.)h(\(Zs)f(b)s(ecome)h(Ys)g(for)f
(the)h(calculations)e(of)h(the)h(other)0 4563 y(\015ux\).)66
b(Firstly)-8 b(,)41 b(dep)s(ending)f(on)f(the)i(direction)e(of)g(the)h
(adv)m(ecting)h(v)m(elo)s(cit)m(y)-8 b(,)41 b(up)m(wind,)h(do)m(wn)m
(wind)0 4683 y(and)32 b(cen)m(tre)h(v)-5 b(alues)32 b(are)g
(determined,)g(FZU,)f(FZC)g(and)h(FZU)f(resp)s(ectiv)m(ely)-8
b(.)44 b(These)34 b(are)e(then)g(used)0 4804 y(to)40
b(calculate)e(the)j(unlimited)c(face)j(v)-5 b(alue,)42
b(FZFS,)d(using)g(m)m(ulti-dimensional)c(in)m(terp)s(olation.)63
b(As)0 4924 y(w)m(ell)35 b(as)g(spatial)f(in)m(terp)s(olation,)f(this)i
(in)m(v)m(olv)m(es)h(some)g(terms)f(concerning)g(the)h(departure)g(p)s
(oin)m(t)f(of)0 5045 y(the)40 b(adv)m(ected)h(v)-5 b(alue,)41
b(whic)m(h)f(leads)g(to)f(a)g(term)g(in)m(v)m(olving)g(the)h(other)f
(comp)s(onen)m(ts)h(of)f(v)m(elo)s(cities)0 5165 y(and)d(CFL)g(n)m(um)m
(b)s(ers.)53 b(The)37 b(next)g(stage)f(is)f(to)g(limit)d(FZFS.)j(This)h
(is)f(done)h(b)m(y)h(normalising)32 b(FZFS)0 5285 y(and)i(FZC)g(with)g
(resp)s(ect)h(to)f(FZU)f(as)h(FZNFS)g(and)g(FZNCS)g(resp)s(ectiv)m(ely)
-8 b(.)49 b(The)35 b(p)s(ossible)e(limited)0 5406 y(v)-5
b(alues)37 b(are)h(FZNREFS,)e(whic)m(h)i(is)f(FZNFS)f(taking)h(in)m(to)
g(accoun)m(t)h(the)f(total)f(out\015o)m(w)i(out)f(of)g(the)0
5526 y(b)s(o)m(x)27 b(using)f(the)h(sum)g(of)f(the)h(Couran)m(t)g(n)m
(um)m(b)s(ers)g(\(SUM)p 2083 5526 V 36 w(CFL)p 2314 5526
V 35 w(OUT\),)g(1.0)f(and)h(FZNCS.)g(FZTEMP)0 5646 y(giv)m(es)h(the)g
(limited)d(normalised)h(face)i(v)-5 b(alue,)29 b(and)e(this)h(is)f
(unnormalised)g(and)g(assigned)h(to)g(FFLXB.)0 5767 y(If)38
b(FZC)g(is)f(a)h(lo)s(cal)e(extrem)m(um,)j(a)f(\014rst-order)g(up)m
(wind)h(adv)m(ection)f(is)g(used,)i(and)e(FFLXB=FZC.)1817
6107 y(102)p eop
%%Page: 103 106
103 105 bop 0 52 a Fv(SIGN)33 b(functions)f(are)h(used)g(to)g(minimise)
c(the)k(use)h(of)e(IF)g(tests.)0 462 y Fp(UVWSR)l(CE)0
767 y Fw(Called)k(b)m(y:)113 b Fv(D)m(YNVIS)0 887 y Fw(Calls:)e
Fv(TVDUVW,)33 b(WRAP)146 1128 y(Calculates)38 b(the)h(v)m(elo)s(cit)m
(y)f(source)h(terms)f(for)g(the)h(adv)m(ection,)h(viscosit)m(y)-8
b(,)40 b(Coriolis,)e(buo)m(y)m(ancy)-8 b(,)0 1248 y(damping)36
b(la)m(y)m(er)j(and)f(large-scale)e(forcing)h(in)g(3-D.)g(The)i(source)
g(terms)e(for)h(the)g(v)m(elo)s(cit)m(y)g(comp)s(o-)0
1369 y(nen)m(ts,)d(U,)e(V)g(and)h(W,)f(are)g(SU,)h(SV)f(and)g(SW)h
(resp)s(ectiv)m(ely)-8 b(,)34 b(and)f(they)h(are)g(calculated)e(in)g
(parallel)0 1489 y(for)26 b(eac)m(h)h(pro)s(cess.)42
b(Firstly)-8 b(,)26 b(the)h(adv)m(ection)g(is)e(calculated.)41
b(If)26 b(the)h(UL)-8 b(TIMA)g(TE)28 b(adv)m(ection)e(sc)m(heme)0
1609 y(has)39 b(b)s(een)g(requested)h(for)e(momen)m(tum)f
(\(ITVDUVWP=1\))i(then)g(the)g(adv)m(ection)f(terms)g(are)h(cal-)0
1730 y(culated)e(and)h(assigned)f(to)g(SU,)h(SV)f(and)h(SW)f(in)g(the)g
(routine)g Fw(TVDUVW)p Fv(.)g(Alternativ)m(ely)-8 b(,)37
b(the)0 1850 y(Piacsek-Williams)24 b(cen)m(tred)30 b(di\013erence)e
(adv)m(ection)h(sc)m(heme)g(is)e(used.)43 b(The)29 b(discretization)d
(is)i(trans-)0 1971 y(paren)m(t,)h(and)e(a)g(sp)s(ecial)f(case)h(is)g
(used)h(for)f(the)g(top)g(mo)s(del)e(lev)m(el.)41 b(The)28
b(next)g(step)g(is)f(to)f(calculate)g(the)0 2091 y(viscosit)m(y)36
b(incremen)m(ts.)55 b(The)37 b(viscosit)m(y)f(incremen)m(t)g(is)g
(de\014ned,)i(in)e(tensor)g(notation,)g(as)g Fn(@)5 b(\034)3520
2106 y Fe(ij)3582 2091 y Fn(=@)g(x)3742 2106 y Fe(j)0
2211 y Fv(for)36 b Fn(u)209 2226 y Fe(j)245 2211 y Fv(,)h(where)g
Fn(\034)636 2226 y Fe(ij)733 2211 y Fv(is)f(the)h(pro)s(duct)f(of)g
(the)g(viscosit)m(y)-8 b(,)38 b(VIS,)f(with)e(the)i(strain)f(rate,)h
Fn(S)3276 2226 y Fe(ij)3336 2211 y Fv(.)55 b(This)36
b(no-)0 2332 y(tation)d(implies)f(summation)g(o)m(v)m(er)j(lik)m(e)f
(indices)g(so)g(that)g(the)h Fn(x)p Fv(-comp)s(onen)m(t)f(of)g(the)h
(viscous)g(term,)0 2452 y Fn(@)5 b(u)112 2467 y Fe(x)156
2452 y Fn(=@)g(t)39 b Fv(w)m(ould)e(b)s(e)h Fn(@)5 b(\034)860
2467 y Fs(11)936 2452 y Fn(=@)g(x)27 b Fv(+)e Fn(@)5
b(\034)1322 2467 y Fs(12)1398 2452 y Fn(=@)g(y)30 b Fv(+)25
b Fn(@)5 b(\034)1780 2467 y Fs(13)1856 2452 y Fn(=@)g(z)t
Fv(.)60 b(T)-8 b(o)38 b(simplify)d(the)j(discretization)f(the)h(com-)0
2573 y(p)s(onen)m(ts)31 b(of)e Fn(\034)511 2588 y Fe(ij)602
2573 y Fv(are)h(calculated)f(in)g(separate)i(arra)m(ys,)g(T)-8
b(A)m(U11,)31 b(T)-8 b(A)m(U12,)31 b(T)-8 b(A)m(U13,)31
b(T)-8 b(A)m(U22,)31 b(T)-8 b(A)m(U23)0 2693 y(and)27
b(T)-8 b(A)m(U33,)29 b(plus)d(T)-8 b(A)m(U11P1,)29 b(T)-8
b(A)m(U12M1)28 b(and)f(T)-8 b(A)m(U13M1)27 b(for)g(v)-5
b(alues)27 b(on)f(the)i(I+1)f(and)g(I-1)f(slice.)0 2813
y(T)-8 b(A)m(U12,)33 b(T)-8 b(A)m(U11,)32 b(T)-8 b(A)m(U22)33
b(and)f(T)-8 b(A)m(U33)33 b(are)f(calculated)f(on)h(P-p)s(oin)m(ts,)g
(and)g(T)-8 b(A)m(U13)33 b(and)f(T)-8 b(A)m(U23)0 2934
y(are)32 b(calculated)g(on)g(W-p)s(oin)m(ts.)43 b(The)34
b(v)-5 b(alues)32 b(of)g(VIS)h(ha)m(v)m(e)h(to)e(b)s(e)g(a)m(v)m
(eraged)i(on)m(to)e(the)h(appropriate)0 3054 y(p)s(oin)m(ts)c(for)g
(the)g(calculation)e(of)i(T)-8 b(A)m(U.)30 b(SU,)f(SV)h(and)f(SW)h(are)
f(then)h(incremen)m(ted)g(b)m(y)g(the)f(gradien)m(ts)0
3174 y(of)j(the)h(appropriate)f(T)-8 b(A)m(U)33 b(comp)s(onen)m(ts.)146
3415 y(The)c(next)g(source)h(term)d(is)h(the)g(Coriolis)e(term)i(for)f
(SU)h(and)h(SV)f(only)-8 b(.)41 b(V)29 b(needs)g(to)f(b)s(e)g(a)m(v)m
(eraged)0 3536 y(on)m(to)45 b(the)h(U)f(p)s(oin)m(ts)g(for)g(the)h(SU)g
(term,)i(and)d(U)h(on)m(to)f(the)h(V)f(p)s(oin)m(ts)g(for)g(the)h(SV)f
(term.)82 b(The)0 3656 y(Galilean)42 b(transformations,)47
b(UGAL)e(and)h(V)m(GAL,)f(are)h(added)g(bac)m(k)g(on)m(to)g(the)g(v)m
(elo)s(cities,)h(and)0 3776 y(the)c(geostrophic)g(winds,)j(UG)c(and)h
(V)m(G,)g(subtracted)h(to)f(calculate)f(the)h(correct)g(Coriolis)e
(term.)0 3897 y(Buo)m(y)m(ancy)48 b(is)d(then)i(calculated)e(for)h(SW.)
g(This)g(tak)m(es)i(t)m(w)m(o)e(parts:)71 b(the)47 b(buo)m(y)m(ancy)h
(due)e(to)g(the)0 4017 y(p)s(oten)m(tial)35 b(temp)s(erature)h(p)s
(erturbation,)g(TH,)h(and)f(that)g(due)h(to)f(the)h(virtual)d
(e\013ects)k(of)d(moisture)0 4138 y(\(reduced)30 b(mass)e(of)g(moist)f
(air,)h(loading)e(of)i(h)m(ydrometeors\).)43 b(The)29
b(virtual)e(temp)s(erature)h(co)s(e\016cien)m(t)0 4258
y(for)48 b(the)h(Q)g(\014elds)g(is)f(CQ.)h(The)g(damping)e(la)m(y)m(er)
i(in)m(v)m(olv)m(es)h(relaxing)d(the)i(\014eld)g(v)-5
b(alues)48 b(bac)m(k)i(to)0 4378 y(the)36 b(horizon)m(tal)f(mean.)53
b(F)-8 b(or)35 b(the)i(large-scale)d(forcing,)i(if)f(subsidence)j(is)d
(used)i(\(ISUBP=1\),)h(then)0 4499 y(v)m(ertical)23 b(adv)m(ection)g
(is)g(applied)f(to)h(the)h(horizon)m(tal)d(mean)i(\014elds;)k(for)c
(prescrib)s(ed)h(large-scale)e(forcing)0 4619 y(\(IF)m(OR)m(CEP=1\),)27
b(SULS)e(and)f(SVLS)h(are)g(added)g(to)f(SU)h(and)f(SV.)h(There)h(are)e
(no)h(large-scale)e(forcing)0 4739 y(terms)33 b(for)f(SW.)0
5149 y Fp(UVW1D)0 5454 y Fw(Called)k(b)m(y:)113 b Fv(D)m(YNVIS)0
5574 y Fw(Calls:)e Fv(WRAP)-8 b(,)33 b(SET0)146 5815
y(Calculates)39 b(the)h(v)m(elo)s(cit)m(y)f(source)i(terms)e(for)g
(viscosit)m(y)-8 b(,)41 b(Coriolis)d(and)h(large-scale)f(forcing)g(in)
1817 6107 y(103)p eop
%%Page: 104 107
104 106 bop 0 52 a Fv(1-D.)41 b(The)i(viscosit)m(y)f(incremen)m(t)g(is)
g(de\014ned)i(as)e Fn(@)5 b(\034)1981 67 y Fe(ij)2043
52 y Fn(=@)g(x)2203 67 y Fe(j)2282 52 y Fv(for)42 b Fn(u)2497
67 y Fe(j)2533 52 y Fv(,)i(where)g Fn(\034)2938 67 y
Fe(ij)3041 52 y Fv(is)d(the)i(pro)s(duct)f(of)0 173 y(the)e(viscosit)m
(y)-8 b(,)42 b(VIS,)e(with)f(the)h(strain)f(rate,)i Fn(S)1810
188 y Fe(ij)1871 173 y Fv(.)64 b(Ho)m(w)m(ev)m(er,)44
b(in)39 b(1-D)f(only)h Fn(@)5 b(=@)g(z)46 b Fv(terms)39
b(need)i(to)0 293 y(b)s(e)e(considered)g(so)g(that)f(the)h
(discretization)e(is)h(relativ)m(ely)f(simple.)60 b(The)39
b(comp)s(onen)m(ts)g(of)f Fn(\034)3550 308 y Fe(ij)3649
293 y Fv(are)0 414 y(calculated)44 b(in)g(separate)i(arra)m(ys)f(T)-8
b(A)m(U13)45 b(and)g(T)-8 b(A)m(U23)45 b(and)g(their)g(v)m(ertical)f
(gradien)m(t)g(giv)m(es)h(SU)0 534 y(and)h(SV.)g(SW)g(has)h(no)e
(viscous)i(source)g(term.)83 b(The)47 b(next)g(source)f(term)g(is)f
(the)h(Coriolis)e(term)0 654 y(for)37 b(SU)g(and)g(SV)h(only)-8
b(.)56 b(The)38 b(Galilean)c(transformations,)j(UGAL)g(and)g(V)m(GAL,)g
(are)h(added)f(bac)m(k)0 775 y(on)m(to)f(the)g(v)m(elo)s(cities,)g(and)
g(the)g(geostrophic)g(winds,)h(UG)f(and)g(V)m(G,)g(subtracted)h(to)e
(calculate)g(the)0 895 y(correct)g(Coriolis)c(term.)47
b(F)-8 b(or)33 b(the)h(large-scale)f(forcing,)g(if)g(subsidence)j(is)d
(used)i(\(ISUBP=1\),)g(then)0 1016 y(v)m(ertical)23 b(adv)m(ection)g
(is)g(applied)g(to)g(the)g(horizon)m(tal)f(mean)h(\014elds,)j(for)d
(prescrib)s(ed)h(large-scale)e(forcing)0 1136 y(\(IF)m(OR)m(CEP=1\))27
b(SULS)g(and)g(SVLS)g(are)f(added)h(to)g(SU)f(and)h(SV.)g(There)h(are)e
(no)h(large-scale)e(forcing)0 1256 y(terms)33 b(for)f(SW.)0
1666 y Fp(UVW2D)0 1971 y Fw(Called)k(b)m(y:)113 b Fv(D)m(YNVIS)0
2091 y Fw(Calls:)e Fv(TVDUVW2D,)33 b(WRAP)146 2332 y(Calculates)38
b(the)h(v)m(elo)s(cit)m(y)f(source)h(terms)f(for)g(the)h(adv)m(ection,)
h(viscosit)m(y)-8 b(,)40 b(Coriolis,)e(buo)m(y)m(ancy)-8
b(,)0 2452 y(damping)27 b(la)m(y)m(er)i(and)g(large-scale)e(forcing)g
(in)h(2-D.)g(Th)m(us,)j Fn(@)5 b(=@)g(x)30 b Fv(terms)f(are)f(assumed)i
(to)e(zero.)43 b(The)0 2573 y(source)32 b(terms)f(for)f(the)i(v)m(elo)s
(cit)m(y)e(comp)s(onen)m(ts,)i(U,)f(V)g(and)g(W,)h(are)f(SU,)g(SV)g
(and)g(SW)g(resp)s(ectiv)m(ely)-8 b(,)0 2693 y(and)28
b(they)g(are)f(calculated)g(in)g(parallel)d(for)j(eac)m(h)i(pro)s
(cess.)43 b(Firstly)-8 b(,)27 b(the)h(adv)m(ection)g(is)f(calculated.)
41 b(If)0 2813 y(the)35 b(UL)-8 b(TIMA)g(TE)36 b(adv)m(ection)e(sc)m
(heme)i(has)e(b)s(een)h(requested)h(for)e(momen)m(tum)f(\(ITVDUVWP=1\))
0 2934 y(then)k(the)f(adv)m(ection)h(terms)f(are)g(calculated)f(and)h
(assigned)g(to)g(SU,)g(SV)h(and)f(SW)g(in)g(the)g(routine)0
3054 y Fw(TVDUVW2D)p Fv(.)29 b(Alternativ)m(ely)-8 b(,)30
b(the)g(Piacsek-Williams)d(cen)m(tred)32 b(di\013erence)f(adv)m(ection)
f(sc)m(heme)0 3174 y(is)38 b(used.)63 b(The)40 b(discretization)d(is)h
(transparen)m(t,)k(and)c(a)h(sp)s(ecial)f(case)h(is)f(used)i(for)e(the)
i(top)e(mo)s(del)0 3295 y(lev)m(el.)55 b(The)37 b(next)g(step)h(is)e
(to)g(calculate)f(the)i(viscosit)m(y)g(incremen)m(ts.)55
b(The)38 b(viscosit)m(y)f(incremen)m(t)f(is)0 3415 y(de\014ned,)k(in)c
(tensor)i(notation,)f(as)h Fn(@)5 b(\034)1431 3430 y
Fe(ij)1492 3415 y Fn(=@)g(x)1652 3430 y Fe(j)1727 3415
y Fv(for)37 b Fn(u)1937 3430 y Fe(j)1973 3415 y Fv(,)h(where)h
Fn(\034)2367 3430 y Fe(ij)2465 3415 y Fv(is)e(the)g(pro)s(duct)h(of)e
(the)i(viscosit)m(y)-8 b(,)0 3536 y(VIS,)48 b(with)f(the)h(strain)f
(rate,)k Fn(S)1255 3551 y Fe(ij)1316 3536 y Fv(.)88 b(This)48
b(notation)e(implies)f(summation)h(o)m(v)m(er)i(lik)m(e)f(indices)g(so)
0 3656 y(that)f(the)h Fn(x)p Fv(-comp)s(onen)m(t)f(of)g(the)h(viscous)g
(term,)i Fn(@)5 b(u)2051 3671 y Fe(x)2095 3656 y Fn(=@)g(t)p
Fv(,)51 b(w)m(ould)46 b(b)s(e)h Fn(@)5 b(\034)2856 3671
y Fs(12)2932 3656 y Fn(=@)g(y)35 b Fv(+)c Fn(@)5 b(\034)3325
3671 y Fs(13)3401 3656 y Fn(=@)g(z)t Fv(.)86 b(T)-8 b(o)0
3776 y(simplify)23 b(the)j(discretization)e(the)i(comp)s(onen)m(ts)f
(of)g Fn(\034)1954 3791 y Fe(ij)2041 3776 y Fv(are)g(calculated)g(in)f
(separate)i(arra)m(ys,)i(T)-8 b(A)m(U12,)0 3897 y(T)g(A)m(U13,)39
b(T)-8 b(A)m(U22,)39 b(T)-8 b(A)m(U23)38 b(and)g(T)-8
b(A)m(U33.)58 b(T)-8 b(A)m(U12,)39 b(T)-8 b(A)m(U22)38
b(and)g(T)-8 b(A)m(U33)37 b(are)h(calculated)e(on)i(P-)0
4017 y(p)s(oin)m(ts,)g(and)g(T)-8 b(A)m(U13)37 b(and)h(T)-8
b(A)m(U23)37 b(are)h(calculated)e(on)h(W-p)s(oin)m(ts.)57
b(The)38 b(v)-5 b(alues)38 b(of)e(VIS)i(ha)m(v)m(e)h(to)0
4138 y(b)s(e)33 b(a)m(v)m(eraged)g(on)m(to)f(the)h(appropriate)e(p)s
(oin)m(ts)h(for)g(the)h(calculation)d(of)i(T)-8 b(A)m(U.)33
b(SU,)g(SV)f(and)h(SW)f(are)0 4258 y(then)h(incremen)m(ted)g(b)m(y)h
(the)f(gradien)m(ts)f(of)g(the)h(appropriate)f(T)-8 b(A)m(U)33
b(comp)s(onen)m(ts.)146 4499 y(The)c(next)g(source)h(term)d(is)h(the)g
(Coriolis)e(term)i(for)f(SU)h(and)h(SV)f(only)-8 b(.)41
b(V)29 b(needs)g(to)f(b)s(e)g(a)m(v)m(eraged)0 4619 y(on)m(to)45
b(the)h(U)f(p)s(oin)m(ts)g(for)g(the)h(SU)g(term,)i(and)d(U)h(on)m(to)f
(the)h(V)f(p)s(oin)m(ts)g(for)g(the)h(SV)f(term.)82 b(The)0
4739 y(Galilean)42 b(transformations,)47 b(UGAL)e(and)h(V)m(GAL,)f(are)
h(added)g(bac)m(k)g(on)m(to)g(the)g(v)m(elo)s(cities,)h(and)0
4860 y(the)c(geostrophic)g(winds,)j(UG)c(and)h(V)m(G,)g(subtracted)h
(to)f(calculate)f(the)h(correct)g(Coriolis)e(term.)0
4980 y(Buo)m(y)m(ancy)48 b(is)d(then)i(calculated)e(for)h(SW.)g(This)g
(tak)m(es)i(t)m(w)m(o)e(parts:)71 b(the)47 b(buo)m(y)m(ancy)h(due)e(to)
g(the)0 5101 y(p)s(oten)m(tial)35 b(temp)s(erature)h(p)s(erturbation,)g
(TH,)h(and)f(that)g(due)h(to)f(the)h(virtual)d(e\013ects)k(of)d
(moisture)0 5221 y(\(reduced)30 b(mass)e(of)g(moist)f(air,)h(loading)e
(of)i(h)m(ydrometeors\).)43 b(The)29 b(virtual)e(temp)s(erature)h(co)s
(e\016cien)m(t)0 5341 y(for)48 b(the)h(Q)g(\014elds)g(is)f(CQ.)h(The)g
(damping)e(la)m(y)m(er)i(in)m(v)m(olv)m(es)h(relaxing)d(the)i(\014eld)g
(v)-5 b(alues)48 b(bac)m(k)i(to)0 5462 y(the)36 b(horizon)m(tal)f
(mean.)53 b(F)-8 b(or)35 b(the)i(large-scale)d(forcing,)i(if)f
(subsidence)j(is)d(used)i(\(ISUBP=1\),)h(then)0 5582
y(v)m(ertical)23 b(adv)m(ection)g(is)g(applied)f(to)h(the)h(horizon)m
(tal)d(mean)i(\014elds;)k(for)c(prescrib)s(ed)h(large-scale)e(forcing)0
5702 y(\(IF)m(OR)m(CEP=1\),)27 b(SULS)e(and)f(SVLS)h(are)g(added)g(to)f
(SU)h(and)f(SV.)h(There)h(are)e(no)h(large-scale)e(forcing)0
5823 y(terms)33 b(for)f(SW.)1817 6107 y(104)p eop
%%Page: 105 108
105 107 bop 0 52 a Fp(WLA)-11 b(TENTDG)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(MICR)m(OPHYS)0 478 y Fw(Calls:)e Fv(-)146
719 y(Calculates)36 b(the)h(microph)m(ysics)g(tendency)h(diagnostics)e
(for)f(w)m(arm)i(rain.)54 b(The)37 b(inputs)g(are)f(the)0
839 y(rain)e(source)h(term,)g(RAINSOUR)m(CE,)h(and)f(the)g(rain)e(sink)
i(term,)g(RAINSINK.)g(These)h(are)f(added)0 959 y(or)45
b(subtracted)h(to)f(the)g(appropriate)f(diagnostic)g(arra)m(y)-8
b(,)48 b(DQ)p 2397 959 30 4 v 35 w(DT)d(and)g(DTH)p 3042
959 V 35 w(DT.)g(RAINSINK)0 1080 y(e\013ectiv)m(ely)f(represen)m(ts)i
(ev)-5 b(ap)s(oration,)45 b(so)f(incremen)m(ts)g(v)-5
b(ap)s(our,)46 b(but)e(reduces)i(temp)s(erature)d(and)0
1200 y(rain.)k(RAINSOUR)m(CE)36 b(represen)m(ts)g(the)f(auto)s(con)m(v)
m(ersion)g(and)f(collection)e(of)i(cloud,)g(so)g(decreases)0
1321 y(cloud)e(b)m(y)i(increasing)d(rain.)0 1730 y Fp(W)l(OUT1D)0
2035 y Fw(Called)36 b(b)m(y:)113 b Fv(DIA)m(G)0 2155
y Fw(Calls:)e Fv(WR)-8 b(TFB)146 2396 y(W)g(rites)24
b(a)f(1-D)f(\014eld,)k(FIELD,)d(of)g(length,)i(LEN,)f(to)g(the)g
(diagnostics)e(\014le)i(giv)m(en)f(b)m(y)i(unit)e(n)m(um)m(b)s(er,)0
2517 y(NUN.)33 b(This)g(is)f(ac)m(hiev)m(ed)i(b)m(y)f(calling)d
Fw(WR)-9 b(TFB)p Fv(.)0 2926 y Fp(W)l(OUT2D)0 3231 y
Fw(Called)36 b(b)m(y:)113 b Fv(DIA)m(G,)32 b(W)m(OUTPV)0
3351 y Fw(Calls:)111 b Fv(EQUA)-8 b(TE,)34 b(WR)-8 b(TYZ,)33
b(WR)-8 b(TXZ,)32 b(WR)-8 b(TXY)146 3592 y(W)g(rites)49
b(out)f(a)h(2-D)e(slices)h(of)h(the)g(\014eld,)j(FIELD,)c(to)h(the)g
(diagnostics)f(\014le)g(giv)m(en)h(b)m(y)g(unit)0 3712
y(n)m(um)m(b)s(er,)29 b(NUN.)f(Firstly)-8 b(,)28 b(if)e(the)i(\015ag)g
(L)p 1478 3712 V 35 w(INFIELD)g(suggests)h(that)e(the)i(data)e(is)g
(not)h(in)f(FIELD,)g(but)0 3833 y(in)g(FIN)g(instead,)i(then)f(FIELD)f
(is)g(set)h(to)g(FIN)f(b)m(y)i(calling)24 b Fw(EQUA)-9
b(TE)p Fv(.)27 b(Then)h(NITEST)i Fn(y)t Fv(-)p Fn(z)h
Fv(slices,)0 3953 y(NJTEST)24 b Fn(x)p Fv(-)p Fn(z)i
Fv(slices)c(and)g(NKTEST)i Fn(x)p Fv(-)p Fn(y)h Fv(slices)d(are)g
(written)g(out)g(b)m(y)h(calling)c Fw(WR)-9 b(TYZ)p Fv(,)21
b Fw(WR)-9 b(TXZ)0 4074 y Fv(and)27 b Fw(WR)-9 b(TXY)24
b Fv(NITEST,)k(NJTEST)g(and)f(NKTEST)h(times)d(resp)s(ectiv)m(ely)-8
b(,)29 b(with)d(ITEST,)i(JTEST)0 4194 y(and)33 b(KTEST)h(iden)m
(tifying)d(the)i(slice)e(to)i(write.)0 4603 y Fp(W)l(OUT3D)0
4908 y Fw(Called)j(b)m(y:)113 b Fv(DIA)m(G,)32 b(W)m(OUTPV)0
5029 y Fw(Calls:)111 b Fv(WR)-8 b(TXY)146 5269 y(W)g(rites)41
b(out)f(a)g(3-D)f(\014eld,)j(FIELD,)e(to)g(the)h(diagnostics)f(\014le)g
(giv)m(en)g(b)m(y)h(unit)f(n)m(um)m(b)s(er,)j(NUN.)0
5390 y(This)33 b(is)f(ac)m(hiev)m(ed)i(b)m(y)f(writing)e(a)i(2-D)e
(horizon)m(tal)g(slice)h(at)g(eac)m(h)h(lev)m(el)g(b)m(y)g(a)f(call)f
(to)h Fw(WR)-9 b(TXY)p Fv(.)1817 6107 y(105)p eop
%%Page: 106 109
106 108 bop 0 52 a Fp(W)l(OUTPD)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(DIA)m(G)0 478 y Fw(Calls:)e Fv(WR)-8
b(TXY)146 719 y(W)g(rites)29 b(out)g(the)g(accum)m(ulated)g
(precipitation)e(\014eld,)j(PUDDLE,)f(to)f(the)i(diagnostics)e(\014le)g
(giv)m(en)0 839 y(b)m(y)40 b(unit)e(n)m(um)m(b)s(er,)j(NUN.)e(The)h
(K=1)f(index)g(of)f(the)i(3-D)d(arra)m(y)i(FIELD)g(is)f(set)i(the)f
(relev)-5 b(an)m(t)39 b(h)m(y-)0 959 y(drometeor)27 b(index,)i(NMET,)g
(of)e(PUDDLE.)g(FIELD)g(is)h(then)g(written)f(out)g(b)m(y)i(a)e(call)f
(to)h Fw(WR)-9 b(TXY)p Fv(.)0 1364 y Fp(W)l(OUTPV)0 1670
y Fw(Called)36 b(b)m(y:)113 b Fv(DIA)m(G)0 1790 y Fw(Calls:)e
Fv(WRAP)-8 b(,)33 b(W)m(OUT2D,)g(W)m(OUT3D)146 2031 y(Calculates)26
b(and)g(writes)g(out)g(the)g(p)s(oten)m(tial)f(v)m(orticit)m(y)g
(\(PV\))i(\014eld)f(to)f(the)i(diagnostics)e(\014le)g(giv)m(en)0
2151 y(b)m(y)36 b(unit)f(n)m(um)m(b)s(er,)i(NUN.)f(The)h(PV)f(\014eld)f
(is)g(calculated)g(as)g(the)h(scalar)f(pro)s(duct)h(of)f(the)h(p)s
(oten)m(tial)0 2271 y(temp)s(erature)g(gradien)m(t)f(and)h(the)g
(absolute)g(v)m(orticit)m(y)g(v)m(ector.)54 b(The)37
b(p)s(oten)m(tial)d(temp)s(erature)i(p)s(er-)0 2392 y(turbation)24
b(is)h(TH,)h(and)g(the)g(v)m(elo)s(cit)m(y)f(comp)s(onen)m(ts)h(are)f
(U,)h(V)f(and)h(W.)f(This)h(is)f(assigned)h(to)f(FIELD,)0
2512 y(with)33 b(separate)i(calculations)d(for)h(the)h(2-D)f(and)h(3-D)
f(cases.)48 b(Finally)-8 b(,)32 b(dep)s(ending)i(on)f(the)i(v)-5
b(alue)33 b(of)0 2633 y(the)43 b(diagnostics)f(\015ag,)j(IDG,)d(the)h
(PV)g(\014eld)f(is)g(either)h(written)f(out)h(as)f(2-D)g(slices)g(b)m
(y)i(a)e(call)f(to)0 2753 y Fw(W)m(OUT2D)32 b Fv(or)h(as)f(the)h(en)m
(tire)g(3-D)e(\014eld)i(b)m(y)g(a)g(call)d(to)j Fw(W)m(OUT3D)p
Fv(.)0 3158 y Fp(W)l(OUTSURF)0 3463 y Fw(Called)j(b)m(y:)113
b Fv(DIA)m(G)0 3583 y Fw(Calls:)e Fv(WR)-8 b(TXY)146
3824 y(W)g(rites)31 b(out)g(a)g(single)f(horizon)m(tal)g(\014eld,)h
(FIN,)g(to)g(the)g(diagnostics)g(\014le)f(giv)m(en)h(b)m(y)h(unit)f(n)m
(um)m(b)s(er,)0 3945 y(NUN.)k(IHALO)g(indicates)f(whether)i(FIN)f(is)f
(dimensioned)f(with)i(horizon)m(tal)e(halo)s(es)h(or)g(not.)50
b(FIN)0 4065 y(is)30 b(assigned)h(to)g(FIELD,)f(but)i(if)d(IHALO=0)i
(then)g(v)-5 b(alues)31 b(are)g(assigned)g(to)g(the)g(horizon)m(tal)e
(halo)s(es,)0 4185 y(although)35 b(it)h(should)h(b)s(e)f(noted)h(that)g
(these)h(are)e(not)h(the)g(correct)g(v)-5 b(alues)37
b(in)e(the)i Fn(x)p Fv(-direction,)g(for)0 4306 y(whic)m(h)c(they)h
(are)e(purely)h(aesthetic.)44 b(FIELD)32 b(is)g(then)h(written)g(out)f
(b)m(y)i(a)e(call)f(to)h Fw(WR)-9 b(TXY)p Fv(.)0 4711
y Fp(WRAP)0 5016 y Fw(Called)60 b(b)m(y:)182 b Fv(SST)-8
b(AR)g(T,)53 b(STEPGAL,)h(STEP)-8 b(,)54 b(STEPW,)h(SMA)m(G,)e(SMA)m
(G2D,)g(SMA)m(G1D,)0 5136 y(UVWSR)m(CE,)33 b(UVW2D,)e(UVW1D,)g(W)m
(OUTPV,)i(RESDGS,)e(SUBDGS,)g(GETRAN,)h(BCKSCT,)0 5256
y(PSR)m(CE,)i(DIVERR,)e(POISSON,)i(PSTEP)-8 b(,)34 b(RAD)p
1934 5256 30 4 v 35 w(LEM,)f(DISTRIB)0 5377 y Fw(Calls:)111
b Fv(-)146 5618 y(Utilit)m(y)23 b(routine)i(whic)m(h)h(determines)f
Fn(y)t Fv(-direction)d(halo)s(es)j(for)f(a)h(\014eld,)i(FLD.)d(F)-8
b(or)24 b(a)h(3-D)f(or)h(single)0 5738 y(PE)40 b(2-D)d(run)i(the)h(p)s
(erio)s(dic)d(b)s(oundary)i(conditions)f(are)h(enforced)g(b)m(y)h
(setting)f(the)g(J=0)g(v)-5 b(alue)38 b(of)0 5858 y(the)33
b(input)g(\014eld,)f(FLD,)g(to)h(the)g(J=JJP)g(v)-5 b(alue)32
b(and)h(the)g(J=JJP+1)g(v)-5 b(alue)33 b(to)f(the)h(J=1)g(v)-5
b(alue.)43 b(F)-8 b(or)1817 6107 y(106)p eop
%%Page: 107 110
107 109 bop 0 52 a Fv(a)30 b(2-D)f(massiv)m(ely)h(parallel)e(run)j(the)
f(J=0)h(and)f(J=JJP+1)h(v)-5 b(alues)30 b(m)m(ust)g(b)s(e)h(passed)h
(from)d(adjacen)m(t)0 173 y(PEs.)44 b(HALOSEND)30 b(con)m(tains)g(the)h
(halo)e(to)h(b)s(e)g(sen)m(t)i(and)e(HALORECV)h(con)m(tains)f(the)h
(halo)d(to)i(b)s(e)0 293 y(receiv)m(ed.)43 b(The)30 b(J=JJP+1)e(halo)f
(is)h(made)f(b)m(y)j(sending)e(the)h(J=1)f(column)f(to)h(ILEFT)g(PEs,)j
(and)d(the)0 414 y(J=0)k(halo)g(b)m(y)h(sending)g(the)g(J=JJP)g(column)
e(to)i(IRIGHT)f(PEs.)0 823 y Fp(WRAPRECV)0 1128 y Fw(Called)k(b)m(y:)
113 b Fv(XWRAP)0 1248 y Fw(Calls:)e Fv(-)146 1489 y(Utilit)m(y)21
b(routine)g(whic)m(h)i(receiv)m(es)h(the)f Fn(x)p Fv(-direction)e(halo)
g(information)e(for)j(the)h(mo)s(del)d(\014elds.)41 b(The)0
1609 y(messages)35 b(are)f(iden)m(ti\014ed)h(b)m(y)g(the)f(tag,)h(L,)f
(ISEND)g(indicates)g(the)h(PE)g(whic)m(h)f(sen)m(t)i(the)e(messages,)0
1730 y(ISLREC)40 b(the)g(slice)e(n)m(um)m(b)s(er)i(to)e(b)s(e)i(receiv)
m(ed,)i(and)d(ISLSND)h(the)f(slice)g(n)m(um)m(b)s(er)g(that)g(w)m(as)h
(sen)m(t.)0 1850 y(Calls)d(of)g(GC)p 519 1850 30 4 v
35 w(RRECV)h(are)g(used)h(to)e(receiv)m(e)i(the)g(halo)s(es)e(of)g(the)
h(U,)g(ZU,)g(V,)g(ZV,)f(W,)h(ZW,)g(TH,)0 1971 y(ZTH,)33
b(Q)f(and)h(ZQ)f(arra)m(ys)h(whic)m(h)g(mirror)e(the)i(sending)f(calls)
g(in)g Fw(WRAPSEND)p Fv(.)0 2380 y Fp(WRAPSEND)0 2685
y Fw(Called)k(b)m(y:)113 b Fv(XWRAP)0 2805 y Fw(Calls:)e
Fv(-)146 3046 y(Utilit)m(y)29 b(routine)h(whic)m(h)i(sends)g(the)g
Fn(x)p Fv(-direction)d(halo)h(information)e(for)i(the)h(mo)s(del)e
(\014elds.)44 b(The)0 3166 y(messages)37 b(are)g(iden)m(ti\014ed)f(b)m
(y)h(the)g(tag,)g(L,)f(IRECV)h(indicates)f(the)h(PE)g(to)f(receiv)m(e)i
(the)e(messages,)0 3287 y(ISLREC)e(the)g(slice)f(n)m(um)m(b)s(er)g(to)g
(b)s(e)h(receiv)m(ed)g(and)g(ISLSND)f(the)h(slice)f(n)m(um)m(b)s(er)g
(to)g(b)s(e)h(sen)m(t.)47 b(Calls)0 3407 y(of)36 b(GC)p
268 3407 V 35 w(RSEND)h(are)f(used)i(to)e(send)i(the)f(halo)s(es)f(of)g
(the)h(U,)g(ZU,)f(V,)h(ZV,)f(W,)h(ZW,)g(TH,)g(ZTH,)g(Q)0
3528 y(and)c(ZQ)f(arra)m(ys)h(whic)m(h)g(mirror)d(the)j(receiving)g
(calls)e(in)h Fw(WRAPRECV)p Fv(.)0 3937 y Fp(WR)-11 b(T2DHEAD)0
4242 y Fw(Called)36 b(b)m(y:)113 b Fv(DIA)m(G)0 4362
y Fw(Calls:)e Fv(WR)-8 b(TNUM,)34 b(WR)-8 b(TCHA)146
4603 y(W)g(rites)22 b(the)g(names)g(of)f(the)h(2-D)f(diagnostic)f
(slices)i(to)f(the)h(diagnostic)f(header)h(string,)h(HEADER.)0
4724 y(CHAR)46 b(con)m(tains)g(the)g(name)f(of)g(the)h(\014eld)f(to)g
(b)s(e)h(written)f(out,)k(and)d(IHEAD)g(the)f(p)s(osition)f(in)0
4844 y(HEADER.)36 b(Three)g(lo)s(ops)e(are)h(conducted)i(o)m(v)m(er)f
(NITEST,)h(NJTEST)g(and)f(NKTEST,)g(the)g(n)m(um-)0 4964
y(b)s(er)31 b(of)g(diagnostic)f(slices)g(in)h(the)g Fn(y)t
Fv(-)p Fn(z)k Fv(plane,)c Fn(x)p Fv(-)p Fn(z)k Fv(plane)c(and)g
Fn(x)p Fv(-)p Fn(y)j Fv(plane)d(resp)s(ectiv)m(ely)-8
b(.)44 b(Using)31 b(calls)0 5085 y(to)i Fw(WR)-9 b(TNUM)32
b Fv(and)h Fw(WR)-9 b(TCHA)31 b Fv(for)i(eac)m(h)h(slice)e(the)h
(dimensions)f(of)h(the)h(slice)e(are)h(written)g(to)0
5205 y(HEADER,)28 b(the)h(name)f(of)f(the)i(\014eld,)g(the)f(p)s
(osition)f(of)g(the)i(slice)e(\(in)h(square)h(brac)m(k)m(ets\))h(and)e
(the)h(end)0 5325 y(of)j(\014eld)g(c)m(haracter,)i(&.)1817
6107 y(107)p eop
%%Page: 108 111
108 110 bop 0 52 a Fp(WR)-11 b(T3DHEAD)0 358 y Fw(Called)36
b(b)m(y:)113 b Fv(DIA)m(G)0 478 y Fw(Calls:)e Fv(WR)-8
b(TNUM,)34 b(WR)-8 b(TCHA)146 719 y(W)g(rites)22 b(the)g(names)g(of)f
(the)h(3-D)f(diagnostic)f(\014elds)i(to)f(the)i(diagnostic)d(header)i
(string,)i(HEADER.)0 839 y(CHAR)46 b(con)m(tains)g(the)g(name)f(of)g
(the)h(\014eld)f(to)g(b)s(e)h(written)f(out,)k(and)d(IHEAD)g(the)f(p)s
(osition)f(in)0 959 y(HEADER.)39 b(Using)f(calls)f(to)i
Fw(WR)-9 b(TNUM)37 b Fv(and)i Fw(WR)-9 b(TCHA)36 b Fv(the)j(dimensions)
f(of)g(the)h(\014eld)f(are)0 1080 y(written)31 b(to)h(HEADER)f(follo)m
(w)m(ed)g(b)m(y)h(the)g(name)f(of)g(the)h(\014eld,)g(and)f(the)h(end)h
(of)e(\014eld)g(c)m(haracter,)i(&.)0 1485 y Fp(WR)-11
b(TCHA)0 1790 y Fw(Called)36 b(b)m(y:)113 b Fv(DIA)m(G,)32
b(WR)-8 b(T2DHEAD,)33 b(WR)-8 b(T3DHEAD)0 1910 y Fw(Calls:)111
b Fv(-)146 2151 y(W)-8 b(rites)32 b(a)f(c)m(haracter)i(string,)e(CHAR,)
i(to)e(the)h(diagnostic)e(header)j(string,)e(HEADER,)h(at)g(p)s(osi-)0
2271 y(tion)g(IHEAD.)g(IHEAD)h(is)f(incremen)m(ted)h(b)m(y)h(the)f
(length)f(of)g(CHAR.)0 2676 y Fp(WR)-11 b(TFB)0 2981
y Fw(Called)36 b(b)m(y:)113 b Fv(W)m(OUT1D,)33 b(WR)-8
b(TYZ,)33 b(WR)-8 b(TXZ,)32 b(WR)-8 b(TXY)0 3102 y Fw(Calls:)111
b Fv(-)146 3343 y(W)-8 b(rites)27 b(an)g(arra)m(y)-8
b(,)28 b(R4IN,)f(of)f(length,)i(NEL)-8 b(TS,)28 b(to)e(the)h
(diagnostics)f(\014le)h(of)f(unit)h(n)m(um)m(b)s(er,)h(NUN,)0
3463 y(in)h(\014xed)i(records)f(of)g(length,)f(IREC.)i(The)g(routine)e
(will)e(write)j(to)f(an)g(incomplete)g(record,)i(and)e(also)0
3583 y(lea)m(v)m(e)37 b(an)g(incomplete)e(record)i(if)f(the)h(\015ag,)g
(IFEND,)f(is)h(zero;)i(IST)-8 b(AR)g(T)37 b(holds)f(the)i(next)f(p)s
(oin)m(t)f(to)0 3704 y(write)c(to)h(on)f(an)g(incomplete)g(record.)146
3945 y(In)m(teger)i(arithmetic)c(is)h(used)j(to)e(determine)f(ho)m(w)i
(man)m(y)f(records)i(will)c(b)s(e)i(\014lled,)f(NRECS,)i(and)0
4065 y(the)j(last)e(elemen)m(t)h(in)f(the)i(\014nal)e(record)i(is)e
(determined)h(as)g(IEND.)h(Then,)h(lo)s(oping)32 b(o)m(v)m(er)k(NRECS,)
0 4185 y(R4IN)d(is)g(written)g(to)h(the)f(arra)m(y)h(R4,)f(whic)m(h)h
(is)f(the)h(length)f(of)g(one)h(record,)g(and)f(already)g(con)m(tains)0
4306 y(an)m(y)39 b(data)g(for)f(a)g(previously)h(incomplete)e(record.)
62 b(The)40 b(index)e(of)h(R4IN)f(is)g(held)h(in)e(the)i(coun)m(ter)0
4426 y(IEL)-8 b(T)33 b(whic)m(h)f(is)g(incremen)m(ted)h(after)f(eac)m
(h)h(assignmen)m(t.)43 b(F)-8 b(or)31 b(eac)m(h)i(record,)g(R4)e(is)h
(assigned)g(to)g(the)0 4546 y(single)40 b(precision)h(arra)m(y)-8
b(,)43 b(R4SNGL,)e(whic)m(h)g(is)g(then)h(written)f(to)g(NUN.)g(The)h
(\014rst)g(\(incomplete\))0 4667 y(record)35 b(is)g(written)f(separate)
i(to)e(this)g(lo)s(op.)49 b(After)35 b(this)f(lo)s(op,)g(the)h
(remaining)e(data)h(is)g(written)h(to)0 4787 y(R4)c(as)g(an)h
(incomplete)e(record.)43 b(R4)31 b(is)g(k)m(ept)i(for)d(completion)g
(in)g(the)i(next)g(call)e(to)h Fw(WR)-9 b(TFB)p Fv(.)31
b(The)0 4908 y(exception)37 b(is)f(if)f(IFEND=1,)i(in)e(whic)m(h)i
(case)h(the)e(data)g(is)g(written)g(out)g(as)h(if)e(a)h(complete)g
(record.)0 5028 y(Finally)-8 b(,)30 b(IST)-8 b(AR)g(T)33
b(is)f(set)i(to)e(the)h(correct)g(index)g(for)f(the)h(next)g(call)e(of)
h Fw(WR)-9 b(TFB)p Fv(.)0 5433 y Fp(WR)e(TNUM)0 5738
y Fw(Called)36 b(b)m(y:)113 b Fv(DIA)m(G,)32 b(WR)-8
b(T2DHEAD,)33 b(WR)-8 b(T3DHEAD)0 5858 y Fw(Calls:)111
b Fv(EXXIT)1817 6107 y(108)p eop
%%Page: 109 112
109 111 bop 146 52 a Fv(W)-8 b(rites)53 b(an)g(in)m(teger,)58
b(NUM,)53 b(to)g(the)g(diagnostic)f(header)h(string,)58
b(HEADER,)53 b(at)f(p)s(osition)0 173 y(IHEAD.)d(The)g(n)m(um)m(b)s(er)
f(of)g(digits)f(in)g(NUM)i(is)e(determined)h(b)m(y)h(taking)f(the)g(in)
m(teger)g(v)-5 b(alue)48 b(of)0 293 y(the)30 b(base)g(10)f(logarithm)e
(of)i(NUM)h(and)g(adding)e(1.)42 b(This)30 b(is)f(assigned)h(to)f
(LENNUM.)i(If)e(LENNUM)0 414 y(is)43 b(greater)g(than)g(9)f(then)i(the)
f(routine)g(cannot)g(write)g(out)f(NUM)i(and)f Fw(EXXIT)f
Fv(is)g(called)g(with)0 534 y(ISTOPU=10.)83 b(A)45 b(format)f(string,)k
(CFMT,)f(is)e(written)g(out)h(as)f(\\\(Ix.x\)")h(where)h(x)f(represen)m
(ts)0 654 y(LENNUM,)36 b(and)f(this)g(is)g(used)h(for)f(writing)e(NUM)j
(to)f(HEADER.)g(IHEAD)h(is)e(then)i(incremen)m(ted)0
775 y(b)m(y)d(the)g(length)g(of)f(CHAR.)0 1184 y Fp(WR)-11
b(TXY)0 1489 y Fw(Called)36 b(b)m(y:)113 b Fv(W)m(OUT2D,)33
b(W)m(OUT3D,)g(W)m(OUTPD,)g(W)m(OUTSURF)0 1609 y Fw(Calls:)111
b Fv(WR)-8 b(TFB)146 1850 y(W)g(rites)42 b(a)g(2-D)f
Fn(x)p Fv(-)p Fn(y)46 b Fv(plane)41 b(of)h(the)h(arra)m(y)f(FIELD)g
(iden)m(ti\014ed)g(b)m(y)h(KPOS)g(to)f(the)g(diagnostics)0
1971 y(\014le)g(giv)m(en)h(b)m(y)g(unit)f(n)m(um)m(b)s(er,)j(NUN.)e
(This)g(needs)h(to)e(b)s(e)g(written)h(out)f(in)f(the)i(order)g
Fn(x)p Fv(,)p Fn(y)j Fv(whic)m(h)0 2091 y(is)41 b(opp)s(osite)g(to)h
(the)g(dimensions)f(of)g(FIELD,)g(and)h(halo)s(es)f(for)g(the)h(J=0)g
(and)g(J=JJP+1)g(v)-5 b(alues)0 2211 y(need)38 b(to)f(b)s(e)g
(constructed.)58 b(F)-8 b(or)36 b(the)i(single)e(PE)h(case,)i(the)f
(J=0)f(v)-5 b(alue)36 b(of)g(FIELD)h(is)g(assigned)g(to)0
2332 y(HALO,)27 b(whic)m(h)g(is)f(then)h(written)f(to)g(the)h
(diagnostics)f(\014le)g(b)m(y)h(a)f(call)f(to)h Fw(WR)-9
b(TFB)p Fv(.)26 b(Next,)i(the)f(arra)m(y)0 2452 y(TEMP)38
b(is)e(assigned)h(with)f(data)g(from)g(FIELD,)g(but)h(in)e(the)i(order)
g Fn(x)p Fv(,)p Fn(y)t Fv(.)55 b(This)37 b(is)f(also)f(written)i(to)0
2573 y(the)j(diagnostics)e(\014le)h(b)m(y)i(a)e(call)e
Fw(WR)-9 b(TFB)p Fv(.)39 b(Finally)-8 b(,)38 b(the)i(J=JJP+1)g(halo)e
(is)h(written)g(out)g(b)m(y)i(a)0 2693 y(call)31 b(to)h
Fw(WR)-9 b(TFB)32 b Fv(and)g(the)h(writing)e(of)h(the)h(\014eld)g(is)f
(completed.)146 2934 y(F)-8 b(or)28 b(the)g(m)m(ultipro)s(cessor)f
(case)j(message)e(passing)g(is)g(required)h(and)f(all)e(the)j(data)f
(is)g(written)g(out)0 3054 y(via)39 b(PE)i(0.)65 b(The)41
b(J=0)f(halo)f(is)g(written)h(out)g(with)g(all)d(PEs)42
b(writing)c(their)i(J=0)f(data)h(to)f(HALO)0 3174 y(at)34
b(the)g(lo)s(cation)e(\(IOFF\))h(whic)m(h)i(corresp)s(onds)g(to)f(the)h
(slices)e(on)h(that)g(PE.)h(This)f(is)g(sen)m(t)h(to)f(PE)h(0)0
3295 y(b)m(y)f(GC)p 289 3295 30 4 v 35 w(RSEND)f(and)g(receiv)m(ed)i
(in)d(the)h(correct)h(lo)s(cation)d(in)h(HALO)h(b)m(y)h(GC)p
2955 3295 V 35 w(RRECV.)g(HALO)f(is)0 3415 y(then)c(written)f(to)g(the)
h(diagnostics)f(\014le)g(b)m(y)h(a)f(call)f(to)h Fw(WR)-9
b(TFB)p Fv(.)28 b(The)h(main)e(\014eld)h(is)g(written)g(out)g(in)0
3536 y(NPES)39 b(segmen)m(ts)f(of)f(arra)m(y)h(TEMP)-8
b(,)39 b(dimensioned)e(\(I)s(IP)-8 b(,JJPEP\).)39 b(Eac)m(h)g(PE)f
(assigns)g(FIELD)f(at)0 3656 y(p)s(osition)30 b(JOFF)g(to)h(a)g(an)g
(arra)m(y)-8 b(,)32 b(P)-8 b(A)m(CKET,)33 b(dimensioned)e(\(I)s(IPEP)-8
b(,JJPEP\),)34 b(whic)m(h)d(is)g(then)h(sen)m(t)0 3776
y(b)m(y)40 b(GC)p 295 3776 V 35 w(RSEND)f(to)f(PE)h(0.)62
b(On)39 b(PE)h(0)e(the)h(lo)s(cal)e(data)h(is)h(assigned)g(to)f(TEMP)i
(for)f(the)g(correct)0 3897 y(JOFF,)24 b(then)g(P)-8
b(A)m(CKET)26 b(is)e(receiv)m(ed)i(from)d(the)h(other)h(PEs)g(b)m(y)g
(GC)p 2513 3897 V 35 w(RRECV)g(and)f(then)h(assigned)g(to)0
4017 y(TEMP)j(in)d(the)i(correct)g(I)g(p)s(osition,)e(IOFF.)h(Extra)h
(halo)s(es)f(are)g(put)g(in)g(place)g(for)g(I=0)g(and)g(I=I)s(IP+1)0
4138 y(for)35 b(PE)g(0)g(and)h(PE=NPES-1,)g(the)g(latter)e(signalled)f
(b)m(y)j(IEXTRA.)h(TEMP)f(is)f(then)h(written)f(out)0
4258 y(to)29 b(the)g(diagnostics)f(\014le)h(through)g(the)h(call)d(to)i
Fw(WR)-9 b(TFB)p Fv(.)28 b(Once)i(the)f(lo)s(op)f(is)g(completed,)i
(the)f(\014nal)0 4378 y(J=JJP+1)k(halo)e(is)h(written)h(out)f(in)g(the)
h(same)f(w)m(a)m(y)i(to)e(the)h(J=0)g(halo.)0 4787 y
Fp(WR)-11 b(TXZ)0 5093 y Fw(Called)36 b(b)m(y:)113 b
Fv(W)m(OUT2D)0 5213 y Fw(Calls:)e Fv(WR)-8 b(TFB)146
5454 y(W)g(rites)33 b(a)g(2-D)e Fn(x)p Fv(-)p Fn(z)38
b Fv(plane)32 b(of)h(the)g(arra)m(y)g(FIELD)g(iden)m(ti\014ed)g(b)m(y)g
(JPOS)h(to)e(the)i(diagnostics)e(\014le)0 5574 y(giv)m(en)24
b(b)m(y)i(unit)d(n)m(um)m(b)s(er)i(NUN.)g(This)f(needs)i(to)e(b)s(e)h
(written)f(out)g(in)g(the)g(order)h Fn(x)p Fv(,)p Fn(z)k
Fv(whic)m(h)c(is)f(opp)s(osite)0 5695 y(to)j(the)i(dimensions)e(of)g
(FIELD.)g(F)-8 b(or)27 b(the)i(single)d(pro)s(cessor)j(case)g(FIELD)e
(is)h(assigned)g(to)f(the)h(arra)m(y)-8 b(,)0 5815 y(TEMP)g(,)38
b(whic)m(h)f(is)f(ordered)h Fn(x)p Fv(,)p Fn(z)t Fv(.)56
b(F)-8 b(or)35 b(the)i(m)m(ultipro)s(cessor)e(case,)k(TEMP)f(is)d
(constructed)k(on)d(PE)1817 6107 y(109)p eop
%%Page: 110 113
110 112 bop 0 52 a Fv(0)36 b(to)h(con)m(tain)f(all)f(the)i(distributed)
f(data.)55 b(Eac)m(h)38 b(PE)f(assigns)g(the)g(JPOS)g(slices)g(of)f
(FIELD)g(to)h(an)0 173 y(arra)m(y)g(P)-8 b(A)m(CKET,)39
b(whic)m(h)f(is)f(sen)m(t)h(to)f(PE)g(0)g(b)m(y)h(GC)p
2002 173 30 4 v 35 w(RSEND.)g(On)f(PE)h(0,)g(P)-8 b(A)m(CKET)38
b(is)f(receiv)m(ed)0 293 y(from)27 b(the)i(other)f(PEs)i(b)m(y)f(GC)p
1124 293 V 35 w(RRECV)g(and)f(then)h(assigned)g(to)f(TEMP)i(in)d(the)i
(correct)g(I)f(p)s(osition,)0 414 y(IOFF.)g(Extra)h(halo)s(es)f(are)h
(put)f(in)g(place)h(for)f(I=0)g(and)h(I=I)s(IP+1)f(for)g(PE)i(0)e(and)h
(PE=NPES-1,)h(the)0 534 y(latter)38 b(signalled)g(b)m(y)i(IEXTRA.)g
(TEMP)h(is)e(then)g(written)h(out)f(to)g(the)g(diagnostics)g(\014le)g
(through)0 654 y(the)33 b(call)e(to)h Fw(WR)-9 b(TFB)p
Fv(.)0 1064 y Fp(WR)e(TYZ)0 1369 y Fw(Called)36 b(b)m(y:)113
b Fv(W)m(OUT2D)0 1489 y Fw(Calls:)e Fv(WR)-8 b(TFB)146
1730 y(W)g(rites)34 b(a)g(2-D)f Fn(y)t Fv(-)p Fn(z)38
b Fv(plane)c(of)f(the)i(arra)m(y)f(FIELD)g(iden)m(ti\014ed)g(b)m(y)h
(IPOS)g(to)f(the)h(diagnostics)e(\014le)0 1850 y(giv)m(en)i(b)m(y)g
(unit)f(n)m(um)m(b)s(er)h(NUN.)g(F)-8 b(or)34 b(the)h(m)m(ultipro)s
(cessor)f(case)h(the)g(PE)h(on)e(whic)m(h)h(the)g(requested)0
1971 y(slice)e(is)h(presen)m(t)i(needs)g(to)d(b)s(e)i(iden)m(ti\014ed.)
48 b(The)35 b(PE)g(is)e(giv)m(en)i(b)m(y)g(NP)f(and)h(the)f(slice)g(as)
g(ILOCAL.)0 2091 y(On)f(PE)h(NP)g(the)g(ILOCAL)f(slice)g(of)g(FIELD)g
(is)f(passed)j(to)e(PE)h(0)f(b)m(y)h(using)f(GC)p 3061
2091 V 35 w(RSEND.)h(This)f(is)0 2211 y(receiv)m(ed)40
b(on)e(PE)h(0)f(b)m(y)h(GC)p 1073 2211 V 35 w(RRECV)g(and)g(placed)f
(in)g(TEMP)-8 b(.)39 b(F)-8 b(or)38 b(the)h(case)g(where)h(the)e(slice)
g(is)0 2332 y(on)31 b(PE)g(0)f(\(including)f(the)i(single)f(PE)h
(case\))h(the)f(relev)-5 b(an)m(t)30 b(slice)g(of)g(FIELD)h(is)f
(assigned)h(directly)f(to)0 2452 y(TEMP)-8 b(.)34 b(TEMP)g(is)e(then)h
(written)g(out)f(to)h(the)g(diagnostics)e(\014le)h(b)m(y)i(a)e(call)f
(to)h Fw(WR)-9 b(TFB)p Fv(.)0 2861 y Fp(XWRAP)0 3166
y Fw(Called)36 b(b)m(y:)113 b Fv(NNSTEPS,)34 b(DIA)m(G)0
3287 y Fw(Calls:)111 b Fv(EQUA)-8 b(TE,)34 b(WRAPSEND,)f(WRAPRECV)146
3528 y(Up)s(dates)e(the)f Fn(x)p Fv(-direction)f(halo)s(es)g(for)h(eac)
m(h)g(mo)s(del)f(\014eld.)42 b(F)-8 b(or)29 b(the)i(single)d(PE)j(case)
g(the)f(halo)s(es)0 3648 y(are)h(up)s(dated)h(b)m(y)g(using)f(the)g
Fw(EQUA)-9 b(TE)30 b Fv(subroutine)h(and)h(setting)f(the)g(slice)g
(ICOPY)h(to)f(the)g(slice)0 3768 y(ID)m(A)-8 b(T)g(A)27
b(for)f(that)h(mo)s(del)e(\014eld.)41 b(F)-8 b(or)26
b(ICOPY=-1,0,I)s(IP+1)h(and)f(I)s(IP+2,)i(ID)m(A)-8 b(T)g(A=I)s(IP-1,I)
s(IP)g(,1)27 b(and)0 3889 y(2)e(resp)s(ectiv)m(ely)-8
b(.)43 b(F)-8 b(or)24 b(Bac)m(kscatter)k(runs)e(additional)d(halo)s(es)
i(corresp)s(onding)h(to)f(ICOPY=-2,I)s(IP+3)0 4009 y(and)37
b(ID)m(A)-8 b(T)g(A=I)s(IP-2,3)37 b(are)h(used.)58 b(F)-8
b(or)37 b(m)m(ultipro)s(cessor)f(runs)i(the)g(subroutines)g
Fw(WRAPSEND)0 4130 y Fv(and)33 b Fw(WRAPRECV)d Fv(are)j(used)i(to)d
(pass)i(the)f(halo)f(data)h(b)s(et)m(w)m(een)i(PEs.)46
b Fw(WRAPSEND)31 b Fv(sends)0 4250 y(the)39 b(data)f(and)h
Fw(WRAPRECV)c Fv(receiv)m(es)41 b(the)e(data)f(for)g(all)e(mo)s(del)h
(\014elds.)62 b(Halo)s(es)37 b(I=-1)h(and)h(0)0 4370
y(are)d(receiv)m(ed)i(from)d(PE)i(ILEFT)g(as)g(slices)f(I=I)s(IPEP-1)h
(and)g(I)s(IPEP)-8 b(,)37 b(whilst)f(halo)s(es)g(I=I)s(IPEP+1)0
4491 y(and)h(I)s(IPEP+2)h(are)f(receiv)m(ed)i(from)c(PE)j(IRIGHT)g(as)f
(slices)g(I=1)g(and)g(2.)57 b(F)-8 b(or)36 b(Bac)m(kscatter)j(runs)0
4611 y(the)33 b(additional)d(halo)s(es)i(for)g(I=-2)f(and)i(I)s(IPEP+3)
h(are)e(also)g(required.)0 5064 y Fx(D)161 b(Alphab)t(etical)56
b(List)e(of)g(F)-13 b(unctions)0 5433 y Fp(DQWSA)i(TDT)0
5738 y Fw(Called)36 b(b)m(y:)113 b Fv(SETMOIST,)35 b(MICR)m(O)m(X,)f
(LA)-8 b(THEA)g(T)1817 6107 y(110)p eop
%%Page: 111 114
111 113 bop 146 52 a Fv(Calculates)37 b(the)g(rate)g(of)f(c)m(hange)i
(of)e(the)h(saturation)f(mixing)f(ratio)g(of)i(air)e(with)i(temp)s
(erature)0 173 y(for)31 b(a)g(giv)m(en)g(saturation)g(mixing)e(ratio,)h
(QWSA)-8 b(T,)32 b(and)g(temp)s(erature,)f(T.)h(This)g(is)e(determined)
i(b)m(y)0 293 y(the)h(empirical)d(expression)1237 456
y(DQWSA)-8 b(TDT)28 b(=)1964 389 y(QWSA)-8 b(T)22 b Fm(\002)h
Fn(c)2493 404 y Fs(1)p 1964 433 569 4 v 2053 534 a Fv(\(T)g
Fm(\000)g Fn(c)2326 549 y Fs(2)2365 534 y Fv(\))2403
486 y Fs(2)0 683 y Fv(where)34 b Fn(c)324 698 y Fs(1)391
683 y Fv(=)27 b(4097)p Fn(:)p Fv(85313)k(and)i Fn(c)1225
698 y Fs(2)1292 683 y Fv(=)27 b(35)p Fn(:)p Fv(86.)0
1089 y Fp(GAMMAFUNC)0 1395 y Fw(Called)36 b(b)m(y:)113
b Fv(MICR)m(OSET)146 1635 y(Calculates)32 b(the)h(Gamma)e(function,)h
(\000,)g(where)1440 1864 y(\000)17 b(\()p Fn(x)p Fv(\))28
b(=)1780 1747 y Fc(Z)1863 1773 y Fi(1)1826 1935 y Fs(0)1955
1864 y Fn(e)2000 1823 y Fi(\000)p Fe(t)2084 1864 y Fn(t)2119
1823 y Fe(x)p Fi(\000)p Fs(1)2254 1864 y Fn(dt)0 2094
y Fv(This)34 b(in)m(tegral)f(is)h(calculated)f(in)h(a)g(DO)m(WHILE)g
(lo)s(op.)47 b(SUM)35 b(giv)m(es)g(the)f(in)m(tegral)f(sum)h(to)g
(date,)h(T)0 2215 y(the)g(curren)m(t)h(v)-5 b(alue)34
b(of)g Fn(t)h Fv(and)g(C)g(is)f(X-1,)h(where)g(X)g(is)f(the)h(function)
g(argumen)m(t.)49 b(F)-8 b(or)34 b(eac)m(h)h(pass)h(of)0
2335 y(the)e(DO)m(WHILE)h(lo)s(op)d(SUM)j(in)e(incremen)m(ted)h(b)m(y)h
(T**C*EXP\(-T\))g(and)f(T)g(b)m(y)h(DT=0.02.)47 b(Once)0
2455 y(T)33 b(exceeds)i(TMAX=200)e(then)g(the)g(lo)s(op)e(is)h(exited)h
(and)g(GAMMAFUNC=SUM*DT.)0 2862 y Fp(GA)l(USSFUNC)0 3167
y Fw(Called)j(b)m(y:)113 b Fv(MICR)m(OSET)146 3408 y(Calculates)32
b(the)h(double)g(in)m(tegral,)e Fn(I)8 b Fv(\()p Fn(a;)17
b(b)p Fv(\),)32 b(where)819 3642 y Fn(I)8 b Fv(\()p Fn(a;)17
b(b)p Fv(\))27 b(=)1213 3525 y Fc(Z)1296 3551 y Fi(1)1259
3713 y Fs(0)1387 3525 y Fc(Z)1470 3551 y Fi(1)1433 3713
y Fs(0)1545 3642 y Fv(\()p Fn(j)h Fv(+)22 b Fn(k)s Fv(\))1841
3601 y Fs(2)1897 3642 y Fm(j)p Fn(j)1971 3601 y Fe(b)2027
3642 y Fm(\000)h Fn(k)2181 3601 y Fe(b)2215 3642 y Fm(j)17
b Fn(j)2306 3601 y Fe(a)2347 3642 y Fn(k)2401 3601 y
Fe(b)2452 3642 y Fn(e)2497 3601 y Fi(\000)p Fs(\()p Fe(j)t
Fs(+)p Fe(k)r Fs(\))2754 3642 y Fn(d)-11 b(j)22 b(dk)0
3872 y Fv(This)27 b(in)m(tegral)f(is)h(calculated)f(in)h(t)m(w)m(o)h
(nested)h(DO)m(WHILE)f(lo)s(ops.)40 b(SUM)28 b(giv)m(es)g(the)g(in)m
(tegral)e(sum)h(to)0 3993 y(date,)j(T1)f(the)h(curren)m(t)g(v)-5
b(alue)29 b(of)g Fn(j)6 b Fv(,)29 b(T2)h(the)f(curren)m(t)i(v)-5
b(alue)28 b(of)h Fn(k)s Fv(,)h(A)f(the)h(function)e(argumen)m(t)h
Fn(a)g Fv(and)0 4113 y(B)36 b(the)h(function)f(argumen)m(t)g
Fn(b)p Fv(.)55 b(F)-8 b(or)36 b(eac)m(h)h(pass)g(of)f(the)h(DO)m(WHILE)
g(lo)s(ops)e(SUM)i(is)f(incremen)m(ted)0 4234 y(b)m(y)e
(\(T1+T2\)**2*ABS\(T1**B-T2**B\)*T1**A*T2**A*EXP\(-\(T1+T2\)\))e(and)h
(T1)g(or)g(T2)h(b)m(y)0 4354 y(DT=0.08.)48 b(Once)35
b(T1)g(and)f(T2)h(exceed)h(TMAX=18.0)f(then)g(the)g(lo)s(ops)e(are)h
(exited)h(and)g(GA)m(USS-)0 4474 y(FUNC=SUM*DT*DT.)0
4881 y Fp(QISA)-11 b(TURA)g(TION)0 5186 y Fw(Called)36
b(b)m(y:)113 b Fv(MICR)m(O)m(X)146 5427 y(Calculates)22
b(the)h(saturation)e(mixing)g(ratio)f(of)i(air)f(with)h(resp)s(ect)i
(to)e(ice)g(for)g(a)g(giv)m(en)g(temp)s(erature,)0 5547
y(T,)33 b(and)g(pressure)h(\(in)e(millibars\),)d(P)-8
b(.)32 b(This)h(is)f(determined)h(b)m(y)g(the)g(empirical)d(expression)
862 5772 y(QISA)-8 b(TURA)g(TION)29 b(=)2297 5705 y Fn(c)2339
5720 y Fs(1)p 1768 5749 1140 4 v 1768 5858 a Fv(P)23
b Fm(\002)g Fv(exp)2122 5762 y Fc(h)2161 5858 y Fn(c)2203
5873 y Fs(2)2265 5858 y Fm(\002)2365 5762 y Fc(\020)2424
5819 y Fs(T)p Fi(\000)p Fe(T)2571 5828 y Fj(0)p 2424
5835 182 4 v 2429 5893 a Fs(T)p Fi(\000)p Fe(c)2566 5902
y Fj(3)2616 5762 y Fc(\021)o(i)2727 5858 y Fm(\000)f
Fn(c)2868 5873 y Fs(4)1817 6107 y Fv(111)p eop
%%Page: 112 115
112 114 bop 0 52 a Fv(where)41 b Fn(T)346 67 y Fs(0)426
52 y Fv(is)e(the)i(freezing)e(p)s(oin)m(t)h(of)f(w)m(ater)i(in)e
(Kelvin,)i(273.15,)g Fn(c)2582 67 y Fs(1)2661 52 y Fv(=)g(3)p
Fn(:)p Fv(8,)g Fn(c)3013 67 y Fs(2)3093 52 y Fv(=)f Fm(\000)p
Fv(21)p Fn(:)p Fv(8745584,)0 173 y Fn(c)42 188 y Fs(3)109
173 y Fv(=)28 b(7)p Fn(:)p Fv(66)k(and)g Fn(c)650 188
y Fs(4)717 173 y Fv(=)c(6)p Fn(:)p Fv(109.)0 582 y Fp(QSA)-11
b(TURA)g(TION)0 887 y Fw(Called)30 b(b)m(y:)94 b Fv(SET1D,)27
b(RESDGS,)g(SETMOIST,)i(MICR)m(O)m(X,)f(MAKINGMO)m(VIES,)h(LA)-8
b(THEA)g(T)146 1128 y(Calculates)35 b(the)i(saturation)d(mixing)g
(ratio)g(of)h(air)g(with)g(resp)s(ect)i(to)f(liquid)d(w)m(ater)k(for)e
(a)g(giv)m(en)0 1248 y(temp)s(erature,)40 b(T,)e(and)h(pressure)h(\(in)
d(millibars\),)f(P)-8 b(.)39 b(This)f(is)g(determined)g(b)m(y)h(the)g
(empirical)c(ex-)0 1369 y(pression)880 1507 y(QSA)-8
b(TURA)g(TION)28 b(=)2280 1439 y Fn(c)2322 1454 y Fs(1)p
1751 1483 1140 4 v 1751 1593 a Fv(P)22 b Fm(\002)h Fv(exp)2105
1497 y Fc(h)2144 1593 y Fn(c)2186 1608 y Fs(2)2247 1593
y Fm(\002)2347 1497 y Fc(\020)2407 1554 y Fs(T)p Fi(\000)p
Fe(T)2554 1563 y Fj(0)p 2407 1570 182 4 v 2412 1627 a
Fs(T)p Fi(\000)p Fe(c)2549 1636 y Fj(3)2598 1497 y Fc(\021i)2709
1593 y Fm(\000)g Fn(c)2851 1608 y Fs(4)0 1774 y Fv(where)41
b Fn(T)346 1789 y Fs(0)426 1774 y Fv(is)e(the)i(freezing)e(p)s(oin)m(t)
h(of)f(w)m(ater)i(in)e(Kelvin,)i(273.15,)g Fn(c)2582
1789 y Fs(1)2661 1774 y Fv(=)g(3)p Fn(:)p Fv(8,)g Fn(c)3013
1789 y Fs(2)3093 1774 y Fv(=)f Fm(\000)p Fv(17)p Fn(:)p
Fv(2693882,)0 1895 y Fn(c)42 1910 y Fs(3)109 1895 y Fv(=)28
b(35)p Fn(:)p Fv(86)j(and)i Fn(c)699 1910 y Fs(4)766
1895 y Fv(=)28 b(6)p Fn(:)p Fv(109.)0 2348 y Fx(E)161
b(Pre-Compiler)53 b(Options)0 2687 y Fv(The)43 b(follo)m(wing)c(are)k
(pre-compiler)d(options)h(supp)s(orted)i(in)f(the)g(LEM.)h(These)h(are)
e(activ)-5 b(ated)42 b(b)m(y)0 2808 y(using)36 b(the)h(n)m(up)s(date)g
(pre-compiler)e(directiv)m(e)h(*DEF)g(and)g(activ)-5
b(ate)36 b(co)s(de)h(enclosed)g(b)m(y)g(*IF)f(DEF)0 2928
y(and)d(*ENDIF)f(directiv)m(es)h(in)f(the)h(LEM.)146
3169 y(POR)-8 b(T)27 b(-)g(Inclusion)f(of)g(co)s(de)h(to)g(allo)m(w)e
(mo)s(del)g(to)h(b)s(e)h(p)s(ortable)f(to)g(other)h(\(non-T3E\))g
(platforms.)146 3410 y(ESRAD,)33 b(A01)p 723 3410 30
4 v 35 w(3A,)f(A02)p 1110 3410 V 35 w(3A,)h(A70)p 1498
3410 V 34 w(1A)g(-)f(Inclusion)g(of)g(Edw)m(ards-Slingo)g(radiation)e
(co)s(de.)146 3650 y(T3E)j(-)f(Includes)i(T3E)f(sp)s(eci\014c)g(co)s
(de)g(in)f(Edw)m(ards-Slingo)g(radiation)e(co)s(de.)1817
6107 y(112)p eop
%%Page: 113 116
113 115 bop 0 52 a Fx(F)162 b(Glossary)54 b(of)g(GCOM)f(Routines)p
0 314 3239 7 v 50 399 a Fv(Routine)579 b(Description)p
0 441 V 50 526 a(GC)p 203 526 30 4 v 35 w(ABOR)-8 b(T)383
b(Ab)s(orts)33 b(program)e(execution)j(on)e(all)f(PEs.)50
646 y(GC)p 203 646 V 35 w(CONFIG)340 b(Returns)34 b(information)29
b(ab)s(out)j(the)h(GC)g(con\014guration.)50 766 y(GC)p
203 766 V 35 w(GSYNC)388 b(Sync)m(hronizes)35 b(the)e(pro)s(cessors.)50
887 y(GC)p 203 887 V 35 w(INIT)522 b(Initializes)31 b(the)i(GCOM)f
(system.)50 1007 y(GC)p 203 1007 V 35 w(IRECV)419 b(Receiv)m(es)35
b(an)d(in)m(teger)h(arra)m(y)f(from)g(a)g(sp)s(eci\014ed)h(PE.)50
1128 y(GC)p 203 1128 V 35 w(ISEND)432 b(Sends)34 b(an)f(in)m(teger)f
(arra)m(y)h(to)f(a)h(sp)s(eci\014ed)g(PE.)50 1248 y(GC)p
203 1248 V 35 w(RBCAST)327 b(Broadcasts)34 b(a)e(real)g(arra)m(y)g(to)h
(ev)m(ery)h(PE.)50 1368 y(GC)p 203 1368 V 35 w(RMAX)428
b(Returns)34 b(real)e(maxim)m(um)e(across)j(all)e(PEs.)50
1489 y(GC)p 203 1489 V 35 w(RMIN)466 b(Returns)34 b(real)e(minim)m(um)d
(across)k(all)e(PEs.)50 1609 y(GC)p 203 1609 V 35 w(RRECV)382
b(Receiv)m(es)35 b(a)d(real)g(arra)m(y)g(from)g(a)g(sp)s(eci\014ed)h
(PE.)50 1729 y(GC)p 203 1729 V 35 w(RSEND)395 b(Sends)34
b(a)f(real)e(arra)m(y)i(to)f(a)h(sp)s(eci\014ed)g(PE.)50
1850 y(GC)p 203 1850 V 35 w(RSUMR)375 b(Calculates)33
b(real)e(repro)s(ducible)h(sum)h(o)m(v)m(er)g(all)e(PEs.)50
1970 y(GCG)p 280 1970 V 34 w(R)-11 b(VECSUMR)101 b(Calculates)33
b(real)e(repro)s(ducible)h(sum)h(for)f(a)g(set)h(of)f(v)m(ectors)967
2091 y(o)m(v)m(er)i(all)d(PEs.)50 2211 y(GCG)p 280 2211
V 34 w(SPLIT)373 b(Splits)32 b(PEs)i(in)m(to)e(groups.)p
0 2254 3239 7 v 146 2452 a(Note)38 b(that)g(these)h(routines)e(are)h
(included)f(as)h(dumm)m(y)g(subprograms)f(when)i(the)g(POR)-8
b(T)38 b(pre-)0 2572 y(compiler)31 b(option)g(is)h(used.)0
3025 y Fx(G)161 b(Output)53 b(Unit)h(Num)l(b)t(ers)p
0 3287 2189 7 v 50 3371 a Fv(Unit)32 b(Num)m(b)s(er)99
b(Description)p 0 3414 V 286 3498 a(10)334 b(Diagnostics)31
b(\014le)286 3619 y(11)334 b(Message)35 b(\014le,)d Fl(mesg)286
3739 y Fv(12)334 b(Mo)s(del)32 b(dump,)h Fl(\014le)-5
b(a)286 3859 y Fv(13)334 b(Mo)s(del)32 b(dump,)h Fl(\014leb)286
3980 y Fv(14)334 b(Indicator)32 b(for)g(mo)s(del)f(dump,)i
Fl(\014lez)286 4100 y Fv(15)334 b(Run)33 b(information,)d
Fl(run)p 1641 4100 30 4 v 36 w(info)286 4221 y Fv(16)334
b(Namelist)31 b(\014le,)h Fl(nmlsetup)p Fv(,)h Fl(nmlchain)286
4341 y Fv(21)334 b(Large-scale)32 b(forcing)g(\014le,)g
Fl(F)-7 b(or)i(c)g(e.dat)286 4461 y Fv(48)334 b(Animation)30
b(information)p 0 4504 2189 7 v 286 4588 a(49)334 b(Animation)30
b(con)m(trol)i(\014le)100 4709 y(50+MYPE)150 b(Animation)30
b(\014les)j(for)f(eac)m(h)i(PE)1817 6107 y(113)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
